"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[2174],{16407:function(e,t,s){s.d(t,{i:function(){return w}});var i=s(89555),o=s(31014),n=s(13062),r=s(37523),l=s(6958),a=s(40553),d=s(47664),c=s(88464),u=s(88443),m=s(9133),p=s(82638),h=s(50111);const{Text:g}=n.T;function f(e,t){const{type:s}=e,i=" ".repeat(2*t);if("object"===s){return`${i}{\n${Object.keys(e.properties).map((s=>{const i=e.properties[s],o=i.required?"":" (optional)",n=f(i,t+1),r=2*(t+1);return`${" ".repeat(r)}${s}: ${n.slice(r)+o}`})).join(",\n")}\n${i}}`}if("array"===s){const s=2*t;return`${i}Array(${f(e.items,t).slice(s)})`}return`${i}${s}`}var v={name:"hhyoc3",styles:"margin-left:32px"};function M({spec:e}){let t=!0;void 0!==e.required?({required:t}=e):void 0!==e.optional&&e.optional&&(t=!1);const s=t?(0,h.Y)(g,{bold:!0,children:"(required)"}):(0,h.Y)(g,{color:"secondary",children:"(optional)"}),i="name"in e?e.name:"-";return(0,h.FD)(g,{css:v,children:[i," ",s]})}function A({spec:e}){const{theme:t}=(0,n.u)(),s="tensor"===e.type?`Tensor (dtype: ${(o=e)["tensor-spec"].dtype}, shape: [${o["tensor-spec"].shape}])`:f(e,0);var o;return(0,h.Y)("pre",{css:(0,i.AH)({whiteSpace:"pre-wrap",padding:t.spacing.sm,marginTop:t.spacing.sm,marginBottom:t.spacing.sm},""),children:s})}var I={name:"1q1lx84",styles:"flex:2;align-items:center"},y={name:"qejc9x",styles:"flex:3;align-items:center"};const Y=({schemaData:e})=>{const t=(0,m.isEmpty)(e),s=(0,c.A)(),i=Boolean(e&&e.length>100),[g,f]=(0,o.useState)(""),v=(0,p.t)(g),Y=(0,o.useMemo)((()=>{if(!i)return e;const t=v.toLowerCase();return null===e||void 0===e?void 0:e.filter((e=>"name"in e&&null!==e.name&&String(e.name).toLowerCase().includes(t))).slice(0,100)}),[e,v,i]);return t?(0,h.Y)(r.TableRow,{children:(0,h.Y)(r.TableCell,{children:(0,h.Y)(u.A,{id:"Wd8Tga",defaultMessage:"No schema. See <link>MLflow docs</link> for how to include input and output schema with your model.",values:{link:e=>(0,h.Y)("a",{href:d.zR,target:"_blank",rel:"noreferrer",children:e})}})})}):(0,h.FD)(h.FK,{children:[i&&(0,h.FD)(h.FK,{children:[(0,h.Y)(l.S,{}),(0,h.Y)(n.T.Hint,{children:(0,h.Y)(u.A,{id:"UYSMKb",defaultMessage:"Schema is too large to display all rows. Please search for a column name to filter the results. Currently showing {currentResults} results from {allResults} total rows.",values:{currentResults:null===Y||void 0===Y?void 0:Y.length,allResults:null===e||void 0===e?void 0:e.length}})}),(0,h.Y)(l.S,{}),(0,h.Y)(a.I,{placeholder:s.formatMessage({id:"6BqLF2",defaultMessage:"Search for a field"}),componentId:"mlflow.schema_table.search_input",value:g,onChange:e=>f(e.target.value)}),(0,h.Y)(l.S,{})]}),null===Y||void 0===Y?void 0:Y.map(((e,t)=>(0,h.FD)(r.TableRow,{children:[(0,h.Y)(r.TableCell,{css:I,children:(0,h.Y)(M,{spec:e})}),(0,h.Y)(r.TableCell,{css:y,children:(0,h.Y)(A,{spec:e})})]},t)))]})};var D={name:"ddxhyk",styles:"max-width:800px"},_={name:"1189xqs",styles:"flex:2"},R={name:"15hibo9",styles:"flex:3"},S={name:"e0dnmk",styles:"cursor:pointer"},b={name:"e0dnmk",styles:"cursor:pointer"};const w=({schema:e,defaultExpandAllRows:t})=>{const{theme:s}=(0,n.u)(),[l,a]=(0,o.useState)(t),[d,c]=(0,o.useState)(t);return(0,h.FD)(r.Table,{css:D,children:[(0,h.FD)(r.TableRow,{isHeader:!0,children:[(0,h.Y)(r.TableHeader,{componentId:"mlflow.schema_table.header.name",css:_,children:(0,h.Y)(g,{bold:!0,css:(0,i.AH)({paddingLeft:s.spacing.lg+s.spacing.xs},""),children:(0,h.Y)(u.A,{id:"Nj6Ez5",defaultMessage:"Name"})})}),(0,h.Y)(r.TableHeader,{componentId:"mlflow.schema_table.header.type",css:R,children:(0,h.Y)(g,{bold:!0,children:(0,h.Y)(u.A,{id:"2f2qeb",defaultMessage:"Type"})})})]}),(0,h.FD)(h.FK,{children:[(0,h.Y)(r.TableRow,{onClick:()=>a(!l),css:S,children:(0,h.Y)(r.TableCell,{children:(0,h.FD)("div",{css:(0,i.AH)({display:"flex",alignItems:"center",gap:s.spacing.xs},""),children:[(0,h.Y)("div",{css:(0,i.AH)({width:s.spacing.lg,height:s.spacing.lg,display:"flex",alignItems:"center",justifyContent:"center",svg:{color:s.colors.textSecondary}},""),children:l?(0,h.Y)(r.MinusSquareIcon,{}):(0,h.Y)(r.PlusSquareIcon,{})}),(0,h.Y)(u.A,{id:"sxlGRc",defaultMessage:"Inputs ({numInputs})",values:{numInputs:e.inputs.length}})]})})}),l&&(0,h.Y)(Y,{schemaData:e.inputs}),(0,h.Y)(r.TableRow,{onClick:()=>c(!d),css:b,children:(0,h.Y)(r.TableCell,{children:(0,h.FD)("div",{css:(0,i.AH)({display:"flex",alignItems:"center",gap:s.spacing.xs},""),children:[(0,h.Y)("div",{css:(0,i.AH)({width:s.spacing.lg,height:s.spacing.lg,display:"flex",alignItems:"center",justifyContent:"center",svg:{color:s.colors.textSecondary}},""),children:d?(0,h.Y)(r.MinusSquareIcon,{}):(0,h.Y)(r.PlusSquareIcon,{})}),(0,h.Y)(u.A,{id:"llVQ2r",defaultMessage:"Outputs ({numOutputs})",values:{numOutputs:e.outputs.length}})]})})}),d&&(0,h.Y)(Y,{schemaData:e.outputs})]})]})}},17765:function(e,t,s){s.r(t),s.d(t,{ModelVersionPage:function(){return he},ModelVersionPageImpl:function(){return ue},default:function(){return ge}});var i=s(31014),o=s(10811),n=s(69708),r=s(26809),l=s(65871),a=s(9133),d=s.n(a),c=s(93215),u=s(69869),m=s(3966),p=s(13062),h=s(6958),g=s(88464),f=s(88443),v=s(7204),M=s(76010),A=s(59508),I=s(87665),y=s(50111);var Y={name:"1yh8glp",styles:"margin-top:-12px"};const D=e=>{const t=(0,g.A)(),s=(0,c.Zp)(),r=(0,i.useRef)((0,v.yk)()),l=(0,i.useRef)((0,v.yk)()),{modelVersion:d}=e,[m,D]=(0,i.useState)(!1),[_,R]=(0,i.useState)(!1),S=(0,o.wA)(),b=(0,o.d4)((e=>e.entities.modelByName)),w=(0,i.useRef)(),C=()=>{D(!1),R(!1)},T=e=>{R(!1),M.A.logErrorAndNotifyUser(e)},V=(0,i.useCallback)((e=>{S((0,n.JK)((0,A.pc)(e),5))}),[S]),E=(0,i.useMemo)((()=>(0,a.debounce)(V,300)),[V]);(0,i.useEffect)((()=>{S((0,n.JK)())}),[S]),(0,i.useEffect)((()=>{m&&S((0,n.JK)())}),[S,m]);return(0,y.FD)("div",{className:"promote-model-btn-wrapper",children:[(0,y.Y)(p.B,{componentId:"codegen_mlflow_app_src_model-registry_components_promotemodelbutton.tsx_165",className:"promote-model-btn",type:"primary",onClick:()=>{D(!0)},children:(0,y.Y)(f.A,{id:"+RYBrq",defaultMessage:"Promote model"})}),(0,y.Y)(h.d,{title:(0,y.Y)(f.A,{id:"oBjwod",defaultMessage:"Promote {sourceModelName} version {sourceModelVersion}",values:{sourceModelName:d.name,sourceModelVersion:d.version}}),width:640,visible:m,onOk:()=>{w.current.validateFields().then((e=>{R(!0);const t=e[I.BE],i="models:/"+d.name+"/"+d.version;if(t===I.QN){const t=e[I.F3];S((0,n.eF)(t,r.current)).then((()=>S((0,n.Ey)(t,i,d.run_id,d.tags,l.current)))).then((e=>{C();const{version:i}=e.value.model_version;s(u.fM.getModelVersionPageRoute(t,i))})).catch(T)}else S((0,n.Ey)(t,i,d.run_id,d.tags,l.current)).then((e=>{C();const{version:i}=e.value.model_version;s(u.fM.getModelVersionPageRoute(t,i))})).catch(T)}))},okText:t.formatMessage({id:"DCkSC3",defaultMessage:"Promote"}),cancelText:t.formatMessage({id:"0tU5gv",defaultMessage:"Cancel"}),confirmLoading:_,onCancel:()=>{D(!1)},centered:!0,children:(0,y.FD)(y.FK,{children:[(0,y.Y)(p.T.Paragraph,{css:Y,children:(0,y.Y)(f.A,{id:"V5cjvM",defaultMessage:"Copy your MLflow models to another registered model for simple model promotion across environments. For more mature production-grade setups, we recommend setting up automated model training workflows to produce models in controlled environments. <link>Learn more</link>",values:{link:e=>(0,y.Y)(p.T.Link,{componentId:"codegen_mlflow_app_src_model-registry_components_promotemodelbutton.tsx_140",href:"https://mlflow.org/docs/latest/model-registry.html#promoting-an-mlflow-model-across-environments",openInNewTab:!0,children:e})}})}),(0,y.Y)(I.xH,{modelByName:b,innerRef:w,onSearchRegisteredModels:E,isCopy:!0})]})})]})};var _=s(16407),R=s(89555),S=s(37523),b=s(81866),w=s(13369);let C=function(e){return e[e.RequestOrDirect=0]="RequestOrDirect",e[e.Approve=1]="Approve",e[e.Reject=2]="Reject",e[e.Cancel=3]="Cancel",e}({});const T=({visible:e,onCancel:t,toStage:s,allowArchivingExistingVersions:o,transitionDescription:n,onConfirm:r,mode:l=C.RequestOrDirect})=>{const{theme:a}=(0,p.u)(),d=(0,w.mN)({defaultValues:{comment:"",archiveExistingVersions:!1}});return(0,i.useEffect)((()=>{e&&d.reset()}),[d,e]),(0,y.FD)(h.d,{title:l===C.Approve?(0,y.Y)(f.A,{id:"CjBv5h",defaultMessage:"Approve pending request"}):l===C.Reject?(0,y.Y)(f.A,{id:"dzoxyA",defaultMessage:"Reject pending request"}):l===C.Cancel?(0,y.Y)(f.A,{id:"bS/iHC",defaultMessage:"Cancel pending request"}):(0,y.Y)(f.A,{id:"rxMHgr",defaultMessage:"Stage transition"}),componentId:"mlflow.model_registry.stage_transition_modal_v2",visible:e,onCancel:t,okText:(0,y.Y)(f.A,{id:"7PCvDy",defaultMessage:"OK"}),cancelText:(0,y.Y)(f.A,{id:"25VTYi",defaultMessage:"Cancel"}),onOk:r&&d.handleSubmit(r),children:[n,(0,y.Y)(h.S,{size:"sm"}),(0,y.Y)(S.FormUI.Label,{htmlFor:"mlflow.model_registry.stage_transition_modal_v2.comment",children:"Comment"}),(0,y.Y)(S.RHFControlledComponents.TextArea,{name:"comment",id:"mlflow.model_registry.stage_transition_modal_v2.comment",componentId:"mlflow.model_registry.stage_transition_modal_v2.comment",control:d.control,rows:4}),(0,y.Y)(h.S,{size:"sm"}),o&&s&&(0,y.Y)(S.RHFControlledComponents.Checkbox,{name:"archiveExistingVersions",componentId:"mlflow.model_registry.stage_transition_modal_v2.archive_existing_versions",control:d.control,children:(0,y.Y)(h.T,{componentId:"mlflow.model_registry.stage_transition_modal_v2.archive_existing_versions.tooltip",content:(0,b.gL)(s),children:(0,y.Y)("span",{css:(0,R.AH)({"[role=status]":{marginRight:a.spacing.xs}},""),children:(0,y.Y)(f.A,{id:"rAJDzz",defaultMessage:"Transition existing {currentStage} model version to {archivedStage}",values:{currentStage:(0,y.Y)("span",{css:(0,R.AH)({marginLeft:a.spacing.xs},""),children:b.$0[s]}),archivedStage:(0,y.Y)("span",{css:(0,R.AH)({marginLeft:a.spacing.xs},""),children:b.$0[b.e3.ARCHIVED]})}})})})})]})};class V extends i.Component{constructor(...e){super(...e),this.state={confirmModalVisible:!1,confirmingActivity:null,handleConfirm:void 0},this.handleMenuItemClick=e=>{const{onSelect:t}=this.props;this.setState({confirmModalVisible:!0,confirmingActivity:e,handleConfirm:t&&(s=>{if(this.setState({confirmModalVisible:!1}),s){const{archiveExistingVersions:i=!1}=s;t(e,i)}else;})})},this.handleConfirmModalCancel=()=>{this.setState({confirmModalVisible:!1})},this.getNoneCurrentStages=e=>{const t=Object.values(b.e3);return d().remove(t,(t=>t===e)),t}}getMenu(){const{currentStage:e}=this.props,t=this.getNoneCurrentStages(e);return(0,y.Y)(S.Menu,{children:t.map((e=>(0,y.FD)(S.Menu.Item,{onClick:()=>this.handleMenuItemClick({type:b.$p.APPLIED_TRANSITION,to_stage:e}),children:[(0,y.Y)(f.A,{id:"UhdPmo",defaultMessage:"Transition to"}),"\xa0\xa0\xa0",(0,y.Y)(S.ArrowRightIcon,{}),"\xa0\xa0\xa0",b.$0[e]]},`transition-to-${e}`)))})}renderConfirmModal(){const{confirmModalVisible:e,confirmingActivity:t,handleConfirm:s}=this.state;if(!t)return null;const i=t.type===b.$p.APPLIED_TRANSITION&&b.jI.includes(t.to_stage);return(0,y.Y)(T,{visible:e,toStage:t.to_stage,onConfirm:s,onCancel:this.handleConfirmModalCancel,transitionDescription:E(t),allowArchivingExistingVersions:i})}render(){const{currentStage:e}=this.props;return(0,y.FD)("span",{children:[(0,y.Y)(S.Dropdown,{overlay:this.getMenu(),trigger:["click"],className:"mlflow-stage-transition-dropdown",children:(0,y.FD)("span",{children:[b.$0[null!==e&&void 0!==e?e:b.e3.NONE],(0,y.Y)(S.ChevronDownIcon,{css:(0,R.AH)({cursor:"pointer",marginLeft:-4},"")})]})}),this.renderConfirmModal()]})}}V.defaultProps={currentStage:b.e3.NONE};const E=e=>e?(0,y.FD)("div",{children:[(0,y.Y)(f.A,{id:"ZYBoeF",defaultMessage:"Transition to"}),"\xa0\xa0\xa0",(0,y.Y)(S.ArrowRightIcon,{}),"\xa0\xa0\xa0",b.$0[e.to_stage]]}):null;var N=s(90925),k=s(47664),x=s(58481),F=s(10405),P=s(96034),q=s(41287),L=s(79085),$=s(64912);var O=s(73414),H=s(84963),U=s(91144),K=s(23381),B=s(86020);const j=e=>(0,y.Y)(f.A,{id:"4Jyn2b",defaultMessage:"Add/Edit alias for model version {version}",values:{version:e}});var z={name:"lkh5er",styles:"display:flex;flex-wrap:wrap;align-items:center"};const G=({aliases:e=[],modelEntity:t,version:s,onAliasesModified:r})=>{var l;const a=(0,o.wA)(),{EditAliasesModal:d,showEditAliasesModal:c}=(0,K.t)({aliases:null!==(l=null===t||void 0===t?void 0:t.aliases)&&void 0!==l?l:[],onSuccess:r,onSave:async(e,s,i)=>{var o;return a((0,n.mq)(null!==(o=null===t||void 0===t?void 0:t.name)&&void 0!==o?o:"",e,s,i))},getTitle:j,description:(0,y.Y)(f.A,{id:"2DNVN4",defaultMessage:"Aliases allow you to assign a mutable, named reference to a particular model version. <link>Learn more</link>",values:{link:e=>(0,y.Y)("a",{href:b.Tm,rel:"noreferrer",target:"_blank",children:e})}})}),u=(0,i.useCallback)((()=>{c(s)}),[c,s]);return(0,y.FD)(y.FK,{children:[d,e.length<1?(0,y.Y)(p.B,{componentId:"codegen_mlflow_app_src_model-registry_components_aliases_modelversionviewaliaseditor.tsx_29",size:"small",type:"link",onClick:u,title:"Add aliases",children:"Add"}):(0,y.FD)("div",{css:z,children:[e.map((e=>(0,y.Y)(B.Z,{compact:!0,value:e},e))),(0,y.Y)(p.B,{componentId:"codegen_mlflow_app_src_model-registry_components_aliases_modelversionviewaliaseditor.tsx_37",size:"small",icon:(0,y.Y)(S.PencilIcon,{}),onClick:u,title:"Edit aliases"})]})]})};var Q=s(52350);var W={name:"s5xdrg",styles:"display:flex;align-items:center"},J={name:"gc6sdx",styles:"padding-left:4px"},Z={name:"vw6wts",styles:"margin-top:8px;display:flex;justify-content:flex-end"};class X extends i.Component{constructor(...e){super(...e),this.state={isDeleteModalVisible:!1,isDeleteModalConfirmLoading:!1,showDescriptionEditor:!1,isTagsRequestPending:!1,isTagAssignmentModalVisible:!1,isSavingTags:!1,tagSavingError:void 0},this.formRef=i.createRef(),this.sharedTaggingUIEnabled=(0,U.V0)(),this.handleDeleteConfirm=()=>{const{modelName:e="",modelVersion:t,navigate:s}=this.props,{version:i}=t;this.showConfirmLoading(),this.props.deleteModelVersionApi(e,i).then((()=>{s(u.fM.getModelPageRoute(e))})).catch((e=>{this.hideConfirmLoading(),M.A.logErrorAndNotifyUser(e)}))},this.showDeleteModal=()=>{this.setState({isDeleteModalVisible:!0})},this.hideDeleteModal=()=>{this.setState({isDeleteModalVisible:!1})},this.showConfirmLoading=()=>{this.setState({isDeleteModalConfirmLoading:!0})},this.hideConfirmLoading=()=>{this.setState({isDeleteModalConfirmLoading:!1})},this.handleCancelEditDescription=()=>{this.setState({showDescriptionEditor:!1})},this.handleSubmitEditDescription=e=>this.props.handleEditDescription(e).then((()=>{this.setState({showDescriptionEditor:!1})})),this.startEditingDescription=e=>{e.stopPropagation(),this.setState({showDescriptionEditor:!0})},this.getTags=()=>d().sortBy(M.A.getVisibleTagValues(this.props.tags).map((([e,t])=>({key:e,name:e,value:t}))),"name"),this.handleCloseTagAssignmentModal=()=>{this.setState({isTagAssignmentModalVisible:!1,tagSavingError:void 0})},this.handleEditTags=()=>{this.setState({isTagAssignmentModalVisible:!0,tagSavingError:void 0})},this.handleSaveTags=(e,t)=>{this.setState({isSavingTags:!0});const{modelName:s}=this.props,{version:i}=this.props.modelVersion,o=e.map((({key:e,value:t})=>this.props.setModelVersionTagApi(s,i,e,t))),n=t.map((({key:e})=>this.props.deleteModelVersionTagApi(s,i,e)));return Promise.all([...o,...n]).then((()=>{this.setState({isSavingTags:!1})})).catch((e=>{const t=e instanceof Q.s?e.getMessageField():e.message;this.setState({isSavingTags:!1,tagSavingError:t})}))},this.handleAddTag=e=>{const t=this.formRef.current,{modelName:s}=this.props,{version:i}=this.props.modelVersion;this.setState({isTagsRequestPending:!0}),this.props.setModelVersionTagApi(s,i,e.name,e.value).then((()=>{this.setState({isTagsRequestPending:!1}),t.resetFields()})).catch((e=>{this.setState({isTagsRequestPending:!1}),console.error(e);const t=e instanceof Q.s?e.getMessageField():e.message;M.A.displayGlobalErrorNotification(this.props.intl.formatMessage({id:"IWuVOI",defaultMessage:"Failed to add tag. Error: {userVisibleError}"},{userVisibleError:t}))}))},this.handleSaveEdit=({name:e,value:t})=>{const{modelName:s}=this.props,{version:i}=this.props.modelVersion;return this.props.setModelVersionTagApi(s,i,e,t).catch((e=>{console.error(e);const t=e instanceof Q.s?e.getMessageField():e.message;M.A.displayGlobalErrorNotification(this.props.intl.formatMessage({id:"HNLDYl",defaultMessage:"Failed to set tag. Error: {userVisibleError}"},{userVisibleError:t}))}))},this.handleDeleteTag=({name:e})=>{const{modelName:t}=this.props,{version:s}=this.props.modelVersion;return this.props.deleteModelVersionTagApi(t,s,e).catch((e=>{console.error(e);const t=e instanceof Q.s?e.getMessageField():e.message;M.A.displayGlobalErrorNotification(this.props.intl.formatMessage({id:"Ay+ZP/",defaultMessage:"Failed to delete tag. Error: {userVisibleError}"},{userVisibleError:t}))}))},this.renderAliasEditor=()=>{var e,t;const s=this.props.modelVersion.version,i=(null===(e=this.props.modelEntity)||void 0===e||null===(t=e.aliases)||void 0===t?void 0:t.filter((({version:e})=>e===s)).map((({alias:e})=>e)))||[];return(0,y.Y)(N.K.Item,{label:this.props.intl.formatMessage({id:"HzGYm5",defaultMessage:"Aliases"}),children:(0,y.Y)(G,{aliases:i,version:this.props.modelVersion.version,modelEntity:this.props.modelEntity,onAliasesModified:this.props.onAliasesModified})},"description-key-aliases")}}componentDidMount(){const e=`${this.props.modelName} v${this.props.modelVersion.version} - MLflow Model`;M.A.updatePageTitle(e)}shouldHideDeleteOption(){return!1}renderStageDropdown(e){const{handleStageTransitionDropdownSelect:t}=this.props;return(0,y.Y)(N.K.Item,{label:this.props.intl.formatMessage({id:"IHyeUr",defaultMessage:"Stage"}),children:e.status===b.IP.READY?(0,y.Y)(V,{currentStage:e.current_stage,permissionLevel:e.permission_level,onSelect:t}):b.$0[e.current_stage]},"description-key-stage")}renderDisabledStage(e){const t=(0,y.Y)(f.A,{id:"gIc8Lp",defaultMessage:"Stages have been deprecated in the new Model Registry UI. Learn how to migrate models <link>here</link>.",values:{link:e=>(0,y.Y)(p.T.Link,{componentId:"codegen_mlflow_app_src_model-registry_components_modelversionview.tsx_301",href:k.pG,openInNewTab:!0,children:e})}});return(0,y.Y)(N.K.Item,{label:this.props.intl.formatMessage({id:"paQ2Wc",defaultMessage:"Stage (deprecated)"}),children:(0,y.FD)("div",{css:W,children:[b.QQ[e.current_stage],(0,y.Y)(S.LegacyTooltip,{title:t,placement:"bottom",children:(0,y.Y)(h.I,{css:J})})]})},"description-key-stage-disabled")}renderRegisteredTimestampDescription(e){return(0,y.Y)(N.K.Item,{label:this.props.intl.formatMessage({id:"+1i81u",defaultMessage:"Registered At"}),children:M.A.formatTimestamp(e,this.props.intl)},"description-key-register")}renderCreatorDescription(e){return e&&(0,y.Y)(N.K.Item,{label:this.props.intl.formatMessage({id:"5Mzn2b",defaultMessage:"Creator"}),children:e},"description-key-creator")}renderLastModifiedDescription(e){return(0,y.Y)(N.K.Item,{label:this.props.intl.formatMessage({id:"o7dzKo",defaultMessage:"Last Modified"}),children:M.A.formatTimestamp(e,this.props.intl)},"description-key-modified")}renderSourceRunDescription(){var e;return null!==(e=this.props.modelVersion)&&void 0!==e&&e.run_id?(0,y.Y)(N.K.Item,{label:this.props.intl.formatMessage({id:"+LLlvi",defaultMessage:"Source Run"}),className:"linked-run",children:this.resolveRunLink()},"description-key-source-run"):null}renderCopiedFromLink(){const{source:e}=this.props.modelVersion;if(!e||!/^models:\/[^/]+\/[^/]+$/.test(e))return null;const t=e.split("/"),s=t[1],i=t[2],o=(0,y.FD)(y.FK,{children:[(0,y.Y)(c.N_,{"data-test-id":"copied-from-link",to:u.fM.getModelVersionPageRoute(s,i),children:s}),"\xa0",(0,y.Y)(f.A,{id:"1RxxTj",defaultMessage:"(Version {sourceModelVersion})",values:{sourceModelVersion:i}})]});return(0,y.Y)(N.K.Item,{label:this.props.intl.formatMessage({id:"oZReP2",defaultMessage:"Copied from"}),children:o},"description-key-copied-from")}getDescriptions(e){const{usingNextModelsUI:t}=this.props;return[this.renderRegisteredTimestampDescription(e.creation_timestamp),this.renderCreatorDescription(e.user_id),this.renderLastModifiedDescription(e.last_updated_timestamp),this.renderSourceRunDescription(),this.renderCopiedFromLink(),t?this.renderAliasEditor():this.renderStageDropdown(e),t?this.renderDisabledStage(e):null].filter((e=>null!==e))}renderMetadata(e){return(0,y.Y)(N.K,{columns:5,className:"metadata-list",children:this.getDescriptions(e)})}renderStatusAlert(){const{status:e,status_message:t}=this.props.modelVersion;if(e!==b.IP.READY){const s=b.zA[e],i=e===b.IP.FAILED_REGISTRATION?"error":"info";return(0,y.Y)(S.Alert,{type:i,className:`mlflow-status-alert mlflow-status-alert-${i}`,message:t||s,icon:b.UA[e],banner:!0})}return null}renderDescriptionEditIcon(){return(0,y.FD)(p.B,{componentId:"codegen_mlflow_app_src_model-registry_components_modelversionview.tsx_516","data-test-id":"descriptionEditButton",type:"link",onClick:this.startEditingDescription,children:[(0,y.Y)(f.A,{id:"Ik96R6",defaultMessage:"Edit"})," "]})}resolveRunLink(){const{modelVersion:e,runInfo:t}=this.props;if(e.run_link)return(0,y.Y)("a",{target:"_blank",href:e.run_link,children:this.resolveRunName()});if(t){var s;let e=null;const i=null===(s=this.props.modelVersion)||void 0===s?void 0:s.source;return i&&(e=function(e,t){var s;return null===(s=e.match(new RegExp(`/${t}/artifacts/(.+)`)))||void 0===s?void 0:s[1]}(i,t.runUuid)),(0,y.Y)(c.N_,{to:x.Ay.getRunPageRoute(t.experimentId,t.runUuid,e),children:this.resolveRunName()})}return null}resolveRunName(){const{modelVersion:e,runInfo:t,runDisplayName:s}=this.props;return e.run_link?e.run_link.substr(0,37)+"...":t?s||t.runUuid:null}renderPomoteModelButton(){const{modelVersion:e,usingNextModelsUI:t,navigate:s}=this.props;return t?(0,y.Y)(D,{modelVersion:e}):null}renderTags(){return this.sharedTaggingUIEnabled?(0,y.Y)(N.K,{columns:1,"data-testid":"model-view-tags",children:(0,y.Y)(N.K.Item,{label:"Tags",children:(0,y.Y)(m.L,{tags:this.getTags(),onEdit:this.handleEditTags})})}):null}getPageHeader(e,t){const s=[{id:"delete",itemName:(0,y.Y)(f.A,{id:"4+RPaz",defaultMessage:"Delete"}),onClick:this.showDeleteModal,disabled:b.jI.includes(this.props.modelVersion.current_stage)}];return(0,y.FD)(L.z,{title:e,breadcrumbs:t,children:[!this.shouldHideDeleteOption()&&(0,y.Y)(L.o,{menu:s}),this.renderPomoteModelButton()]})}render(){const{modelName:e="",modelVersion:t,tags:s,schema:i}=this.props,{description:o}=t,{isDeleteModalVisible:n,isDeleteModalConfirmLoading:r,showDescriptionEditor:l,isTagsRequestPending:a}=this.state,d=(0,y.Y)(f.A,{id:"F16DNA",defaultMessage:"Version {versionNum}",values:{versionNum:t.version}}),m=[(0,y.Y)(c.N_,{to:u.fM.modelListPageRoute,children:(0,y.Y)(f.A,{id:"pl1bdY",defaultMessage:"Registered Models"})}),(0,y.Y)(c.N_,{"data-test-id":"breadcrumbRegisteredModel",to:u.fM.getModelPageRoute(e),children:e})];return(0,y.FD)("div",{children:[this.getPageHeader(d,m),this.renderStatusAlert(),this.renderMetadata(t),this.renderTags(),(0,U.WX)()&&(0,y.Y)("div",{css:Z,children:(0,y.Y)(H.C,{})}),(0,y.Y)(F.i,{title:(0,y.FD)("span",{children:[(0,y.Y)(f.A,{id:"z9UqPZ",defaultMessage:"Description"})," ",l?null:this.renderDescriptionEditIcon()]}),forceOpen:l,defaultCollapsed:!o,"data-test-id":"model-version-description-section",children:(0,y.Y)(P.V,{defaultMarkdown:o,onSubmit:this.handleSubmitEditDescription,onCancel:this.handleCancelEditDescription,showEditor:l})}),!this.sharedTaggingUIEnabled&&(0,y.Y)("div",{"data-test-id":"tags-section",children:(0,y.Y)(F.i,{title:(0,y.Y)(f.A,{id:"TlFUsN",defaultMessage:"Tags"}),defaultCollapsed:0===M.A.getVisibleTagValues(s).length,"data-test-id":"model-version-tags-section",children:(0,y.Y)(q.h,{innerRef:this.formRef,handleAddTag:this.handleAddTag,handleDeleteTag:this.handleDeleteTag,handleSaveEdit:this.handleSaveEdit,tags:s,isRequestPending:a})})}),(0,y.Y)(F.i,{title:(0,y.Y)(f.A,{id:"gUdmaJ",defaultMessage:"Schema"}),"data-test-id":"model-version-schema-section",children:(0,y.Y)(_.i,{schema:i})}),(0,y.Y)(h.d,{title:this.props.intl.formatMessage({id:"98Ub01",defaultMessage:"Delete Model Version"}),visible:n,confirmLoading:r,onOk:this.handleDeleteConfirm,okText:this.props.intl.formatMessage({id:"ICtiKS",defaultMessage:"Delete"}),okType:"danger",onCancel:this.hideDeleteModal,cancelText:this.props.intl.formatMessage({id:"zMhOr3",defaultMessage:"Cancel"}),children:(0,y.Y)("span",{children:(0,y.Y)(f.A,{id:"88l+j9",defaultMessage:"Are you sure you want to delete model version {versionNum}? This cannot be undone.",values:{versionNum:t.version}})})})]})}}const ee={setModelVersionTagApi:n.Id,deleteModelVersionTagApi:n.nZ},te=(0,o.Ng)(((e,t)=>{const{modelName:s}=t,{version:i}=t.modelVersion;return{tags:(0,l.hs)(s,i,e)}}),ee)((0,O.p)((0,$.Ay)(X)));var se=s(26458),ie=s(68621),oe=s(82214),ne=s(96277),re=s(24478),le=s(48588),ae=s(25869),de=s(20109),ce=s(62448);class ue extends i.Component{constructor(...e){super(...e),this.listTransitionRequestId=void 0,this.pollIntervalId=void 0,this.initGetModelVersionDetailsRequestId=(0,v.yk)(),this.getRunRequestId=(0,v.yk)(),this.updateModelVersionRequestId=(0,v.yk)(),this.transitionModelVersionStageRequestId=(0,v.yk)(),this.getModelVersionDetailsRequestId=(0,v.yk)(),this.initGetMlModelFileRequestId=(0,v.yk)(),this.state={criticalInitialRequestIds:[this.initGetModelVersionDetailsRequestId,this.initGetMlModelFileRequestId]},this.pollingRelatedRequestIds=[this.getModelVersionDetailsRequestId,this.getRunRequestId],this.hasPendingPollingRequest=()=>this.pollingRelatedRequestIds.every((e=>{const t=this.props.apis[e];return Boolean(t&&t.active)})),this.loadData=e=>{const t=[this.getModelVersionDetailAndRunInfo(e)];return Promise.all(t)},this.pollData=()=>{const{modelName:e,version:t,navigate:s}=this.props;return!this.hasPendingPollingRequest()&&M.A.isBrowserTabVisible()?this.loadData().catch((i=>{"RESOURCE_DOES_NOT_EXIST"===i.getErrorCode()?(M.A.logErrorAndNotifyUser(i),this.props.deleteModelVersionApi(e,t,void 0,!0),s(u.fM.getModelPageRoute(e))):console.error(i)})):Promise.resolve()},this.handleStageTransitionDropdownSelect=(e,t)=>{const{modelName:s,version:i}=this.props,o=e.to_stage;e.type===b.$p.APPLIED_TRANSITION&&this.props.transitionModelVersionStageApi(s,i.toString(),o,t,this.transitionModelVersionStageRequestId).then(this.loadData).catch(M.A.logErrorAndNotifyUser)},this.handleEditDescription=e=>{const{modelName:t,version:s}=this.props;return this.props.updateModelVersionApi(t,s,e,this.updateModelVersionRequestId).then(this.loadData).catch(console.error)},this.loadModelDataWithAliases=()=>{this.props.getRegisteredModelApi(this.props.modelName)}}getModelVersionDetailAndRunInfo(e){const{modelName:t,version:s}=this.props;return this.props.getModelVersionApi(t,s,!0===e?this.initGetModelVersionDetailsRequestId:this.getModelVersionDetailsRequestId).then((({value:e})=>{var t;e&&!e[(0,re.zL)("model_version")].run_link&&null!==(t=e[(0,re.zL)("model_version")])&&void 0!==t&&t.run_id&&this.props.getRunApi(e[(0,re.zL)("model_version")].run_id,this.getRunRequestId)}))}getModelVersionMlModelFile(){const{modelName:e,version:t}=this.props;this.props.getModelVersionArtifactApi(e,t).then((s=>this.props.parseMlModelFile(e,t,s.value,this.initGetMlModelFileRequestId))).catch((()=>{this.setState((e=>({criticalInitialRequestIds:d().without(e.criticalInitialRequestIds,this.initGetMlModelFileRequestId)})))}))}componentDidMount(){this.loadData(!0).catch(console.error),this.loadModelDataWithAliases(),this.pollIntervalId=setInterval(this.pollData,b.Gs),this.getModelVersionMlModelFile()}componentDidUpdate(e){this.props.version===e.version&&this.props.modelName===e.modelName||(this.loadData(!0).catch(console.error),this.getModelVersionMlModelFile())}componentWillUnmount(){clearInterval(this.pollIntervalId)}render(){const{modelName:e,version:t,modelVersion:s,runInfo:i,runDisplayName:o,navigate:n,schema:r,modelEntity:l}=this.props;return(0,y.Y)(le.L,{children:(0,y.Y)(ie.Ay,{requestIds:this.state.criticalInitialRequestIds,children:(a,d,c)=>{if(d){clearInterval(this.pollIntervalId);const s=M.A.getResourceConflictError(c,this.state.criticalInitialRequestIds);if(s)return(0,y.Y)(oe.E,{statusCode:409,subMessage:s.error.getMessageField(),fallbackHomePageReactRoute:u.fM.modelListPageRoute});if(M.A.shouldRender404(c,this.state.criticalInitialRequestIds))return(0,y.Y)(oe.E,{statusCode:404,subMessage:`Model ${e} v${t} does not exist`,fallbackHomePageReactRoute:u.fM.modelListPageRoute});const i=c.filter((e=>{var t;return this.state.criticalInitialRequestIds.includes(e.id)&&(null===(t=e.error)||void 0===t?void 0:t.getErrorCode())===k.tG.PERMISSION_DENIED}));var m;if(i&&i[0])return(0,y.Y)(oe.E,{statusCode:403,subMessage:this.props.intl.formatMessage({id:"bQSJKh",defaultMessage:'Permission denied for {modelName} version {version}. Error: "{errorMsg}"'},{modelName:e,version:t,errorMsg:null===(m=i[0].error)||void 0===m?void 0:m.getMessageField()}),fallbackHomePageReactRoute:u.fM.modelListPageRoute});(0,ie.dD)(c)}else{if(a)return(0,y.Y)(ne.y,{});if(s)return(0,y.Y)(te,{modelName:e,modelVersion:s,modelEntity:l,runInfo:i,runDisplayName:o,handleEditDescription:this.handleEditDescription,deleteModelVersionApi:this.props.deleteModelVersionApi,navigate:n,handleStageTransitionDropdownSelect:this.handleStageTransitionDropdownSelect,schema:r,onAliasesModified:this.loadModelDataWithAliases})}return null}})})}}const me={getModelVersionApi:n.s5,getRegisteredModelApi:n.SY,updateModelVersionApi:n.DL,transitionModelVersionStageApi:n.tP,getModelVersionArtifactApi:n.ax,parseMlModelFile:n.qI,deleteModelVersionApi:n.TQ,getRunApi:r.aO},pe=(0,ae.h)((0,o.Ng)(((e,t)=>{const s=decodeURIComponent(t.params.modelName),{version:i}=t.params,o=(0,l.Af)(e,s,i),n=(0,l.SE)(e,s,i);let r=null;o&&!o.run_link&&(r=(0,se.K4)(o&&o.run_id,e));const a=r&&(0,se.X3)(r.runUuid,e)&&r&&M.A.getRunDisplayName(r,r.runUuid),d=e.entities.modelByName[s],{apis:c}=e;return{modelName:s,version:i,modelVersion:o,schema:n,runInfo:r,runDisplayName:a,apis:c,modelEntity:d}}),me)((0,$.Ay)(ue))),he=(0,de.X)(ce.A.mlflowServices.MODEL_REGISTRY,pe);var ge=he},59508:function(e,t,s){s.d(t,{_C:function(){return l},pc:function(){return n},so:function(){return r}});var i=s(81866),o=s(69708);function n(e){return e?`${i.Qs} ilike ${(0,o.GP)(e,!0)}`:""}function r({query:e=""}={}){const t=[],s=e.includes("tags.")?e:n(e);return s&&t.push(s),t.join(" AND ")}function l(e){return"searchInput"in e?e.searchInput:"nameSearchInput"in e&&"tagSearchInput"in e?n(e.nameSearchInput)+" AND "+e.tagSearchInput:"tagSearchInput"in e?e.tagSearchInput:"nameSearchInput"in e?e.nameSearchInput:""}},82638:function(e,t,s){s.d(t,{t:function(){return n}});var i=s(9133),o=s(31014);const n=(0,i.isFunction)(o.useDeferredValue)?o.useDeferredValue:i.identity},87665:function(e,t,s){s.d(t,{QN:function(){return u},F3:function(){return p},xH:function(){return h},BE:function(){return m}});var i=s(31014),o=s(37523),n=s(40553),r=s(88443),l=s(50111);const{Option:a,OptGroup:d}=o.LegacySelect,c="Create New Model",u=`$$$__${c}__$$$`,m="selectedModel",p="modelName";class h extends i.Component{constructor(...e){super(...e),this.state={selectedModel:null},this.handleModelSelectChange=e=>{this.setState({selectedModel:e})},this.modelNameValidator=(e,t,s)=>{const{modelByName:i}=this.props;s(i[t]?`Model "${t}" already exists.`:void 0)},this.handleFilterOption=(e,t)=>-1!==(t&&t.value||"").toLowerCase().indexOf(e.toLowerCase())}renderExplanatoryText(){const{isCopy:e}=this.props,{selectedModel:t}=this.state;if(!t||t===u)return null;const s=e?(0,l.Y)(r.A,{id:"hxMEqi",defaultMessage:"The model version will be copied to {selectedModel} as a new version.",values:{selectedModel:t}}):(0,l.Y)(r.A,{id:"zjXq2X",defaultMessage:"The model will be registered as a new version of {selectedModel}.",values:{selectedModel:t}});return(0,l.Y)("p",{className:"modal-explanatory-text",children:s})}renderModel(e){return(0,l.Y)(a,{value:e.name,children:e.name},e.name)}render(){const{modelByName:e,innerRef:t,isCopy:s}=this.props,{selectedModel:i}=this.state,r=i===u;return(0,l.FD)(o.LegacyForm,{ref:t,layout:"vertical",className:"mlflow-register-model-form",children:[(0,l.Y)(o.LegacyForm.Item,{label:s?(0,l.Y)("b",{children:"Copy to model"}):"Model",name:m,rules:[{required:!0,message:"Please select a model or create a new one."}],children:(0,l.FD)(o.LegacySelect,{dropdownClassName:"mlflow-model-select-dropdown",onChange:this.handleModelSelectChange,placeholder:"Select a model",filterOption:this.handleFilterOption,onSearch:this.props.onSearchRegisteredModels,showSearch:!0,children:[(0,l.FD)(a,{value:u,className:"mlflow-create-new-model-option",children:[(0,l.Y)("i",{className:"fa fa-plus fa-fw",style:{fontSize:13}})," ",c]}),(0,l.Y)(d,{label:"Models",children:Object.values(e).map((e=>this.renderModel(e)))})]})}),r?(0,l.Y)(o.LegacyForm.Item,{label:"Model Name",name:p,rules:[{required:!0,message:"Please input a name for the new model."},{validator:this.modelNameValidator}],children:(0,l.Y)(n.I,{componentId:"codegen_mlflow_app_src_model-registry_components_registermodelform.tsx_132",placeholder:"Input a model name"})}):null,this.renderExplanatoryText()]})}}}}]);
//# sourceMappingURL=2174.f9c34a74.chunk.js.map