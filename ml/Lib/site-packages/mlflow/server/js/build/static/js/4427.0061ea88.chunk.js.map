{"version":3,"file":"static/js/4427.0061ea88.chunk.js","mappings":"oHAkOA,IA7NmC,CACjC,2BAA4B,CAC1BA,WACE,8NACFC,SAAU,OACVC,WAAY,QACZC,UAAW,MACXC,UAAW,OACXC,WAAY,MACZC,YAAa,SACbC,UAAW,SACXC,WAAY,IACZC,SAAU,IACVC,QAAS,IACTC,cAAe,OACfC,WAAY,OACZC,UAAW,OACXC,QAAS,OACTC,WAAY,UACZC,MAAO,WAET,0BAA2B,CACzBhB,WACE,8NACFC,SAAU,OACVC,WAAY,QACZC,UAAW,MACXC,UAAW,OACXC,WAAY,MACZC,YAAa,SACbC,UAAW,SACXC,WAAY,IACZC,SAAU,IACVC,QAAS,IACTC,cAAe,OACfC,WAAY,OACZC,UAAW,OACXC,QAAS,OACTC,WAAY,UACZC,MAAO,UACPC,QAAS,MACTC,OAAQ,SACRC,SAAU,QAEZ,iCAAkC,CAChClB,SAAU,OAEZ,0CAA2C,CACzCmB,WAAY,OACZL,WAAY,WAEd,2CAA4C,CAC1CK,WAAY,OACZL,WAAY,WAEd,2CAA4C,CAC1CK,WAAY,OACZL,WAAY,WAEd,4CAA6C,CAC3CK,WAAY,OACZL,WAAY,WAEd,qCAAsC,CACpCK,WAAY,OACZL,WAAY,WAEd,sCAAuC,CACrCK,WAAY,OACZL,WAAY,WAEd,sCAAuC,CACrCK,WAAY,OACZL,WAAY,WAEd,uCAAwC,CACtCK,WAAY,OACZL,WAAY,WAEd,uCAAwC,CACtCE,QAAS,OACTI,aAAc,QAEhBC,QAAS,CACPN,MAAO,WAETO,OAAQ,CACNP,MAAO,WAETQ,QAAS,CACPR,MAAO,WAETS,MAAO,CACLT,MAAO,WAETU,YAAa,CACXV,MAAO,WAETW,UAAW,CACTC,QAAS,MAEXC,IAAK,CACHb,MAAO,WAETc,SAAU,CACRd,MAAO,WAETe,OAAQ,CACNf,MAAO,WAETgB,SAAU,CACRhB,MAAO,WAETiB,SAAU,CACRjB,MAAO,WAET,SAAU,CACRA,MAAO,WAETkB,SAAU,CACRlB,MAAO,WAET,YAAa,CACXA,MAAO,WAET,2BAA4B,CAC1BA,MAAO,WAET,YAAa,CACXA,MAAO,WAET,oBAAqB,CACnBA,MAAO,WAET,qBAAsB,CACpBA,MAAO,WAETmB,QAAS,CACPnB,MAAO,WAEToB,OAAQ,CACNpB,MAAO,WAETqB,OAAQ,CACNrB,MAAO,UACPsB,OAAQ,QAEVC,IAAK,CACHvB,MAAO,WAET,8BAA+B,CAC7BA,MAAO,WAET,+BAAgC,CAC9BA,MAAO,WAET,uBAAwB,CACtBA,MAAO,WAET,aAAc,CACZA,MAAO,WAETwB,QAAS,CACPxB,MAAO,WAETyB,QAAS,CACPzB,MAAO,WAET0B,UAAW,CACT1B,MAAO,WAET2B,KAAM,CACJ3B,MAAO,WAET4B,UAAW,CACT5B,MAAO,WAET6B,MAAO,CACL7B,MAAO,WAET8B,OAAQ,CACN9B,MAAO,WAET+B,YAAa,CACX/B,MAAO,WAETgC,SAAU,CACRhC,MAAO,WAETiC,QAAS,CACPC,eAAgB,gBAElBC,SAAU,CACRC,aAAc,qBACdF,eAAgB,QAElBG,OAAQ,CACNC,UAAW,UAEbC,UAAW,CACTC,WAAY,OACZxC,MAAO,WAETyC,KAAM,CACJD,WAAY,QAEd,uBAAwB,CACtBE,QAAS,qBACTC,cAAe,QAEjB,gDAAiD,CAC/CC,iBAAkB,WAEpB,iDAAkD,CAChD5C,MAAO,WAET,iCAAkC,CAChCD,WAAY,iF,oLCvMhB,IAAA8C,EAAA,CAAAC,KAAA,UAAAC,OAAA,kCAAAC,EAAA,CAAAF,KAAA,UAAAC,OAAA,0DAAAE,EAAA,CAAAH,KAAA,SAAAC,OAAA,6BAuGA,OA/FwCG,EAAAA,EAAAA,aAGtC,EAAGC,eAAcC,YAAWC,eAAcC,YAAWC,eAAcC,aAAYC,iBAAiBC,KAAS,IAADC,EACxG,MAAOC,EAAYC,IAAiBC,EAAAA,EAAAA,WAAS,GACvCC,GAAeC,EAAAA,EAAAA,QAAuB,MACtCC,EAAyD,QAA3CN,GAAGO,EAAAA,EAAAA,IAAkB,CAAER,IAAKK,WAAe,IAAAJ,OAAA,EAAxCA,EAA0CQ,MAE3DC,GAA0B,OAAdH,QAAc,IAAdA,EAAAA,EAAkBI,KAAYZ,EAE1Ca,GAAQN,EAAAA,EAAAA,QAAOb,IACf,MAAEoB,IAAUC,EAAAA,EAAAA,KAEZC,GAAcC,EAAAA,EAAAA,cAGjBC,IACKV,IACFK,EAAMM,QAAUD,EAAeV,EACjC,GAEF,CAACA,IAcH,OAXAY,EAAAA,EAAAA,qBAAoBnB,GAAK,MACvBe,mBAGFK,EAAAA,EAAAA,kBAAgB,KAEVb,GACFZ,GAAa0B,EAAAA,EAAAA,OAAMd,EAAiBK,EAAMM,QAASrB,EAAca,GACnE,GACC,CAACH,EAAgBG,EAAUb,EAAcE,EAAeJ,KAGzD2B,EAAAA,EAAAA,IAAA,OACEtB,IAAKK,EACLkB,IAAGjC,EAKDkC,SAAA,CAEDtB,IACCuB,EAAAA,EAAAA,GAACC,EAAAA,GAAM,CACLrC,OAAMF,KAOVsC,EAAAA,EAAAA,GAACE,EAAAA,aAAY,CACXC,KAAK,IACLnB,MAAOf,EACP6B,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQC,KAAM,OAAOrC,OAAe,IACpDsC,QACEP,EAAAA,EAAAA,GAAA,OAAKF,IAAGhC,EAAqCiC,UAC3CC,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACVxB,MAAOI,EAAMqB,QAAQC,GACrBC,YAAavB,EAAMqB,QAAQG,GAC3BC,UAAW,OACX1E,OAAQ,YACR2E,gBAAiB,gBACjBC,OAAQ,EACR,SAAU,CACRD,gBAAiB,oBAEpB,QAIPE,SAAUA,CAACC,GAAKC,WACd,MAAMC,GAAcvB,EAAAA,EAAAA,OAAMsB,EAAKlC,MAAOZ,EAAca,GACpDf,EAAaiD,GACTrC,IACFK,EAAMM,QAAU0B,EAAcrC,EAChC,EAEFsC,cAAeA,IAAM1C,GAAc,GACnC2C,aAAcA,IAAM3C,GAAc,GAClC4C,eAAgB,CAAClD,EAAcc,KAC/BqC,eAAgB,CAACtC,EAAUC,KAAUa,SAEpC5B,IAEFE,IACG,I,sBC/GyB,IAAAX,EAAA,CAAAC,KAAA,SAAAC,OAAA,oCAoFnC,MAhFoC4D,EAClCC,eACAC,kBACAC,YACAC,wBACAC,gCAYA,MAAOC,EAAaC,IAAkBpD,EAAAA,EAAAA,UAAS8C,GACzCO,GAA2BC,EAAAA,EAAAA,IAAqBP,EAAiB,MACjE,MAAEtC,IAAUC,EAAAA,EAAAA,KAElB,OACEQ,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfC,eAAgB,gBAChBC,IAAKhD,EAAMqB,QAAQC,IACpB,IAACX,SAAA,EAEFC,EAAAA,EAAAA,GAACqC,EAAAA,EAAK,CACJC,YAAY,2CACZC,YAAU,EACV3F,YAAY,SACZ4F,MAAOV,EACPW,QAASA,KACPf,EAAgB,IAChBK,EAAe,GAAG,EAEpBW,SAAWzB,IACTc,EAAed,EAAE0B,OAAOH,OACxBR,EAAyBf,EAAE0B,OAAOH,MAAMI,cAAc,EAExDC,QAAQ7C,EAAAA,EAAAA,GAAC8C,EAAAA,EAAU,IACnBhD,IAAGpC,IAKJiE,EAAUoB,QACTlD,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfvB,WAAYvB,EAAMqB,QAAQG,GAC1BoC,YAAa5D,EAAMqB,QAAQC,GAC3BuC,WAAY,UACb,IAAClD,SAAA,EAEFF,EAAAA,EAAAA,IAACqD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAElG,WAAY,SAAU8I,YAAa5D,EAAMqB,QAAQC,IAAI,IAACX,SAAA,CAC3E4B,EAAUyB,kBAAoB,EAAE,MAAIzB,EAAU0B,iBAEjDrD,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACL,cAAY,oBACZC,MAAMvD,EAAAA,EAAAA,GAACwD,EAAAA,cAAa,IACpBC,QAAS5B,EACTS,YAAY,mDAEdtC,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACL,cAAY,oBACZC,MAAMvD,EAAAA,EAAAA,GAAC0D,EAAAA,gBAAe,IACtBD,QAAS7B,EACTU,YAAY,uDAId,ECpFH,MAAMqB,EAAuBzE,IAGvB0E,EACL,EADKA,EAEH,EAFGA,EAGN,EA2CMC,EAA6EC,IACxF,MAAMC,EAAyB,GACzBC,EAAoBC,IAAkC,IAADC,EACpDD,IAGLF,EAAkBI,KAAKF,GACD,QAAtBC,EAAAD,EAAclE,gBAAQ,IAAAmE,GAAtBA,EAAwBE,QAAQJ,GAAiB,EAInD,OADAF,EAAMM,QAAQJ,GACPD,CAAiB,EAGbM,EAA0BA,CACrCP,EACAQ,EAAcpF,OAEd,MAAMqF,EAAoC,CAAC,EAErCC,EAAWA,CAACP,EAA8BQ,KAAmB,IAADC,GAC3DT,GAAiBQ,EAAQH,IAG9BC,EAASN,EAAcU,KAAOV,EACR,QAAtBS,EAAAT,EAAclE,gBAAQ,IAAA2E,GAAtBA,EAAwBN,SAASQ,GAAaJ,EAASI,EAAOH,EAAQ,KAAG,EAI3E,OADAX,EAAMM,QAAQI,EAAU,GACjBD,CAAQ,EAiCJM,EAAqBC,IAEhC,GAAwB,IAApBA,EACF,MAAO,KACF,GAAIA,GAAmB,IAAU,CAGtC,MAAO,IADkBA,EAAkB,IAAM,IACtBC,QAAQ,KACrC,CAAO,GAAID,GAAmB,IAAK,CAIjC,MAAO,IADkBA,EAAkB,KAChBC,QAAQ,KACrC,CAGE,MAAO,IADiBD,EAAkB,KAChBC,QAAQ,MACpC,EAGWC,EAAsBA,CAACC,EAA0BC,KAAkC,IAADC,EAC7F,OAAIF,EAAKN,MAAQO,EACR,GAGY,QAAdC,EAACF,EAAKlF,gBAAQ,IAAAoF,EAAAA,EAAI,IAAIC,WAAWR,GAAUI,EAAoBJ,EAAOM,IAAiB,GAAE,EAGrFG,EAA8BJ,IAAsC,IAADK,EAC9E,IAAKL,EAAKlF,UAAsC,KAAb,QAAbuF,EAAAL,EAAKlF,gBAAQ,IAAAuF,OAAA,EAAbA,EAAeC,QACnC,OAAO,EAGT,MAAMC,EAAcP,EAAKlF,SAAS0F,IAAIJ,GACtC,OAAOK,KAAKC,OAAOH,GAAe,CAAC,EClIxBI,GAAqCC,EAAAA,EAAAA,eAA2C,CAC3FC,SAAU,KACVC,QAAS,CAAC,EACVC,WAAY,UACZC,cAAeA,OACfC,kBAAcC,EACdC,gBAAiBA,OACjBC,UAAW,UACXC,aAAcA,OACdC,uBAAuB,EACvBC,yBAA0BA,OAC1BC,yBAAyB,EACzBC,2BAA4BA,OAC5BC,wBAAwB,IAGbC,EAAiCA,KACrCC,EAAAA,EAAAA,YAAWjB,GAGPkB,EAAsCA,EACjDC,aACAC,oBACAC,yBAIAN,yBACA5G,eAOK,IAADrC,EAAAwJ,EAAAC,EACJ,MAAMrB,GAAWsB,EAAAA,EAAAA,UAAQ,KAAMC,EAAAA,EAAAA,IAAsBN,IAAa,CAACA,IAC7DhB,GAAUqB,EAAAA,EAAAA,UAAQ,IAAOtB,EAAWzB,EAAwB,CAACyB,IAAa,CAAC,GAAI,CAACA,IAChFwB,GAAuBC,EAAAA,EAAAA,IAAmBzB,EAAUmB,GACpDO,EAAsD,QAAnC9J,EAAuB,OAApB4J,QAAoB,IAApBA,EAAAA,EAAwBxB,SAAQ,IAAApI,EAAAA,OAAIyI,EAC1DsB,GAA0D,QAAzCP,EAAoB,OAAnBM,QAAmB,IAAnBA,GAAgC,QAAbL,EAAnBK,EAAqBE,mBAAW,IAAAP,OAAb,EAAnBA,EAAkC5B,cAAM,IAAA2B,EAAAA,EAAI,GAAK,GAElElB,EAAYC,IAAiBtH,EAAAA,EAAAA,UAA+BqI,IAC5Dd,EAAcE,IAAmBzH,EAAAA,EAAAA,UAAyC6I,IAC1EnB,EAAWC,IAAgB3H,EAAAA,EAAAA,UAA4C,OAAZuH,QAAY,IAAZA,GAAAA,EAAcyB,aAAe,OAAS,YACjGpB,EAAuBC,IAA4B7H,EAAAA,EAAAA,WAAS,IAC5D8H,EAAyBC,IAA8B/H,EAAAA,EAAAA,UAAS8I,GAEjEjF,GAAQ4E,EAAAA,EAAAA,UACZ,MACEtB,WACAC,UACAC,aACAC,gBACAI,YACAC,eACAJ,eACAE,kBACAG,wBACAC,2BACAC,0BACAC,6BACAC,4BAEF,CACEX,EACAD,EACAM,EACAP,EACAI,EACAK,EACAC,EACAC,EACAC,EACAC,IAIJ,OACE3G,EAAAA,EAAAA,GAAC4F,EAAmCgC,SAAQ,CAACpF,MAAOA,EAAMzC,SAAEA,GAAuD,ECjEjH8H,EAAkB9E,IACtB,OAAQA,EAAM+E,SACZ,IAAK,SACL,IAAK,UAML,QAEE,MAAO,UANT,IAAK,aACH,MAAO,aACT,IAAK,SACH,MAAO,SAIX,EAGWC,EAAsBA,EACjCC,WACA9B,eACAE,kBACAE,eACA2B,kBACAC,qBAqBI,IAADC,EACH,MAAO1G,EAAcC,IAAmB/C,EAAAA,EAAAA,UAAiB,KAClDyJ,EAAiBC,IAAsB1J,EAAAA,EAAAA,WAA0B,IA/DvCqJ,KACjC,MAAMM,EAAgD,CAAC,EAInDN,IACmBO,EAAAA,EAAAA,SAAQ1E,EAA6C,CAACmE,IAAWvC,KAAKR,GAASA,EAAKuD,QAC5FpE,SAASqE,IACpBH,EAAqBG,IAAY,CAAI,IAIzC,MAAO,CACLC,aAAa,EACbC,gBAAgB,EAChBL,uBACD,EA+C6EM,CAA0BZ,MACjGa,EAAkBC,IAAuBnK,EAAAA,EAAAA,UAAS,IACnD,kBAAEoK,EAAiB,QAAEC,IAAY5B,EAAAA,EAAAA,UAAQ,KACzC6B,EAAAA,EAAAA,OAAMjB,GACD,CACLe,kBAAmB,GACnBC,QAAS,KAINE,EAAAA,EAAAA,IAAWlB,EAAUvG,EAAc2G,IAKzC,CAAS,OAARJ,QAAQ,IAARA,OAAQ,EAARA,EAAUrD,IAAKlD,EAAc2G,EAAiBF,IAE5CnC,GAAUqB,EAAAA,EAAAA,UAAQ,IACf/C,EAAwB0E,IAC9B,CAACA,IAEEI,GAAc5J,EAAAA,EAAAA,cACjB6J,IACC,GAAIA,GAAiBJ,EAAQzD,QAAU6D,EAAgB,EACrD,OAEFN,EAAoBM,GACpB,MAAMrG,EAAQiG,EAAQI,GACtBhD,EAAgBrD,EAAMsG,MACtB/C,EAAauB,EAAe9E,IAE5B,MAAMuG,EF4CwBC,EAACtE,EAA0Bc,KAC7D,MAAMuD,EAAU,IAAIE,IAEpB,IAAIC,EAAcxE,EAClB,KAAOwE,GAAeA,EAAYC,UAChCJ,EAAQK,IAAIF,EAAYC,UACxBD,EAAc1D,EAAQ0D,EAAYC,UAGpC,OAAOJ,CAAO,EErDMC,CAAqBxG,EAAMsG,KAAMtD,GACjDkC,GAAiB2B,GAER,IAAIJ,IAAI,IAAII,KAAiBN,KACpC,GAEJ,CAACN,EAAS5C,EAAiBE,EAAcP,EAASkC,IAG9CrG,GAAwBrC,EAAAA,EAAAA,cAAY,KACxC4J,EAAYN,EAAmB,EAAE,GAChC,CAACA,EAAkBM,IAEhBtH,GAA4BtC,EAAAA,EAAAA,cAAY,KAC5C4J,EAAYN,EAAmB,EAAE,GAChC,CAACA,EAAkBM,IAyCtB,OAvCAxJ,EAAAA,EAAAA,kBAAgB,KACd,GAAiC,IAA7BoJ,EAAkBxD,OAQtB,GAAuB,IAAnByD,EAAQzD,OAuBZuD,EAAoB,GACpB1C,EAAgB4C,EAAQ,GAAGK,MAC3B/C,EAAauB,EAAemB,EAAQ,SAzBpC,CAA2B,IAADa,EAGxB,MAAMC,EAAmC,QAApBD,EAAe,OAAZ3D,QAAY,IAAZA,OAAY,EAAZA,EAAcvB,WAAG,IAAAkF,EAAAA,EAAI,GAC7C,GAAMC,KAAmB/D,EASvBK,EAAgBL,EAAQ+D,QATS,CACjC,MAAMC,EAAUhB,EAAkB,GAClC3C,EAAgB2D,GAChBzD,EAAoB,OAAPyD,QAAO,IAAPA,GAAAA,EAASpC,aAAe,OAAS,UAChD,CAYF,CAKwC,GAGvC,CAACoB,EAAmBC,EAAS5C,IAEzB,CACLzE,UAAW,CACToB,MAAgC,QAA3BoF,EAAEa,EAAQH,UAAiB,IAAAV,EAAAA,EAAI,KACpC9E,aAAc2F,EAAQzD,OACtBnC,kBAAmByF,GAErBpH,aAAcA,EAAamB,cAAcoH,OACzCtI,kBACA0G,kBACAC,qBACAU,oBACAnH,wBACAC,4BACD,E,eCpLI,MAAMoI,EAAyB,YACzBC,EAA2B,YCO3BC,EAA2CA,EACtD1I,eACA2I,OACAC,cACAC,0BAOA,MAAM,MAAElL,IAAUC,EAAAA,EAAAA,KACZkL,GAAsBhL,EAAAA,EAAAA,cAAa0F,IACnC,OAAJA,QAAI,IAAJA,GAAAA,EAAMuF,eAAe,CAAEC,MAAO,UAAWC,OAAQ,WAAY,GAC5D,IAEGC,GAAQvD,EAAAA,EAAAA,UAAQ,IACf3F,GAIEmJ,EAAAA,EAAAA,IAA6B,CAClCR,OACA3I,eACAoJ,2BAA4BzL,EAAM0L,OAAOb,GACzCc,6BAA8B3L,EAAM0L,OAAOZ,GAC3CI,sBACAD,cACAE,wBAVO,IAYR,CAAC9I,EAAc2I,EAAMhL,EAAOkL,EAAqBD,EAAaE,IAEjE,OACEvK,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHlG,WAAY,WACZ4G,gBAAiB1B,EAAM0L,OAAOE,oBAC9BlQ,QAASsE,EAAMqB,QAAQC,GACvB5G,SAAUsF,EAAM6L,WAAWC,YAC5B,IAACnL,SAED4K,GACG,E,gDCXT,IAAAjN,EAAA,CAAAC,KAAA,UAAAC,OAAA,iBAAAC,EAAA,CAAAF,KAAA,SAAAC,OAAA,+EAED,MAAMuN,EAAaA,EAAGpL,eAIlBC,EAAAA,EAAAA,GAAA,OAAK,cAAY,cAAcF,IAAGpC,EAAuBqC,UAEvDC,EAAAA,EAAAA,GAACoL,EAAAA,MAAK,CACJC,YAAU,EACVvL,IAAGjC,EAQHkC,SAAUA,MAMLuL,EAAgBA,EAAGvL,WAAUkF,WACxC,MAAM,OAAEsG,EAAM,KAAEC,EAAI,QAAEC,GAzDjB,UAAkC,SAAE1L,IAIxC,IAAD2L,EACA,IAAK3L,EACH,MAAO,CACLwL,YAAQpF,EACRqF,KAAM,GACNC,SAAS,GAIb,MAAME,EAAaC,EAAAA,SAAeC,QAAQ9L,GAc1C,MAAO,CACLwL,OAb0B,QAAhBG,EAAGC,EAAW,UAAE,IAAAD,EAAAA,OAAIvF,EAc9BqF,KAXiCG,EAAWG,MAAM,GAAGC,SAASnH,GAC1DgH,EAAAA,eAAqBhH,GAChBgH,EAAAA,SAAeC,QAAQjH,EAAMoH,MAAMjM,UAAUkM,QAAQC,GAC1DN,EAAAA,eAAqBM,KAGlB,KAMPT,SAAS,EAEb,CAyBoCU,CAAyB,CAAEpM,WAAUkF,SAEvE,OAAKwG,GAKEzL,EAAAA,EAAAA,GAACoM,EAAgB,CAACb,OAAQA,EAAQC,KAAMA,KAHtCxL,EAAAA,EAAAA,GAACmL,EAAU,CAACpL,SAAUA,EAAUkF,KAAMA,GAGQ,EAKrC,IAAAnH,EAAA,CAAAH,KAAA,SAAAC,OAAA,qEAEpB,MAAMwO,EAAmBA,EAAGb,SAAQC,WAClC,MAAM,MAAEpM,IAAUC,EAAAA,EAAAA,KAEZgN,EAAYT,EAAAA,OAA6B,MAEzCU,GAAiBC,EAAAA,EAAAA,GAAW,CAChCrL,KAAMsK,EAAKjG,OACX8G,YACAG,SAVa,MAaT,aAAEC,EAAY,UAAEC,GAAcJ,EAEpC,OACEtM,EAAAA,EAAAA,GAAA,OACE,cAAY,oBACZzB,IAAK8N,EACLvM,KAAGM,EAAAA,EAAAA,IAAE,CACHpF,SAAU,OACV2R,UAvBiB,IAwBjBC,OAAQ,YACRC,YAAazN,EAAM0L,OAAO8B,OAC1B1R,aAAckE,EAAM0N,QAAQC,eAC5BC,aAAc5N,EAAMqB,QAAQwM,GAC5BlM,OAAQ,GACT,IAAChB,UAEFF,EAAAA,EAAAA,IAACuL,EAAAA,MAAK,CACJtL,IAAGhC,EAKDiC,SAAA,CAEDwL,GACDvL,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACV0M,OAAQ,GAAGR,MACX1N,MAAO,OAEP,mCAAoC,CAAE/B,aAAc,SACrD,IAAC8C,SAED0M,EAAahH,KAAK0H,IACjB,MAAMC,EAAWD,EAAWE,MACtBC,EAAa9B,EAAK4B,GAExB,OACEpN,EAAAA,EAAAA,GAAA,OACEzB,IAAK4O,EAAWI,WAEhBzN,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACVgN,IAAK,GAAGL,EAAWM,UACnBzO,MAAO,QACR,IAACe,SAEDuN,GAPIF,EAQD,UAKV,EAIGM,EAAsBA,EAAG3N,WAAUkF,WAC9C,MAAM0I,EAAe,OAAJ1I,QAAI,IAAJA,OAAI,EAAJA,EAAMlF,SAAS6N,MAAMhJ,GAA4B,OAAlBA,EAAMiJ,WAChD,MAAEzO,IAAUC,EAAAA,EAAAA,KAClB,OACEW,EAAAA,EAAAA,GAAC8N,EAAAA,SAAQ,CACPC,MACEJ,EACI,CAAEnN,SAAU,SAAUgN,IAAK,EAAGzM,OAAQ,EAAGD,gBAAiB1B,EAAM0L,OAAOkD,wBACvE7H,EAENpG,SAAUA,EACV4N,SAAUA,GACV,EAIOM,EAAuBA,EAAGlO,WAAUkF,WAC/C,MAAM0I,EAA6B,QAAd,OAAJ1I,QAAI,IAAJA,OAAI,EAAJA,EAAM4I,UACjB,MAAEzO,IAAUC,EAAAA,EAAAA,KAElB,OAAIsO,GAEA3N,EAAAA,EAAAA,GAACkO,EAAAA,YAAW,CACV,cAAY,2BACZ5L,YAAY,2BACZxC,KAAGM,EAAAA,EAAAA,IAAE,CAAE+N,YAAa/O,EAAMqB,QAAQC,GAAImM,YAAazN,EAAM0L,OAAO8B,OAAQ/R,MAAOuE,EAAM0L,OAAOsD,aAAa,IACzGrO,SAAUA,KAKTC,EAAAA,EAAAA,GAACqO,EAAAA,UAAS,CAACtO,SAAUA,GAAY,ECjK1C,MAAMuO,EAA8B9L,GAC9BA,EAAM+L,WAAW,mBAAqB/L,EAAM+L,WAAW,mBAClD/L,GAEFgM,EAAAA,EAAAA,IAAoBhM,GAGhBiM,EAAyBzC,IACpC,MAAM0C,GAAyBtH,EAAAA,EAAAA,UAC7B,IAAMuH,GAAsB,CAAEC,WAAY5C,EAAM0C,cAChD,CAAC1C,EAAM0C,aAET,OACE1O,EAAAA,EAAAA,GAAC6O,EAAAA,GAAa,CAACH,WAAYA,EAAYI,cAAeC,GAAeT,aAAcA,EAAavO,SAC7FiM,EAAMjM,UACO,EAIdiP,GAAwBA,EAC5BC,YACAC,aACAjK,UACGkK,MAC+D,IAADC,EAAAC,EACjE,MAAMC,EAAW1D,EAAAA,SAAc,KAAO,IAAD2D,EACnC,MAAMxM,EAAQ,iBAAiByM,KAAwB,QAApBD,EAACJ,EAAUM,iBAAS,IAAAF,EAAAA,EAAI,IAC3D,OAAOxM,GAASA,EAAM,GAAKA,EAAM,QAAKoD,CAAS,GAC9C,CAACgJ,EAAUM,YAEd,OAAQ,OAAJxK,QAAI,IAAJA,GAAc,QAAVmK,EAAJnK,EAAMzE,gBAAQ,IAAA4O,OAAV,EAAJA,EAAgB3B,MAAMiC,SAAa,OAAJzK,QAAI,IAAJA,GAAc,QAAVoK,EAAJpK,EAAMzE,gBAAQ,IAAA6O,OAAV,EAAJA,EAAgBM,IAAID,MAC9C9D,EAAAA,cAAoBsD,EAAYC,GAGlCvD,EAAAA,cAAoBqD,EAAW,IAAKE,EAAWG,YAAW,EAG7DM,GAAaA,EAAG7P,eAA2CC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAC0M,MAAI,EAAA9P,SAAEA,IAExF,IAAArC,GAAA,CAAAC,KAAA,SAAAC,OAAA,qBAIA,MAAMkS,GAAYlE,EAAAA,MAAW,EAAG7L,WAAUuP,eACxC,MAAM,MAAElQ,IAAUC,EAAAA,EAAAA,KACZwQ,EAAOE,OAAOhQ,GAAUiQ,QAAQ,MAAO,IAC7C,OACEhQ,EAAAA,EAAAA,GAAA,OAAKF,IAAGpC,GAA2BqC,UACjCC,EAAAA,EAAAA,GAACiQ,EAAAA,GAAW,CACVC,SAASlQ,EAAAA,EAAAA,GAACmQ,EAAAA,GAAiB,CAAC7N,YAAY,sCAAsC8N,SAAUP,IACxFzQ,MAAOA,EAAMiR,WAAa,cAAgB,QAC1CtQ,SAAU8P,EACVP,SAAUA,GAAYgB,GAAsBhB,GAAYA,EAAW,OACnEvB,MAAO,CACLjT,QAAS,QACTI,aAAc,EACd8D,MAAO,OACPuR,UAAW,aAGX5D,UAAW,IAGXtM,QAAS,OACT6B,cAAe,kBAEjBsO,iBAAe,KAEb,IAIJzB,GAA0C,CAAC0B,EAAAA,GAIjD,IAAA5S,GAAA,CAAAF,KAAA,SAAAC,OAAA,kBAQO,MAAM+Q,GAAyB3C,IAA0C,CAE5E0E,EAAGA,EAAGC,OAAM5Q,eACVC,EAAAA,EAAAA,GAACkD,EAAAA,EAAW0N,KAAI,CACdtO,YAAY,+CACZqO,KAAMA,EAENE,GACM,OAAJF,QAAI,IAAJA,GAAAA,EAAMpC,WAAW,qBAAuBoC,EAAKX,QAAQ,oBAAqB,4BAAyB7J,EAErG2K,SAAc,OAAJH,QAAI,IAAJA,OAAI,EAAJA,EAAMpC,WAAW,KAE3BxO,SAAc,OAAJ4Q,QAAI,IAAJA,GAAAA,EAAMpC,WAAW,sBAAuB1O,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,CAAE,IAAEA,EAAS,OAAOA,EAEtEiR,eAAgBL,GAAQA,EAAKpC,WAAW,QAG5CsB,KAAOV,IAAS,IAAA8B,EAAAC,EAAAC,EAAAC,EAAA,OACdpR,EAAAA,EAAAA,GAACgP,GAAqB,IAChBG,EACJF,UAAsC,QAA7BgC,EAAkB,QAAlBC,EAAElF,EAAM4C,kBAAU,IAAAsC,OAAA,EAAhBA,EAAkBjC,iBAAS,IAAAgC,EAAAA,EAAInB,GAC1CZ,WAAwC,QAA9BiC,EAAkB,QAAlBC,EAAEpF,EAAM4C,kBAAU,IAAAwC,OAAA,EAAhBA,EAAkBlC,kBAAU,IAAAiC,EAAAA,EAAIvB,IAC5C,EAEJyB,EAAGA,EAAGtR,eAAeC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWoO,UAAS,CAACvR,SAAUA,IACrDwR,GAAIA,EAAGxR,eAAeC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWsO,MAAK,CAACC,MAAO,EAAG1R,SAAUA,IAC5D2R,GAAIA,EAAG3R,eAAeC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWsO,MAAK,CAACC,MAAO,EAAG1R,SAAUA,IAC5D4R,GAAIA,EAAG5R,eAAeC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWsO,MAAK,CAACC,MAAO,EAAG1R,SAAUA,IAC5D6R,GAAIA,EAAG7R,eAAeC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWsO,MAAK,CAACC,MAAO,EAAG1R,SAAUA,IAC5D8R,GAAIA,EAAG9R,eAAeC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWsO,MAAK,CAACC,MAAO,EAAG1R,SAAUA,IAC5D+R,MAAOA,EAAG/R,WAAUkF,WAAWjF,EAAAA,EAAAA,GAACsL,EAAa,CAACvL,SAAUA,EAAUkF,KAAMA,IACxE8M,GAAIA,EAAGhS,WAAUkF,WAAWjF,EAAAA,EAAAA,GAAC0N,EAAmB,CAAC3N,SAAUA,EAAUkF,KAAMA,IAC3E+M,GAAIA,EAAGjS,WAAUkF,WAAWjF,EAAAA,EAAAA,GAACiO,EAAoB,CAAClO,SAAUA,EAAUkF,KAAMA,IAG5EgN,GAAIA,EAAGlS,eAAeC,EAAAA,EAAAA,GAACqO,EAAAA,UAAS,CAACtO,SAAUA,EAAUmS,WAAS,IAE9DC,MAAOA,EAAGpS,eAAeC,EAAAA,EAAAA,GAAA+Q,EAAAA,GAAA,CAAAhR,SAAGA,IAC5BqS,MAAOA,EAAGrS,eAAeC,EAAAA,EAAAA,GAAA+Q,EAAAA,GAAA,CAAAhR,SAAGA,IAC5BsS,IAAKA,EAAGC,MAAKC,UAAUvS,EAAAA,EAAAA,GAAA,OAAKsS,IAAKA,EAAKC,IAAKA,EAAKzS,IAAGjC,OAGjDyS,GAAyBkC,IAG7B,OADiBA,GAEf,IAAK,KACL,IAAK,OACL,IAAK,aACL,IAAK,OACL,IAAK,SACL,IAAK,MACL,IAAK,OACL,IAAK,OACH,OAAO,EACT,QACE,OAAO,EACX,EC9IgC,IAAA9U,GAAA,CAAAC,KAAA,SAAAC,OAAA,qBAAAC,GAAA,CAAAF,KAAA,SAAAC,OAAA,wBAE3B,SAAS6U,IAAkC,KAChDrI,EAAI,aACJ3I,EAAe,GAAE,YACjB4I,EAAc,KAAI,oBAClBC,GAAsB,EAAK,WAC3BoI,EAAaC,EAAAA,GAAsBC,OAQnC,MAAMC,EAAkBC,QAAQrR,MAAkBwH,EAAAA,EAAAA,OAAMoB,IAAgBD,EAAKxH,cAAcmQ,SAAStR,IAC9F,MAAErC,IAAUC,EAAAA,EAAAA,MACX2T,EAAeC,IAAoBtU,EAAAA,EAAAA,UAAwB,SAAf+T,IAC5CQ,EAAUC,IAAexU,EAAAA,EAAAA,UAASkU,GACnCO,GAAavU,EAAAA,EAAAA,QAAuB,MAGpCwU,GAAyBjM,EAAAA,EAAAA,UAAQ,KACrC,GAAmB,SAAfsL,EACF,OAAOtI,EAGT,MAAMkJ,EAAaV,KAAKW,MAAMnJ,GAC9B,OAAIoJ,EAAAA,EAAAA,UAASF,GACJA,EAGFlJ,CAAI,GACV,CAACA,EAAMsI,IAEJe,EACJT,GACAK,EAAeK,MAAM,MAAMnO,OAxCD,GAyC1B8N,EAAe9N,OAtCW,IAyCtBoO,GAAgBvM,EAAAA,EAAAA,UAAQ,KAC5B,GAAIqM,IAAeP,EAAU,CAC3B,MAAMQ,EAAQL,EAAeK,MAAM,MAAM5H,MAAM,EA9CvB,GA8CiD8H,KAAK,MAC9E,OAAOF,EAAMnO,OA5CW,IA4CsBmO,EAAM5H,MAAM,EA5ClC,KA4C8D4H,CACxF,CAEA,OAAOL,CAAc,GACpB,CAACA,EAAgBI,EAAYP,KAEhCW,EAAAA,EAAAA,YAAU,KACJT,EAAW3T,SACbwT,EAAiBG,EAAW3T,QAAQqU,YAAcV,EAAW3T,QAAQsU,YACvE,GACC,CAAC3J,IAIJ,MAAM4J,GAAazU,EAAAA,EAAAA,cAAa0U,IAAkBjU,EAAAA,EAAAA,GAAA,UAASiU,EAAU1V,IAAK6U,KAAgB,IAE1F,OAAIP,GAGA7S,EAAAA,EAAAA,GAACmK,EAAwC,CACvCC,KAAMA,EACN3I,aAAcA,EACd4I,YAAaA,EACbC,qBAAsBD,EAAY6J,YAAc5J,KAMpDzK,EAAAA,EAAAA,IAAA,OAAKC,IAAGpC,GAA2BqC,SAAA,CACjB,aAAf2S,GACC1S,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHtF,QAASsE,EAAMqB,QAAQwM,GACvBnM,gBAAiB1B,EAAM0L,OAAOE,oBAC9BgC,cAAe5N,EAAMqB,QAAQwM,IAC9B,IAAClN,UAEFC,EAAAA,EAAAA,GAACyO,EAAqB,CAAA1O,SAAE4T,OAG1B9T,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACmQ,EAAAA,GAAiB,CAEhB7N,YAAY,2CACZ8N,SAAUhG,EACVlJ,KAAK,QACLpB,KAAGM,EAAAA,EAAAA,IAAE,CAAEI,SAAU,WAAYgN,IAAKpO,EAAMqB,QAAQG,GAAIuT,MAAO/U,EAAMqB,QAAQG,GAAIG,OAAQ,GAAG,KAJpF,iBAONf,EAAAA,EAAAA,GAACiQ,EAAAA,GAAW,CACVmE,OAAQJ,EACRxD,iBAAe,EACflB,SAAUoD,EACV2B,UAAW,CAAEtG,MAAO,CAAE3T,UAAW,aAAcF,WAAY,aAC3Doa,UAAWpB,EACX9T,MAAOA,EAAMiR,WAAa,cAAgB,QAC1CtC,MAAO,CACLjN,gBAAiB1B,EAAM0L,OAAOE,oBAC9BlQ,QAASsE,EAAMqB,QAAQC,GACvB6T,cAAed,EAAa,EAAIrU,EAAMqB,QAAQC,GAC9C8T,aAAiC,EAAnBpV,EAAMqB,QAAQwM,GAC5BjS,SAAUkY,EAAW,OAAS,SAC9BuB,aAAc,WACd3a,SAAUsF,EAAM6L,WAAWC,WAC3BnR,WAAYqF,EAAM6L,WAAWyJ,gBAC7B3U,SAED4T,OAINF,IACCzT,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEU,gBAAiB1B,EAAM0L,OAAOE,qBAAqB,IAACjL,UAC9DC,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLxD,IAAGjC,GACHyE,YACE4Q,EAAW,+CAAiD,+CAE9D3P,KAAM2P,GAAWlT,EAAAA,EAAAA,GAACwD,EAAAA,cAAa,KAAMxD,EAAAA,EAAAA,GAAC0D,EAAAA,gBAAe,IACrD8E,KAAK,WACL/E,QAASA,IAAM0P,GAAaD,GAAUnT,SAErCmT,GACClT,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,cAIjB5U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,mBAS/B,CCzJO,MAAMC,GAA4CA,EACvDC,QACArT,eACAsT,oBAMA,MAAM,MAAE3V,IAAUC,EAAAA,EAAAA,KACZkL,GAAsBhL,EAAAA,EAAAA,cAAa0F,IACnC,OAAJA,QAAI,IAAJA,GAAAA,EAAMuF,eAAe,CAAEC,MAAO,UAAWC,OAAQ,WAAY,GAC5D,IAEGsK,EAAaF,EAAMlS,cACzB,IAAKoS,EAAWjC,SAAStR,GACvB,OAAOzB,EAAAA,EAAAA,GAAA,OAAAD,SAAM+U,IAGf,MAAMG,EAAWD,EAAWE,QAAQzT,GAC9B0T,EAASF,EAAWxT,EAAa8D,OACjCzE,EAAkBiU,EAAgB3V,EAAM0L,OAAOb,GAA0B7K,EAAM0L,OAAOZ,GAE5F,OACErK,EAAAA,EAAAA,IAAA,OAAAE,SAAA,CACG+U,EAAMhJ,MAAM,EAAGmJ,IAChBjV,EAAAA,EAAAA,GAAA,QAAMzB,IAAKwW,EAAgBxK,EAAsB,KAAMzK,KAAGM,EAAAA,EAAAA,IAAE,CAAEU,kBAAiBsU,gBAAiB,IAAI,IAACrV,SAClG+U,EAAMhJ,MAAMmJ,EAAUE,KAExBL,EAAMhJ,MAAMqJ,KACT,ECxBV,SAASE,GAAqBC,EAAuBC,GACnD,OAAIA,IAIAD,EACK3C,EAAAA,GAAsB6C,SAGxB7C,EAAAA,GAAsBC,KAC/B,CAEA,SAAS6C,GAAyB/C,GAChC,OAAQA,GACN,KAAKC,EAAAA,GAAsBC,KACzB,MAAO,OACT,KAAKD,EAAAA,GAAsB+C,KACzB,MAAO,OACT,KAAK/C,EAAAA,GAAsB6C,SACzB,MAAO,WAEb,CAAC,IAAA9X,GAAA,CAAAC,KAAA,SAAAC,OAAA,qBAAAC,GAAA,CAAAF,KAAA,UAAAC,OAAA,4EAAAE,GAAA,CAAAH,KAAA,SAAAC,OAAA,sDAAA+X,GAAA,CAAAhY,KAAA,SAAAC,OAAA,+BAEM,SAASgY,IAA8B,MAC5Cd,EAAK,OACLe,EAAM,KACNzL,EAAI,aACJ3I,EAAe,GAAE,YACjB4I,EAAc,KAAI,oBAClBC,GAAsB,EAAK,kBAC3BiL,IAYE,IAADO,EACD,MAAMxC,GAAalM,EAAAA,EAAAA,UAAQ,IAAMwL,KAAKW,MAAMnJ,IAAO,CAACA,IAC9CkL,GAAe9B,EAAAA,EAAAA,UAASF,IACxB,MAAElU,IAAUC,EAAAA,EAAAA,MAEXqT,EAAYqD,IAAiBpX,EAAAA,EAAAA,UAClC0W,GAAqBC,EAAcC,IAE/BS,EAAe1L,GAA+C,QAA5BwL,EAAgB,OAAXzL,QAAW,IAAXA,OAAW,EAAXA,EAAa6J,kBAAU,IAAA4B,GAAAA,EAC9DG,EAA+BX,IAAiB7T,EAOtD,OAJAoS,EAAAA,EAAAA,YAAU,KACRkC,EAAcV,GAAqBC,EAAcC,GAAmB,GACnE,CAACD,EAAcC,KAGhBvV,EAAAA,EAAAA,GAAA,OACEF,IAAGpC,GAEDqC,UAEFF,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHlF,aAAckE,EAAM0N,QAAQoJ,eAC5BtJ,OAAQ,aAAaxN,EAAM0L,OAAO8B,SAClC5R,SAAU,UACX,IAAC+E,SAAA,EAEA+U,GAASmB,KACTpW,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfC,eAAgB,gBAChBc,WAAY,SACZnI,QAASsE,EAAMqB,QAAQC,IACxB,IAACX,SAAA,EAGFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWsO,MAAK,CACf1R,IAAGjC,GAMH4T,MAAO,EACP5W,MAAM,YACNsb,gBAAc,EAAApW,UAEdC,EAAAA,EAAAA,GAAC6U,GAAyC,CACxCC,MAAOA,EACPrT,aAAcA,EACdsT,cAAeiB,OAGnBhW,EAAAA,EAAAA,GAAA,OAAKF,IAAGhC,GAAkEiC,SACvEkW,IACCpW,EAAAA,EAAAA,IAACuW,EAAAA,aAAaC,KAAI,CAAAtW,SAAA,EAChBC,EAAAA,EAAAA,GAACoW,EAAAA,aAAaE,QAAO,CAACC,SAAO,EAAAxW,UAC3BC,EAAAA,EAAAA,GAACwW,EAAAA,IAAG,CACFlU,YAAY,sDACZxC,IAAG6V,GAGD5V,UAGFF,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAE+N,YAAa/O,EAAMqB,QAAQG,GAAIoC,YAAa5D,EAAMqB,QAAQG,GAAIzE,OAAQ,WAAW,IAAC4D,SAAA,EAC5FC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACjC,KAAK,KAAKrG,MAAM,YAAWkF,SACzC0V,GAAyB/C,MAE5B1S,EAAAA,EAAAA,GAAC0D,EAAAA,gBAAe,YAItB7D,EAAAA,EAAAA,IAACuW,EAAAA,aAAaK,QAAO,CAAA1W,SAAA,EACnBC,EAAAA,EAAAA,GAACoW,EAAAA,aAAaM,WAAU,CACtBpU,YAAY,wDACZE,MAAOkQ,EACPiE,cAAgBnU,GAAUuT,EAAcvT,GAAgCzC,SAEvE6W,OAAOC,OAAOlE,EAAAA,IAAuBlN,KAAKqR,IACzCjX,EAAAA,EAAAA,IAACuW,EAAAA,aAAaW,UAAS,CAAYvU,MAAOsU,EAAK/W,SAAA,EAC7CC,EAAAA,EAAAA,GAACoW,EAAAA,aAAaY,cAAa,IAC1BvB,GAAyBqB,KAFCA,QAMjC9W,EAAAA,EAAAA,GAACoW,EAAAA,aAAaa,MAAK,gBAO/BjX,EAAAA,EAAAA,GAACyS,GAAiC,CAChCrI,KAAMA,EACN3I,aAAcA,EACd4I,YAAaA,EACbC,oBAAqBA,EACrBoI,WAAYA,QAKtB,CCzJO,SAASwE,IAAgC,WAC9CC,EAAU,aACV1V,EAAY,YACZ4I,IAMA,MAAM,MAAEjL,IAAUC,EAAAA,EAAAA,MACZ,WAAE+X,GAAeD,EACjBE,GAAqBC,EAAAA,EAAAA,MAAKF,GAAY7R,OAAS,EAC/CgS,IAAqBtO,EAAAA,EAAAA,OAAMoB,IAAgBA,EAAYhB,KAAK1E,MAAQwS,EAAWxS,IAErF,OAAK0S,IAAsBpO,EAAAA,EAAAA,OAAMmO,IAE7BpX,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEoX,UAAWpY,EAAMqB,QAAQwM,IAAI,IAAClN,UACxCC,EAAAA,EAAAA,GAACyX,EAAAA,MAAK,CACJC,aACE1X,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,6BAUzB5U,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfE,IAAKhD,EAAMqB,QAAQC,GACnB5F,QAASsE,EAAMqB,QAAQwM,IACxB,IAAClN,SAED6W,OAAOe,QAAQP,GAAY3R,KAAI,EAAEd,EAAKnC,MACrCxC,EAAAA,EAAAA,GAAC4V,GAA6B,CAE5Bd,MAAOnQ,EACPyF,KAAMwI,KAAKgF,UAAUpV,EAAO,KAAM,GAClCf,aAAcA,EACd4I,YAAaA,EACbC,oBAAqBiN,GAA6C,eAAxBlN,EAAYvC,SAA4BuC,EAAY1F,MAAQA,GALjGA,MAUf,CCrDO,SAASkT,IAAgC,UAC9CC,EAAS,gBACTC,EAAe,WACfC,IAMA,MAAM,MAAE5Y,IAAUC,EAAAA,EAAAA,MAEZ,KAAEmJ,EAAI,YAAEkP,EAAaO,KAAMC,GAAeH,EAE1CI,EAAoB3P,GAAQkP,GAAeQ,EAE3CE,EAAeD,EACjB,CACEE,oBAAqBjZ,EAAM0N,QAAQC,eACnCuL,qBAAsBlZ,EAAM0N,QAAQC,eACpC9P,aAAc,aAAamC,EAAM0L,OAAO8B,UAE1C,CACE1R,aAAckE,EAAM0N,QAAQC,gBAGlC,OACElN,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACflD,MAAO,OACP9D,aAAckE,EAAM0N,QAAQC,eAC5BH,OAAQ,aAAaxN,EAAM0L,OAAO8B,UACnC,IAAC7M,SAAA,EAEFF,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfe,WAAY,SACZnC,gBAAiB1B,EAAM0L,OAAOE,oBAC9BlQ,QAAS,GAAGsE,EAAMqB,QAAQC,QAAQtB,EAAMqB,QAAQwM,OAChD7K,IAAKhD,EAAMqB,QAAQC,MAChB0X,GACJ,IAACrY,SAAA,EAEFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWsO,MAAK,CAAC2E,gBAAc,EAACpI,MAAO,CAAE7T,WAAY,SAAUua,aAAc,WAAYzZ,SAAU,UAAW+E,SAC5G+X,IAEFE,IACChY,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACgT,gBAAc,EAACtb,MAAM,QAAOkF,UAC3CC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,kBAMtBuD,IACCtY,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACTkY,oBAAqB,WACrBC,iBAAkB,OAClBpW,IAAKhD,EAAMqB,QAAQwM,GACnBnS,QAAS,GAAGsE,EAAMqB,QAAQC,QAAQtB,EAAMqB,QAAQwM,QACjD,IAAClN,SAAA,CAEDyI,IACC3I,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACgT,gBAAc,EAAC7Y,MAAI,EAAAyC,UAClCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,YAInB5U,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACgT,gBAAc,EAACtG,MAAI,EAAA9P,SACjCyI,OAINkP,IACC7X,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACgT,gBAAc,EAAC7Y,MAAI,EAAAyC,UAClCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,mBAInB5U,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACgT,gBAAc,EAAApW,SAAE2X,OAGpCQ,IACCrY,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACgT,gBAAc,EAAC7Y,MAAI,EAAAyC,UAClCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,mBAInB5U,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,MAAOE,IAAKhD,EAAMqB,QAAQC,GAAI+X,SAAU,QAAQ,IAAC1Y,SAC1FmY,EAAWzS,KAAKjD,IACfxC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACgT,gBAAc,EAACtG,MAAI,EAAA9P,SACjCyC,GADuCA,eAW5D,CC/GO,SAASkW,IAA2B,KAAEC,IAAuC,IAADC,EAAAC,EAAAC,EACjF,MAAM,MAAE1Z,IAAUC,EAAAA,EAAAA,MACX6T,EAAUC,IAAexU,EAAAA,EAAAA,WAAS,GAEnC+Y,EAAciB,EAAK7c,SAAS4b,YAC5BK,EAA0C,QAA3Ba,EAAGD,EAAK7c,SAASid,kBAAU,IAAAH,OAAA,EAAxBA,EAA0BI,WAC5CC,EAAmD,QAArCJ,EAA2B,QAA3BC,EAAGH,EAAK7c,SAASid,kBAAU,IAAAD,OAAA,EAAxBA,EAA0BI,gBAAQ,IAAAL,EAAAA,EAAI,GAIvDM,EAAezB,GAAeK,EAE9BqB,EAAcD,EAChB,CAAE,SAAU,CAAErY,gBAAiB1B,EAAM0L,OAAOuO,0BAA2Bld,OAAQ,YAC/E,CAAC,EAEL,OACE0D,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACflD,MAAO,OACP9D,aAAckE,EAAM0N,QAAQC,eAC5BH,OAAQ,aAAaxN,EAAM0L,OAAO8B,SAClC9L,gBAAiB1B,EAAM0L,OAAOkD,mBAC/B,IACD,cAAY,iCAAgCjO,SAAA,EAE5CF,EAAAA,EAAAA,IAAA,OACEyZ,KAAK,SACLxZ,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfE,IAAKhD,EAAMqB,QAAQC,GACnBuC,WAAY,SACZhG,aAAckc,GAAgBjG,EAAW,aAAa9T,EAAM0L,OAAO8B,SAAW,OAC9E9R,QAASsE,EAAMqB,QAAQC,MACpB0Y,GACJ,IACD3V,QAASA,IAAM0P,GAAaD,GAC5B,cAAY,wCAAuCnT,SAAA,CAElDoZ,IAAiBjG,GAAWlT,EAAAA,EAAAA,GAAC0D,EAAAA,gBAAe,KAAM1D,EAAAA,EAAAA,GAACuZ,EAAAA,EAAgB,MACpEvZ,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CACd7F,MAAI,EACJ6Y,gBAAc,EACdpI,MAAO,CAAE7T,WAAY,SAAUua,aAAc,WAAYzZ,SAAU,UAAW+E,SAE7E4Y,EAAK7c,SAAS6B,UAGlBwb,GAAgBjG,IACfrT,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEtF,QAASsE,EAAMqB,QAAQC,IAAI,IAACX,SAAA,CACrC2X,IACC1X,EAAAA,EAAAA,GAACkD,EAAAA,EAAWoO,UAAS,CACnBvD,MAAO,CAAE7T,WAAY,WAAY8S,aAAc5N,EAAMqB,QAAQC,GAAI5F,QAAS,OAAOsE,EAAMqB,QAAQG,QAASb,SAEvG4Y,EAAK7c,SAAS4b,cAGlBK,IACC/X,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAC3E6W,OAAOU,KAAKS,GAAiBtS,KAAKd,IACjC3E,EAAAA,EAAAA,GAAC6X,GAA+B,CAE9BC,UAAWnT,EACXoT,gBAAiBA,EAAgBpT,GACjCqT,WAAYiB,EAAelG,SAASpO,IAH/BA,YAYvB,C,2BCtEA,MAAM6U,GAAeF,IACnB,OAAQA,GACN,IAAK,SACH,OAAOtZ,EAAAA,EAAAA,GAACyZ,GAAAA,EAAsB,CAACjR,KAAMkR,EAAAA,GAAcC,SACrD,IAAK,OACH,OAAO3Z,EAAAA,EAAAA,GAACyZ,GAAAA,EAAsB,CAACjR,KAAMkR,EAAAA,GAAcE,OACrD,IAAK,OACL,IAAK,WACH,OAAO5Z,EAAAA,EAAAA,GAACyZ,GAAAA,EAAsB,CAACjR,KAAMkR,EAAAA,GAAcG,SACrD,QACE,OAAO7Z,EAAAA,EAAAA,GAACyZ,GAAAA,EAAsB,CAACjR,KAAMkR,EAAAA,GAAcI,SACvD,EAGIC,GAAsBC,IAC1B,OAAQA,EAAQV,MACd,IAAK,SACH,OACEtZ,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,WAIrB,IAAK,OACH,OACE5U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,SAIrB,IAAK,YACH,OACE5U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,cAIrB,IAAK,OACH,OAAIoF,EAAQrc,KACHqc,EAAQrc,MAGfqC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,SAIrB,IAAK,WACH,OACE5U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,aAIrB,QACE,OAAOoF,EAAQV,KACnB,EACA,IAAA5b,GAAA,CAAAC,KAAA,SAAAC,OAAA,gFAAAC,GAAA,CAAAF,KAAA,UAAAC,OAAA,6DAEK,MAAMqc,GAAsCA,EACjDd,eACAjG,WACAC,cACA6G,cAOA,MAAM,MAAE5a,IAAUC,EAAAA,EAAAA,KACZ+Z,EAAcD,EAChB,CACE,SAAU,CACRrY,gBAAiB1B,EAAM0L,OAAOuO,0BAC9Bld,OAAQ,YAGZ,CAAC,EAEL,OACE0D,EAAAA,EAAAA,IAAA,OACEyZ,KAAK,SACLxZ,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfe,WAAY,SACZnI,QAASsE,EAAMqB,QAAQC,GACvB0B,IAAKhD,EAAMqB,QAAQC,MAChB0Y,GACJ,IACD3V,QAASA,IAAM0P,GAAaD,GAAUnT,SAAA,CAErCoZ,IAAiBjG,GAAWlT,EAAAA,EAAAA,GAAC0D,EAAAA,gBAAe,KAAM1D,EAAAA,EAAAA,GAACuZ,EAAAA,EAAgB,KACnEC,GAAYQ,EAAQV,MACpBU,EAAQE,cACPla,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CACdtI,MAAM,YACNiF,IAAGpC,GAMDqC,UAEFC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,wCAEfiC,OAAQ,CACNsD,UACEna,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAE4C,YAAa5D,EAAMqB,QAAQG,IAAI,IAAEtD,MAAI,EAAAyC,SAC1Dga,GAAmBC,KAGxBI,YACEpa,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CAAC/X,YAAY,OAAOgY,QAASN,EAAQE,aAAana,UACxDC,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,cAAeka,WAAY,EAAGvf,SAAU,SAAU2F,WAAYvB,EAAMqB,QAAQG,IAAI,IAACb,UAEjGC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,IAAGjC,GAA0EgS,MAAI,EAAA9P,SAC/Fia,EAAQE,yBASvBla,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAC7F,MAAI,EAAAyC,SAAEga,GAAmBC,OAExC,EC7I+E,IAAAtc,GAAA,CAAAC,KAAA,UAAAC,OAAA,6DAElF,SAAS4c,IAAkC,SAAEC,IAClD,MAAM,MAAErb,IAAUC,EAAAA,EAAAA,KAElB,OACEQ,EAAAA,EAAAA,IAAA,OAAuBC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAAA,EAC9FC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CACdtI,MAAM,YACNiF,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfe,WAAY,SACZnI,QAAS,OAAOsE,EAAMqB,QAAQC,GAAKtB,EAAMqB,QAAQG,QAClD,IAACb,UAEFC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,wCAEfiC,OAAQ,CACN6D,cACE7a,EAAAA,EAAAA,IAAC2W,EAAAA,IAAG,CACF3b,MAAM,SACNyH,YAAY,gDACZxC,KAAGM,EAAAA,EAAAA,IAAE,CAAErF,OAAQ,OAAOqE,EAAMqB,QAAQG,QAAQ,IAACb,SAAA,EAE7CC,EAAAA,EAAAA,GAAC2a,EAAAA,aAAY,KACb3a,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAElG,WAAY,SAAUyG,WAAYvB,EAAMqB,QAAQG,IAAI,IAACb,SAC1E0a,EAAS3e,SAAS6B,UAIzByc,YACEpa,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CAAC/X,YAAY,OAAOgY,QAASG,EAAS5J,GAAG9Q,UAC/CC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,cAAeka,WAAY,EAAGvf,SAAU,SAAU2F,WAAYvB,EAAMqB,QAAQG,IAAI,IAACb,UACpGC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CACdrD,IAAGpC,GAKHmS,MAAI,EACJhV,MAAM,YAAWkF,SAEhB0a,EAAS5J,eAQxB7Q,EAAAA,EAAAA,GAACyS,GAAiC,CAACrI,KAAMqQ,EAAS3e,SAAS8e,cA9CnDH,EAAS5J,GAiDvB,CChCA,SAASgK,IAAqC,QAC5CP,EAAO,yBACPQ,IAKA,MAAM,MAAE1b,IAAUC,EAAAA,EAAAA,KAElB,OAAKib,EAIDQ,GAEA9a,EAAAA,EAAAA,GAACyS,GAAiC,CAChCrI,KAAMkQ,EACN7Y,aAAa,GACb4I,YAAa,KACbC,qBAAqB,EACrBoI,WAAYC,EAAAA,GAAsBC,QAMtC5S,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHtF,QAASsE,EAAMqB,QAAQC,GACvBqa,WAAY,EAIZ/N,cAAe5N,EAAM6L,WAAW+P,cACjC,IAACjb,UAEFC,EAAAA,EAAAA,GAACyO,EAAqB,CAAA1O,SAAEua,MA1BnB,IA6BX,CAEO,SAASW,IAA8B,QAC5CjB,EAAO,UACPvK,IAIE,IAADyL,EAAAC,EACD,MAAM,MAAE/b,IAAUC,EAAAA,EAAAA,MACX6T,EAAUC,IAAexU,EAAAA,EAAAA,WAAS,IACnC,QAAE2b,EAAO,OAAEc,GAhEQd,KACzB,IACE,MAAO,CACLA,QAAS1H,KAAKgF,UAAUhF,KAAKW,MAAM+G,GAAU,KAAM,GACnDc,QAAQ,EAEZ,CAAE,MAAOC,GACP,MAAO,CACLf,UACAc,QAAQ,EAEZ,GAqD4BE,CAAiC,QAAhBJ,EAAClB,EAAQM,eAAO,IAAAY,EAAAA,EAAI,IAI3DJ,EAA2BM,IAA4B,SAAjBpB,EAAQV,MAAoC,aAAjBU,EAAQV,MAEzEiC,EAAgC,QAAlBJ,EAAGnB,EAAQM,eAAO,IAAAa,OAAA,EAAfA,EAAiB5M,WAAW,MAI7C4K,GAAgB2B,IAA6BS,GAAkBjB,EAAQ/U,OCvFvC,IDyFhCiW,EAAmBrC,IAAiBjG,EAAW,GAAGoH,EAAQxO,MAAM,ECzFhC,UDyFoEwO,EAE1G,OACEza,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACflD,MAAO,OACP9D,aAAckE,EAAM0N,QAAQoJ,eAC5BtJ,OAAQ,aAAaxN,EAAM0L,OAAO8B,SAClC9L,gBAAiB1B,EAAM0L,OAAOkD,kBAC9BhT,SAAU,UACX,IACDyU,UAAWA,EAAU1P,SAAA,EAErBC,EAAAA,EAAAA,GAACia,GAAmC,CAClCd,aAAcA,EACdjG,SAAUA,EACVC,YAAaA,EACb6G,QAASA,KAEXna,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAAA,GAC1EkJ,EAAAA,EAAAA,OAAM+Q,EAAQyB,aACdzB,EAAQyB,WAAWhW,KAAKgV,IACtBza,EAAAA,EAAAA,GAACwa,GAAiC,CAAmBC,SAAUA,GAAvBA,EAAS5J,OAErD7Q,EAAAA,EAAAA,GAAC6a,GAAoC,CACnCP,QAASkB,EACTV,yBAA0BA,OAG7B3B,IACCnZ,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLhB,YACE4Q,EACI,oDACA,oDAEN3P,KAAM2P,GAAWlT,EAAAA,EAAAA,GAACwD,EAAAA,cAAa,KAAMxD,EAAAA,EAAAA,GAAC0D,EAAAA,gBAAe,IACrD8E,KAAK,WACL/E,QAASA,IAAM0P,GAAaD,GAC5BpT,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACTrB,MAAO,OACPlE,QAASsE,EAAMqB,QAAQwM,GACvB/R,aAAc,kBACf,IAAC6E,SAEDmT,GACClT,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,cAIjB5U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,iBAQ7B,CEjJO,SAAS8G,IAA+B,SAAEC,IAC/C,MAAM,MAAEvc,IAAUC,EAAAA,EAAAA,KAElB,OAAI4J,EAAAA,EAAAA,OAAM0S,GACD,MAIP3b,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfE,IAAKhD,EAAMqB,QAAQC,IACpB,IAACX,SAED4b,EAASlW,KAAI,CAACuU,EAAS3M,KACtBrN,EAAAA,EAAAA,GAACib,GAA6B,CAAajB,QAASA,GAAhB3M,MAI5C,CCzBwH,IAAA3P,GAAA,CAAAC,KAAA,UAAAC,OAAA,cAEjH,MAAMge,GAAuCA,EAClDC,aACA/G,QACA/U,WACA+b,cAAa,EACbrM,gBAQA,MAAOyD,EAAUC,IAAexU,EAAAA,EAAAA,WAAS,IACnC,MAAES,IAAUC,EAAAA,EAAAA,KAClB,OACEQ,EAAAA,EAAAA,IAAA,OACE4P,UAAWA,EACX3P,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfhH,aAAckE,EAAM0N,QAAQC,gBAC7B,IAAChN,SAAA,EAEFF,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACH6C,WAAY,SACZ5C,QAAS,OACT6B,cAAe,MACfE,IAAKhD,EAAMqB,QAAQG,GACnB9F,QAASghB,EAAa1c,EAAMqB,QAAQC,GAAK,EACzC9F,WAAYkhB,EAAa1c,EAAM0L,OAAOE,yBAAsB7E,EAC5DkS,oBAAqBjZ,EAAM0N,QAAQC,eACnCuL,qBAAsBlZ,EAAM0N,QAAQC,eACpCgP,uBAAwB7I,EAAW,EAAI9T,EAAM0N,QAAQC,eACrDiP,wBAAyB9I,EAAW,EAAI9T,EAAM0N,QAAQC,eACtDH,OAAQkP,EAAa,aAAa1c,EAAM0L,OAAO8B,cAAWzG,EAC1D6G,aAAc8O,EAAa,EAAI1c,EAAMqB,QAAQC,IAC9C,IAACX,SAAA,EAEFC,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLpC,KAAK,QACLoB,YAAa,sCAAsCuZ,IACnDrT,KAAK,WACLjF,KAAM2P,GAAWlT,EAAAA,EAAAA,GAAC0D,EAAAA,gBAAe,KAAM1D,EAAAA,EAAAA,GAACuZ,EAAAA,EAAgB,IACxD9V,QAASA,IAAM0P,GAAaD,MAE9BlT,EAAAA,EAAAA,GAACkD,EAAAA,EAAWsO,MAAK,CAAC2E,gBAAc,EAAC1E,MAAO,EAAG3R,IAAGpC,GAAoBqC,SAC/D+U,OAGJ5B,IACClT,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHwM,OAAQkP,EAAa,aAAa1c,EAAM0L,OAAO8B,cAAWzG,EAC1D8V,UAAW,OACXF,uBAAwBD,EAAa1c,EAAM0N,QAAQC,oBAAiB5G,EACpE6V,wBAAyBF,EAAa1c,EAAM0N,QAAQC,oBAAiB5G,EACrErL,QAASghB,EAAa1c,EAAMqB,QAAQC,GAAK,GAC1C,IAACX,SAEDA,MAGD,EC5DH,SAASmc,IAA0B,aACxCvU,EAAY,UACZwU,IAKA,MAAM,MAAE/c,IAAUC,EAAAA,EAAAA,KAElB,OACEQ,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHgc,UAAW,OACXthB,QAASsE,EAAMqB,QAAQwM,IACxB,IACD,cAAY,gCAA+BlN,SAAA,CAE1Coc,IACCnc,EAAAA,EAAAA,GAAC4b,GAAoC,CACnC9b,KAAGM,EAAAA,EAAAA,IAAE,CAAE4M,aAAc5N,EAAMqB,QAAQC,IAAI,IACvCoU,OACE9U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,UAInBiH,WAAW,WAAU9b,UAErBC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAC3Eoc,EAAU1W,KAAKkT,IACd3Y,EAAAA,EAAAA,GAAC0Y,GAA0B,CAA0BC,KAAMA,GAA1BA,EAAK7c,SAAS6B,aAMvDqC,EAAAA,EAAAA,GAAC4b,GAAoC,CACnC9G,OACE9U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,aAInBiH,WAAW,WAAU9b,UAErBC,EAAAA,EAAAA,GAAC0b,GAA8B,CAACC,SAAUhU,QAIlD,CChD+F,IAAAjK,GAAA,CAAAC,KAAA,UAAAC,OAAA,+FAAAC,GAAA,CAAAF,KAAA,SAAAC,OAAA,4EAExF,SAASye,IAAkC,WAChDlF,EAAU,UACV1H,EAAS,aACThO,EAAY,YACZ4I,IAOA,MAAM,MAAEjL,IAAUC,EAAAA,EAAAA,KACZid,GAAYlV,EAAAA,EAAAA,UAAQ,KAAMmV,EAAAA,EAAAA,IAA+B,OAAVpF,QAAU,IAAVA,OAAU,EAAVA,EAAYqF,SAAS,CAACrF,IACrEsF,GAAarV,EAAAA,EAAAA,UAAQ,KAAMmV,EAAAA,EAAAA,IAA+B,OAAVpF,QAAU,IAAVA,OAAU,EAAVA,EAAYuF,UAAU,CAACvF,IAE7E,IAAIlO,EAAAA,EAAAA,OAAMkO,GACR,OAAO,KAGT,MAAMwF,EAAiBL,EAAU/W,OAAS,EACpCqX,EAAkBH,EAAWlX,OAAS,EAEtCgS,IAAqBtO,EAAAA,EAAAA,OAAMoB,IAAgBA,EAAYhB,KAAK1E,MAAQwS,EAAWxS,IAErF,OACE9E,EAAAA,EAAAA,IAAA,OAAK,cAAY,yCAAwCE,SAAA,CACtD4c,IACC3c,EAAAA,EAAAA,GAAC4b,GAAoC,CACnCE,YAAU,EACVhc,KAAGM,EAAAA,EAAAA,IAAE,CAAE4M,aAAc5N,EAAMqB,QAAQC,IAAI,IACvCmb,WAAW,QACX/G,OACE9U,EAAAA,EAAAA,GAAA,OACEF,IAAGpC,GAMDqC,UAEFC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,aAIpB7U,UAEDC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAC3Euc,EAAU7W,KAAI,EAAGd,MAAKnC,SAAS6K,KAC9BrN,EAAAA,EAAAA,GAAC4V,GAA6B,CAE5Bd,MAAOnQ,EACPyF,KAAM5H,EACNf,aAAcA,EACd4I,YAAaA,EACbC,oBAAqBiN,GAA6C,WAAxBlN,EAAYvC,SAAwBuC,EAAY1F,MAAQA,GAL7FA,GAAO0I,SAWrBuP,IACC5c,EAAAA,EAAAA,GAAC4b,GAAoC,CACnCE,YAAU,EACVD,WAAW,SACX/G,OACE9U,EAAAA,EAAAA,GAAA,OAAKF,IAAGjC,GAA4FkC,UAClGC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,cAIpB7U,UAEDC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAC3E0c,EAAWhX,KAAI,EAAGd,MAAKnC,YACtBxC,EAAAA,EAAAA,GAAC4V,GAA6B,CAE5Bd,MAAOnQ,EACPyF,KAAM5H,EACNf,aAAcA,EACd4I,YAAaA,EACbC,oBAAqBiN,GAA6C,YAAxBlN,EAAYvC,SAAyBuC,EAAY1F,MAAQA,GAL9FA,WAarB,CCjGA,MAEMkY,GAAsBC,GAC1BA,EACI,CACE9hB,SAAU,SACVyZ,aAAc,WACdva,WAAY,UAEd,CAAEA,WAAY,UAKP6iB,GAAcA,EACzBC,UACAC,YACAC,YAjBuB,GAkBvBje,WAAW,IACXwQ,gBAQA,MAAM,kBAAE0N,EAAiB,oBAAEC,GAmBtB,SACLzY,EACAnC,EACA0a,GAEA,MAAMG,EAAa1Y,EAAIY,OAAS/C,EAAM+C,OAChC+X,EAAc3Y,EAAIY,OAAS/C,EAAM+C,OACjCgY,EAAgBD,EAAc9a,EAAM+C,OAASZ,EAAIY,OAGvD,OAAI8X,GAAcH,EAAkB,CAAEC,mBAAmB,EAAOC,qBAAqB,GAEjFG,EAAgBL,EAAY,EAAU,CAAEC,mBAAmB,EAAMC,qBAAqB,GAGnF,CACLD,kBAAmBG,EACnBF,qBAAsBE,EAE1B,CAtCqDE,CAAgCR,EAASC,EAAWC,GAEvG,OACEld,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CAAC/X,YAAY,0DAA0DgY,QAAS,GAAG0C,MAAYC,IAAYld,UACjHC,EAAAA,EAAAA,GAACwW,EAAAA,IAAG,CAAClU,YAAY,4CAA4CmN,UAAWA,EAAU1P,UAChFF,EAAAA,EAAAA,IAAA,QAAMC,KAAGM,EAAAA,EAAAA,IAAE,CAAEnB,WAAUoB,QAAS,eAAe,IAACN,SAAA,EAC9CC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAC7F,MAAI,EAACwC,IAAK+c,GAAmBM,GAAoBjc,KAAK,KAAInB,SACxEid,IACe,SAElBhd,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,IAAK+c,GAAmBO,GAAsBlc,KAAK,KAAInB,SACrEkd,UAIC,EC3C6C,IAAAvf,GAAA,CAAAC,KAAA,UAAAC,OAAA,sCAEpD,SAAS6f,IAAwC,KACtDC,EAAI,aACJC,EAAY,YACZxK,EAAW,iBACXyK,IAOA,MAAM,MAAExe,IAAUC,EAAAA,EAAAA,KAElB,OACEQ,EAAAA,EAAAA,IAAA,OAAKC,IAAGpC,GAA+CqC,SAAA,EACrDC,EAAAA,EAAAA,GAAA,OACEsZ,KAAK,SACL7V,QAASA,KACP0P,GAAY,GACI,OAAhByK,QAAgB,IAAhBA,GAAAA,EAAmB,WAAW,EAEhC9d,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfe,WAAY,SACZ9G,OAAQ,UACRrB,QAAS,GAAGsE,EAAMqB,QAAQC,QAAQtB,EAAMqB,QAAQwM,OAChDC,OAAQ9N,EAAM6L,WAAWyJ,eACzBnE,UAAW,cACX,UAAW,CACTzP,gBAAiB1B,EAAM0L,OAAOE,sBAEjC,IAACjL,UAEFC,EAAAA,EAAAA,GAAC6d,EAAAA,iBAAgB,OAEnB7d,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEtF,QAASsE,EAAMqB,QAAQwM,GAAIsH,cAAe,GAAG,IAACxU,UACxDC,EAAAA,EAAAA,GAACyO,EAAqB,CAAA1O,SAAE2d,OAE1B1d,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEtF,QAASsE,EAAMqB,QAAQwM,GAAI8N,WAAY,GAAG,IAAChb,SACpD4d,EAAalY,KAAI,EAAGd,MAAKnC,YACxBxC,EAAAA,EAAAA,GAAC+c,GAAW,CAAWC,QAASrY,EAAKsY,UAAWza,GAA9BmC,QAGtB3E,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLxD,KAAGM,EAAAA,EAAAA,IAAE,CAAEpB,MAAO,OAAQlE,QAASsE,EAAMqB,QAAQC,IAAI,IACjD4B,YAAY,0DACZiB,MAAMvD,EAAAA,EAAAA,GAACwD,EAAAA,cAAa,IACpBgF,KAAK,WACL/E,QAASA,IAAM0P,GAAY,GAAOpT,UAElCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,iBAMzB,CC9D2D,IAAAlX,GAAA,CAAAC,KAAA,SAAAC,OAAA,YAAAC,GAAA,CAAAF,KAAA,UAAAC,OAAA,wBAAAE,GAAA,CAAAH,KAAA,UAAAC,OAAA,+BAEpD,SAASkgB,IAA2C,KACzDJ,EAAI,aACJC,EAAY,YACZxK,EAAW,iBACXyK,IAOA,MAAM,MAAExe,IAAUC,EAAAA,EAAAA,KAElB,OACEQ,EAAAA,EAAAA,IAAA,OACEyZ,KAAK,SACL7V,QAASA,KACP0P,GAAY,GACI,OAAhByK,QAAgB,IAAhBA,GAAAA,EAAmB,SAAS,EAE9B9d,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfpH,QAAS,GAAGsE,EAAMqB,QAAQC,QAAQtB,EAAMqB,QAAQwM,OAChD7K,IAAKhD,EAAMqB,QAAQC,GACnBuC,WAAY,SACZd,eAAgB,gBAChBhG,OAAQ,UACR,UAAW,CACT2E,gBAAiB1B,EAAM0L,OAAOE,sBAEjC,IAACjL,SAAA,EAEFF,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfE,IAAKhD,EAAMqB,QAAQC,GACnBuC,WAAY,SACZ8a,SAAU,EACVxD,WAAY,GACb,IAACxa,SAAA,EAEFC,EAAAA,EAAAA,GAAC6d,EAAAA,iBAAgB,KACjB7d,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAC6a,UAAQ,EAAC9c,KAAK,KAAInB,SAChC2d,QAGL7d,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfE,IAAKhD,EAAMqB,QAAQC,IACpB,IAACX,SAAA,CAED4d,EAAapY,OAAS,GACrBvF,EAAAA,EAAAA,GAAC+c,GAAW,CAACjd,IAAGpC,GAAiBsf,QAASW,EAAa,GAAGhZ,IAAKsY,UAAWU,EAAa,GAAGnb,QACxF,KACHmb,EAAapY,OAAS,GACrBvF,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CACN/X,YAAY,sDACZgY,QAASqD,EAAa7R,MAAM,GAAGrG,KAAI,EAAGd,MAAKnC,YACzCxC,EAAAA,EAAAA,GAAA,QAAgBF,IAAGjC,GAA8BkC,SAC9C,GAAG4E,MAAQnC,KADHmC,KAGV5E,UAEHF,EAAAA,EAAAA,IAAC2W,EAAAA,IAAG,CAAClU,YAAY,wCAAwCxC,IAAGhC,GAAsCiC,SAAA,CAAC,IAC/F4d,EAAapY,OAAS,OAG1B,UAIZ,CCzEO,SAAS0Y,IAAoC,KAClDP,EAAI,SACJQ,IAKA,MAAOhL,EAAUC,IAAexU,EAAAA,EAAAA,WAAS,GACnCgf,GAAepB,EAAAA,EAAAA,IAAqB2B,GAE1C,OAAOhL,GACLlT,EAAAA,EAAAA,GAACyd,GACC,CACAC,KAAMA,EACNC,aAAcA,EACdxK,YAAaA,KAGfnT,EAAAA,EAAAA,GAAC8d,GACC,CACAJ,KAAMA,EACNC,aAAcA,EACdxK,YAAaA,GAGnB,CCvBoD,IAAAzV,GAAA,CAAAC,KAAA,SAAAC,OAAA,mCAAAC,GAAA,CAAAF,KAAA,SAAAC,OAAA,mCAE7C,SAASugB,IAAmC,qBACjDC,EAAoB,wBACpBC,IAKA,MAAM,MAAEjf,IAAUC,EAAAA,EAAAA,KAElB,OACEQ,EAAAA,EAAAA,IAACye,EAAAA,sBAAqB,CACpB,cAAY,0CACZ3gB,KAAK,cACLuD,KAAK,QACLoB,YAAa,0DAA0D8b,IACvE5b,MAAO4b,EACP1b,SAAW6b,IACTF,EAAwBE,EAAM5b,OAAOH,MAAM,EAC3CzC,SAAA,EAEFC,EAAAA,EAAAA,GAACwe,EAAAA,uBAAsB,CAAC,cAAY,+CAA+Chc,OAAO,EAAMzC,UAC9FC,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CACN/X,YAAY,0DACZgY,SACEta,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,cAGlB7U,UAEDC,EAAAA,EAAAA,GAAA,OAAKF,IAAGpC,GAA4CqC,UAClDC,EAAAA,EAAAA,GAACye,EAAAA,YAAW,CAAC3e,KAAGM,EAAAA,EAAAA,IAAE,CAAEtG,SAAUsF,EAAM6L,WAAWyT,YAAY,aAIjE1e,EAAAA,EAAAA,GAACwe,EAAAA,uBAAsB,CAAC,cAAY,6CAA6Chc,OAAK,EAAAzC,UACpFC,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CACN/X,YAAY,wDACZgY,SACEta,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,sBAGlB7U,UAEDC,EAAAA,EAAAA,GAAA,OAAKF,IAAGjC,GAA4CkC,UAClDC,EAAAA,EAAAA,GAAC2e,EAAAA,MAAK,CAAC7e,KAAGM,EAAAA,EAAAA,IAAE,CAAEtG,SAAUsF,EAAM6L,WAAWyT,YAAY,cAMjE,CCnD2F,IAAAhhB,GAAA,CAAAC,KAAA,UAAAC,OAAA,+FAEpF,SAASghB,IAAoC,WAClDzH,EAAU,UACV1H,EAAS,aACThO,EAAY,YACZ4I,IAOA,MAAM,MAAEjL,IAAUC,EAAAA,EAAAA,MACX+e,EAAsBC,IAA2B1f,EAAAA,EAAAA,WAAS,GAC3D2d,GAAYlV,EAAAA,EAAAA,UAAQ,KAAMmV,EAAAA,EAAAA,IAAqBpF,EAAWqF,SAAS,CAACrF,IAEpEuF,EAAUvF,EAAWuF,QAErBC,EAAiBL,EAAU/W,OAAS,EAKpCgS,IAAqBtO,EAAAA,EAAAA,OAAMoB,IAAgBA,EAAYhB,KAAK1E,MAAQwS,EAAWxS,IAC/Eka,EAA6BtH,GAA6C,YAAxBlN,EAAYvC,QAEpE,OACEjI,EAAAA,EAAAA,IAAA,OAAK4P,UAAWA,EAAW,cAAY,2CAA0C1P,SAAA,CAC9E4c,IACC3c,EAAAA,EAAAA,GAAC4b,GAAoC,CACnCC,WAAW,QACX/b,KAAGM,EAAAA,EAAAA,IAAE,CAAE4M,aAAc5N,EAAMqB,QAAQC,IAAI,IACvCoU,OACE9U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,WAGlB7U,UAEDC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAC3Euc,EAAU7W,KAAI,EAAGd,MAAKnC,SAAS6K,KAC9BrN,EAAAA,EAAAA,GAAC4V,GAA6B,CAE5Bd,MAAOnQ,EACPyF,KAAM5H,EACNf,aAAcA,EACd4I,YAAaA,EACbC,oBAAqBiN,GAA6C,WAAxBlN,EAAYvC,SAAwBuC,EAAY1F,MAAQA,GAL7FA,GAAO0I,UAYtBrN,EAAAA,EAAAA,GAAC4b,GAAoC,CACnCC,WAAW,SACX/G,OACEjV,EAAAA,EAAAA,IAAA,OACEC,IAAGpC,GAMDqC,SAAA,EAEFF,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,MAAOE,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAAA,EACzEC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,eAGjB5U,EAAAA,EAAAA,GAACwW,EAAAA,IAAG,CAAClU,YAAY,6CAA4CvC,SAAE2c,EAAQnX,aAEvEsZ,IACA7e,EAAAA,EAAAA,GAACme,GAAkC,CACjCC,qBAAsBA,EACtBC,wBAAyBA,OAIhCte,SAEAqe,IAAyBS,GACxB7e,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHwM,OAAQ,aAAaxN,EAAM0L,OAAO8B,SAClC1R,aAAckE,EAAM0f,cAAc/R,gBACnC,IAAChN,SAED2c,EAAQjX,KAAI,CAACsZ,EAAUC,KACtBhf,EAAAA,EAAAA,GAAA,OAEEF,KAAGM,EAAAA,EAAAA,IAAE,CAAEnD,aAAc+hB,IAAQtC,EAAQnX,OAAS,EAAI,aAAanG,EAAM0L,OAAO8B,SAAW,IAAI,IAAC7M,UAE5FC,EAAAA,EAAAA,GAACie,GAAmC,CAElCP,KAAMqB,EAASE,aACff,SAAUa,EAASb,UAFdc,IAJFA,QAYXhf,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHwM,OAAQ,aAAaxN,EAAM0L,OAAO8B,SAClC1R,aAAckE,EAAM0f,cAAc/R,eAClCjS,QAASsE,EAAMqB,QAAQwM,IACxB,IAAClN,UAEFC,EAAAA,EAAAA,GAAC4V,GAA6B,CAC5Bd,MAAM,GACN1K,KAAMwI,KAAKgF,UAAU8E,EAAS,KAAM,GACpCjb,aAAcA,EACd4I,YAAaA,EACbC,oBAAqBiN,GAA6C,YAAxBlN,EAAYvC,gBAOpE,CC7HO,SAASoX,IAA6B,WAC3C/H,EAAU,UACV1H,EAAS,aACThO,EAAY,YACZ4I,IAOA,MAAM,MAAEjL,IAAUC,EAAAA,EAAAA,KAElB,QAAK4J,EAAAA,EAAAA,OAAMkO,KAAegI,EAAAA,EAAAA,IAA0BhI,IAEhDnX,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHgc,UAAW,OACXthB,QAASsE,EAAMqB,QAAQwM,IACxB,IACDwC,UAAWA,EACX,cAAY,mCAAkC1P,UAE9CC,EAAAA,EAAAA,GAAC4e,GAAmC,CAClCzH,WAAYA,EACZ1H,UAAWA,EACXhO,aAAcA,EACd4I,YAAaA,OAOnBrK,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHgc,UAAW,OACXthB,QAASsE,EAAMqB,QAAQwM,IACxB,IACDwC,UAAWA,EACX,cAAY,mCAAkC1P,UAE9CC,EAAAA,EAAAA,GAACqc,GAAiC,CAChClF,WAAYA,EACZ1H,UAAWA,EACXhO,aAAcA,EACd4I,YAAaA,KAIrB,CCjDO,SAAS+U,IAA4B,WAC1CjI,EAAU,aACV1V,EAAY,YACZ4I,IAMA,MAAM,MAAEjL,IAAUC,EAAAA,EAAAA,MACZ,OAAEggB,GAAWlI,EACbI,IAAqBtO,EAAAA,EAAAA,OAAMoB,IAAgBA,EAAYhB,KAAK1E,MAAQwS,EAAWxS,IAErF,OAAK2a,MAAMC,QAAQF,IAA6B,IAAlBA,EAAO9Z,QAgBnCvF,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEtF,QAASsE,EAAMqB,QAAQwM,IAAI,IAAClN,SACrCsf,EAAO5Z,KAAI,CAAC8Y,EAAOlR,KAClB,MAAM+J,EAAamH,EAAMnH,WACnBtC,EACW,cAAfyJ,EAAM5gB,MACJkC,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACwf,EAAAA,YAAW,CAAC1f,KAAGM,EAAAA,EAAAA,IAAE,CAAE4C,YAAa5D,EAAMqB,QAAQC,IAAI,IAAE7F,MAAM,YAC3DmF,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACtI,MAAM,QAAQyC,MAAI,EAAAyC,SAAC,iBAKtCwe,EAAM5gB,KAGV,OAAKyZ,GAGHpX,EAAAA,EAAAA,GAAC4b,GAAoC,CAEnCC,WAAY0C,EAAM5gB,KAClBmX,MAAOA,EACPgH,YAAU,EAAA/b,UAEVC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAC3E6W,OAAOU,KAAKF,GAAY3R,KAAKga,IAC5B,MAAM9a,GAAM+a,EAAAA,EAAAA,IAAqBnB,EAAM5gB,KAAM0P,EAAOoS,GAEpD,OACEzf,EAAAA,EAAAA,GAAC4V,GAA6B,CAE5Bd,MAAO2K,EACPrV,KAAMwI,KAAKgF,UAAUR,EAAWqI,GAAY,KAAM,GAClDhe,aAAcA,EACd4I,YAAaA,EACbC,oBACEiN,GAA6C,WAAxBlN,EAAYvC,SAAwBuC,EAAY1F,MAAQA,EAE/E4Q,kBAAmB5C,EAAAA,GAAsB+C,MARpC/Q,EASL,OApBH,GAAG4Z,EAAM5gB,QAAQ0P,KAJF,IA4BiB,OAzD3CrN,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEoX,UAAWpY,EAAMqB,QAAQwM,IAAI,IAAClN,UACxCC,EAAAA,EAAAA,GAACyX,EAAAA,MAAK,CACJC,aACE1X,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,uBA0D7B,CCrFO,SAAS+K,IAAwB,MAAEC,IACxC,MAAM,MAAExgB,IAAUC,EAAAA,EAAAA,KAElB,OACEW,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT4C,WAAY,SACZd,eAAgB,SAChBjH,aAAckE,EAAM6L,WAAW+P,aAC/B9N,OAAQ9N,EAAM6L,WAAW+P,aACzBla,gBAAiB1B,EAAM0L,OAAO+U,qCAC9B/kB,QAASsE,EAAMqB,QAAQG,GACvBD,WAAYvB,EAAMqB,QAAQG,GAC1B2P,UAAW,cACZ,IAACxQ,UAEFC,EAAAA,EAAAA,GAAA,QAAMF,KAAGM,EAAAA,EAAAA,IAAE,CAAEvF,MAAOuE,EAAM0L,OAAOgV,yBAA0BhmB,SAAU,IAAI,IAACiG,SAAE6f,KAGlF,CCnBuF,IAAAliB,GAAA,CAAAC,KAAA,SAAAC,OAAA,iBAAAC,GAAA,CAAAF,KAAA,SAAAC,OAAA,8CAEhF,MAAMmiB,GAAuBA,KAClC,MAAM,wBAAEtZ,EAAuB,2BAAEC,EAA0B,uBAAEC,GAC3DC,IAEF,OACE5G,EAAAA,EAAAA,GAACse,EAAAA,sBAAqB,CACpBxe,IAAGpC,GACHC,KAAK,sDACL2E,YAAY,sDACZE,MAAOiE,EACPvF,KAAK,QAAOnB,UAEZC,EAAAA,EAAAA,GAACwe,EAAAA,uBAAsB,CACrBhc,OAAK,EACLsO,UAAWnK,EACXpD,MAAMvD,EAAAA,EAAAA,GAACggB,EAAAA,UAAS,IAChBvc,QAASA,IAAgC,OAA1BiD,QAA0B,IAA1BA,OAA0B,EAA1BA,GAA8BD,GAC7C3G,IAAGjC,GAKDkC,UAEA0G,IACAzG,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,mBAKC,E,4BC9BrB,MAAMqL,GAA4B,IAsB5BC,GAAeA,CAACC,EAAWC,EAAgB,IAAIC,QAC1D,MAAMC,EAAU5a,KAAKC,IAAI,EAAGD,KAAK6a,OAAOH,EAAcI,UAAYL,GAAQ,MAC1E,IAAIM,EAAW/a,KAAK6a,MAAMD,EAAU,SAEpC,OAAIG,GAAY,GAEZzgB,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,uDAEfiC,OAAQ,CAAE6J,UAAWD,MAI3BA,EAAW/a,KAAK6a,MAAMD,EAAU,QAC5BG,GAAY,GAEZzgB,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,yDAEfiC,OAAQ,CAAE6J,UAAWD,MAI3BA,EAAW/a,KAAK6a,MAAMD,EAAU,OAC5BG,GAAY,GAEZzgB,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,qDAEfiC,OAAQ,CAAE6J,UAAWD,MAI3BA,EAAW/a,KAAK6a,MAAMD,EAAU,MAC5BG,GAAY,GAEZzgB,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,uDAEfiC,OAAQ,CAAE6J,UAAWD,MAI3BA,EAAW/a,KAAK6a,MAAMD,EAAU,IAC5BG,GAAY,GAEZzgB,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,2DAEfiC,OAAQ,CAAE6J,UAAWD,MAKzBzgB,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,2DAEfiC,OAAQ,CAAE6J,UAAWJ,QACrB,EAoBOK,GAAkCA,EAC7CC,YACAC,WACAC,gBAMIA,EACK,CAAEC,SAAU,CAAEve,MAAOoe,IAGb,SAAbC,EACK,CAAEG,YAAa,CAAEC,iBAAkB,CAAEze,MAAOuN,OAAO6Q,GAAYM,qBAAsB,iBAGvF,CAAEF,YAAa,CAAExe,MAAOoe,I,gBCxHjC,MAAMO,GAAUC,MAEhB,SAASC,GAAqBC,GAC5B,QAAgBnb,IAAZmb,EAGJ,MAA0B,kBAAZA,GAAwBA,aAAmBC,UAAYD,aAAmBE,KACpFF,EACA1O,KAAKgF,UAAU0J,EACrB,CAEO,MAAMG,GAAWC,MAAOtlB,EAAaulB,EAA8C,MAAOC,KAC/F,MAAMC,QAAiBV,GAAQ/kB,EAAK,CAClCulB,SACAC,KAAMP,GAAqBO,GAC3BE,QAASF,EAAO,CAAE,eAAgB,oBAAuB,CAAC,IAE5D,IAAKC,EAASE,GAAI,CAChB,MAAMC,GAAkBC,EAAAA,GAAAA,IAAqBJ,GAC7C,GAAIG,EAAiB,CACnB,IAEE,MAAMhI,SAAiB6H,EAASK,QAAQlI,QACxCgI,EAAgBhI,QAAiB,OAAPA,QAAO,IAAPA,EAAAA,EAAWgI,EAAgBhI,OACvD,CAAE,MACA,CAEF,MAAMgI,CACR,CACF,CACA,OAAOH,EAASK,MAAM,ECtBXC,GAAmBA,EAAGb,aACjCG,GAAS,+BAA+BH,EAAQc,WAAWC,uBAAwB,OAAQf,GCHhFgB,IAA+Bzc,EAAAA,EAAAA,eAAgD,CAC1F0c,iBAAkB,OAGPC,GAAkCA,KACtC3b,EAAAA,EAAAA,YAAWyb,ICUPG,GAAuBA,EAClCC,iBACAC,SACAC,UAGAzP,kBAOA,MAAM0P,GAAOC,EAAAA,GAAAA,MACP,MAAE1jB,IAAUC,EAAAA,EAAAA,MAEX1B,EAAMolB,IAAWpkB,EAAAA,EAAAA,UAAS,KAC1BqkB,EAAgBC,IAAqBtkB,EAAAA,EAAAA,UAAqC,aAC1EkiB,EAAUqC,IAAevkB,EAAAA,EAAAA,UAAsC,YAC/D6D,EAAO2gB,IAAYxkB,EAAAA,EAAAA,WAAoC,IACvDykB,EAAWC,IAAgB1kB,EAAAA,EAAAA,UAAS,KACpC2kB,EAAYC,IAAiB5kB,EAAAA,EAAAA,UAAiC,OAE/D,iBAAE4jB,GAAqBC,MAErBgB,OAAQC,EAAwB,UAAEC,IAAcC,EAAAA,GAAAA,GAAY,CAClEC,WAAatC,GAAqCa,GAAiB,CAAEb,YACrEuC,UAAWA,KACO,OAAhBtB,QAAgB,IAAhBA,GAAAA,GAAoB,EAEtBuB,QAAUzI,KACR0I,EAAAA,EAAAA,IACElB,EAAKmB,cACH,CAAAnT,GAAA,SACE+D,eAAe,+CAGjB,CACEyG,MAAOA,aAAiB4I,MAAQ5I,EAAMrB,QAAUjK,OAAOsL,KAG5D,EAEH6I,UAAWA,KACT/Q,GAAY,EAAM,IAIhBgR,IAAmBlb,EAAAA,EAAAA,OAAMyZ,GAEzB0B,GAAe7kB,EAAAA,EAAAA,cAAYmiB,UAC/B,GAAiB,SAAbb,EACF,IAEEjO,KAAKW,MAAM/Q,EACb,CAAE,MAAOvB,GAOP,YANAsiB,GACEvjB,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,yCAKrB,CAGF,MAAMyP,EAAW1D,GAAgC,CAC/CC,UAAWpe,EACXqe,WACAC,WAA+B,aAAnBkC,IAGR1B,EAAmC,CACvCc,WAAY,CACVkC,gBAAiBH,EAAkBzB,EAAiB/kB,EACpD0kB,SAAUO,EACV2B,OAAQ,CACNC,YAAa,QACbC,WAAWC,EAAAA,EAAAA,OAEbC,QAAShC,EACTS,eACGiB,UAIDZ,EAAyBnC,EAAQ,GACtC,CACDT,EACAre,EACAwgB,EACAmB,EACAzB,EACA/kB,EACAilB,EACAD,EACAS,EACAK,IAGF,OACE5jB,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfE,IAAKhD,EAAMqB,QAAQG,GACnB4W,UAAWpY,EAAMqB,QAAQC,GACzBkM,OAAQ,aAAaxN,EAAM0L,OAAO8B,SAClC9R,QAASsE,EAAMqB,QAAQC,GACvBxF,aAAckE,EAAM0N,QAAQoJ,gBAC7B,IAACnW,SAAA,EAEFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACjC,KAAK,KAAKrG,MAAM,YAAWkF,UAC1CC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,uBAInB/U,EAAAA,EAAAA,IAAC+kB,EAAAA,aAAY,CACX/T,GAAG,qDACHvO,YAAY,qDACZE,MAAOwgB,EACPlS,SAAU4S,EACVhhB,SAAWzB,GAAMgiB,EAAkBhiB,EAAE0B,OAAOH,OAAqCzC,SAAA,EAEjFC,EAAAA,EAAAA,GAAC6kB,EAAAA,mBAAkB,CAACriB,MAAM,WAAUzC,UAClCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,gBAEnC5U,EAAAA,EAAAA,GAAC6kB,EAAAA,mBAAkB,CAACriB,MAAM,cAAazC,UACrCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,sBAKrB5U,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAEoX,UAAWpY,EAAMqB,QAAQG,IAAI,IAAEM,KAAK,KAAKrG,MAAM,YAAWkF,UAChFC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,sBAIlBuP,GACCnkB,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAApD,SAAE2iB,KAElB1iB,EAAAA,EAAAA,GAACqC,EAAAA,EAAK,CACJC,YAAY,oDACZE,MAAO7E,EACPmT,SAAU4S,EACVoB,UAAY7jB,GAAMA,EAAE8jB,kBACpBriB,SAAWzB,GAAM8hB,EAAQ9hB,EAAE0B,OAAOH,UAGtCxC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAEoX,UAAWpY,EAAMqB,QAAQG,IAAI,IAAEM,KAAK,KAAKrG,MAAM,YAAWkF,UAChFC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,iBAInB/U,EAAAA,EAAAA,IAAC+kB,EAAAA,aAAY,CACX/T,GAAG,0DACHvO,YAAY,0DACZE,MAAOqe,EACP/P,SAAU4S,EACVhhB,SAAWzB,IACTiiB,EAAYjiB,EAAE0B,OAAOH,OACrB+gB,EAAc,KAAK,EACnBxjB,SAAA,CAEkB,gBAAnBijB,IACChjB,EAAAA,EAAAA,GAAC6kB,EAAAA,mBAAkB,CAACriB,MAAM,OAAMzC,UAC9BC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,YAGrC5U,EAAAA,EAAAA,GAAC6kB,EAAAA,mBAAkB,CAACriB,MAAM,SAAQzC,UAChCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,cAEnC5U,EAAAA,EAAAA,GAAC6kB,EAAAA,mBAAkB,CAACriB,MAAM,UAASzC,UACjCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,eAInB5U,EAAAA,EAAAA,GAAC6kB,EAAAA,mBAAkB,CAACriB,MAAM,SAAQzC,UAChCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,iBAGrC5U,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAEoX,UAAWpY,EAAMqB,QAAQG,IAAI,IAAEM,KAAK,KAAKrG,MAAM,YAAWkF,UAChFC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,YAErB,SAAbiM,IACChhB,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACqC,EAAAA,EAAM2iB,SAAQ,CACb1iB,YAAY,iEACZE,MAAOuN,OAAOvN,GACdyiB,SAAU,CAAEC,QAAS,EAAGC,QAAS,GACjCL,UAAY7jB,GAAMA,EAAE8jB,kBACpBriB,SAAWzB,IACTkiB,EAASliB,EAAE0B,OAAOH,OAClB+gB,EAAc,KAAK,EAErB6B,gBAAiB9B,EAAa,aAAUnd,EACxC2K,SAAU4S,IAEXJ,IACCtjB,EAAAA,EAAAA,GAACqlB,EAAAA,OAAOC,QAAO,CACbzU,GAAG,+DACHmJ,QAASsJ,EACT9a,KAAK,aAKC,WAAbqY,IACC7gB,EAAAA,EAAAA,GAACqC,EAAAA,EAAK,CACJC,YAAY,4DACZE,MAAOuN,OAAOvN,GACdsiB,UAAY7jB,GAAMA,EAAE8jB,kBACpBriB,SAAWzB,IACTkiB,EAASliB,EAAE0B,OAAOH,OAClB+gB,EAAc,KAAK,EAErBzS,SAAU4S,EACVnhB,YAAU,IAGA,YAAbse,IACChhB,EAAAA,EAAAA,IAACye,EAAAA,sBAAqB,CACpBhc,YAAY,6DACZ3E,KAAK,6DACL6E,MAAOA,EACPsO,SAAU4S,EACVhhB,SAAWzB,IACTkiB,EAASliB,EAAE0B,OAAOH,OAClB+gB,EAAc,KAAK,EACnBxjB,SAAA,EAEFC,EAAAA,EAAAA,GAACwe,EAAAA,uBAAsB,CAAChc,OAAK,EAAAzC,SAAC,UAC9BC,EAAAA,EAAAA,GAACwe,EAAAA,uBAAsB,CAAChc,OAAO,EAAMzC,SAAC,aAG5B,WAAb8gB,IACC7gB,EAAAA,EAAAA,GAACqC,EAAAA,EAAK,CACJC,YAAY,4DACZE,MAAOuN,OAAOvN,GACdsiB,UAAY7jB,GAAMA,EAAE8jB,kBACpBriB,SAAWzB,IACTkiB,EAASliB,EAAE0B,OAAOH,MAAQ+iB,OAAOtkB,EAAE0B,OAAOH,OAAS,IACnD+gB,EAAc,KAAK,EAErB/a,KAAK,SACLsI,SAAU4S,EACVnhB,YAAU,KAGdvC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAEoX,UAAWpY,EAAMqB,QAAQG,IAAI,IAAEM,KAAK,KAAKrG,MAAM,YAAWkF,UAChFC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,iBAInB5U,EAAAA,EAAAA,GAACqC,EAAAA,EAAM2iB,SAAQ,CACb1iB,YAAY,yDACZE,MAAO4gB,EACP6B,SAAU,CAAEC,QAAS,EAAGC,QAAS,GACjCrU,SAAU4S,EACVoB,UAAY7jB,GAAMA,EAAE8jB,kBACpBriB,SAAWzB,GAAMoiB,EAAapiB,EAAE0B,OAAOH,UAEzC3C,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ8B,eAAgB,WAAYqV,UAAWpY,EAAMqB,QAAQG,IAAI,IAACb,SAAA,EACrFC,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLhB,YAAY,uDACZwO,SAAU4S,EACVjgB,QAASA,IAAM0P,GAAY,GAAOpT,UAElCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,cAInB5U,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLxD,KAAGM,EAAAA,EAAAA,IAAE,CAAEO,WAAYvB,EAAMqB,QAAQC,IAAI,IACrC8H,KAAK,UACLlG,YAAY,uDACZmB,QAAS2gB,EACToB,QAAS9B,EAAU3jB,UAEnBC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,kBAGjC,ECnTG6Q,GAAyBA,EACpC3Q,QACA4N,iBACAC,SACAC,cAOA,MAAO1P,EAAUC,IAAexU,EAAAA,EAAAA,WAAS,GAEzC,OACEkB,EAAAA,EAAAA,IAAA,OAAAE,SAAA,EACEC,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLpC,KAAK,QACLoB,YAAY,iDACZiB,MAAMvD,EAAAA,EAAAA,GAAC0lB,EAAAA,SAAQ,IACfjiB,QAASA,IAAM0P,GAAY,GAAMpT,SAEhC+U,IAEF5B,IACClT,EAAAA,EAAAA,GAACyiB,GAAoB,CACnBC,eAAgBA,EAChBC,OAAQA,EACRC,QAASA,EACTzP,YAAaA,MAGb,EC9BGwS,GAAgCA,EAC3CvD,aACAwD,eACAC,yBAMA,MAAM/E,EAAa,aAAcsB,EAC3B0D,GAAOpB,EAAAA,EAAAA,MAEPqB,GAAgBC,EAAAA,EAAAA,MAChBC,EACJH,IAAS1D,EAAWmC,OAAOE,WAAc3D,GAAgD,UAAlCsB,EAAWmC,OAAOC,YACrE0B,EAAiBH,GAAiBE,GAA2BL,EAEnE,OACE/lB,EAAAA,EAAAA,IAACuW,EAAAA,aAAaC,KAAI,CAAAtW,SAAA,EAChBC,EAAAA,EAAAA,GAACoW,EAAAA,aAAaE,QAAO,CAACC,SAAO,EAAAxW,UAC3BC,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CAAChB,YAAY,qDAAqDiB,MAAMvD,EAAAA,EAAAA,GAACmmB,EAAAA,aAAY,IAAKjlB,KAAK,aAExGrB,EAAAA,EAAAA,IAACuW,EAAAA,aAAaK,QAAO,CAACsH,SAAU,IAAIhe,SAAA,CACjCmmB,IACCrmB,EAAAA,EAAAA,IAACuW,EAAAA,aAAagQ,KAAI,CAChB9jB,YAAY,qDACZmB,QAASA,IAAkB,OAAZmiB,QAAY,IAAZA,OAAY,EAAZA,GAAe,GAAM7lB,SAAA,EAEpCC,EAAAA,EAAAA,GAACoW,EAAAA,aAAaiQ,YAAW,CAAAtmB,UACvBC,EAAAA,EAAAA,GAACsmB,EAAAA,WAAU,OAEbtmB,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,aAGrC/U,EAAAA,EAAAA,IAACuW,EAAAA,aAAagQ,KAAI,CAChB9jB,YAAY,uDACZmB,QAASA,IAAMoiB,GAAmB,GAAM9lB,SAAA,EAExCC,EAAAA,EAAAA,GAACoW,EAAAA,aAAaiQ,YAAW,CAAAtmB,UACvBC,EAAAA,EAAAA,GAACumB,EAAAA,UAAS,OAEZvmB,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,mBAGnB,ECxCX4R,GAAwBA,EACnCpE,aACAqE,iBACAC,wBAMA,MAAM7D,GAAOC,EAAAA,GAAAA,MACP,iBAAEP,GAAqBC,MAErBgB,OAAQmD,EAAwB,UAAEjD,IAAcC,EAAAA,GAAAA,GAAY,CAClEC,WAAYA,ILrBgBgD,GAAGhE,UAASiE,kBAC1CpF,GAAS,+BAA+BmB,iBAAuBiE,IAAgB,UKoB3DD,CAAiB,CAAEhE,QAASR,EAAWC,SAAUwE,aAAczE,EAAW0E,gBAC5FjD,UAAWA,KACO,OAAhBtB,QAAgB,IAAhBA,GAAAA,GAAoB,EAEtBuB,QAAUzI,KACR0I,EAAAA,EAAAA,IACElB,EAAKmB,cACH,CAAAnT,GAAA,SACE+D,eAAe,+CAGjB,CACEyG,MAAOA,aAAiB4I,MAAQ5I,EAAMrB,QAAUjK,OAAOsL,KAG5D,EAEH6I,UAAWA,KACTwC,GAAkB,EAAM,IAItBK,GAAexnB,EAAAA,EAAAA,cAAYmiB,gBACzBiF,GAA0B,GAC/B,CAACA,IAEJ,OACE3mB,EAAAA,EAAAA,GAACgnB,GAAAA,EAAK,CACJ1kB,YAAY,sDACZ2kB,QAASR,EACTS,KAAMH,EACNI,cAAe,CAAEC,QAAQ,EAAM5B,QAAS9B,GACxC2D,QAAQrnB,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,WACzC0S,SAAUA,KACRZ,GAAkB,EAAM,EAE1Ba,YAAYvnB,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,WAC7C4S,eAAgB9D,EAChB5O,OAAO9U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,sBAAoE7U,UAE5GC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,sDAGX,ECzDC6S,GAAsBA,EACjCrF,aACAG,mBACAsB,YACAC,UACAI,gBAQA,MAAMrB,GAAOC,EAAAA,GAAAA,MACLU,OAAQkE,EAAwB,UAAEhE,IAAcC,EAAAA,GAAAA,GAAY,CAClEC,WAAatC,GNGeqG,GAC9B/E,UACAiE,eACAvF,aAKIG,GAAS,+BAA+BmB,iBAAuBiE,IAAgB,QAASvF,GMVxFqG,CAAiB,CAAE/E,QAASR,EAAWC,SAAUwE,aAAczE,EAAW0E,cAAexF,YAC3FwC,QAAUzI,KACR0I,EAAAA,EAAAA,IACElB,EAAKmB,cACH,CAAAnT,GAAA,SACE+D,eAAe,+CAGjB,CACEyG,MAAOA,aAAiB4I,MAAQ5I,EAAMrB,QAAUjK,OAAOsL,MAItD,OAAPyI,QAAO,IAAPA,GAAAA,EAAUzI,EAAM,EAElBwI,UAAWA,KACO,OAAhBtB,QAAgB,IAAhBA,GAAAA,IACS,OAATsB,QAAS,IAATA,GAAAA,GAAa,EAEfK,UAAWA,KACA,OAATA,QAAS,IAATA,GAAAA,GAAa,IAIjB,MAAO,CACLwD,2BACAhE,YACD,ECsBUkE,GAAqBA,EAChCxF,aACAyB,YACAK,YACAoD,eAOA,MAAMxG,EAAa,aAAcsB,EAC3ByF,EAxBoBzF,IACtB,aAAcA,EACTA,EAAWrB,SAASve,MAGzB,UAAW4f,EAAWpB,YACjBoB,EAAWpB,YAAYxe,MAGzB4f,EAAWpB,YAAYC,iBAAiBze,MAe1BslB,CAAmB1F,GAClC2F,EA9DeC,EAACxlB,EAAYse,KAClC,GAAqB,kBAAVte,EAAoB,CAE7B,GAAc,KAAVA,EACF,MAAO,UAGT,GAAIse,EACF,MAAO,SAGT,IAEE,OADAlO,KAAKW,MAAM/Q,GACJ,MACT,CAAE,MAAOvB,GAEP,MAAO,QACT,CACF,CAEA,MAAqB,mBAAVuB,GAAwC,kBAAVA,SACzBA,EAET,SAAS,EAuCIwlB,CAAeH,EAAc/G,GAC3CmH,EArCiBzlB,IACF,kBAAVA,EAEFA,GAAS,KAEG,mBAAVA,GAAwC,kBAAVA,EAChCA,EAEF,KA6Bc0lB,CAAgBL,GAC/B/B,GAAOpB,EAAAA,EAAAA,OAEP,MAAEtlB,IAAUC,EAAAA,EAAAA,MACXwhB,EAAUqC,IAAevkB,EAAAA,EAAAA,UAAsCopB,IAC/DvlB,EAAO2gB,IAAYxkB,EAAAA,EAAAA,UAA2CspB,IAC9D7E,EAAWC,IAAgB1kB,EAAAA,EAAAA,UAASyjB,EAAWgB,YAC/CE,EAAYC,IAAiB5kB,EAAAA,EAAAA,UAAiC,OAC/D,iBAAE4jB,GAAqBC,MAEvB,yBAAEkF,EAA0BhE,UAAWyE,GAAeV,GAAoB,CAC9ErF,aACAG,mBACAsB,YACAK,eAGI,2BAAEkE,EAA4B1E,UAAW2E,GCjGZC,GACnC/F,mBACAsB,YACAC,UACAI,gBAOA,MAAMrB,GAAOC,EAAAA,GAAAA,MAELU,OAAQ4E,EAA0B,UAAE1E,IAAcC,EAAAA,GAAAA,GAAY,CACpEC,WAAYA,EACV2E,gBACA/lB,QACA4gB,gBAMA,MAAMoF,EAA4B,IAC7BD,KACA/lB,EACH4gB,YACAmB,OAAQ,CACNE,WAAWC,EAAAA,EAAAA,MACXF,YAAa,SAEfiE,UAAWF,EAAczB,eAErBxF,EAAmC,CACvCc,YAAYsG,EAAAA,EAAAA,MAAKF,EAAe,gBAAiB,cAAe,mBAAoB,0BAEtF,OAAOrG,GAAiB,CAAEb,WAAU,EAEtCwC,QAAUzI,KACR0I,EAAAA,EAAAA,IACElB,EAAKmB,cACH,CAAAnT,GAAA,SACE+D,eAAe,iDAGjB,CACEyG,MAAOA,aAAiB4I,MAAQ5I,EAAMrB,QAAUjK,OAAOsL,MAItD,OAAPyI,QAAO,IAAPA,GAAAA,EAAUzI,EAAM,EAElBwI,UAAWA,KACO,OAAhBtB,QAAgB,IAAhBA,GAAAA,IACS,OAATsB,QAAS,IAATA,GAAAA,GAAa,EAEfK,UAAWA,KACA,OAATA,QAAS,IAATA,GAAAA,GAAa,IAIjB,MAAO,CACLkE,6BACA1E,YACD,EDiCgE4E,CAAsB,CACrF/F,mBACAsB,YACAK,cAGIR,EAAYyE,GAAcE,EAE1BM,GAAeppB,EAAAA,EAAAA,cAAYmiB,UAC/B,GAAiB,SAAbb,EACF,IACEjO,KAAKW,MAAM/Q,EACb,CAAE,MAAOvB,GAOP,YANAsiB,GACEvjB,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,yCAKrB,CAGF,MAAMyP,EAAW1D,GAAgC,CAC/CC,UAAWpe,EACXqe,WACAC,eAMF,GAAIgF,IAAS1D,EAAWmC,OAAOE,WAAc3D,QAWrCsH,EAA2B,CAC/BG,cAAenG,EACf5f,MAAO6hB,KACHjB,EAAY,CAAEA,aAAc,CAAC,QAdoB,CACvD,MAAM9B,EAAmC,CACvCc,WAAY,IACPiC,EACHjB,aAEFwF,aAAgB9H,EAAa,WAAa,eAA7B,oBAGT4G,EAAyBpG,EACjC,CAMA,GACC,CAACT,EAAUre,EAAOse,EAAYgF,EAAM1D,EAAYgB,EAAWsE,EAA0BU,IAExF,OACEvoB,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfE,IAAKhD,EAAMqB,QAAQG,GACnB4W,UAAWpY,EAAMqB,QAAQC,GACzBkM,OAAQ,aAAaxN,EAAM0L,OAAO8B,SAClC9R,QAASsE,EAAMqB,QAAQC,GACvBxF,aAAckE,EAAM0N,QAAQoJ,gBAC7B,IAACnW,SAAA,EAEFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAEoX,UAAWpY,EAAMqB,QAAQG,IAAI,IAAEM,KAAK,KAAKrG,MAAM,YAAWkF,UAChFC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,iBAInB/U,EAAAA,EAAAA,IAAC+kB,EAAAA,aAAY,CACX/T,GAAG,+DACHvO,YAAY,+DACZE,MAAOqe,EACP/P,SAAU4S,EACVhhB,SAAWzB,IACTiiB,EAAYjiB,EAAE0B,OAAOH,OACrB+gB,EAAc,KAAK,EACnBxjB,SAAA,EAEA+gB,IACA9gB,EAAAA,EAAAA,GAAC6kB,EAAAA,mBAAkB,CAACriB,MAAM,OAAMzC,UAC9BC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,YAGrC5U,EAAAA,EAAAA,GAAC6kB,EAAAA,mBAAkB,CAACriB,MAAM,SAAQzC,UAChCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,cAEnC5U,EAAAA,EAAAA,GAAC6kB,EAAAA,mBAAkB,CAACriB,MAAM,UAASzC,UACjCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,eAInB5U,EAAAA,EAAAA,GAAC6kB,EAAAA,mBAAkB,CAACriB,MAAM,SAAQzC,UAChCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,iBAGrC5U,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAEoX,UAAWpY,EAAMqB,QAAQG,IAAI,IAAEM,KAAK,KAAKrG,MAAM,YAAWkF,UAChFC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,YAErB,SAAbiM,IACChhB,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACqC,EAAAA,EAAM2iB,SAAQ,CACb1iB,YAAY,iEACZE,MAAOuN,OAAOvN,GACdgJ,KAAM,EACNsZ,UAAY7jB,GAAMA,EAAE8jB,kBACpBriB,SAAWzB,IACTkiB,EAASliB,EAAE0B,OAAOH,OAClB+gB,EAAc,KAAK,EAErB6B,gBAAiB9B,EAAa,aAAUnd,EACxC2K,SAAU4S,IAEXJ,IACCtjB,EAAAA,EAAAA,GAACqlB,EAAAA,OAAOC,QAAO,CACbzU,GAAG,+DACHmJ,QAASsJ,EACT9a,KAAK,aAKC,WAAbqY,IACC7gB,EAAAA,EAAAA,GAACqC,EAAAA,EAAK,CACJC,YAAY,iEACZE,MAAOuN,OAAOvN,GACdsiB,UAAY7jB,GAAMA,EAAE8jB,kBACpBriB,SAAWzB,IACTkiB,EAASliB,EAAE0B,OAAOH,OAClB+gB,EAAc,KAAK,EAErBzS,SAAU4S,EACVnhB,YAAU,IAGA,YAAbse,IACChhB,EAAAA,EAAAA,IAACye,EAAAA,sBAAqB,CACpBhc,YAAY,kEACZ3E,KAAK,kEACL6E,MAAOA,EACPsO,SAAU4S,EACVhhB,SAAWzB,IACTkiB,EAASliB,EAAE0B,OAAOH,OAClB+gB,EAAc,KAAK,EACnBxjB,SAAA,EAEFC,EAAAA,EAAAA,GAACwe,EAAAA,uBAAsB,CAAChc,OAAK,EAAAzC,SAAC,UAC9BC,EAAAA,EAAAA,GAACwe,EAAAA,uBAAsB,CAAChc,OAAO,EAAMzC,SAAC,aAG5B,WAAb8gB,IACC7gB,EAAAA,EAAAA,GAACqC,EAAAA,EAAK,CACJC,YAAY,iEACZE,MAAOuN,OAAOvN,GACdsiB,UAAY7jB,GAAMA,EAAE8jB,kBACpBriB,SAAWzB,IACTkiB,EAASliB,EAAE0B,OAAOH,MAAQ+iB,OAAOtkB,EAAE0B,OAAOH,OAAS,IACnD+gB,EAAc,KAAK,EAErB/a,KAAK,SACLsI,SAAU4S,EACVnhB,YAAU,KAGdvC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAEoX,UAAWpY,EAAMqB,QAAQG,IAAI,IAAEM,KAAK,KAAKrG,MAAM,YAAWkF,UAChFC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,iBAInB5U,EAAAA,EAAAA,GAACqC,EAAAA,EAAM2iB,SAAQ,CACb1iB,YAAY,8DACZE,MAAO4gB,EACP6B,SAAU,CAAEC,QAAS,EAAGC,QAAS,GACjCrU,SAAU4S,EACVoB,UAAY7jB,GAAMA,EAAE8jB,kBACpBriB,SAAWzB,GAAMoiB,EAAapiB,EAAE0B,OAAOH,UAEzC3C,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ8B,eAAgB,WAAYqV,UAAWpY,EAAMqB,QAAQG,IAAI,IAACb,SAAA,EACrFC,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLhB,YAAY,4DACZwO,SAAU4S,EACVjgB,QAAS6jB,EAASvnB,UAElBC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,cAInB5U,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLxD,KAAGM,EAAAA,EAAAA,IAAE,CAAEO,WAAYvB,EAAMqB,QAAQC,IAAI,IACrC8H,KAAK,UACLlG,YAAY,0DACZmB,QAASklB,EACTnD,QAAS9B,EAAU3jB,UAEnBC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,gBAGjC,EEjTiF,IAAAlX,GAAA,CAAAC,KAAA,UAAAC,OAAA,oCAAAC,GAAA,CAAAF,KAAA,UAAAC,OAAA,6DAEpF,MAAMirB,GAA0BA,EAAGC,YAAWtmB,YACnD,MAAM,MAAEpD,IAAUC,EAAAA,EAAAA,KACZ0pB,GAAevV,EAAAA,EAAAA,UAAShR,GAASA,EAAQoQ,KAAKgF,UAAUpV,GAE9D,OACExC,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CAACC,QAASyO,EAAczmB,YAAY,gEAA+DvC,UACzGC,EAAAA,EAAAA,GAACwW,EAAAA,IAAG,CACF3b,MAAM,SACNyH,YAAY,yDACZxC,IAAGpC,GAA6CqC,UAEhDF,EAAAA,EAAAA,IAACqD,EAAAA,EAAWC,KAAI,CAACrD,IAAGjC,GAAyEkC,SAAA,CAC1F+oB,IACCjpB,EAAAA,EAAAA,IAACqD,EAAAA,EAAWC,KAAI,CAAC7F,MAAI,EAACwC,KAAGM,EAAAA,EAAAA,IAAE,CAAE4C,YAAa5D,EAAMqB,QAAQG,IAAI,IAACb,SAAA,CAC1D+oB,EAAU,OAGdC,QAGG,EChBDC,GAAyBA,EAAG/jB,WAA0C,IAADgkB,EAChF,MAAM,MAAE7pB,IAAUC,EAAAA,EAAAA,MACZ,gBAAE+G,EAAe,cAAEH,EAAa,yBAAEO,GAA6BI,IAC/DsiB,GAAeC,EAAAA,EAAAA,IAAsBlkB,GAAQ,EAEnD,OACEpF,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT4C,WAAY,SACZD,YAAa5D,EAAMqB,QAAQG,GAC3BwB,IAAKhD,EAAMqB,QAAQG,GACnB,UAAW,CACT7D,eAAgB,YAChBqsB,oBAAqBF,EACjB9pB,EAAM0L,OAAOue,+BACbjqB,EAAM0L,OAAOwe,yBACjBntB,OAAQ,YAEX,IACDsH,QAASA,KACP2C,EAAgBnB,GAChBgB,EAAc,UACdO,GAAyB,EAAM,EAC/BzG,SAAA,EAEFC,EAAAA,EAAAA,GAACyZ,GAAAA,EAAsB,CACrByP,aAAcA,EACd1gB,MAAM+gB,EAAAA,EAAAA,IAA4B,QAAVN,EAAChkB,EAAKuD,YAAI,IAAAygB,EAAAA,EAAIO,EAAAA,GAAcC,YAEtDzpB,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CACdtI,MAAOquB,EAAe,QAAU,UAChCppB,KAAGM,EAAAA,EAAAA,IAAE,CAAEO,WAAYvB,EAAMqB,QAAQG,GAAI5F,SAAU,SAAUyZ,aAAc,WAAYva,WAAY,UAAU,IAAC6F,SAEzGkF,EAAK6P,UAEJ,EC7BV,MAAM4U,GAAmBC,GACnBrK,MAAMC,QAAQoK,GACTA,EAAYlkB,KAAI,CAACmkB,EAAMvc,KAAUrN,EAAAA,EAAAA,GAAC6oB,GAAuB,CAACrmB,MAAOonB,GAAWvc,MAGjFwc,EAAAA,EAAAA,UAASF,GACJ/S,OAAOe,QAAQgS,GAAalkB,KAAI,EAAEd,EAAKnC,MAC5CxC,EAAAA,EAAAA,GAAC6oB,GAAuB,CAAWC,UAAWnkB,EAAKnC,MAAOA,GAA5BmC,MAI3B3E,EAAAA,EAAAA,GAAC6oB,GAAuB,CAACrmB,MAAOmnB,IACvC,IAAAjsB,GAAA,CAAAC,KAAA,SAAAC,OAAA,iEAAAC,GAAA,CAAAF,KAAA,UAAAC,OAAA,6DAEK,MAAMksB,GAAkBA,EAAG9I,kBAChC,MAAM,MAAE5hB,IAAUC,EAAAA,EAAAA,MACX0qB,EAAWnE,IAAgBjnB,EAAAA,EAAAA,WAAS,IACpCqrB,EAAiBnE,IAAsBlnB,EAAAA,EAAAA,WAAS,IACjD,QAAEoH,EAAO,WAAEC,GAAeY,IAE1BqjB,EAAiBjJ,EAAY2D,QAAU5e,EAAQib,EAAY2D,SAAW,KAGtEuF,EAAoC,YAAflkB,GAA4BikB,EAEjDN,EbkDkC3I,KACxC,GAAI,UAAWA,EACb,OAAOA,EAAYxe,MAGrB,IAKE,OAAOoQ,KAAKW,MAAMyN,EAAYC,iBAAiBze,MACjD,CAAE,MAAOvB,GACP,OAAO+f,EAAYC,iBAAiBze,KACtC,Ga/DoB2nB,CAA0BnJ,EAAYA,aAE1D,OACEnhB,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHtF,QAASsE,EAAMqB,QAAQC,GAAKtB,EAAMqB,QAAQG,GAC1Cma,WAAY3b,EAAMqB,QAAQC,GAC1BkM,OAAQ,aAAaxN,EAAM0L,OAAO8B,SAClC1R,aAAckE,EAAM0N,QAAQC,eAC5B1M,QAAS,OACT6B,cAAe,SACfE,IAAKhD,EAAMqB,QAAQC,IACpB,IAACX,SAAA,EAEFF,EAAAA,EAAAA,IAAA,OAAKC,IAAGpC,GAA6EqC,SAAA,EACnFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAC7F,MAAI,EAACwC,IAAGjC,GAAyEkC,SAC/FihB,EAAYsD,mBAEftkB,EAAAA,EAAAA,GAAC2lB,GAA6B,CAC5BvD,WAAYpB,EACZ4E,aAAcA,EACdC,mBAAoBA,KAEtB7lB,EAAAA,EAAAA,GAACwmB,GAAqB,CACpBpE,WAAYpB,EACZyF,eAAgBuD,EAChBtD,kBAAmBb,OAGtBkE,GACC/pB,EAAAA,EAAAA,GAAC4nB,GAAkB,CACjBxF,WAAYpB,EACZ6C,UAAWA,IAAM+B,GAAa,GAC9B0B,SAAUA,IAAM1B,GAAa,KAG/B8D,GAAgBC,GAEjBO,IACCrqB,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQG,IAAI,IAACb,SAAA,EAC5EC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACjC,KAAK,KAAKrG,MAAM,YAAWkF,UAC1CC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,YAEnC5U,EAAAA,EAAAA,GAACgpB,GAAsB,CAAC/jB,KAAMglB,SAG9B,ECzEV,IAAAvsB,GAAA,CAAAC,KAAA,UAAAC,OAAA,2DACO,MAAMwsB,GAAyBA,EAAGC,gBACvC,MAAM,MAAEjrB,IAAUC,EAAAA,EAAAA,KAGlB,IAAKgrB,GAA2B,OAAdA,EAChB,OAAO,KAGT,IAAIV,EACJ,IACEA,EAAc/W,KAAKW,MAAM8W,EAC3B,CAAE,MAAOppB,GAEP0oB,EAAcU,CAChB,CAEA,IAAIxvB,EAAmB,UACnBkF,EAA4B6S,KAAKgF,UAAU+R,EAAa,KAAM,GA8ClE,MA7CoB,QAAhBA,GACF9uB,EAAQ,OACRkF,GACEF,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACsqB,EAAAA,gBAAe,CAACxqB,KAAGM,EAAAA,EAAAA,IAAE,CAAE4C,YAAa5D,EAAMqB,QAAQG,IAAI,OACvDZ,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,YAGZ,OAAhB+U,GACT9uB,EAAQ,QACRkF,GACEF,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACwf,EAAAA,YAAW,CAAC1f,KAAGM,EAAAA,EAAAA,IAAE,CAAE4C,YAAa5D,EAAMqB,QAAQG,IAAI,OACnDZ,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,WAGL,kBAAhB+U,EAChB5pB,EAAW4pB,EACc,OAAhBA,GAET9uB,EAAQ,QACRkF,GACEF,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACuqB,EAAAA,EAAU,CAACzqB,KAAGM,EAAAA,EAAAA,IAAE,CAAE4C,YAAa5D,EAAMqB,QAAQG,IAAI,OAClDZ,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,eAGZ,IAAhB+U,GACT9uB,EAAQ,OACRkF,GACEF,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACsqB,EAAAA,gBAAe,CAACxqB,KAAGM,EAAAA,EAAAA,IAAE,CAAE4C,YAAa5D,EAAMqB,QAAQG,IAAI,OACvDZ,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,cAGZ,IAAhB+U,IACT9uB,EAAQ,QACRkF,GACEF,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACwf,EAAAA,YAAW,CAAC1f,KAAGM,EAAAA,EAAAA,IAAE,CAAE4C,YAAa5D,EAAMqB,QAAQG,IAAI,OACnDZ,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,eAMrC5U,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CAAC/X,YAAY,sDAAsDgY,QAASva,EAASA,UAC3FC,EAAAA,EAAAA,GAACwW,EAAAA,IAAG,CACF1W,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,cAAepB,SAAU,OAAQ8e,SAAU3e,EAAMqB,QAAQwM,GAAIjK,YAAa,GAAG,IAC7FV,YAAY,kDACZzH,MAAOA,EAAMkF,UAEbC,EAAAA,EAAAA,GAAA,QACEF,IAAGpC,GAIDqC,SAEDA,OAGG,EC1FDyqB,GAAuBA,EAAGjG,aACrC,MAAM,MAAEnlB,IAAUC,EAAAA,EAAAA,KAElB,OACEW,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CAAC/X,YAAY,qDAAqDgY,QAASiK,EAAOE,UAAU1kB,UAElGC,EAAAA,EAAAA,GAAA,QACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHma,WAAY,EACZvf,SAAU,SACVyZ,aAAc,WACdgW,SAAU,SACV9pB,WAAYvB,EAAMqB,QAAQC,GAC1Bqd,SAAU3e,EAAMqB,QAAQwM,IACzB,IAAClN,UAEFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAApD,UACdC,EAAAA,EAAAA,GAAA,QAAMF,KAAGM,EAAAA,EAAAA,IAAE,CAAEvF,MAAOuE,EAAM0L,OAAO4f,SAAS,IAAC3qB,SAAEwkB,EAAOE,iBAGhD,ECLZ,IAAA/mB,GAAA,CAAAC,KAAA,SAAAC,OAAA,sDAEK,MAAM+sB,GAAuBA,EAElCC,mBAAkB,EAClBxI,aACAwD,mBAMA,MAAM,MAAExmB,IAAUC,EAAAA,EAAAA,MACX2qB,EAAiBnE,IAAsBlnB,EAAAA,EAAAA,WAAS,GAEjDksB,EAxBetG,KACrB,OAAQA,EAAOC,aACb,IAAK,QACH,OAAOsG,EAAAA,SACT,IAAK,YACH,OAAOC,EAAAA,YACT,QACE,OAAOC,EAAAA,SACX,EAgBmBC,CAAc7I,EAAWmC,QAE5C,OACE1kB,EAAAA,EAAAA,IAAA,OAAKC,IAAGpC,GAAkEqC,SAAA,CACvE6qB,IACC5qB,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACV0qB,MAAO,EACP1d,IAAK,EACLxO,MAAO,GACPkO,OAAQ9N,EAAM6L,WAAWyJ,eACzBnE,UAAW,aACXwL,uBAAwB3c,EAAM0N,QAAQC,eACtC9P,aAAc,aAAamC,EAAM0L,OAAO8B,SACxCue,WAAY,aAAa/rB,EAAM0L,OAAO8B,UACvC,OAGL5M,EAAAA,EAAAA,GAAC6qB,EAAU,CACT3pB,KAAM9B,EAAM6L,WAAWC,WACvBpL,KAAGM,EAAAA,EAAAA,IAAE,CACHtF,QAAS,EACTgG,gBAAiB1B,EAAM0L,OAAOuO,0BAC9Bne,aAAckE,EAAM0N,QAAQse,kBAC7B,OAEHprB,EAAAA,EAAAA,GAACwqB,GAAoB,CAACjG,OAAQnC,EAAWmC,UACzC1kB,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHO,WAAY,OACZN,QAAS,OACT6B,cAAe,MACfe,WAAY,SACZb,IAAKhD,EAAMqB,QAAQG,IACpB,IAACb,SAAA,CAEDqiB,EAAWiJ,mBACVrrB,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CACdtI,MAAM,YACNqG,KAAK,KACLpB,KAAGM,EAAAA,EAAAA,IAAE,CACHO,WAAYvB,EAAMqB,QAAQC,GAC1B1F,SAAU,SACVyZ,aAAc,WACdgW,SAAU,UACX,IAAC1qB,SAEDmgB,GAAa,IAAIG,KAAK+B,EAAWiJ,sBAGtCrrB,EAAAA,EAAAA,GAAC2lB,GAA6B,CAC5BvD,WAAYA,EACZwD,aAAcA,EACdC,mBAAoBA,KAEtB7lB,EAAAA,EAAAA,GAACwmB,GAAqB,CACpBpE,WAAYA,EACZqE,eAAgBuD,EAChBtD,kBAAmBb,SAGnB,ECxFGyF,GAAoBA,EAAGjQ,YAClC,MAAM,MAAEjc,IAAUC,EAAAA,EAAAA,MACXonB,EAAgBC,IAAqB/nB,EAAAA,EAAAA,WAAS,GAErD,OACEkB,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQG,IAAI,IAACb,SAAA,EAC5EC,EAAAA,EAAAA,GAACurB,EAAAA,MAAK,CACJ/iB,KAAK,QACLgjB,UAAU,EACVxR,QAASqB,EAAMoQ,WACfnpB,YAAY,kDACZoV,aACE7X,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQG,IAAI,IAACb,SAAA,EAC5EC,EAAAA,EAAAA,GAAA,QAAAD,SAAOsb,EAAMqQ,gBACZrQ,EAAMsQ,cACL3rB,EAAAA,EAAAA,GAACkD,EAAAA,EAAW0N,KAAI,CACdtO,YAAY,mEACZmB,QAASA,IAAMijB,GAAkB,GAAM3mB,UAEvCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,4BAQ1ByG,EAAMsQ,cACL3rB,EAAAA,EAAAA,GAACgnB,GAAAA,EAAK,CACJlS,OACE9U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,sBAInBqS,QAASR,EACTnkB,YAAY,+DACZspB,OAAQ,KACRtE,SAAUA,IAAMZ,GAAkB,GAAO3mB,UAEzCC,EAAAA,EAAAA,GAAC4V,GAA6B,CAC5BxL,KAAMwI,KAAKgF,UAAUyD,EAAMsQ,aAC3B7W,MAAM,GACNS,kBAAmB5C,EAAAA,GAAsB+C,WAI3C,EChD8C,IAAAhY,GAAA,CAAAC,KAAA,SAAAC,OAAA,wDAKjD,MAAMiuB,GAAsBA,EAAG9K,eACpC,MAAM,MAAE3hB,IAAUC,EAAAA,EAAAA,KACZmD,EAAQue,EAASA,SAASve,MAEhC,OACE3C,EAAAA,EAAAA,IAAA,OACEC,IAAGpC,GAIDqC,SAAA,EAEFC,EAAAA,EAAAA,GAAC2qB,GAAoB,CAACC,iBAAiB,EAAOxI,WAAYrB,KAC1DlhB,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfE,IAAKhD,EAAMqB,QAAQG,GACnBD,WAAY,GACZwN,YAAa/O,EAAMqB,QAAQwM,GAC3B8N,WAAY3b,EAAMqB,QAAQC,GAC1B6T,cAAenV,EAAMqB,QAAQwM,GAC7BuH,aAAcpV,EAAMqB,QAAQqrB,GAC5BX,WAAY,aAAa/rB,EAAM0L,OAAO8B,UACvC,IAAC7M,SAAA,EAEAkJ,EAAAA,EAAAA,OAAM8X,EAASA,SAAS1F,QAGxBxb,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACjC,KAAK,KAAKrG,MAAM,YAAWkF,UAC1CC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,gBAEnC5U,EAAAA,EAAAA,GAAA,OAAAD,UACEC,EAAAA,EAAAA,GAACoqB,GAAsB,CAACC,UAAWzX,KAAKgF,UAAUpV,WAPtDxC,EAAAA,EAAAA,GAACsrB,GAAiB,CAACjQ,MAAO0F,EAASA,SAAS1F,QAW7C0F,EAASqC,YACRvjB,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACjC,KAAK,KAAKrG,MAAM,YAAYiF,KAAGM,EAAAA,EAAAA,IAAE,CAAEoX,UAAWpY,EAAMqB,QAAQG,IAAI,IAACb,UAChFC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,iBAInB5U,EAAAA,EAAAA,GAACyO,EAAqB,CAAA1O,SAAEghB,EAASqC,oBAInC,ECrCG2I,GAAuBA,EAClCtF,iBACAC,oBACA3F,eAMA,MAAMiL,GAAoB5kB,EAAAA,EAAAA,UAAQ,IAvBVgb,KACxB,MAAM6J,EAAO,IAAIziB,IACX0iB,EAAY,GAElB,IAAIC,EAA4C/J,EAChD,KAAO+J,IAAsBF,EAAKG,IAAID,EAAkBrF,gBACtDmF,EAAKtiB,IAAIwiB,EAAkBrF,eAC3BoF,EAAU/nB,KAAKgoB,GACfA,EAAoBA,EAAkBE,qBAGxC,OAAOH,CAAS,EAYwBI,CAAiBvL,IAAW,CAACA,IAErE,OACE/gB,EAAAA,EAAAA,GAACgnB,GAAAA,EAAK,CACJ1kB,YAAY,qDACZ2kB,QAASR,EACTmF,OAAQ,KACRtE,SAAUA,KACRZ,GAAkB,EAAM,EAE1B5R,OACE9U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,iBAGlB7U,SAEAisB,EAAkBvmB,KAAK2c,GACtB,aAAcA,GAAapiB,EAAAA,EAAAA,GAAC6rB,GAAmB,CAAgC9K,SAAUqB,GAApCA,EAAW0E,eAA0C,QAEtG,EC3C2E,IAAAppB,GAAA,CAAAC,KAAA,UAAAC,OAAA,sDAAAC,GAAA,CAAAF,KAAA,UAAAC,OAAA,0CAEhF,MAAM2uB,GAAsBA,EAAGxL,eACpC,MAAOyL,EAAuBC,IAA4B9tB,EAAAA,EAAAA,WAAS,IAC7D,MAAES,IAAUC,EAAAA,EAAAA,MACZ,QAAE0G,EAAO,WAAEC,GAAeY,IAE1BpE,EAAQue,EAASA,SAASve,MAE1BynB,EAAiBlJ,EAAS4D,QAAU5e,EAAQgb,EAAS4D,SAAW,KAGhEuF,EAAoC,YAAflkB,GAA4BikB,EAEvD,OACEpqB,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQC,GAAIC,WAAYvB,EAAMqB,QAAQqrB,IAAI,IAAC/rB,SAAA,GACxGkJ,EAAAA,EAAAA,OAAM8X,EAASA,SAAS1F,SAAUrb,EAAAA,EAAAA,GAACsrB,GAAiB,CAACjQ,MAAO0F,EAASA,SAAS1F,QAC/E6O,IACCrqB,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfE,IAAKhD,EAAMqB,QAAQG,IACpB,IAACb,SAAA,EAEFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACjC,KAAK,KAAKrG,MAAM,YAAWkF,UAC1CC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,YAEnC5U,EAAAA,EAAAA,GAACgpB,GAAsB,CAAC/jB,KAAMglB,QAGjChhB,EAAAA,EAAAA,OAAM8X,EAASA,SAAS1F,SACvBxb,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQG,IAAI,IAACb,SAAA,EAC5EC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACjC,KAAK,KAAKrG,MAAM,YAAWkF,UAC1CC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,gBAEnC/U,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ+B,IAAKhD,EAAMqB,QAAQG,IAAI,IAACb,SAAA,EACnDC,EAAAA,EAAAA,GAACoqB,GAAsB,CAACC,UAAWzX,KAAKgF,UAAUpV,KACjDue,EAASsL,uBACRxsB,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAAA,QAAMyD,QAASA,IAAMgpB,GAAyB,GAAM1sB,UAClDC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CACdrD,IAAGpC,GAMH7C,MAAM,YAAWkF,UAEjBC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,kBAKrB5U,EAAAA,EAAAA,GAAC+rB,GAAoB,CACnBtF,eAAgB+F,EAChB9F,kBAAmB+F,EACnB1L,SAAUA,aAOrBA,EAASqC,YACRvjB,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQG,IAAI,IAACb,SAAA,EAC5EC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACjC,KAAK,KAAKrG,MAAM,YAAWkF,UAC1CC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,iBAInB5U,EAAAA,EAAAA,GAAA,OAAKF,IAAGjC,GAAkDkC,UACxDC,EAAAA,EAAAA,GAACyO,EAAqB,CAAA1O,SAAEghB,EAASqC,mBAInC,EClFGsJ,GAAeA,EAAG3L,eAC7B,MAAM,MAAE3hB,IAAUC,EAAAA,EAAAA,MACX0qB,EAAWnE,IAAgBjnB,EAAAA,EAAAA,WAAS,GAE3C,OACEkB,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfE,IAAKhD,EAAMqB,QAAQG,GACnBuN,YAAa/O,EAAMqB,QAAQqrB,GAAK,EAChCnrB,WAAYvB,EAAMqB,QAAQqrB,GAAK,EAC/B/Q,WAAY3b,EAAMqB,QAAQC,GAC1B6T,cAAenV,EAAMqB,QAAQC,GAC7ByqB,WAAY,aAAa/rB,EAAM0L,OAAO8B,SACtCpM,SAAU,YACX,IAACT,SAAA,EAEFC,EAAAA,EAAAA,GAAC2qB,GAAoB,CAACvI,WAAYrB,EAAU6E,aAAcA,IACzDmE,GACC/pB,EAAAA,EAAAA,GAAC4nB,GAAkB,CACjBxF,WAAYrB,EACZ8C,UAAWA,IAAM+B,GAAa,GAC9B0B,SAAUA,IAAM1B,GAAa,MAG/B5lB,EAAAA,EAAAA,GAACusB,GAAmB,CAACxL,SAAUA,MAE7B,EC/BV,MAAM4L,GAAqBC,IACzB,MAAMC,EAAkB,CACtB,UAAW,CACT7tB,MAAO,GACPkO,OAAQ,KAGZ,OAAQ0f,GACN,IAAK,QACH,OAAO5sB,EAAAA,EAAAA,GAAC8qB,EAAAA,SAAQ,CAAChrB,IAAK+sB,IACxB,IAAK,YACH,OAAO7sB,EAAAA,EAAAA,GAAC+qB,EAAAA,YAAW,CAACjrB,IAAK+sB,IAC3B,IAAK,OACH,OAAO7sB,EAAAA,EAAAA,GAACgrB,EAAAA,SAAQ,CAAClrB,IAAK+sB,IACxB,QACE,OAAO,KACX,EACA,IAAAnvB,GAAA,CAAAC,KAAA,SAAAC,OAAA,YAEK,MAAMkvB,GAAiCA,EAAGC,gBAC/C,MAAM,MAAE3tB,IAAUC,EAAAA,EAAAA,KAElB,GAAI0tB,EAAUxnB,OAAS,EACrB,OAAO,KAGT,MAAMynB,GAAeC,EAAAA,EAAAA,SAAQF,GAAYhM,GAAaA,EAASwD,OAAOC,cACtE,OACExkB,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ+B,IAAKhD,EAAMqB,QAAQG,GAAIqC,WAAY,SAAUtC,WAAYvB,EAAMqB,QAAQG,IAAI,IAACb,SACtG6W,OAAOe,QAAQqV,GAAcvnB,KAAI,EAAEmnB,EAAYhN,MAC9C5f,EAAAA,EAAAA,GAACwW,EAAAA,IAAG,CACFlU,YAAa,qDAAqDsqB,IAClE9sB,IAAGpC,GAEDqC,UAGFF,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ4C,WAAY,SAAUb,IAAKhD,EAAMqB,QAAQG,IAAI,IAACb,SAAA,CACxE4sB,GAAkBC,IACnB5sB,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAApD,SAAE6f,QAJfgN,MAQL,EC3CwE,IAAAlvB,GAAA,CAAAC,KAAA,UAAAC,OAAA,sCAAAC,GAAA,CAAAF,KAAA,SAAAC,OAAA,iBAAAE,GAAA,CAAAH,KAAA,UAAAC,OAAA,sCAG3E,MAAMsvB,GAAqBA,EAChC7C,YACA0C,gBAKA,MAAM,MAAE3tB,IAAUC,EAAAA,EAAAA,MACX6T,EAAUC,IAAexU,EAAAA,EAAAA,WAAS,GAEzC,OACEkB,EAAAA,EAAAA,IAAA,OAAKC,IAAGpC,GAA+CqC,SAAA,EACrDF,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ+B,IAAKhD,EAAMqB,QAAQG,GAAIqC,WAAY,UAAU,IAAClD,SAAA,EACzEC,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLhB,YAAY,yDACZxC,IAAGjC,GACHqD,KAAK,QACLqC,KAAM2P,GAAWlT,EAAAA,EAAAA,GAAC0D,EAAAA,gBAAe,KAAM1D,EAAAA,EAAAA,GAACuZ,EAAAA,EAAgB,IACxD9V,QAASA,IAAM0P,GAAaD,MAE9BlT,EAAAA,EAAAA,GAACoqB,GAAsB,CAACC,UAAWA,KACnCrqB,EAAAA,EAAAA,GAAC8sB,GAA8B,CAACC,UAAWA,OAE5C7Z,IACClT,EAAAA,EAAAA,GAAA,OACEF,IAAGhC,GAGDiC,SAEDgtB,EAAUtnB,KAAKsb,IAEM,KAAZ,OAARA,QAAQ,IAARA,OAAQ,EAARA,EAAUoM,OAAkB,MAAOntB,EAAAA,EAAAA,GAAC0sB,GAAY,CAAC3L,SAAUA,GAAeA,EAAS+F,qBAIrF,ECtCgD,IAAAppB,GAAA,CAAAC,KAAA,UAAAC,OAAA,2DAAAC,GAAA,CAAAF,KAAA,SAAAC,OAAA,iBAGnD,MAAMwvB,GAAgBA,EAC3BzvB,OACA0vB,YACAzK,UACA0K,mBAOA,MAAM,MAAEluB,IAAUC,EAAAA,EAAAA,KACZkuB,ExBLiC5vB,KACvC,MAAM+V,EAAQ/V,EAAK+V,MAAM,KACzB,OAAqB,IAAjBA,EAAMnO,OACD5H,EACmB,IAAjB+V,EAAMnO,OACRmO,EAAM,GAERA,EAAM5H,MAAM,GAAG8H,KAAK,IAAI,EwBFX4Z,CAAyB7vB,IACtC8vB,EAAgBC,IAAqB/uB,EAAAA,EAAAA,WAAS,GAC/CgvB,EAAW/W,OAAOC,OAAOwW,GAC5BO,OACAhgB,MAAMmT,KAAc9X,EAAAA,EAAAA,OAAM8X,EAASA,SAAS1F,SAE/C,OACExb,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACf8K,aAAc5N,EAAMqB,QAAQC,GAC5BkM,OAAQ,aAAaxN,EAAM0L,OAAO8B,SAClC1R,aAAckE,EAAM0N,QAAQC,eAC5BjS,QAASsE,EAAMqB,QAAQC,GAAKtB,EAAMqB,QAAQG,GAC1Cma,WAAY3b,EAAMqB,QAAQC,GAC1B0B,IAAKhD,EAAMqB,QAAQC,IACpB,IAACX,SAAA,EAEFF,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfe,WAAY,SACZd,eAAgB,gBAChBC,IAAKhD,EAAMqB,QAAQC,IACpB,IAACX,SAAA,EAEFF,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ4C,WAAY,SAAUb,IAAKhD,EAAMqB,QAAQC,GAAIJ,KAAM,EAAGyd,SAAU,GAAG,IAAChe,SAAA,EAC/FC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAC7F,MAAI,EAACwC,IAAGpC,GAAuEqC,SAC7FwtB,IAEFI,IAAY3tB,EAAAA,EAAAA,GAACuqB,EAAAA,EAAU,CAACzqB,IAAGjC,GAAqBhD,MAAM,eAEzDmF,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CAACC,QAAQ,mBAAmBhY,YAAY,4DAA2DvC,UACzGC,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLhB,YAAY,2CACZxC,KAAGM,EAAAA,EAAAA,IAAE,CAAEma,WAAY,EAAGvX,aAAc5D,EAAMqB,QAAQG,IAAI,IACtDM,KAAK,QACLqC,MAAMvD,EAAAA,EAAAA,GAAC0lB,EAAAA,SAAQ,IACfjiB,QAASA,IAAMiqB,GAAkB,UAItC9W,OAAOe,QAAQ0V,GAAW5nB,KAAI,EAAE4kB,EAAW0C,MAC1C/sB,EAAAA,EAAAA,GAACktB,GAAkB,CAAC7C,UAAWA,EAAW0C,UAAWA,GAAgB1C,KAEtEoD,IACCztB,EAAAA,EAAAA,GAACyiB,GAAoB,CACnBC,eAAgB/kB,EAChBglB,OAAQ2K,EACR1K,QAASA,EACTzP,YAAaua,MAGb,ECjCR,IAAAhwB,GAAA,CAAAC,KAAA,SAAAC,OAAA,iEAEK,MAAMiwB,GAAkBA,EAC7BnmB,cACAkb,UACA0K,mBAMA,MAAM,MAAEluB,IAAUC,EAAAA,EAAAA,MACZ,2BAAEqH,GAA+BE,KAChCmmB,EAAWe,IAAgB1mB,EAAAA,EAAAA,UAChC,KAAM2mB,EAAAA,EAAAA,WAAUrmB,GAAc0a,GAAe,aAAcA,KAC3D,CAAC1a,IAEGsmB,GAAmB5mB,EAAAA,EAAAA,UAAQ,IA5CX2lB,KACtB,MAAMkB,EAAsD,CAAC,EAyB7D,OAxBAlB,EAAU3oB,SAAS2c,IACjB,IAAuB,IAAnBA,EAASoM,MACX,OAGF,IAAI3qB,EAAQ,KACoB,KAA5Bue,EAASA,SAASve,QACpBA,EAAQoQ,KAAKgF,UAAUmJ,EAASA,SAASve,QAG3C,MAAM,gBAAE8hB,GAAoBvD,EACvBkN,EAAW3J,KACd2J,EAAW3J,GAAmB,CAAC,GAGjC,MAAM4J,EAAQD,EAAW3J,IACpBrb,EAAAA,EAAAA,OAAMzG,KACJ0rB,EAAM1rB,KACT0rB,EAAM1rB,GAAS,IAEjB0rB,EAAM1rB,GAAO2B,KAAK4c,GACpB,IAGKnK,OAAOe,QAAQsW,GAAYE,UAAS,EAAEC,IAAYC,KAAeD,EAASE,cAAcD,IAAW,EAkBnEE,CAAexB,IAAY,CAACA,IAC7DyB,EAAqBV,EAAaK,UAAS,CAACjD,EAAM/W,IACtD+W,EAAK5G,gBAAgBgK,cAAcna,EAAMmQ,mBAG3C,OACEzkB,EAAAA,EAAAA,IAAA,OACE,cAAY,mBACZC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfpH,QAASsE,EAAMqB,QAAQC,GACvBqa,WAAY3b,EAAMqB,QAAQG,GAC1BsM,OAAQ,OACRie,WAAY,aAAa/rB,EAAM0L,OAAO8B,SACtCwP,UAAW,SACX2B,SAAUkC,GACVjhB,MAAO,OACPuR,UAAW,cACZ,IAACxQ,SAAA,EAEFF,EAAAA,EAAAA,IAAA,OAAKC,IAAGpC,GAA6EqC,SAAA,EACnFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAE4M,aAAc5N,EAAMqB,QAAQC,IAAI,IAAEpD,MAAI,EAAAyC,UAC5DC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,kBAElClO,IACC1G,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CACN/X,YAAY,6DACZgY,SACEta,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,qBAGlB7U,UAEDC,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACL,cAAY,gCACZhB,YAAY,qDACZpB,KAAK,QACLqC,MAAMvD,EAAAA,EAAAA,GAACyuB,EAAAA,EAAS,IAChBhrB,QAASA,IAAMiD,GAA2B,UAKjDsnB,EAAiBvoB,KAAI,EAAE9H,EAAM0vB,MAC5BrtB,EAAAA,EAAAA,GAACotB,GAAa,CAAYzvB,KAAMA,EAAM0vB,UAAWA,EAAWzK,QAASA,EAAS0K,aAAcA,GAAxE3vB,KAErB6wB,EAAmBjpB,OAAS,IAC3B1F,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACtI,MAAM,YAAYiF,KAAGM,EAAAA,EAAAA,IAAE,CAAE4M,aAAc5N,EAAMqB,QAAQC,IAAI,IAACX,UACzEC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,oBAInB5U,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQC,GAAIsM,aAAc5N,EAAMqB,QAAQC,IAAI,IAACX,SAExGyuB,EAAmB/oB,KAAKub,IACvBhhB,EAAAA,EAAAA,GAAC8pB,GAAe,CAAC9I,YAAaA,GAAkBA,EAAY8F,uBAKpE9mB,EAAAA,EAAAA,GAACylB,GAAsB,CAAC3Q,MAAM,qBAAqB6N,OAAQ2K,EAAc1K,QAASA,MAC9E,ECtGV,SAAS8L,IAAoC,WAC3CvX,EAAU,aACV1V,EAAY,YACZ4I,EAAW,UACXhE,EAAS,aACTC,IAQA,MAAM,MAAElH,IAAUC,EAAAA,EAAAA,MACXpB,EAAWC,IAAgBS,EAAAA,EAAAA,UAAS,KACrCgwB,EAAqC,CAAEruB,KAAM,EAAGkX,WAAYpY,EAAMqB,QAAQwM,GAAImP,UAAW,SACzF,wBAAE3V,EAAuB,uBAAEE,GAA2BC,IAE5D,IAAIqC,EAAAA,EAAAA,OAAMkO,GACR,OAAOnX,EAAAA,EAAAA,GAACyX,EAAAA,MAAK,CAACC,YAAY,kDAG5B,MAAMkX,GAAiBzF,EAAAA,EAAAA,IAAsBhS,GACvC+R,EAAe0F,EAAiB,EAChCC,GACJhvB,EAAAA,EAAAA,IAACivB,EAAAA,KAAKzY,KAAI,CACR/T,YAAY,8CACZxC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACf5B,KAAM,EACN6qB,WAAY,aAAa/rB,EAAM0L,OAAO8B,SACtCmR,SAAU,IACVvd,SAAU,YACX,IACDgC,MAAO6D,EACPsQ,cAAgBoY,GAAgBzoB,EAAayoB,GAA8BhvB,SAAA,EAE3EC,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACV2T,MAAO1N,EAA0BrH,EAAMqB,QAAQG,GAAKxB,EAAMqB,QAAQwM,GAClEO,IAAKpO,EAAMqB,QAAQG,IACpB,IAACb,UAEFC,EAAAA,EAAAA,GAAC+f,GAAoB,OAEvBlgB,EAAAA,EAAAA,IAACivB,EAAAA,KAAKE,KAAI,CACRlvB,KAAGM,EAAAA,EAAAA,IAAE,CACHtF,QAAS,EACTqT,YAAa/O,EAAMqB,QAAQwM,GAC3BuH,aAAcpV,EAAMqB,QAAQC,GAC5B6P,UAAW,aACXvR,MAAO,QACR,IAACe,SAAA,CAEDoX,EAAWxP,eACV3H,EAAAA,EAAAA,GAAC8uB,EAAAA,KAAKxY,QAAO,CAAC9T,MAAM,OAAMzC,UACxBC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,YAGrC5U,EAAAA,EAAAA,GAAC8uB,EAAAA,KAAKxY,QAAO,CAAC9T,MAAM,UAASzC,UAC3BC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,wBAMnB5U,EAAAA,EAAAA,GAAC8uB,EAAAA,KAAKxY,QAAO,CAAC9T,MAAM,aAAYzC,SAAC,gBACjCF,EAAAA,EAAAA,IAACivB,EAAAA,KAAKxY,QAAO,CAAC9T,MAAM,SAAQzC,SAAA,CAAC,UACnBmpB,IAAgBlpB,EAAAA,EAAAA,GAAC2f,GAAuB,CAACC,MAAOgP,UAG3DzX,EAAWxP,eACV3H,EAAAA,EAAAA,GAAC8uB,EAAAA,KAAKrY,QAAO,CAAC3W,IAAK6uB,EAAcnsB,MAAM,OAAMzC,UAC3CC,EAAAA,EAAAA,GAACkc,GAAyB,CAACvU,aAAcwP,EAAWxP,aAAcwU,UAAWhF,EAAWgF,eAG5Fnc,EAAAA,EAAAA,GAAC8uB,EAAAA,KAAKrY,QAAO,CAAC3W,IAAK6uB,EAAcnsB,MAAM,UAASzC,UAC9CC,EAAAA,EAAAA,GAACkf,GAA4B,CAAC/H,WAAYA,EAAY1V,aAAcA,EAAc4I,YAAaA,OAEjGrK,EAAAA,EAAAA,GAAC8uB,EAAAA,KAAKrY,QAAO,CAAC3W,IAAK6uB,EAAcnsB,MAAM,aAAYzC,UACjDC,EAAAA,EAAAA,GAACkX,GAA+B,CAC9BC,WAAYA,EACZ1V,aAAcA,EACd4I,YAAaA,OAGjBrK,EAAAA,EAAAA,GAAC8uB,EAAAA,KAAKrY,QAAO,CAAC3W,IAAK6uB,EAAcnsB,MAAM,SAAQzC,UAC7CC,EAAAA,EAAAA,GAACof,GAA2B,CAACjI,WAAYA,EAAY1V,aAAcA,EAAc4I,YAAaA,SAKpG,OAAO1D,GAA0BF,GAC/BzG,EAAAA,EAAAA,GAACivB,EAA+B,CAC9BjxB,aAnGsB,GAoGtBC,UAAWA,EACXC,aAAcA,EACdC,UAAW0wB,EACXzwB,aA1GgC,IA2GhCC,YACE2B,EAAAA,EAAAA,GAAC6tB,GAAe,CACdnmB,YAAayP,EAAWzP,YACxBkb,QAASzL,EAAWyL,QACpB0K,aAAcnW,EAAWzN,SAAWqG,OAAOoH,EAAWxS,UAAOwB,IAGjE7H,cAAe2hB,KAGjB4O,CAEJ,CAEO,MAAMK,GAAkCtjB,EAAAA,KAAW8iB,IC9H7CS,GAA2BA,EACtC/mB,kBACAC,yBAKA,MAAM,MAAEjJ,IAAUC,EAAAA,EAAAA,KAElB,OACEQ,EAAAA,EAAAA,IAACuvB,EAAAA,GAAQ/Y,KAAI,CAAC/T,YAAY,2DAA0DvC,SAAA,EAClFC,EAAAA,EAAAA,GAACovB,EAAAA,GAAQ9Y,QAAO,CAACC,SAAO,EAAAxW,UACtBC,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLhB,YAAY,0DACZiB,MAAMvD,EAAAA,EAAAA,GAACqvB,EAAAA,WAAU,IACjBnuB,KAAK,QAAOnB,UAEZC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,gBAGrC5U,EAAAA,EAAAA,GAACovB,EAAAA,GAAQ3Y,QAAO,CAAC6Y,MAAM,QAAOvvB,UAC5BF,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQC,GAAI6T,cAAenV,EAAMqB,QAAQG,IAAI,IAACb,SAAA,EAC7GC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAC7F,MAAI,EAAAyC,UACnBC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,cAInB5U,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACtI,MAAM,YAAWkF,UAChCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,gBAIlBgC,OAAOe,QAAQvP,EAAgBE,sBAAsB7C,KAAI,EAAEgD,EAAU8mB,MACpE,MAAMhsB,GAAOvD,EAAAA,EAAAA,GAACyZ,GAAAA,EAAsB,CAACjR,MAAM+gB,EAAAA,EAAAA,IAAmB9gB,KAC9D,OACE5I,EAAAA,EAAAA,IAAC2vB,EAAAA,SAAQ,CAEPltB,YAAa,kDAAkDmG,MAAa8mB,IAC5ExhB,MAAO,CAAE/O,MAAO,QAChBywB,UAAWF,EACX7sB,SAAUA,IACR2F,EAAmB,IACdD,EACHE,qBAAsB,IACjBF,EAAgBE,qBACnB,CAACG,IAAY8mB,KAGlBxvB,SAAA,CAEAwD,GACDvD,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAEO,WAAYvB,EAAMqB,QAAQG,IAAI,IAACb,UACpD2vB,EAAAA,EAAAA,IAA0BjnB,OAhBxBA,EAkBI,KAGfzI,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACtI,MAAM,YAAWkF,UAChCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,gBAInB/U,EAAAA,EAAAA,IAAC2vB,EAAAA,SAAQ,CACPltB,YAAa,oDAAoD8F,EAAgBM,cACjFqF,MAAO,CAAE/O,MAAO,QAChBywB,UAAWrnB,EAAgBM,YAC3BhG,SAAUA,IACR2F,EAAmB,IACdD,EACHM,aAAcN,EAAgBM,cAEjC3I,SAAA,EAEDC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAE4C,YAAa5D,EAAMqB,QAAQG,IAAI,IAACb,UACtDC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,6BAInB5U,EAAAA,EAAAA,GAAC2vB,EAAAA,YAAW,CACVrtB,YAAY,mDACZgY,SACEta,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,gFAMvB/U,EAAAA,EAAAA,IAAC2vB,EAAAA,SAAQ,CACPltB,YAAa,oDAAoD8F,EAAgBO,iBACjFoF,MAAO,CAAE/O,MAAO,QAChBywB,UAAWrnB,EAAgBO,eAC3BjG,SAAUA,IACR2F,EAAmB,IACdD,EACHO,gBAAiBP,EAAgBO,iBAEpC5I,SAAA,EAEDC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAE4C,YAAa5D,EAAMqB,QAAQG,IAAI,IAACb,UACtDC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,uBAInB5U,EAAAA,EAAAA,GAAC2vB,EAAAA,YAAW,CACVrtB,YAAY,sDACZgY,SACEta,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,mFAQd,EC1HNgb,GAAqBA,EAChCC,mBACAC,sBACA1nB,kBACAC,yBAOA,MAAM,MAAEjJ,IAAUC,EAAAA,EAAAA,KAElB,OACEQ,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHtF,QAAS,GAAGsE,EAAMqB,QAAQG,QAAQxB,EAAMqB,QAAQC,OAChD6T,cAAe,EACftX,aAAc,aAAamC,EAAM0L,OAAO8B,SACxC2D,UAAW,aACXpC,YAAa/O,EAAMqB,QAAQC,GAC3BuC,WAAY,SACZ5C,QAAS,OACT8B,eAAgB,iBACjB,IAACpC,SAAA,EAEFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAC7F,MAAI,EAAAyC,UACnBC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,uBAInB/U,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,MAAOE,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAAA,EACzEC,EAAAA,EAAAA,GAACmvB,GAAwB,CAAC/mB,gBAAiBA,EAAiBC,mBAAoBA,KAChFxI,EAAAA,EAAAA,IAACye,EAAAA,sBAAqB,CACpB3gB,KAAK,aACL6E,MAAOqtB,EACPntB,SAAW6b,IACTuR,EAAoBvR,EAAM5b,OAAOH,MAAM,EAEzCtB,KAAK,QACLoB,YAAY,mDAAkDvC,SAAA,EAE9DC,EAAAA,EAAAA,GAACwe,EAAAA,uBAAsB,CACrB,cAAY,4BACZjb,MACEvD,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CACN/X,YAAY,yDACZgY,SACEta,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,mBAGlB7U,UAEDC,EAAAA,EAAAA,GAAC+vB,EAAAA,eAAc,MAGnBvtB,OAAO,KAETxC,EAAAA,EAAAA,GAACwe,EAAAA,uBAAsB,CACrB,cAAY,4BACZjb,MACEvD,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CACN/X,YAAY,yDACZgY,SACEta,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,4BAGlB7U,UAEDC,EAAAA,EAAAA,GAACgwB,EAAAA,0BAAyB,MAG9BxtB,OAAK,YAIP,ECxFJytB,GAAsBA,EAAGC,aAC7B,MAAM,MAAE9wB,IAAUC,EAAAA,EAAAA,KACZwN,EAAcqjB,EAAS9wB,EAAM0L,OAAO4f,QAAUtrB,EAAM0L,OAAO8B,OAEjE,OACE5M,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACV0qB,KAAM,OACNiF,OAAQ,EAIRnxB,MAAOoxB,EACPljB,OAAQ9N,EAAMqB,QAAQwM,GACtBsD,UAAW,aACX+H,qBAAsBlZ,EAAM0N,QAAQC,eACpCkP,UAAW,aAAapP,IACxBwjB,YAAa,aAAaxjB,IAC1B9L,OAAQ6C,GACT,KACD,EAIA0sB,GAAoBA,EAAGJ,aAC3B,MAAM,MAAE9wB,IAAUC,EAAAA,EAAAA,KACZwN,EAAcqjB,EAAS9wB,EAAM0L,OAAO4f,QAAUtrB,EAAM0L,OAAO8B,OAEjE,OACE5M,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACV0qB,KAAM,MACN1d,IAAK,EACLxO,MAAOoxB,EACPljB,OAAQ9N,EAAMqB,QAAQwM,GACtBsD,UAAW,aACXwL,uBAAwB3c,EAAM0N,QAAQC,eACtC9P,aAAc,aAAa4P,IAC3Bse,WAAY,aAAate,IACzB9L,OAAQmvB,EAAStsB,EAA4BA,GAC9C,KACD,EAIA2sB,GAAoBA,EAAGL,aAC3B,MAAM,MAAE9wB,IAAUC,EAAAA,EAAAA,KACZwN,EAAcqjB,EAAS9wB,EAAM0L,OAAO4f,QAAUtrB,EAAM0L,OAAO8B,OAEjE,OACE5M,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACVxB,MAAOoxB,EACPlF,KAAM,MACNhe,O5DrDuB,G4DsDvBie,WAAY,aAAate,IACzB0D,UAAW,aACXxP,OAAQmvB,EAAStsB,EAA4BA,GAC9C,KACD,EAQO4sB,GAA4BA,EACvCC,eACAC,kBACAC,gBACAC,cACAC,gBAW6B,IAAzBF,EAAcprB,QAEdvF,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHpB,MAAO,EACPkO,O5DvFqB,G4DwFrBqD,UAAW,aACX/P,SAAU,YACX,IAACT,SAED6wB,IAAe5wB,EAAAA,EAAAA,GAACiwB,GAAmB,CAACC,OAAQQ,IAAoBD,OAMrEzwB,EAAAA,EAAAA,GAAA+Q,EAAAA,GAAA,CAAAhR,SACG4wB,EAAclrB,KAAI,EAAGqrB,eAAcC,YAAY/R,KAI9Cnf,EAAAA,EAAAA,IAAA,OAEEC,KAAGM,EAAAA,EAAAA,IAAE,CACHpB,M5D3GqB,G4D4GrBkO,O5D3GmB,G4D4GnBqD,UAAW,aACX/P,SAAU,YACX,IAACT,SAAA,CAED+wB,IAEC9wB,EAAAA,EAAAA,GAACuwB,GAAiB,CAACL,OAAQa,IAE5B/R,IAAQ2R,EAAcprB,OAAS,IAG9B1F,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACswB,GAAiB,CAACJ,OAAQQ,IAC1BE,GAAeC,IAAc7wB,EAAAA,EAAAA,GAACiwB,GAAmB,CAACC,OAAQQ,IAAoBD,SAjB9EzR,OCxGoD,IAAAthB,GAAA,CAAAC,KAAA,UAAAC,OAAA,sCAE5D,MAAMozB,GAA0BA,EACrC3nB,OACAtJ,eAIK,IAADkxB,EACJ,MAAM,MAAE7xB,IAAUC,EAAAA,EAAAA,KACZ6xB,GAAW3H,EAAAA,EAAAA,IAA4B,QAAV0H,EAAC5nB,EAAKb,YAAI,IAAAyoB,EAAAA,EAAIzH,EAAAA,GAAcC,SACzD0H,EAAmB/xB,EAAMiR,WAAajR,EAAM0L,OAAOsmB,QAAUhyB,EAAM0L,OAAOumB,QAC1EC,EAAqBlyB,EAAMiR,WAAajR,EAAM0L,OAAOymB,QAAUnyB,EAAM0L,OAAO0mB,QAElF,OACExxB,EAAAA,EAAAA,GAACqa,GAAAA,EAAO,CACN/X,YAAY,yDACZmvB,kBAAkB,EAClBnX,SACEza,EAAAA,EAAAA,IAAA,OACEC,IAAGpC,GAGDqC,SAAA,EAEFF,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfE,IAAKhD,EAAMqB,QAAQG,GACnBqC,WAAY,SACZjI,SAAU,SACVZ,UAAW,aACZ,IAAC2F,SAAA,EAEFC,EAAAA,EAAAA,GAACyZ,GAAAA,EAAsB,CAACjR,KAAM0oB,EAAUQ,aAAW,KACnD1xB,EAAAA,EAAAA,GAAA,QAAMF,KAAGM,EAAAA,EAAAA,IAAE,CAAEvF,MAAOs2B,GAAkB,IAACpxB,SAAEsJ,EAAKyL,SAC9C9U,EAAAA,EAAAA,GAAA,QACEF,KAAGM,EAAAA,EAAAA,IAAE,CAAEO,WAAYvB,EAAMqB,QAAQG,GAAI/F,MAAOy2B,EAAoBx3B,SAAUsF,EAAM6L,WAAWC,YAAY,IAACnL,SAEvG8E,EAAkBwE,EAAKsG,IAAMtG,EAAKoE,aAGvC5N,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,MAAOrH,MAAOs2B,GAAkB,IAACpxB,SAAA,EAC3EC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,WAA6D,IAC7F/P,EAAkBwE,EAAKoE,OACvB,OACDzN,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SAAC+D,eAAe,SAAyD,IACzF/P,EAAkBwE,EAAKsG,WAI9BgiB,KAAK,QACL1yB,SAAU,IAAIc,SAEbA,GACO,ECjDyE,IAAArC,GAAA,CAAAC,KAAA,UAAAC,OAAA,6EAAAC,GAAA,CAAAF,KAAA,SAAAC,OAAA,oEAEhF,MAAMg0B,GAAmBA,EAC9B3sB,OACA4sB,cACAjoB,eACA3B,kBACA6pB,iBACAC,eACAC,WACArB,oBAaK,IAADxrB,EAAAG,EACJ,MAAM4N,EAAWtJ,EAAawiB,IAAInnB,EAAKN,MACjC,MAAEvF,IAAUC,EAAAA,EAAAA,KACZuxB,GAA4B,QAAdzrB,EAACF,EAAKlF,gBAAQ,IAAAoF,EAAAA,EAAI,IAAII,OAAS,GAC7C,2BAAEmB,GAA+BE,IAEjCmqB,EAAWc,IAAgB5sB,EAAKN,IAChCstB,EAAmBjtB,EAAoBC,EAAM8K,OAAO8hB,IAEpDnB,EAAkBuB,GAAoB,EAEtC/I,GAAeC,EAAAA,EAAAA,IAAsBlkB,GAAQ,EAE7CnE,EAAkBiwB,EAAW3xB,EAAM0L,OAAOonB,6BAA+B,cAE/E,OACEryB,EAAAA,EAAAA,IAAAkR,EAAAA,GAAA,CAAAhR,SAAA,EACEC,EAAAA,EAAAA,GAACgxB,GAAuB,CAAC3nB,KAAMpE,EAAKlF,UAClCC,EAAAA,EAAAA,GAAA,OACE,cAAa,sBAAsBiF,EAAKN,MACxC7E,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACflD,MAAO,OACP7C,OAAQ,UACRoU,UAAW,aACXzP,kBACA,SAAU,CACRA,gBAAiB1B,EAAM0L,OAAOonB,8BAEhC,UAAW,CACTpxB,gBAAiB1B,EAAM0L,OAAOqnB,+BAEjC,IACD1uB,QAASA,KACC,OAARuuB,QAAQ,IAARA,GAAAA,EAAW/sB,EAAK,EAChBlF,UAEFC,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfe,WAAY,SAEZnI,QAAS,OAAOsE,EAAMqB,QAAQC,OAC9ByB,eAAgB,gBAChBnH,SAAU,SACVsF,KAAM,GACP,IAACP,UAEFF,EAAAA,EAAAA,IAAA,OAAKC,IAAGpC,GAA+FqC,SAAA,CACpG6wB,GACC5wB,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLpC,KAAK,QACL,cAAa,wBAAwB+D,EAAKN,MAC1C7E,KAAGM,EAAAA,EAAAA,IAAE,CAAEma,WAAY,EAAGvX,YAAa5D,EAAMqB,QAAQG,IAAI,IACrD2C,KAAM2P,GAAWlT,EAAAA,EAAAA,GAAC0D,EAAAA,gBAAe,KAAM1D,EAAAA,EAAAA,GAACuZ,EAAAA,EAAgB,IACxD9V,QAAU8a,IAERA,EAAMwG,kBACN,MAAMqN,EAAkB,IAAI5oB,IAAII,GAC5BsJ,EACFkf,EAAgBC,OAAOptB,EAAKN,KAE5BytB,EAAgBzoB,IAAI1E,EAAKN,KAE3BsD,EAAgBmqB,EAAgB,EAElC9vB,YAAY,6CAGdtC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEpB,MAAO,GAAIgE,YAAa5D,EAAMqB,QAAQG,IAAI,OAExDZ,EAAAA,EAAAA,GAACwwB,GAAyB,CACxBC,aAAcM,EACdL,gBAAiBA,EACjBC,cAAeA,EACfC,YAAaA,EACbC,WAAY3d,KAEdlT,EAAAA,EAAAA,GAAA,QACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHma,WAAY,EACZvX,YAAa5D,EAAMqB,QAAQG,GAC3B1F,aAAckE,EAAM0N,QAAQoJ,eAC5BtJ,OAAQ,aACNqlB,GAAoB,EAAI7yB,EAAM0L,OAAO4f,QAAUtrB,EAAM0L,OAAOE,sBAE9DjK,OAAQ6C,GACT,IAAC7D,SAEDkF,EAAK1B,QAERvD,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CACdtI,MAAOquB,EAAe,QAAU,UAChCppB,IAAGjC,GAKDkC,SAEDkF,EAAK6P,QAEP7P,EAAKyC,YAAYnC,OAAS,IACzB1F,EAAAA,EAAAA,IAAC2W,EAAAA,IAAG,CACF3b,MAAM,SACN,cAAa,kBAAkBoK,EAAKN,MACpCrC,YAAY,+CACZxC,KAAGM,EAAAA,EAAAA,IAAE,CACHrF,OAAQ,EACRG,aAAckE,EAAM0N,QAAQoJ,gBAC7B,IACDzS,QAASA,IAAgC,OAA1BiD,QAA0B,IAA1BA,OAA0B,EAA1BA,GAA6B,GAAM3G,SAAA,EAElDC,EAAAA,EAAAA,GAACggB,EAAAA,UAAS,KACVhgB,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAEO,WAAYvB,EAAMqB,QAAQG,IAAI,IAACb,SAAEkF,EAAKyC,YAAYnC,qBAOrF2N,IACc,QADN5N,EACPL,EAAKlF,gBAAQ,IAAAuF,OAAA,EAAbA,EAAeG,KAAI,CAACb,EAAOoa,KAAG,IAAAsT,EAAAC,EAAA,OAC5BvyB,EAAAA,EAAAA,GAAC4xB,GAAgB,CAEf3sB,KAAML,EACNgF,aAAcA,EACd3B,gBAAiBA,EACjB4pB,YAAaA,EACbC,eAAgBA,EAChBC,aAAcA,EACdC,SAAUA,EACVrB,cAAeA,EAAc6B,OAAO,CAGlC1B,aAAc9R,GAA4B,QAAtBsT,EAAc,QAAdC,EAACttB,EAAKlF,gBAAQ,IAAAwyB,OAAA,EAAbA,EAAehtB,cAAM,IAAA+sB,EAAAA,EAAI,GAAK,EAGnDvB,SAAU/R,EAAMiT,KAdbrtB,EAAMD,IAgBX,OAEL,ECjL8D,IAAAjH,GAAA,CAAAC,KAAA,UAAAC,OAAA,oEAE9D,MAAM60B,GAAwBA,EACnCxtB,OACA4sB,cACAa,aACA1zB,QACAgzB,WACApoB,eACA3B,sBASK,IAAD9C,EACJ,MAAM,MAAE/F,IAAUC,EAAAA,EAAAA,KACZszB,GAAgB9zB,EAAAA,EAAAA,QAAwB,MACxC+zB,GAAoB/zB,EAAAA,EAAAA,QAAwB,MAE5CiC,EADW+wB,IAAgB5sB,EAAKN,IACHvF,EAAM0L,OAAOonB,6BAA+B,cACzEtB,GAA4B,QAAdzrB,EAACF,EAAKlF,gBAAQ,IAAAoF,EAAAA,EAAI,IAAII,OAAS,EAC7C2N,EAAWtJ,EAAawiB,IAAInnB,EAAKN,KAkBvC,OAhBAhF,EAAAA,EAAAA,kBAAgB,KACd,IAAKgzB,EAAclzB,UAAYmzB,EAAkBnzB,QAC/C,OAGgBiG,KAAKC,IAAIgtB,EAAclzB,QAAQozB,YAAaD,EAAkBnzB,QAAQozB,aAExE7zB,EAAQI,EAAMqB,QAAQC,IACpCiyB,EAAclzB,QAAQsO,MAAM1N,QAAU,SACtCuyB,EAAkBnzB,QAAQsO,MAAM1N,QAAU,SAE1CsyB,EAAclzB,QAAQsO,MAAM1N,QAAU,OACtCuyB,EAAkBnzB,QAAQsO,MAAM1N,QAAU,SAC5C,GACC,CAACjB,EAAMqB,QAAQC,GAAI1B,KAGpBgB,EAAAA,EAAAA,GAACgxB,GAAuB,CAAC3nB,KAAMpE,EAAKlF,UAClCF,EAAAA,EAAAA,IAAA,OAEEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACf/F,OAAQ,UACRoU,UAAW,aACXpC,YAAa/O,EAAMqB,QAAQG,GAC3B4T,aAAcpV,EAAMqB,QAAQC,GAC5Bqa,WAAY3b,EAAMqB,QAAQG,GAC1B2T,cAAenV,EAAMqB,QAAQG,GAC7BE,gBAAiBA,EACjBmC,WAAY,SACZ,SAAU,CACRnC,gBAAiB1B,EAAM0L,OAAOonB,8BAEhC,UAAW,CACTpxB,gBAAiB1B,EAAM0L,OAAOqnB,8BAEhCpxB,OAAQ6C,GACT,IACDH,QAASA,IAAc,OAARuuB,QAAQ,IAARA,OAAQ,EAARA,EAAW/sB,GAAMlF,SAAA,CAE/B6wB,GACC5wB,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLpC,KAAK,QACL,cAAa,iCAAiC+D,EAAKN,MACnD7E,KAAGM,EAAAA,EAAAA,IAAE,CAAEma,WAAY,EAAGvX,YAAa5D,EAAMqB,QAAQG,IAAI,IACrD2C,KAAM2P,GAAWlT,EAAAA,EAAAA,GAAC0D,EAAAA,gBAAe,KAAM1D,EAAAA,EAAAA,GAACuZ,EAAAA,EAAgB,IACxD9V,QAAU8a,IAERA,EAAMwG,kBACN,MAAMqN,EAAkB,IAAI5oB,IAAII,GAC5BsJ,EACFkf,EAAgBC,OAAOptB,EAAKN,KAE5BytB,EAAgBzoB,IAAI1E,EAAKN,KAE3BsD,EAAgBmqB,EAAgB,EAElC9vB,YAAY,sDAGdtC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEpB,MAAO,GAAIgE,YAAa5D,EAAMqB,QAAQG,IAAI,OAExDZ,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEpB,MAAO0zB,EAAYnY,WAAY,GAAG,OAC9Cva,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACVxB,QACAkO,OAAQ9N,EAAM6L,WAAWyJ,eACzB5T,gBAAiB1B,EAAM0L,OAAOgoB,QAC9B53B,aAAckE,EAAM0N,QAAQoJ,eAC5BqE,WAAY,GACb,IAACxa,UAEFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAApD,UACdC,EAAAA,EAAAA,GAAA,QACEzB,IAAKo0B,EACL7yB,KAAGM,EAAAA,EAAAA,IAAE,CACHO,WAAYvB,EAAMqB,QAAQG,GAC1B/F,MAAOuE,EAAM0L,OAAOioB,MACpB1yB,QAAS,QACV,IAACN,SAEDkF,EAAK6P,aAIZjV,EAAAA,EAAAA,IAAA,OAAKC,IAAGpC,GAAkFqC,SAAA,EACxFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAApD,UACdC,EAAAA,EAAAA,GAAA,QACEzB,IAAKq0B,EACL9yB,KAAGM,EAAAA,EAAAA,IAAE,CACHO,WAAYvB,EAAMqB,QAAQG,GAC1B/F,MAAOuE,EAAM0L,OAAOsD,aACrB,IAACrO,SAEDkF,EAAK6P,WAGV9U,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAEO,WAAYvB,EAAMqB,QAAQG,IAAI,IAAE/F,MAAM,YAAWkF,SACtE8E,EAAkBI,EAAK0K,IAAM1K,EAAKwI,cAjFlCxI,EAAKN,MAqFY,ECnF7B,IAAAjH,GAAA,CAAAC,KAAA,UAAAC,OAAA,8EAAAC,GAAA,CAAAF,KAAA,SAAAC,OAAA,qBAAAE,GAAA,CAAAH,KAAA,SAAAC,OAAA,4CAEM,MAAMo1B,GAAwBA,EACnClvB,QACA+tB,cACAG,WACAF,iBACAC,eACAnoB,eACA3B,sBASK,IAADgrB,EAAAz0B,EACJ,MAAM,MAAEY,IAAUC,EAAAA,EAAAA,KACZ6zB,GAAmBr0B,EAAAA,EAAAA,QAAuB,MAC1Cs0B,EAAsE,QAAtDF,EAA+C,QAA/Cz0B,GAAGO,EAAAA,EAAAA,IAAkB,CAAER,IAAK20B,WAAmB,IAAA10B,OAAA,EAA5CA,EAA8CQ,aAAK,IAAAi0B,EAAAA,EAAI,EAC1EG,GAAgBhsB,EAAAA,EAAAA,UACpB,IAhEJ,SAAuB8jB,EAAc/W,EAAekf,EAAoBC,EAAwB,IAC9F,MAAMC,EAAQpf,EAAQ+W,EACtB,GAAIqI,GAAS,GAAKF,GAAc,EAAG,MAAO,GAE1C,MAAMG,EAAe9tB,KAAK6a,MAAM8S,EAAaC,GAC7C,GAAIE,EAAe,EAAG,MAAO,GAG7B,MAAMC,EAAcF,EAAQC,EAGtBE,EAAYhuB,KAAKiuB,IAAI,GAAIjuB,KAAK6a,MAAM7a,KAAKkuB,MAAMH,KAC/CI,EAAWJ,EAAcC,EAE/B,IAAII,EACeA,EAAfD,GAAY,EAAkB,EACzBA,GAAY,EAAkB,EAC9BA,GAAY,EAAkB,EACnB,GAEpB,MAAME,EAAeD,EAAeJ,EAK9BM,EAAgB7f,EAAQ,EAAI4f,EAI5BE,EAAkB,GAExB,IAAK,IAAIC,EAHSxuB,KAAKyuB,KAAKjJ,EAAO6I,GAAgBA,EAGxBG,GAAQF,EAAeE,GAAQH,EACxDE,EAAM9vB,KAAKohB,OAAO2O,EAAKnvB,QAAQ,MAGjC,OAAOkvB,CACT,CA4BUG,CAActC,EAAgBC,EAAcoB,IAClD,CAACpB,EAAcD,EAAgBqB,IAE3BjI,EAAOxlB,KAAK2uB,OAAOjB,GAKnBjf,GAASif,EAAcA,EAAc7tB,OAAS,GAAK6tB,EAAcA,EAAc7tB,OAAS,IAAM,EAE9F+uB,EAASlB,EAActnB,MAAM,GAAI,GAEjCyoB,EAA4B/xB,GArCpC,SAAgBA,EAAe0oB,EAAc/W,EAAenV,GAC1D,OAASwD,EAAQ0oB,IAAS/W,EAAQ+W,GAASlsB,CAC7C,CAmCsDw1B,CAAOhyB,EAAO0oB,EAAM/W,EAAOgf,GAE/E,OACEtzB,EAAAA,EAAAA,IAAA,OACEC,IAAGpC,GAKDqC,SAAA,EAGFC,EAAAA,EAAAA,GAAA,OACEzB,IAAK20B,EACLpzB,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACTrB,MAAO,OACPkD,cAAe,MACfgL,OAAQ9N,EAAM6L,WAAWyJ,eACzBvG,YAlGuB,GAmGvBqG,aAAcpV,EAAMqB,QAAQqrB,GAC5Bvb,UAAW,aACX/P,SAAU,SACVgN,IAAK,EACL1M,gBAAiB1B,EAAM0L,OAAOkD,kBAC9BjN,OAAQ6C,GACT,IAAC7D,UAEFC,EAAAA,EAAAA,GAAA,OACE,cAAY,mBACZF,IAAGjC,GAEDkC,SAEDu0B,EAAO7uB,KAAKgvB,IACXz0B,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CACdrD,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACVk0B,UAAW,mBACXxJ,KAAMqJ,EAAyBE,GAC/Bv6B,WAAY,UACb,IAAC6F,SAGD8E,EAAkB4vB,IAFdA,UAQbz0B,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHE,KAAM,EACNq0B,cAAe,OACf5zB,OAAQ6C,GACT,IAAC7D,UAEFC,EAAAA,EAAAA,GAAA,OACEF,IAAGhC,GAIDiC,SAEDu0B,EAAO7uB,KAAKgvB,IACXz0B,EAAAA,EAAAA,GAAA,OAEEF,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACV0qB,KAAMqJ,EAAyBE,GApJd,GAqJjBpE,YAAa,aAAajxB,EAAM0L,OAAO8B,SACvCM,OAAQ,QACT,KANIunB,SAYZ3wB,EAAM2B,KAAKR,IACV,MAAMytB,EAAa6B,EAAyBtvB,EAAKwI,OAC3CzO,EAAQu1B,EAAyBtvB,EAAK0K,KAAO+iB,EACnD,OACE1yB,EAAAA,EAAAA,GAACyyB,GAAqB,CAEpBZ,YAAaA,EACbG,SAAUA,EACV/sB,KAAMA,EACNytB,WAAYA,EACZ1zB,MAAOA,EACP4K,aAAcA,EACd3B,gBAAiBA,GAPZhD,EAAKN,IAQV,MAGF,EC7K6E,IAAAjH,GAAA,CAAAC,KAAA,UAAAC,OAAA,iGAAAC,GAAA,CAAAF,KAAA,UAAAC,OAAA,6DAAAE,GAAA,CAAAH,KAAA,UAAAC,OAAA,kDAAA+X,GAAA,CAAAhY,KAAA,SAAAC,OAAA,uCAEhF,MAAMg3B,GAAeA,EAC1BC,YACA3uB,eACAE,kBACA0rB,iBACAC,eACAnoB,eACA3B,kBACAG,kBACAC,qBACAoH,gBAaA,MAAM,MAAErQ,IAAUC,EAAAA,EAAAA,KAEZy1B,GAAcv1B,EAAAA,EAAAA,cACjB0F,IACgB,OAAfmB,QAAe,IAAfA,GAAAA,EAAkBnB,EAAK,GAEzB,CAEEmB,KAIIG,sBAAuBspB,EAAkBrpB,yBAA0BspB,GACzElpB,IAEImuB,GAAoB3tB,EAAAA,EAAAA,UACxB,IjEf4C4tB,EAC9ClxB,EACA8F,KAEA,MAAM7F,EAAyB,GACzBC,EAAoBC,IAKkB,IAADgxB,EAJpChxB,IAGLF,EAAkBI,KAAKF,GACnB2F,EAAawiB,IAAInoB,EAAcU,OACX,QAAtBswB,EAAAhxB,EAAclE,gBAAQ,IAAAk1B,GAAtBA,EAAwB7wB,QAAQJ,IAClC,EAIF,OADAF,EAAMM,QAAQJ,GACPD,CAAiB,EiEDhBixB,CAAiCH,EAAWjrB,IAClD,CAACirB,EAAWjrB,IAGRsrB,GAAc9tB,EAAAA,EAAAA,UAClB,SAAAyC,EAAA,OACE7J,EAAAA,EAAAA,GAAA,OACEF,IAAGpC,GAODqC,SAED8vB,GACC7vB,EAAAA,EAAAA,GAACgzB,GAAqB,CACpBlvB,MAAOixB,EACPlD,YAA8B,QAAnBhoB,EAAc,OAAZ3D,QAAY,IAAZA,OAAY,EAAZA,EAAcvB,WAAG,IAAAkF,EAAAA,EAAI,GAClCmoB,SAAU8C,EACVhD,eAAgBA,EAChBC,aAAcA,EACdnoB,aAAcA,EACd3B,gBAAiBA,IAGnB4sB,EAAUpvB,KAAKR,IAAI,IAAAkwB,EAAA,OACjBn1B,EAAAA,EAAAA,GAAC4xB,GAAgB,CAEf3sB,KAAMA,EACN2E,aAAcA,EACd3B,gBAAiBA,EACjB4pB,YAA8B,QAAnBsD,EAAc,OAAZjvB,QAAY,IAAZA,OAAY,EAAZA,EAAcvB,WAAG,IAAAwwB,EAAAA,EAAI,GAClCrD,eAAgBA,EAChBC,aAAcA,EACdC,SAAU8C,EACVnE,cAAe,IARV1rB,EAAKN,IASV,KAGF,GAER,CACEkrB,EACAkF,EACY,OAAZ7uB,QAAY,IAAZA,OAAY,EAAZA,EAAcvB,IACdmwB,EACAhD,EACAC,EACA8C,EACAjrB,EACA3B,IAIJ,OACEjI,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACH8M,OAAQ,OACRhS,aAAckE,EAAM0f,cAAc/R,eAClC/R,SAAU,SACVqF,QAAS,QACV,IACDoP,UAAWA,EAAU1P,UAErBC,EAAAA,EAAAA,GAAA,OACEF,IAAGjC,GAKDkC,UAEFF,EAAAA,EAAAA,IAAA,OAAKC,IAAGhC,GAA+DiC,SAAA,EACrEC,EAAAA,EAAAA,GAAC4vB,GAAkB,CACjBC,iBAAkBA,EAClBC,oBAAqBA,EACrB1nB,gBAAiBA,EACjBC,mBAAoBA,IAErBwsB,EAAUtvB,OAAS,GAClBvF,EAAAA,EAAAA,GAAA,OAAKF,IAAG6V,GAAkD5V,SAAEm1B,KAE5Dl1B,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHE,KAAM,EACND,QAAS,OACT8B,eAAgB,SAChBrH,QAASsE,EAAMqB,QAAQwM,GACvB8N,WAAY3b,EAAMqB,QAAQqrB,IAC3B,IAAC/rB,UAEFC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,iEAOrB,ECpHR,IAAAlX,GAAA,CAAAC,KAAA,SAAAC,OAAA,0DAAAC,GAAA,CAAAF,KAAA,SAAAC,OAAA,UAEK,MAAMw3B,GAA+BA,EAC1CruB,aACA0I,YACA4lB,iBACAC,mBAMK,IAADC,EAAAC,EACJ,MAAM,MAAEp2B,IAAUC,EAAAA,EAAAA,KACZrB,EAnBFy3B,OAAOC,YAAc,IAChB,IAGF,IAgBDC,GAAU92B,EAAAA,EAAAA,QAA2C,OACpDZ,EAAWC,IAAgBS,EAAAA,EAAAA,UAAS,MAGzCmH,SAAUkC,EAAQ,aAClB9B,EAAY,gBACZE,EAAe,UACfC,EAAS,aACTC,GACEM,KAEE,aAAEgD,EAAY,gBAAE3B,GlE0BoB2tB,EAC1CC,EAII,CAAC,KAEL,MAAOjsB,EAAc3B,IAAmBtJ,EAAAA,EAAAA,WAA+B,KACrE,GAAIk3B,EAAOhB,UAAW,CACpB,MAAMiB,GAAOjf,EAAAA,EAAAA,QAAOxS,EAAwBwxB,EAAOhB,UAAWgB,EAAOE,qBAAqBtwB,KAAKR,GAASA,EAAKN,MAC7G,OAAO,IAAI6E,IAAIssB,EACjB,CACA,OAAO,IAAItsB,GAAK,IAGlB,MAAO,CACLI,eACA3B,kBACD,EkE5CyC2tB,CAA6B,CACrEf,UAAW7sB,EAAW,CAACA,GAAY,GAEnC+tB,mBAAoBpyB,KAGhB,UACJhC,EAAS,aACTF,EAAY,gBACZC,EAAe,gBACf0G,EAAe,mBACfC,EAAkB,kBAClBU,EAAiB,sBACjBnH,EAAqB,0BACrBC,GACEkG,EAAoB,CACtBC,WACA9B,eACAE,kBACAE,eACA2B,kBACAC,eAA0B,OAAVnB,QAAU,IAAVA,OAAU,EAAVA,EAAYivB,QAa9Br2B,EAAAA,EAAAA,kBAAgB,KAEd,MAAMm2B,GAAOjf,EAAAA,EAAAA,QAAOxS,EAAwB0E,EAAmBpF,IAAuB8B,KAAKR,GAASA,EAAKN,MACzGsD,EAAgB,IAAIuB,IAAIssB,GAAM,GAC7B,CAAC/sB,EAAmBd,IAEvB,MAAMguB,GAAmB7uB,EAAAA,EAAAA,UAAQ,KAE/B,MAAM8uB,ElEhGuB,GkEiG3BxwB,KAAKC,OAAOoD,EAAkBtD,IAAIJ,IA9EG,EA+EAjG,EAAMqB,QAAQqrB,GAErD,OAAOpmB,KAAKC,IAhFsB,IAgFauwB,EAAiB,GAC/D,CAACntB,EAAmB3J,EAAMqB,QAAQqrB,KAErC,OACEjsB,EAAAA,EAAAA,IAAA,OACEC,IAAGpC,GAMH+R,UAAWA,EAAU1P,SAAA,EAErBC,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHtF,QAASsE,EAAMqB,QAAQG,GACvB3D,aAAc,aAAamC,EAAM0L,OAAO8B,UACzC,IAAC7M,UAEFC,EAAAA,EAAAA,GAACwB,EAA2B,CAC1BC,aAAcA,EACdC,gBAAiBA,EACjBC,UAAWA,EACXC,sBAAuBA,EACvBC,0BAA2BA,OAG/B7B,EAAAA,EAAAA,GAACivB,EAA+B,CAC9B1wB,IAAKo3B,EACL33B,aAAcA,EACdC,UAAWA,EACXC,aAAcA,EACdC,WACE6B,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACf5B,KAAM,EACNyd,SAAUkY,GACX,IAACl2B,UAEFC,EAAAA,EAAAA,GAAC40B,GAAY,CACXC,UAAW9rB,EACX7C,aAAcA,EACd4rB,eAA+B,QAAjByD,EAAU,OAARvtB,QAAQ,IAARA,OAAQ,EAARA,EAAUyF,aAAK,IAAA8nB,EAAAA,EAAI,EACnCxD,aAA2B,QAAfyD,EAAU,OAARxtB,QAAQ,IAARA,OAAQ,EAARA,EAAU2H,WAAG,IAAA6lB,EAAAA,EAAI,EAC/BpvB,gBApEUnB,IACpBmB,EAAgBnB,GAEhBqB,EAAiB,OAAJrB,QAAI,IAAJA,GAAAA,EAAM0C,aAAe,OAAS,YACvC6L,EAAAA,EAAAA,UAAa,OAAJvO,QAAI,IAAJA,OAAI,EAAJA,EAAMN,OACL,OAAZ2wB,QAAY,IAAZA,GAAAA,EAAmB,OAAJrwB,QAAI,IAAJA,OAAI,EAAJA,EAAMN,KACvB,EA+DU7E,IAAGjC,GACH+L,aAAcA,EACd3B,gBAAiBA,EACjBG,gBAAiBA,EACjBC,mBAAoBA,MAI1BjK,aAAc63B,EACd53B,YACE2B,EAAAA,EAAAA,GAACkvB,GAA+B,CAC9B/X,WAAYjR,EACZzE,aAAcA,EACd4I,YAAa1I,EAAUoB,MACvBsD,UAAWA,EACXC,aAAcA,IAGlBhI,cTvJ4B63B,QSyJ1B,EC/KqF,IAAAz4B,GAAA,CAAAC,KAAA,UAAAC,OAAA,4BAAAC,GAAA,CAAAF,KAAA,SAAAC,OAAA,U,gBCKxF,MAAMw4B,GAAyBA,EACpCxT,UACAyT,gBACAC,gCAMOC,EAAAA,GAAAA,GAAS,CACdC,QAASA,InCDmBC,GAAG7T,aACjCnB,GAAS,+BAA+BmB,KmCAvB6T,CAAiB,CAAE7T,YAClCiB,UAAYhC,IACVwU,GAAeK,IAA0B,IAAAC,EAAAC,EAAA,MAAM,CAC7CxsB,KAAMssB,EAAetsB,KACrB4rB,KAAiC,QAA7BW,EAAU,OAAR9U,QAAQ,IAARA,GAAe,QAAP+U,EAAR/U,EAAUgV,aAAK,IAAAD,OAAP,EAARA,EAAiBE,kBAAU,IAAAH,EAAAA,EAAI,CAAC,EACvC,IACDL,GAA0B,EAAK,EAEjCxS,QAASA,KACPwS,GAA0B,EAAM,ICnBzBS,GAAsCA,EACjDjiB,QACAkiB,YAKA,MAAM,MAAE53B,IAAUC,EAAAA,EAAAA,KAClB,OACEQ,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfE,IAAKhD,EAAMqB,QAAQC,GACnB5F,QAASsE,EAAMqB,QAAQC,GACvBkM,OAAQ,aAAaxN,EAAM0L,OAAO8B,SAClC1R,aAAckE,EAAM0N,QAAQoJ,gBAC7B,IAACnW,SAAA,CAED+U,IACC9U,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACrD,KAAGM,EAAAA,EAAAA,IAAE,CAAEO,WAAYvB,EAAMqB,QAAQG,IAAI,IAAEtD,MAAI,EAAAyC,SACzD+U,IAGJkiB,EAAMvxB,KAAKkT,IACV3Y,EAAAA,EAAAA,GAAC0Y,GAA0B,CAA0BC,KAAMA,GAA1BA,EAAK7c,SAAS6B,UAE7C,EC3BGs5B,GAA2CA,EACtDniB,QACAoiB,gBAKA,MAAM,MAAE93B,IAAUC,EAAAA,EAAAA,KAClB,OACEQ,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHU,gBAAiB1B,EAAM0L,OAAOkD,kBAC9B9S,aAAckE,EAAM0N,QAAQoJ,eAC5BtJ,OAAQ,aAAaxN,EAAM0L,OAAO8B,UACnC,IAAC7M,SAAA,CAED+U,IACC9U,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHtF,QAAS,GAAGsE,EAAMqB,QAAQG,QAAQxB,EAAMqB,QAAQC,OAChDzD,aAAc,aAAamC,EAAM0L,OAAO8B,UACzC,IAAC7M,UAEFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAC7F,MAAI,EAAAyC,SAAE+U,MAG1BoiB,EAAUzxB,KAAI,CAACsZ,EAAUC,KACxBhf,EAAAA,EAAAA,GAAA,OAAeF,KAAGM,EAAAA,EAAAA,IAAE,CAAEnD,aAAc+hB,IAAQkY,EAAU3xB,OAAS,EAAI,aAAanG,EAAM0L,OAAO8B,SAAW,IAAI,IAAC7M,UAC3GC,EAAAA,EAAAA,GAACie,GAAmC,CAAWP,KAAMqB,EAASE,aAAcf,SAAUa,EAASb,UAArDc,IADlCA,OAIR,EC5BGmY,GAAsCA,EAAGriB,QAAOtS,YAC3D,MAAM,MAAEpD,IAAUC,EAAAA,EAAAA,MACX6T,EAAUC,IAAexU,EAAAA,EAAAA,WAAS,GAEnCwa,EAAe3W,EAAM+C,OANG,IAOxBwjB,GACH7V,GAAY1Q,EAAM+C,OARS,IAQ0B/C,EAAMsJ,MAAM,EARtC,KAQoE,MAAQtJ,EAEpG4W,EAAcD,EAChB,CAAE,SAAU,CAAErY,gBAAiB1B,EAAM0L,OAAOuO,0BAA2Bld,OAAQ,YAC/E,CAAC,EAEL,OACE0D,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHwM,OAAQ,aAAaxN,EAAM0L,OAAO8B,SAClC1R,aAAckE,EAAM0N,QAAQoJ,gBAC7B,IAACnW,SAAA,CAED+U,IACCjV,EAAAA,EAAAA,IAAA,OACEyZ,KAAK,SACLxZ,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT8B,eAAgB,gBAChBc,WAAY,SACZnI,QAAS,GAAGsE,EAAMqB,QAAQC,QAAQtB,EAAMqB,QAAQC,GAAKtB,EAAMqB,QAAQG,UAChEwY,GACJ,IACD3V,QAASA,IAAM0P,GAAaD,GAAUnT,SAAA,EAEtCC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAAC7F,MAAI,EAAAyC,SAAE+U,IACtBqE,IAAiBjG,GAAWlT,EAAAA,EAAAA,GAAC0D,EAAAA,gBAAe,KAAM1D,EAAAA,EAAAA,GAACuZ,EAAAA,EAAgB,SAGxE1Z,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfE,IAAKhD,EAAMqB,QAAQC,GACnByN,YAAa/O,EAAMqB,QAAQC,GAAKtB,EAAMqB,QAAQG,GAC9C4T,aAAcpV,EAAMqB,QAAQC,GAAKtB,EAAMqB,QAAQG,GAC/Cma,WAAYjG,EAAQ,EAAI1V,EAAMqB,QAAQC,GACtC6T,cAAenV,EAAMqB,QAAQC,GAE7B,uBAAwB,CACtBsM,aAAc,IAEjB,IAACjN,SAAA,EAEFC,EAAAA,EAAAA,GAACyO,EAAqB,CAAA1O,SAAEgpB,IACvB5P,IACCnZ,EAAAA,EAAAA,GAACkD,EAAAA,EAAW0N,KAAI,CACdnN,QAASA,IAAM0P,GAAaD,GAC5B5Q,YAAY,uDAAsDvC,SAEjEmT,GACClT,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,cAIjB5U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,oBAOrB,ECnEGwiB,GAAkCA,EAC7CtiB,QACA1K,OACAsI,iBAMA,MAAMY,GAAalM,EAAAA,EAAAA,UAAQ,KACzB,IACE,OAAOwL,KAAKW,MAAMnJ,EACpB,CAAE,MAAOnJ,GACP,OAAOmJ,CACT,IACC,CAACA,IAEEkL,GAAe9B,EAAAA,EAAAA,UAASF,GACxB3L,GAAe0vB,EAAAA,EAAAA,IAAsB/jB,GACrCgkB,EAAchY,MAAMC,QAAQjM,IAAeA,EAAW/N,OAAS,IAAKgyB,EAAAA,EAAAA,OAAMjkB,EAAYkkB,EAAAA,IACtFC,EACJnY,MAAMC,QAAQjM,IAAeA,EAAW/N,OAAS,IAAKgyB,EAAAA,EAAAA,OAAMjkB,EAAYokB,EAAAA,IAE1E,MAAmB,SAAfhlB,GACK1S,EAAAA,EAAAA,GAAC4V,GAA6B,CAACd,MAAOA,EAAO1K,KAAMA,EAAMmL,kBAAmB5C,EAAAA,GAAsBC,OAGxF,SAAfF,GACK1S,EAAAA,EAAAA,GAAC4V,GAA6B,CAACd,MAAOA,EAAO1K,KAAMA,EAAMmL,kBAAmB5C,EAAAA,GAAsB+C,OAGvGJ,GACKtV,EAAAA,EAAAA,GAACm3B,GAAmC,CAACriB,MAAOA,EAAOtS,MAAO8Q,IAG/D3L,GAAgBA,EAAapC,OAAS,GACjCvF,EAAAA,EAAAA,GAAC0b,GAA8B,CAACC,SAAUhU,IAG/C2vB,GACKt3B,EAAAA,EAAAA,GAAC+2B,GAAmC,CAACjiB,MAAOA,EAAOkiB,MAAO1jB,IAG/DmkB,GACKz3B,EAAAA,EAAAA,GAACi3B,GAAwC,CAACniB,MAAOA,EAAOoiB,UAAW5jB,KAGrEtT,EAAAA,EAAAA,GAAC4V,GAA6B,CAACd,MAAOA,EAAO1K,KAAMA,GAAQ,ECnDvDutB,GAAiDA,EAAG1yB,WAA0C,IAAD2yB,EACxG,MAAM,MAAEx4B,IAAUC,EAAAA,EAAAA,KACZw4B,GAAkBC,EAAAA,EAAAA,IAAuB7yB,GACzC8yB,GAAU9yB,EAAKyE,SAIfsuB,EAAiBH,EAAgB,GAEvC,OAAKG,GAKHh4B,EAAAA,EAAAA,GAAC4b,GAAoC,CACnC9b,KAAGM,EAAAA,EAAAA,IAAE,CAAE4M,aAAc+qB,EAAS34B,EAAMqB,QAAQC,GAAK,GAAG,IACpDob,WAAYic,EAEZlc,WAAYmc,EAAer6B,KAC3BmX,OACEjV,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ4C,WAAY,SAAUb,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAAA,EACzEC,EAAAA,EAAAA,GAACwf,EAAAA,YAAW,CAAC3kB,MAAM,YACnBmF,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACtI,MAAM,QAAQyC,MAAI,EAAAyC,SAAC,iBAIvCA,UAEDC,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfE,IAAKhD,EAAMqB,QAAQC,GACnB6T,cAAenV,EAAMqB,QAAQC,GAC7ByN,YAAa4pB,EAAS,EAAI34B,EAAMqB,QAAQqrB,IACzC,IAAC/rB,SAED6W,OAAOe,QAAiC,QAA1BigB,EAACI,EAAe5gB,kBAAU,IAAAwgB,EAAAA,EAAI,CAAC,GAAGnyB,KAAI,EAAEga,EAAWjd,MAChExC,EAAAA,EAAAA,GAACo3B,GAA+B,CAE9BtiB,MAAO2K,EACPrV,KAAMwI,KAAKgF,UAAUpV,EAAO,KAAM,GAClCkQ,WAAW,QAHN+M,QAtBNuY,EAAer6B,MAPf,IAoCgC,ECtCrB,IAAAD,GAAA,CAAAC,KAAA,SAAAC,OAAA,yDAAAC,GAAA,CAAAF,KAAA,SAAAC,OAAA,iEAAAE,GAAA,CAAAH,KAAA,UAAAC,OAAA,sDAEf,MAAMq6B,GAA4CA,EACvDhzB,OACAyN,iBAKA,MAAM,MAAEtT,IAAUC,EAAAA,EAAAA,MACX6T,EAAUC,IAAexU,EAAAA,EAAAA,WAAS,GACnC2d,GAAYlV,EAAAA,EAAAA,UAAQ,KAAMmV,EAAAA,EAAAA,IAAqBtX,EAAKuX,SAAS,CAACvX,IAC9DwX,GAAarV,EAAAA,EAAAA,UAAQ,KAAMmV,EAAAA,EAAAA,IAAqBtX,EAAKyX,UAAU,CAACzX,IAGhEikB,GAFkB4O,EAAAA,EAAAA,IAAuB7yB,GAEVM,OAAS,EACxCoX,EAAiBL,EAAU/W,OAAS,EACpCqX,EAAkBH,EAAWlX,OAAS,GAEtC,gBAAEa,EAAe,cAAEH,EAAa,yBAAEO,GAA6BI,IAErE,OACE/G,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,MACfrB,UA1BW,GA2BX0Z,WAAY,GACb,IAACxa,SAAA,EAEFC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAE8M,OA9BC,GA8BmB7M,QAAS,OAAQ4C,WAAY,UAAU,IAAClD,UACtEC,EAAAA,EAAAA,GAACsD,EAAAA,EAAM,CACLpC,KAAK,QACL,cAAa,wBAAwB+D,EAAKN,MAC1C7E,KAAGM,EAAAA,EAAAA,IAAE,CAAEma,WAAY,EAAGvX,YAAa5D,EAAMqB,QAAQG,IAAI,IACrD2C,KAAM2P,GAAWlT,EAAAA,EAAAA,GAAC0D,EAAAA,gBAAe,KAAM1D,EAAAA,EAAAA,GAACuZ,EAAAA,EAAgB,IACxD9V,QAASA,IAAM0P,GAAaD,GAC5B5Q,YAAY,+CAGhBtC,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACV+P,UAAW,aACXrD,OAAQ,OACRie,WAAY,aAAa/rB,EAAM0L,OAAO8B,SACtC5N,MA/Cc,IAgDf,IAACe,UAEFC,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACV0qB,MAAO,EACP1d,IAAK,GACLN,OAvDY,GAwDZlO,MAxDY,GAyDZuR,UAAW,aACXwL,uBAAwB3c,EAAM0N,QAAQC,eACtC9P,aAAc,aAAamC,EAAM0L,OAAO8B,SACxCue,WAAY,aAAa/rB,EAAM0L,OAAO8B,UACvC,SAGL/M,EAAAA,EAAAA,IAAA,OAAKC,IAAGpC,GAAqEqC,SAAA,EAC3EF,EAAAA,EAAAA,IAAA,OAAKC,IAAGjC,GAA6EkC,SAAA,EACnFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CAACtI,MAAM,YAAYiF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,cAAe4C,WAAY,SAAUiK,OAjE/E,IAiEmG,IAACnN,UAC3GC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,wBAEfiC,OAAQ,CACNqhB,UAAUl4B,EAAAA,EAAAA,GAACgpB,GAAsB,CAAC/jB,KAAMA,UAI9CjF,EAAAA,EAAAA,GAAA,QACEyD,QAASA,KACP2C,EAAgBnB,GAChBgB,EAAc,UACdO,GAAyB,EAAK,EAC9BzG,UAEFC,EAAAA,EAAAA,GAACkD,EAAAA,EAAWC,KAAI,CACdrD,IAAGhC,GAMHjD,MAAM,YAAWkF,SAEhB8E,EAAkBI,EAAK0K,IAAM1K,EAAKwI,cAIxCyF,IACCrT,EAAAA,EAAAA,IAAA,OAAAE,SAAA,CACGmpB,IAAgBlpB,EAAAA,EAAAA,GAAC23B,GAA8C,CAAC1yB,KAAMA,IACtE0X,IACC3c,EAAAA,EAAAA,GAAC4b,GAAoC,CACnCC,WAAW,QACX/G,OACE9U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,WAGlB7U,UAEDC,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfE,IAAKhD,EAAMqB,QAAQC,GACnByN,YAAa/O,EAAMqB,QAAQqrB,GAC3B9e,aAAc4P,EAAkB,EAAIxd,EAAMqB,QAAQC,IACnD,IAACX,SAEDuc,EAAU7W,KAAI,EAAGd,MAAKnC,SAAS6K,KAC9BrN,EAAAA,EAAAA,GAACo3B,GAA+B,CAE9BtiB,MAAOnQ,EACPyF,KAAM5H,EACNkQ,WAAYA,GAHP/N,GAAO0I,SASrBuP,IACC5c,EAAAA,EAAAA,GAAC4b,GAAoC,CACnCC,WAAW,SACX/G,OACE9U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,YAGlB7U,UAEDC,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACfE,IAAKhD,EAAMqB,QAAQC,GACnByN,YAAa/O,EAAMqB,QAAQqrB,GAC3B9e,aAAc5N,EAAMqB,QAAQC,IAC7B,IAACX,SAED0c,EAAWhX,KAAI,EAAGd,MAAKnC,YACtBxC,EAAAA,EAAAA,GAACo3B,GAA+B,CAAWtiB,MAAOnQ,EAAKyF,KAAM5H,EAAOkQ,WAAYA,GAA1C/N,iBAQhD,EC3JGwzB,GAAiCA,EAC5CryB,WACAsyB,wBAKA,MAAM,MAAEh5B,IAAUC,EAAAA,EAAAA,MACXqT,EAAYqD,IAAiBpX,EAAAA,EAAAA,UAAuC,WAErE05B,EAAavyB,EAAS0W,OACtB8b,EAAcxyB,EAAS4W,QACvB6b,GAAaT,EAAAA,EAAAA,IAAuBhyB,GACpC0yB,EAAuBJ,EAAkB7yB,OAAS,EAClDkzB,EAAgBF,EAAWhzB,OAAS,EAEpC+W,GAAYC,EAAAA,EAAAA,IAAqB8b,GACjC5b,GAAaF,EAAAA,EAAAA,IAAqB+b,GAExC,OACEz4B,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHC,QAAS,OACT6B,cAAe,SACf5B,KAAM,EACNO,UAAW,EACX/F,QAASsE,EAAMqB,QAAQwM,GACvB8N,WAAY3b,EAAMqB,QAAQC,GAC1B1F,SAAU,OACV+iB,SA/B+B,KAgChC,IAAChe,SAAA,EAEFC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,MAAOC,eAAgB,WAAY6K,aAAc5N,EAAMqB,QAAQC,IAAI,IAACX,UAC9GF,EAAAA,EAAAA,IAAA,OAAKC,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ+B,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAAA,EACnDF,EAAAA,EAAAA,IAACye,EAAAA,sBAAqB,CACpB3gB,KAAK,cACL2E,YAAY,uDACZE,MAAOkQ,EACPxR,KAAK,QACLwB,SAAW6b,GAAUxI,EAAcwI,EAAM5b,OAAOH,OAAOzC,SAAA,EAEvDC,EAAAA,EAAAA,GAACwe,EAAAA,uBAAsB,CAAChc,MAAM,UAASzC,UACrCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,eAInB5U,EAAAA,EAAAA,GAACwe,EAAAA,uBAAsB,CAAChc,MAAM,OAAMzC,UAClCC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,eAKrB5U,EAAAA,EAAAA,GAAC+f,GAAoB,SAGxB0Y,IAAiBz4B,EAAAA,EAAAA,GAAC23B,GAA8C,CAAC1yB,KAAMa,KACxE9F,EAAAA,EAAAA,GAAC4b,GAAoC,CACnCE,YAAU,EACVhH,OACE9U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,WAInB9U,KAAGM,EAAAA,EAAAA,IAAE,CAAE4M,aAAcwrB,EAAuB,EAAIp5B,EAAMqB,QAAQwM,IAAI,IAClE4O,WAAW,iBAAgB9b,UAE3BC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAC3Euc,EAAU7W,KAAI,EAAGd,MAAKnC,SAAS6K,KAC9BrN,EAAAA,EAAAA,GAACo3B,GAA+B,CAAoBtiB,MAAOnQ,EAAKyF,KAAM5H,EAAOkQ,WAAYA,GAAnD/N,GAAO0I,SAIlDmrB,GACCJ,EAAkB3yB,KAAKR,IACrBjF,EAAAA,EAAAA,GAACi4B,GAAyC,CAAgBhzB,KAAMA,EAAMyN,WAAYA,GAAlCzN,EAAKN,QAEzD3E,EAAAA,EAAAA,GAAC4b,GAAoC,CACnCE,YAAU,EACVhH,OACE9U,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,YAInBiH,WAAW,kBAAiB9b,UAE5BC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEC,QAAS,OAAQ6B,cAAe,SAAUE,IAAKhD,EAAMqB,QAAQC,IAAI,IAACX,SAC3E0c,EAAWhX,KAAI,EAAGd,MAAKnC,SAAS6K,KAC/BrN,EAAAA,EAAAA,GAACo3B,GAA+B,CAAoBtiB,MAAOnQ,EAAKyF,KAAM5H,EAAOkQ,WAAYA,GAAnD/N,GAAO0I,WAI/C,EC/FJqrB,GAAmBzzB,IAA8B,IAADgkB,EAGpD,QAAKhkB,EAAKyE,WAKR,CACE8f,EAAAA,GAAcmP,MACdnP,EAAAA,GAAcoP,UACdpP,EAAAA,GAAcqP,WACdrP,EAAAA,GAAcsP,KACdtP,EAAAA,GAAcuP,KACdhmB,SAAkB,QAAVkW,EAAChkB,EAAKuD,YAAI,IAAAygB,EAAAA,EAAIO,EAAAA,GAAcC,WAAYN,EAAAA,EAAAA,IAAsBlkB,GAAQ,EAAC,EAIxE+zB,GAAgCA,EAAGjyB,iBAC9C,MAAM,MAAE3H,IAAUC,EAAAA,EAAAA,MACXpB,EAAWC,IAAgBS,EAAAA,EAAAA,UAAS,MACrC,SAAEmH,EAAQ,QAAEC,EAAO,uBAAEY,EAAsB,wBAAEF,GAA4BG,IAEzEqyB,GAAiB7xB,EAAAA,EAAAA,UAAQ,IAAMwP,OAAOC,OAAO9Q,GAASgG,SAAS9G,GAASA,EAAKyC,eAAc,CAAC3B,IAE5FqyB,GAAoBhxB,EAAAA,EAAAA,UAAQ,KAChC,IAAKtB,EACH,MAAO,GAST,OAHcjC,EAAyB,CAACiC,IACRmG,OAAOysB,GAEf,GACvB,CAAC5yB,IAEJ,OAAKA,EAeEa,GAA0BF,GAC/BzG,EAAAA,EAAAA,GAACivB,EAA+B,CAC9BjxB,aAAc,IACdC,UAAWA,EACXC,aAAcA,EACdC,WAAW6B,EAAAA,EAAAA,GAACm4B,GAA8B,CAACryB,SAAUA,EAAUsyB,kBAAmBA,IAClF/5B,YAAY2B,EAAAA,EAAAA,GAAC6tB,GAAe,CAACnmB,YAAauxB,EAAgBrW,QAAS9c,EAAS8c,QAAS0K,kBAAcnnB,IACnG/H,aD/DiC,ICgEjCE,cAAe2hB,MAGjBjgB,EAAAA,EAAAA,GAACm4B,GAA8B,CAACryB,SAAUA,EAAUsyB,kBAAmBA,KAxBrEp4B,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEoX,UAAWpY,EAAMqB,QAAQqrB,IAAI,IAAC/rB,UACxCC,EAAAA,EAAAA,GAACyX,EAAAA,MAAK,CACJC,aACE1X,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,+BAqB1B,EChEyF,IAAAlX,GAAA,CAAAC,KAAA,UAAAC,OAAA,kEAAAC,GAAA,CAAAF,KAAA,UAAAC,OAAA,uHAAAE,GAAA,CAAAH,KAAA,SAAAC,OAAA,0DAAA+X,GAAA,CAAAhY,KAAA,SAAAC,OAAA,0DAE5F,MAAMs7B,GAAyBA,EAC7BnyB,aACA0I,YACA4lB,iBACAC,mBAOA,MAAM,MAAEl2B,IAAUC,EAAAA,EAAAA,KACZ85B,GAAoBC,EAAAA,EAAAA,OACpB,WAAEpzB,EAAU,cAAEC,GAAkBW,IAEtC,OAAKuyB,GAcHt5B,EAAAA,EAAAA,IAACivB,EAAAA,KAAKzY,KAAI,CACR/T,YAAY,uBACZE,MAAOwD,EACP2Q,cAAgBnU,GAAUyD,EAAczD,GACxC1C,IAAGjC,GASDkC,SAAA,EAEFF,EAAAA,EAAAA,IAACivB,EAAAA,KAAKE,KAAI,CAAClvB,KAAGM,EAAAA,EAAAA,IAAE,CAAE+N,YAAa/O,EAAMqB,QAAQwM,GAAIsN,WAAY,GAAG,IAACxa,SAAA,EAC/DC,EAAAA,EAAAA,GAAC8uB,EAAAA,KAAKxY,QAAO,CAAC9T,MAAM,UAASzC,UAC3BC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,eAInB5U,EAAAA,EAAAA,GAAC8uB,EAAAA,KAAKxY,QAAO,CAAC9T,MAAM,SAAQzC,UAC1BC,EAAAA,EAAAA,GAAC2U,EAAAA,EAAgB,CAAA9D,GAAA,SACf+D,eAAe,6BAKrB5U,EAAAA,EAAAA,GAAC8uB,EAAAA,KAAKrY,QAAO,CACXjU,MAAM,UACN1C,IAAGhC,GAKDiC,UAEFC,EAAAA,EAAAA,GAACg5B,GAA6B,CAACjyB,WAAYA,OAE7C/G,EAAAA,EAAAA,GAAC8uB,EAAAA,KAAKrY,QAAO,CACXjU,MAAM,SACN1C,IAAG6V,GAKD5V,UAEFC,EAAAA,EAAAA,GAACo1B,GAA4B,CAC3BruB,WAAYA,EACZ0I,UAAWA,EACX4lB,eAAgBA,EAChBC,aAAcA,UAjElBt1B,EAAAA,EAAAA,GAAA,OAAKF,IAAGpC,GAAmFqC,UACzFC,EAAAA,EAAAA,GAACo1B,GAA4B,CAC3BruB,WAAYA,EACZ0I,UAAWA,EACX4lB,eAAgBA,EAChBC,aAAcA,KA+DR,EAIV+D,GAAmBA,EACvBC,sBACAv5B,eAOEC,EAAAA,EAAAA,GAACsiB,GAA6B1a,SAAQ,CAACpF,MAAO82B,EAAoBv5B,SAC/DA,IAKMw5B,GAAqBA,EAChCxyB,WAAYyyB,EACZ/pB,YACAzI,oBAAoB,UACpBquB,iBACAC,mBAQA,MAAOvuB,EAAYsvB,IAAiB13B,EAAAA,EAAAA,UAAS66B,IACtC7yB,EAAwB2vB,IAA6B33B,EAAAA,EAAAA,WAAS,GAC/DikB,GAAU6W,EAAAA,EAAAA,IAAgBD,IAC1B,QAAEE,GAAYtD,GAAuB,CACzCxT,UACAyT,gBACAC,8BAEIgD,GAAsBlyB,EAAAA,EAAAA,UAAQ,MAASmb,iBAAkBmX,KAAY,CAACA,IAS5E,OAPA7lB,EAAAA,EAAAA,YAAU,KACRwiB,EAAcmD,GACdE,GAAS,GAGR,CAAC9W,KAGF5iB,EAAAA,EAAAA,GAACq5B,GAAgB,CAACzW,QAASA,EAAS0W,oBAAqBA,EAAoBv5B,UAC3EC,EAAAA,EAAAA,GAAC8G,EAAmC,CAClCC,WAAYA,EACZC,kBAAmBA,EACnBC,uBAAwBouB,EACxB1uB,uBAAwBA,EAAuB5G,UAE/CC,EAAAA,EAAAA,GAACk5B,GAAsB,CACrBnyB,WAAYA,EACZ0I,UAAWA,EACX4lB,eAAgBA,EAChBC,aAAcA,OAGD,EAIvBiE,GAAmBI,SV1KuBC,EAAGC,YAC3C,MAAM,MAAEz6B,IAAUC,EAAAA,EAAAA,KAClB,OACEQ,EAAAA,EAAAA,IAAA,OAAKC,IAAGpC,GAAsCqC,SAAA,EAC5CF,EAAAA,EAAAA,IAAA,OAAKC,IAAGjC,GAAckC,SAAA,EACpBC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEtF,QAASsE,EAAMqB,QAAQC,GAAIzD,aAAc,aAAamC,EAAM0L,OAAO8B,UAAU,IAAC7M,UACxFC,EAAAA,EAAAA,GAAC85B,EAAAA,cAAa,CAACD,MAAOA,OAExBh6B,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHlF,aAAckE,EAAM0f,cAAc/R,eAClC/R,SAAU,SACVqF,QAAS,QACV,IAACN,SAAA,EAEFC,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEE,KAAM,EAAGxF,QAASsE,EAAMqB,QAAQC,GAAI2vB,YAAa,aAAajxB,EAAM0L,OAAO8B,UAAU,IAAC7M,UAChGC,EAAAA,EAAAA,GAAC+5B,EAAAA,cAAa,CAACC,MAAO,OAExBh6B,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEE,KAAM,EAAGxF,QAASsE,EAAMqB,QAAQC,IAAI,IAACX,UAC/CC,EAAAA,EAAAA,GAAC+5B,EAAAA,cAAa,CAACC,MAAO,aAI5Bh6B,EAAAA,EAAAA,GAAA,OAAKF,KAAGM,EAAAA,EAAAA,IAAE,CAAEtF,QAASsE,EAAMqB,QAAQwM,GAAImP,UAAW,OAAQ9b,KAAM,GAAG,IAACP,UAClEC,EAAAA,EAAAA,GAAC+5B,EAAAA,cAAa,CAACC,MAAO,SAEpB,C,wGWSV,MAAMC,EAAyBC,IACtBrQ,EAAAA,EAAAA,UAASqQ,KAAQ1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,SAAU1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,WAAY1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,cAGhGE,EAAoBF,IACxB,KAAKrQ,EAAAA,EAAAA,UAASqQ,GACZ,OAAO,EAIT,MAAMG,GAAcF,EAAAA,EAAAA,KAAID,EAAK,QAC7B,GAAIG,EAAa,CACf,GAAoB,kBAAhBA,EACF,OAAO7mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,YAE3B,GAAoB,gBAAhBG,EACF,OAAOjO,EAAAA,EAAAA,KAAI8N,EAAK,aAAc9N,EAAAA,EAAAA,KAAI8N,EAAK,UAEzC,GAAoB,qBAAhBG,EACF,OAAOjO,EAAAA,EAAAA,KAAI8N,EAAK,aAAc9N,EAAAA,EAAAA,KAAI8N,EAAK,UAEzC,GAAoB,oBAAhBG,EACF,OAAOjO,EAAAA,EAAAA,KAAI8N,EAAK,aAAc9N,EAAAA,EAAAA,KAAI8N,EAAK,SAE3C,CAGA,UAAI9N,EAAAA,EAAAA,KAAI8N,EAAK,YAAa,CAAC,SAAU,OAAQ,YAAa,YAAYnnB,UAASonB,EAAAA,EAAAA,KAAID,EAAK,cAC/E9N,EAAAA,EAAAA,KAAI8N,EAAK,UAGN,EAGRI,EACJhgB,IAEI9G,EAAAA,EAAAA,UAAS8G,IACJigB,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,UAAShB,KAAM,eAG9DiG,EAAAA,EAAAA,SAAQjF,IAAYA,EAAQid,MAAM0C,GAC7B,CACL3gB,KAAM,YACNmC,WAAYnB,EAAQ7U,KAAK+0B,IACvBC,EAAAA,EAAAA,IAAoB,CAClB5pB,GAAI2pB,EAAE3pB,GACN/U,SAAU,CACR6B,KAAM68B,EAAE78B,KACRid,UAAW4f,EAAE5f,gBAOhB,KAGH8f,EAA2B1gB,IAE/B,GAAqB,kBAAjBA,EAAQxR,KACV,OAAO+xB,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,QAASN,EAAQM,QAAShB,KAAM,WAGnF,GAAqB,gBAAjBU,EAAQxR,KAAwB,CAClC,IAAIgL,EAAAA,EAAAA,UAASwG,EAAQM,SACnB,OAAOigB,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,QAASN,EAAQM,QAAShB,KAAM,SAGnF,IAAIiG,EAAAA,EAAAA,SAAQvF,EAAQM,SAAU,CAE5B,MAAMqgB,EAAY3gB,EAAQM,QACvBrO,QAAQ2uB,IAAcpnB,EAAAA,EAAAA,UAASonB,KAAU/Q,EAAAA,EAAAA,UAAS+Q,IAAgC,SAAtBA,EAAapyB,OACzE/C,KAAKm1B,IAAepnB,EAAAA,EAAAA,UAASonB,GAAQ,CAAEpyB,KAAM,OAAiBkV,KAAMkd,GAASA,IAEhF,GAAID,EAAUp1B,OAAS,EACrB,OAAOg1B,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,QAASqgB,EAAWrhB,KAAM,QAE/E,CACF,CAEA,GAAqB,qBAAjBU,EAAQxR,KACV,OAAO8xB,EAAqCtgB,EAAQM,SAGtD,GAAqB,oBAAjBN,EAAQxR,KAEV,OAAO+xB,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,QAAS1H,KAAKgF,UAAUoC,EAAQM,SAAUhB,KAAM,SAInG,GAAuB,WAAnBU,EAAQuK,OACV,OAAOgW,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,QAASN,EAAQM,QAAShB,KAAM,WAGnF,GAAuB,SAAnBU,EAAQuK,OAAmB,CAC7B,IAAI/Q,EAAAA,EAAAA,UAASwG,EAAQM,SACnB,OAAOigB,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,QAASN,EAAQM,QAAShB,KAAM,SAGnF,IAAIiG,EAAAA,EAAAA,SAAQvF,EAAQM,SAAU,CAE5B,MAAMqgB,EAAY3gB,EAAQM,QACvBrO,QAAQ2uB,IAAcpnB,EAAAA,EAAAA,UAASonB,KAC/Bn1B,KAAKm1B,IAAS,CAAQpyB,KAAM,OAAiBkV,KAAMkd,MAEtD,GAAID,EAAUp1B,OAAS,EACrB,OAAOg1B,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,QAASqgB,EAAWrhB,KAAM,QAE/E,CACF,CAEA,MAAuB,cAAnBU,EAAQuK,OACH+V,EAAqCtgB,EAAQM,SAG/B,aAAnBN,EAAQuK,QAEHgW,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,QAAS1H,KAAKgF,UAAUoC,EAAQM,SAAUhB,KAAM,SAG5F,IAAI,EAGAuhB,EAA6BX,IACxC,IAAIjxB,EAAAA,EAAAA,OAAMixB,GACR,OAAO,KAIT,IAAI3a,EAAAA,EAAAA,SAAQ2a,IAAQA,EAAI30B,OAAS,GAAK20B,EAAI3C,MAAM6C,GAC9C,OAAO7xB,EAAAA,EAAAA,SAAQ2xB,EAAIz0B,IAAIi1B,IAIzB,IAAI7Q,EAAAA,EAAAA,UAASqQ,IAAQ,aAAcA,EAAK,CACtC,MAAMve,EAAYue,EAAYve,SAC9B,IAAI4D,EAAAA,EAAAA,SAAQ5D,IAAaA,EAASpW,OAAS,GAAKoW,EAAS4b,MAAM6C,GAC7D,OAAO7xB,EAAAA,EAAAA,SAAQoT,EAASlW,IAAIi1B,GAEhC,CAEA,OAAO,IAAI,EAGAI,EAA8BZ,IACzC,IAAIjxB,EAAAA,EAAAA,OAAMixB,GACR,OAAO,KAIT,IAAI3a,EAAAA,EAAAA,SAAQ2a,IAAQA,EAAI30B,OAAS,GAAK20B,EAAI3C,MAAM6C,GAC9C,OAAO7xB,EAAAA,EAAAA,SAAQ2xB,EAAIz0B,IAAIi1B,IAIzB,IAAI7Q,EAAAA,EAAAA,UAASqQ,IAAQ,YAAaA,EAAK,CACrC,MAAMlgB,GAAUugB,EAAAA,EAAAA,IAAuB,CAAEjhB,KAAM,YAAagB,QAAS4f,EAAI5f,QAAmB9R,KAAM,YAClG,OAAOwR,EAAU,CAACA,GAAW,IAC/B,CAEA,OAAO,IAAI,C,wGCrKb,MAAM+gB,EAAuBzgB,IAC3B,GAAIA,EAAQoD,KACV,MAAO,CAAElV,KAAM,OAAQkV,KAAMpD,EAAQoD,MAGvC,GAAIpD,EAAQ4H,KACV,MAAO,CAAE1Z,KAAM,OAAQkV,KAAM9K,KAAKgF,UAAU0C,EAAQ4H,OAGtD,GAAI5H,EAAQ0gB,MAAO,CACjB,MAAMC,EAAQ3gB,EAAQ0gB,MAAMzW,OAAO0W,MAC7BC,EAAS5gB,EAAQ0gB,MAAME,OAC7B,IAAI9wB,EAEJ,GAAqB,kBAAV6wB,EACT7wB,EAAO6wB,MACF,CAGL7wB,EADe+wB,OAAOC,KAAKH,GACbI,SAAS,SACzB,CAGA,MAAO,CACL7yB,KAAM,YACN8yB,UAAW,CAAEl/B,IAAK,QAHA,SAAS8+B,cAGqB9wB,KAEpD,CAGA,OAAO,IAAI,EAGPmxB,EAAsCvhB,IAC1C,IAAIV,EAAiDU,EAAQV,KAC7D,MAAMkiB,EAAqC,GACrCC,EAAmB,GACzB,IAAIrhB,EAEJ,IAAK,MAAME,KAAWN,EAAQM,QAC5B,GAAIA,EAAQohB,QAAS,CACnB,MAAMjhB,EAAWH,EAAQohB,QACnBC,EAAkC,kBAAnBlhB,EAASkhB,MAAqBlhB,EAASkhB,MAAQ/oB,KAAKgF,UAAU6C,EAASkhB,OAE5FF,EAAUt3B,MACRs2B,EAAAA,EAAAA,IAAoB,CAClB5pB,GAAI4J,EAASmhB,UACb9/B,SAAU,CACR6B,KAAM8c,EAAS9c,KACfid,UAAW+gB,KAInB,MAAO,GAAIrhB,EAAQuhB,WAAY,CAC7BzhB,EAAaE,EAAQuhB,WAAWD,UAChCtiB,EAAO,OAEP,IAAK,MAAMwiB,KAAiBxhB,EAAQuhB,WAAWvhB,QAAS,CACtD,MAAMyhB,EAAgBhB,EAAoBe,GACtCC,GACFP,EAASr3B,KAAK43B,EAElB,CACF,KAAO,CACL,MAAMA,EAAgBhB,EAAoBzgB,GACtCyhB,GACFP,EAASr3B,KAAK43B,EAElB,CAIF,IAAIC,EAAgB,GAChBR,EAASj2B,OAAS,IACpBy2B,EAAgBR,EACb/1B,KAAKm1B,GACc,SAAdA,EAAKpyB,KACAoyB,EAAKld,KACW,cAAdkd,EAAKpyB,KACP,WAAWoyB,EAAKU,UAAUl/B,OAE5B,KAER6P,QAAQyR,GAASA,EAAKnY,OAAS,IAC/BqO,KAAK,MAGV,MAAMqoB,EAAqC,CACzC3iB,KAAMA,EACNgB,QAAS0hB,GAWX,OARIP,EAAUl2B,OAAS,IACrB02B,EAAYxgB,WAAaggB,GAGvBrhB,IACF6hB,EAAY/hB,aAAeE,GAGtB6hB,CAAW,EAGdC,EAAoBhC,IACxB,KAAKrQ,EAAAA,EAAAA,UAASqQ,GACZ,OAAO,EAGT,MAAMiC,GAAU/P,EAAAA,EAAAA,KAAI8N,EAAK,UAAW1mB,EAAAA,EAAAA,UAAS0mB,EAAI5gB,OAAS,CAAC,OAAQ,YAAa,UAAUvG,SAASmnB,EAAI5gB,MACjG8iB,GAAahQ,EAAAA,EAAAA,KAAI8N,EAAK,aAAc3a,EAAAA,EAAAA,SAAQ2a,EAAI5f,SAEtD,OAAO6hB,GAAWC,CAAU,EAGjBC,EAA6BnC,IACxC,IAAIjxB,EAAAA,EAAAA,OAAMixB,GACR,OAAO,KAIT,IAAIrQ,EAAAA,EAAAA,UAASqQ,IAAQ,aAAcA,EAAK,CACtC,MAAMve,EAAYue,EAAYve,SAC9B,IAAI4D,EAAAA,EAAAA,SAAQ5D,IAAaA,EAASpW,OAAS,GAAKoW,EAAS4b,MAAM2E,GAC7D,OAAO3zB,EAAAA,EAAAA,SAAQoT,EAASlW,IAAI81B,GAEhC,CAEA,OAAO,IAAI,EAGAe,EAA8BpC,IACzC,IAAIjxB,EAAAA,EAAAA,OAAMixB,GACR,OAAO,KAIT,IAAIrQ,EAAAA,EAAAA,UAASqQ,IAAQ,WAAYA,EAAK,CACpC,MAAMqC,EAAUrC,EAAYqC,OAC5B,IAAI1S,EAAAA,EAAAA,UAAS0S,IAAW,YAAaA,EAAQ,CAC3C,MAAMviB,EAAUuiB,EAAOviB,QACvB,GAAIkiB,EAAiBliB,GACnB,MAAO,CAACuhB,EAAmCvhB,GAE/C,CACF,CAEA,OAAO,IAAI,C,sBC+Bb,IA5M6B,CAC3B,2BAA4B,CAC1B/f,UAAW,OACXC,WAAY,MACZC,YAAa,SACbC,UAAW,SACXoiC,SAAU,SACV3hC,MAAO,kBACPD,WAAY,UACZf,WAAY,mEACZC,SAAU,OACVC,WAAY,QACZM,WAAY,IACZC,SAAU,IACVC,QAAS,IACTC,cAAe,OACfC,WAAY,OACZC,UAAW,OACXC,QAAS,QAEX,0BAA2B,CACzBV,UAAW,OACXC,WAAY,MACZC,YAAa,SACbC,UAAW,SACXoiC,SAAU,SACV3hC,MAAO,kBACPD,WAAY,UACZf,WAAY,mEACZC,SAAU,OACVC,WAAY,QACZM,WAAY,IACZC,SAAU,IACVC,QAAS,IACTC,cAAe,OACfC,WAAY,OACZC,UAAW,OACXC,QAAS,OACTK,SAAU,OACVwF,SAAU,WACVzF,OAAQ,UACRD,QAAS,cAEX,2CAA4C,CAC1CF,WAAY,UACZC,MAAO,WAET,0CAA2C,CACzCD,WAAY,UACZC,MAAO,WAET,4CAA6C,CAC3CD,WAAY,UACZC,MAAO,WAET,2CAA4C,CAC1CD,WAAY,UACZC,MAAO,WAET,sCAAuC,CACrCD,WAAY,UACZC,MAAO,WAET,qCAAsC,CACpCD,WAAY,UACZC,MAAO,WAET,uCAAwC,CACtCD,WAAY,UACZC,MAAO,WAET,sCAAuC,CACrCD,WAAY,UACZC,MAAO,WAET,uCAAwC,CACtCX,WAAY,SACZgB,aAAc,QACdJ,QAAS,SAEX,uBAAwB,CACtBD,MAAO,WAET,wBAAyB,CACvBA,MAAO,WAET,wBAAyB,CACvBA,MAAO,WAET,kCAAmC,CACjCY,QAAS,OAEXkB,OAAQ,CACN9B,MAAO,WAET,YAAa,CACXA,MAAO,WAET,aAAc,CACZA,MAAO,WAET4kB,UAAW,CACT5kB,MAAO,WAETmB,QAAS,CACPnB,MAAO,WAET4hC,QAAS,CACP5hC,MAAO,WAETS,MAAO,CACLT,MAAO,WAET6hC,KAAM,CACJ7hC,MAAO,WAET8hC,MAAO,CACL9hC,MAAO,WAET,aAAc,CACZA,MAAO,WAETM,QAAS,CACPN,MAAO,WAET+hC,SAAU,CACR/hC,MAAO,WAETiC,QAAS,CACPjC,MAAO,WAETQ,QAAS,CACPR,MAAO,WAETqB,OAAQ,CACNrB,MAAO,WAETiB,SAAU,CACRjB,MAAO,WAETgiC,QAAS,CACPhiC,MAAO,WAETgW,GAAI,CACFhW,MAAO,UACPwC,WAAY,QAEdD,UAAW,CACTvC,MAAO,UACPwC,WAAY,QAEdL,SAAU,CACRnC,MAAO,WAETwB,QAAS,CACPxB,MAAO,WAETe,OAAQ,CACNf,MAAO,WAETc,SAAU,CACRd,MAAO,WAETO,OAAQ,CACNP,MAAO,WAETgB,SAAU,CACRhB,MAAO,WAET,eAAgB,CACdA,MAAO,WAET,iBAAkB,CAChBA,MAAO,WAETU,YAAa,CACXV,MAAO,mBAET6B,MAAO,CACL7B,MAAO,WAETkB,SAAU,CACRlB,MAAO,WAEToB,OAAQ,CACNpB,MAAO,WAETiiC,OAAQ,CACNjiC,MAAO,WAETa,IAAK,CACHb,MAAO,WAET2B,KAAM,CACJ3B,MAAO,WAETuB,IAAK,CACHvB,MAAO,WAETgC,SAAU,CACRhC,MAAO,W,0MC3LJ,MAAMkiC,EAA4B7C,IAA8C,IAAD8C,EACpF,IAAK9C,EACH,OAAO,KAGT,MAAMve,EAAuB,QAAfqhB,EAAG9C,EAAIve,gBAAQ,IAAAqhB,EAAAA,EAAI9C,EAAIyB,MACrC,OAAKrc,MAAMC,QAAQ5D,IAAiC,IAApBA,EAASpW,QAAiBoW,EAAS4b,MAAM0F,EAAAA,KAIlE10B,EAAAA,EAAAA,SAAQoT,EAASlW,IAAI80B,EAAAA,KAHnB,IAG2C,EAIzC2C,EAA+BhD,IACtCiD,EAAAA,EAAAA,IAAoBjD,GACfA,EAAIz0B,KAAK23B,IAAM,IAAAC,EAAA,MAAM,IACvBD,EAAOpjB,QACVyB,WAAqC,QAA3B4hB,EAAED,EAAOpjB,QAAQyB,kBAAU,IAAA4hB,OAAA,EAAzBA,EAA2B53B,IAAIg1B,EAAAA,IAC5C,KAGE6C,EAAAA,EAAAA,IAAyBpD,GAIvBA,EAAIqD,QAAQ93B,KAAK23B,IAAM,IAAAI,EAAA,MAAM,IAC/BJ,EAAOpjB,QACVyB,WAAqC,QAA3B+hB,EAAEJ,EAAOpjB,QAAQyB,kBAAU,IAAA+hB,OAAA,EAAzBA,EAA2B/3B,IAAIg1B,EAAAA,IAC5C,IANQ,KASLgD,EAAiCvD,OACjC9N,EAAAA,EAAAA,KAAI8N,EAAK,UAAW9N,EAAAA,EAAAA,KAAI8N,EAAK,YAAc,CAAC,OAAQ,YAAa,SAAU,aAAannB,SAASmnB,EAAI5gB,UAErG9F,EAAAA,EAAAA,UAAS0mB,EAAI5f,WACZiF,EAAAA,EAAAA,SAAQ2a,EAAI5f,UACX4f,EAAI5f,QAAQid,OACT3N,IAAkBwC,EAAAA,EAAAA,KAAIxC,EAAM,SAAW,CAAC,aAAc,cAAe,cAAc7W,SAAS6W,EAAKphB,SAY/Fk1B,EAA+BxD,IAC1C,KAAKrQ,EAAAA,EAAAA,UAASqQ,GACZ,OAAO,EAGT,GAAyB,aAArBC,EAAAA,EAAAA,KAAID,EAAK,QACX,OAAO+C,EAAAA,EAAAA,IAA2B/C,GAGpC,GAAyB,mBAArBC,EAAAA,EAAAA,KAAID,EAAK,QACX,OAAO1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,cAAe1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,WAAY1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,cAG1F,GAAyB,0BAArBC,EAAAA,EAAAA,KAAID,EAAK,QACX,OAAO1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,cAAe1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,WAG5D,GAAyB,2BAArBC,EAAAA,EAAAA,KAAID,EAAK,QAAqC,CAChD,MAAMyD,GAAexD,EAAAA,EAAAA,KAAID,EAAK,iBAC9B,OAAO1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,aAAc1mB,EAAAA,EAAAA,UAASmqB,IAAiB,CAAC,MAAO,OAAQ,QAAQ5qB,SAAS4qB,EACpG,CAEA,MAAyB,eAArBxD,EAAAA,EAAAA,KAAID,EAAK,WACJ9N,EAAAA,EAAAA,KAAI8N,EAAK,QAAS3a,EAAAA,EAAAA,UAAQ4a,EAAAA,EAAAA,KAAID,EAAK,YAGhC,EAiCR0D,EAAwC1D,IAC5C,IAAI1mB,EAAAA,EAAAA,UAAS0mB,EAAI5f,SAAU,CACzB,MAAMN,GAAUugB,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,QAAS4f,EAAI5f,QAAShB,KAAM4gB,EAAI5gB,OAC1F,OAAOU,GAAW,CAACA,EACrB,CACE,OAAOkgB,EAAI5f,QAAQ7U,KAAKmkB,GAnCciU,EACxC3D,EACA5gB,KAEA,MAAMoE,GAAOyc,EAAAA,EAAAA,KAAID,EAAK,QACtB,GAAyB,gBAArBC,EAAAA,EAAAA,KAAID,EAAK,UAA4B1mB,EAAAA,EAAAA,UAASkK,GAChD,OAAO6c,EAAAA,EAAAA,IAAuB,CAC5B/xB,KAAM,UACN8R,QAAS,CAAC,CAAE9R,KAAM,OAAQkV,SAC1BpE,KAAMA,IAIV,MAAMwkB,GAAW3D,EAAAA,EAAAA,KAAID,EAAK,aAC1B,MAAyB,iBAArBC,EAAAA,EAAAA,KAAID,EAAK,UAA6B1mB,EAAAA,EAAAA,UAASsqB,IAC1CvD,EAAAA,EAAAA,IAAuB,CAC5B/xB,KAAM,UACN8R,QAAS,CAAC,CAAE9R,KAAM,YAAa8yB,UAAW,CAAEl/B,IAAK0hC,KACjDxkB,KAAMA,IASH,IAAI,EAQwBukB,CAAkCjU,EAAMsQ,EAAI5gB,QAAOrN,QAAQ2d,GAAkB,OAATA,GACvG,EAGWmU,EAAiC7D,IAC5C,MAAMyB,GAAiBxB,EAAAA,EAAAA,KAAID,EAAK,SAEhC,IAAI1mB,EAAAA,EAAAA,UAASmoB,GAAQ,CACnB,MAAM3hB,GAAUugB,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,QAASqhB,EAAOriB,KAAM,SAChF,OAAOU,GAAW,CAACA,EACrB,CAEA,OAAIuF,EAAAA,EAAAA,SAAQoc,IAAUA,EAAMpE,MAAMkG,IACzBl1B,EAAAA,EAAAA,SAAQozB,EAAM5vB,QAAQ6xB,IAGxB,IAAI,EAGAI,EAAsC9D,GAChC,YAAbA,EAAI1xB,MACC+xB,EAAAA,EAAAA,IAAuBL,GAGf,kBAAbA,EAAI1xB,KACC,CACL8Q,KAAM,YACNmC,WAAY,EACVgf,EAAAA,EAAAA,IAAoB,CAClB5pB,GAAIqpB,EAAI+D,QACRniC,SAAU,CACR8e,UAAWsf,EAAItf,UACfjd,KAAMu8B,EAAIv8B,UAOH,yBAAbu8B,EAAI1xB,KACC,CACL8Q,KAAM,OACNY,aAAcggB,EAAI+D,QAClB3jB,QAAS4f,EAAIqC,QAIA,0BAAbrC,EAAI1xB,MACC+xB,EAAAA,EAAAA,IAAuB,CAC5B/xB,KAAM,UACN8R,QAAS,CAAC,CAAE9R,KAAM,YAAa8yB,UAAW,CAAEl/B,IAAK,cAAc89B,EAAIgE,wBAAwBhE,EAAIiE,YAC/F7kB,KAAM,UAIN4gB,EAAI1xB,KAEC,MAME41B,EAAkClE,IAC7C,IAAIjxB,EAAAA,EAAAA,OAAMixB,GACR,OAAO,KAGT,MAAMqC,GAAkBpC,EAAAA,EAAAA,KAAID,EAAK,UAGjC,OAAI3a,EAAAA,EAAAA,SAAQgd,IAAWA,EAAOh3B,OAAS,GAAKg3B,EAAOhF,MAAMmG,IAChDn1B,EAAAA,EAAAA,SAAQg0B,EAAO92B,IAAIu4B,GAAoC/xB,OAAO6G,WAKrEyM,EAAAA,EAAAA,SAAQgd,IACRA,EAAOh3B,OAAS,GAChBg3B,EAAOhF,OAAO8G,GAAyB,8BAAfA,EAAM71B,MAAwCk1B,EAA4BW,EAAMzU,SAEjGrhB,EAAAA,EAAAA,SAAQg0B,EAAO92B,KAAK44B,GAAUL,EAAmCK,EAAMzU,SAGzE,IAAI,EAKP0U,EAAwBpE,MACvBrQ,EAAAA,EAAAA,UAASqQ,SAKV9N,EAAAA,EAAAA,KAAI8N,EAAK,UAAW9N,EAAAA,EAAAA,KAAI8N,EAAK,YAAc,CAAC,OAAQ,YAAa,SAAU,QAAQnnB,SAASmnB,EAAI5gB,SAK3E,mBAArB6gB,EAAAA,EAAAA,KAAID,EAAK,SACJ1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,cAAe1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,WAAY1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,cAIjE,0BAArBC,EAAAA,EAAAA,KAAID,EAAK,WACJ1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,cAAe1mB,EAAAA,EAAAA,WAAS2mB,EAAAA,EAAAA,KAAID,EAAK,cAMxDqE,EAA+BrE,IAEnC,IAAI9N,EAAAA,EAAAA,KAAI8N,EAAK,UAAW9N,EAAAA,EAAAA,KAAI8N,EAAK,WAAY,CAE3C,IAAI3a,EAAAA,EAAAA,SAAQ2a,EAAI5f,SAAU,CACxB,MAAMkkB,EAActE,EAAI5f,QACrBrO,QAAQ2d,GAA4B,gBAAdA,EAAKphB,OAA0BgL,EAAAA,EAAAA,UAASoW,EAAKlM,QACnEjY,KAAKmkB,GAAcA,EAAKlM,OACxB9J,KAAK,KAER,GAAI4qB,EACF,OAAOjE,EAAAA,EAAAA,IAAuB,IACzBL,EACH5f,QAASkkB,GAGf,CAGA,OAAOjE,EAAAA,EAAAA,IAAuBL,EAChC,CAGA,GAAyB,mBAArBC,EAAAA,EAAAA,KAAID,EAAK,QAA6B,CACxC,MAAMuE,GAAStE,EAAAA,EAAAA,KAAID,EAAK,WAClBwE,GAAavE,EAAAA,EAAAA,KAAID,EAAK,aACtBv8B,GAAOw8B,EAAAA,EAAAA,KAAID,EAAK,QAEtB,IAAI1mB,EAAAA,EAAAA,UAASirB,KAAWjrB,EAAAA,EAAAA,UAASkrB,KAAelrB,EAAAA,EAAAA,UAAS7V,GACvD,MAAO,CACL2b,KAAM,YACNmC,WAAY,EACVgf,EAAAA,EAAAA,IAAoB,CAClB5pB,GAAI4tB,EACJ3iC,SAAU,CACR8e,UAAW8jB,EACX/gC,KAAMA,MAMlB,CAGA,GAAyB,0BAArBw8B,EAAAA,EAAAA,KAAID,EAAK,QAAoC,CAC/C,MAAMuE,GAAStE,EAAAA,EAAAA,KAAID,EAAK,WAClBqC,GAASpC,EAAAA,EAAAA,KAAID,EAAK,UAExB,IAAI1mB,EAAAA,EAAAA,UAASirB,KAAWjrB,EAAAA,EAAAA,UAAS+oB,GAC/B,MAAO,CACLjjB,KAAM,OACNY,aAAcukB,EACdnkB,QAASiiB,EAGf,CAEA,OAAO,IAAI,EAGAoC,EAA6BzE,IACpCjxB,EAAAA,EAAAA,OAAMixB,GACD,MAIL3a,EAAAA,EAAAA,SAAQ2a,IAAQA,EAAI30B,OAAS,GAAK20B,EAAI3C,MAAM+G,IACvC/1B,EAAAA,EAAAA,SAAQ2xB,EAAIz0B,IAAI84B,IAGlB,KAGIK,EAA8B1E,IACrCjxB,EAAAA,EAAAA,OAAMixB,GACD,MAIL3a,EAAAA,EAAAA,SAAQ2a,IAAQA,EAAI30B,OAAS,GAAK20B,EAAI3C,MAAM+G,IACvC/1B,EAAAA,EAAAA,SAAQ2xB,EAAIz0B,IAAI84B,IAGlB,I,wGCpTT,MAAMM,EAAgC3E,IACpC,MAAMxc,GAAOyc,EAAAA,EAAAA,KAAID,EAAK,QACtB,MAAkC,UAA3BC,EAAAA,EAAAA,KAAID,EAAK,gBAA4B1mB,EAAAA,EAAAA,UAASkK,EAAK,EAGtDohB,EAA2B9kB,IAC/B,MAAM+kB,GAAkB5E,EAAAA,EAAAA,KAAIngB,EAAS,UAC/BV,GAAgB6gB,EAAAA,EAAAA,KAAIngB,EAAS,QACnC,OACExG,EAAAA,EAAAA,UAAS8F,IACT,CAAC,YAAa,SAAU,QAAQvG,SAASuG,KACzCiG,EAAAA,EAAAA,SAAQwf,IACRA,EAAOxH,MAAMsH,EAA6B,EAaxCG,EAAsBhlB,IACnBugB,EAAAA,EAAAA,IAAuB,CAC5BjhB,KAAMU,EAAQV,KACdgB,QAASN,EAAQ+kB,OAAOt5B,KAAKgF,IAAK,CAAQjC,KAAM,OAAQkV,KAAMjT,EAAMiT,WAI3DuhB,EAAmC/E,IAC9C,IAjBgCA,IACzB4E,GAAwB3E,EAAAA,EAAAA,KAAID,EAAK,YAgBnCgF,CAAyBhF,GAC5B,OAAO,KAGT,MAAMlgB,EAAUglB,EAAmB9E,EAAIlgB,SACvC,OAAOA,GAAW,CAACA,EAAQ,EAGhBmlB,EAAgCjF,GArBdA,KAC7B,MAAMve,GAAoBwe,EAAAA,EAAAA,KAAID,EAAK,YACnC,OAAO3a,EAAAA,EAAAA,SAAQ5D,IAAaA,EAAS4b,MAAMuH,EAAwB,EAoB9DM,CAAsBlF,IAIpB3xB,EAAAA,EAAAA,SAAQ2xB,EAAIve,SAASlW,IAAIu5B,IAHvB,I,8HC7CJ,MAAMvlB,EAAyBA,EACpCjR,OAAOkR,EAAAA,GAAc2lB,QAErB3N,eAAc,EACdxI,gBAAe,EACfoW,cAAa,MAOb,MAAM,MAAElgC,IAAUC,EAAAA,EAAAA,KAGlB,IAAIkgC,EACAD,EACFC,EAAY,KACHrW,IACTqW,EAAY,UAGd,MAAMC,EAAU,CACd,CAAC9lB,EAAAA,GAAcI,SAAS9Z,EAAAA,EAAAA,GAACy/B,EAAAA,WAAU,CAAC5kC,MAAO0kC,IAC3C,CAAC7lB,EAAAA,GAAcgmB,WAAW1/B,EAAAA,EAAAA,GAAC6d,EAAAA,iBAAgB,CAAChjB,MAAO0kC,IACnD,CAAC7lB,EAAAA,GAAc2lB,UAAUr/B,EAAAA,EAAAA,GAAC2/B,EAAAA,YAAW,CAAC9kC,MAAO0kC,IAC7C,CAAC7lB,EAAAA,GAAckmB,OAAO5/B,EAAAA,EAAAA,GAACgrB,EAAAA,SAAQ,CAACnwB,MAAO0kC,IACvC,CAAC7lB,EAAAA,GAAcmmB,WAAW7/B,EAAAA,EAAAA,GAAC2a,EAAAA,aAAY,CAAC9f,MAAO0kC,IAC/C,CAAC7lB,EAAAA,GAAcomB,UAAU9/B,EAAAA,EAAAA,GAAC+/B,EAAAA,YAAW,CAACllC,MAAO0kC,IAC7C,CAAC7lB,EAAAA,GAAcsmB,SAAShgC,EAAAA,EAAAA,GAAC8C,EAAAA,EAAU,CAACjI,MAAO0kC,IAC3C,CAAC7lB,EAAAA,GAAcumB,OAAOjgC,EAAAA,EAAAA,GAACkgC,EAAAA,iBAAgB,CAACrlC,MAAO0kC,IAC/C,CAAC7lB,EAAAA,GAAc+P,UAAUzpB,EAAAA,EAAAA,GAACmgC,EAAAA,iBAAgB,CAACtlC,MAAO0kC,IAClD,CAAC7lB,EAAAA,GAAcG,SAAS7Z,EAAAA,EAAAA,GAACogC,EAAAA,WAAU,CAACvlC,MAAO0kC,IAC3C,CAAC7lB,EAAAA,GAAcif,QAAQ34B,EAAAA,EAAAA,GAACqgC,EAAAA,gBAAe,CAACxlC,MAAO0kC,IAC/C,CAAC7lB,EAAAA,GAAc4mB,QAAQtgC,EAAAA,EAAAA,GAACugC,EAAAA,UAAS,CAAC1lC,MAAO0kC,IACzC,CAAC7lB,EAAAA,GAAcE,OAAO5Z,EAAAA,EAAAA,GAAC8qB,EAAAA,SAAQ,CAACjwB,MAAO0kC,IACvC,CAAC7lB,EAAAA,GAAcC,SAAS3Z,EAAAA,EAAAA,GAACwgC,EAAAA,SAAQ,CAAC3lC,MAAO0kC,KAO3C,IAAI1kC,EAAgBuE,EAAM0L,OAAO21B,yBAC7BC,EAAuBthC,EAAM0L,OAAO61B,kBACpC7/B,EAA0B1B,EAAM0L,OAAOE,oBAC3C,OAAQxC,GACN,KAAKkR,EAAAA,GAAcsmB,OACjBnlC,EAAQuE,EAAM0L,OAAO81B,sBACrBF,EAAethC,EAAM0L,OAAO+1B,SAC5B//B,EAAkB1B,EAAMiR,WAAajR,EAAM0L,OAAOg2B,SAAW1hC,EAAM0L,OAAOi2B,SAC1E,MACF,KAAKrnB,EAAAA,GAAcI,OACjBjf,EAAQuE,EAAMiR,WAAajR,EAAM0L,OAAO4f,QAAUtrB,EAAM0L,OAAOk2B,UAC/DN,EAAethC,EAAMiR,WAAajR,EAAM0L,OAAOk2B,UAAY5hC,EAAM0L,OAAO4f,QACxE5pB,EAAkB1B,EAAMiR,WAAajR,EAAM0L,OAAOm2B,QAAU7hC,EAAM0L,OAAOo2B,QACzE,MACF,KAAKxnB,EAAAA,GAAcG,OACjBhf,EAAQuE,EAAMiR,WAAajR,EAAM0L,OAAOq2B,OAAS/hC,EAAM0L,OAAOs2B,OAC9DV,EAAethC,EAAMiR,WAAajR,EAAM0L,OAAOs2B,OAAShiC,EAAM0L,OAAOq2B,OACrErgC,EAAkB1B,EAAMiR,WAAajR,EAAM0L,OAAOu2B,OAASjiC,EAAM0L,OAAOw2B,OAI5E,OACEzhC,EAAAA,EAAAA,IAAA,OACEC,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACVxB,MAAOI,EAAMmiC,QAAQC,SACrBt0B,OAAQ9N,EAAMmiC,QAAQC,SACtBnhC,QAAS,OACT4C,WAAY,SACZd,eAAgB,SAChBjH,aAAckE,EAAM0N,QAAQoJ,eAC5Btb,WAAY82B,EAActyB,EAAM0L,OAAO22B,yBAA2B3gC,EAClEjG,MAAO62B,EAAcgP,EAAe7lC,EACpC6mC,IAAK,CAAE1iC,MAAOI,EAAMmiC,QAAQI,aAAcz0B,OAAQ9N,EAAMmiC,QAAQI,cAChEpnB,WAAY,GACb,IAACxa,SAAA,CAEDmpB,IACClpB,EAAAA,EAAAA,GAAA,OACEF,KAAGM,EAAAA,EAAAA,IAAE,CACHI,SAAU,WACVgN,KAAMpO,EAAMqB,QAAQG,GACpBuT,OAAQ/U,EAAMqB,QAAQG,GACtBsM,OAAQ9N,EAAMqB,QAAQC,GACtB1B,MAAOI,EAAMqB,QAAQC,GACrBxF,aAAckE,EAAM0N,QAAQoJ,eAC5BpV,gBAAiB1B,EAAM0L,OAAO+U,qCAC9B9e,OAAQ,GACT,MAGJy+B,EAAQh3B,KACL,C,gYC5BV,MAAMo5B,EAAgC1H,IACpC,IAAIjxB,EAAAA,EAAAA,OAAMixB,GACR,OAAO,EAGT,IAAI9N,EAAAA,EAAAA,KAAI8N,EAAK,QAAS,CACpB,GAAiB,SAAbA,EAAI1xB,OAAmB4jB,EAAAA,EAAAA,KAAI8N,EAAK,UAAW1mB,EAAAA,EAAAA,UAAS0mB,EAAIxc,MAC1D,OAAO,EAGT,GAAiB,UAAbwc,EAAI1xB,OAAoB4jB,EAAAA,EAAAA,KAAI8N,EAAK,YAAa9N,EAAAA,EAAAA,KAAI8N,EAAI3V,OAAQ,QAAS,CACzE,GACsB,WAApB2V,EAAI3V,OAAO/b,OACX4jB,EAAAA,EAAAA,KAAI8N,EAAI3V,OAAQ,gBAChB/Q,EAAAA,EAAAA,UAAS0mB,EAAI3V,OAAOsd,aACpB,CAAC,aAAc,YAAa,YAAa,cAAc9uB,SAASmnB,EAAI3V,OAAOsd,cAC3EzV,EAAAA,EAAAA,KAAI8N,EAAI3V,OAAQ,UAChB/Q,EAAAA,EAAAA,UAAS0mB,EAAI3V,OAAOna,MAEpB,OAAO,EAGT,GAAwB,QAApB8vB,EAAI3V,OAAO/b,OAAkB4jB,EAAAA,EAAAA,KAAI8N,EAAI3V,OAAQ,SAAU/Q,EAAAA,EAAAA,UAAS0mB,EAAI3V,OAAOnoB,KAC7E,OAAO,CAEX,CAEA,GAAiB,aAAb89B,EAAI1xB,OAAuB4jB,EAAAA,EAAAA,KAAI8N,EAAK,QAAS9N,EAAAA,EAAAA,KAAI8N,EAAK,UAAW9N,EAAAA,EAAAA,KAAI8N,EAAK,SAC5E,OAAO1mB,EAAAA,EAAAA,UAAS0mB,EAAIrpB,MAAO2C,EAAAA,EAAAA,UAAS0mB,EAAIv8B,QAASksB,EAAAA,EAAAA,UAASqQ,EAAIyB,OAGhE,GAAiB,gBAAbzB,EAAI1xB,OAA0B4jB,EAAAA,EAAAA,KAAI8N,EAAK,iBAAkB9N,EAAAA,EAAAA,KAAI8N,EAAK,WACpE,OAAO1mB,EAAAA,EAAAA,UAAS0mB,EAAI4H,eAAgBtuB,EAAAA,EAAAA,UAAS0mB,EAAI5f,QAErD,CACA,OAAO,CAAK,EAGRynB,EAA2B7H,IAC/B,KAAKrQ,EAAAA,EAAAA,UAASqQ,GACZ,OAAO,EAGT,MAAMiC,GAAU/P,EAAAA,EAAAA,KAAI8N,EAAK,UAAW1mB,EAAAA,EAAAA,UAAS0mB,EAAI5gB,OAAS,CAAC,OAAQ,aAAavG,SAASmnB,EAAI5gB,MACvF8iB,EACJ,YAAalC,KACZ1mB,EAAAA,EAAAA,UAAS0mB,EAAI5f,WAAaiF,EAAAA,EAAAA,SAAQ2a,EAAI5f,UAAY4f,EAAI5f,QAAQid,MAAMqK,IAEvE,OAAOzF,GAAWC,CAAU,EAGxB4F,EAAuCpY,IAC3C,OAAQA,EAAKphB,MACX,IAAK,OACH,MAAO,CAAEA,KAAM,OAAQkV,KAAMkM,EAAKlM,MAEpC,IAAK,QACH,OAAQkM,EAAKrF,OAAO/b,MAClB,IAAK,SACH,MAAO,CACLA,KAAM,YACN8yB,UAAW,CAAEl/B,IAAK,QAAQwtB,EAAKrF,OAAOsd,qBAAqBjY,EAAKrF,OAAOna,SAG3E,IAAK,MACH,MAAO,CAAE5B,KAAM,YAAa8yB,UAAW,CAAEl/B,IAAKwtB,EAAKrF,OAAOnoB,OAKlE,MAAM,IAAI6nB,MAAM,mCAAoC2F,EAAaphB,OAAO,EAqCpEy5B,EAA2BjoB,IAC/B,MAAM2B,EAAoC,GAE1C,GAA+B,kBAApB3B,EAAQM,QAAsB,CACvC,MAAM2hB,GAAc1B,EAAAA,EAAAA,IAAuB,CACzC/xB,KAAM,UACN8R,QAASN,EAAQM,QACjBhB,KAAMU,EAAQV,OAEZ2iB,GAAatgB,EAASxX,KAAK83B,EACjC,KAAO,CACL,MAAQtgB,SAAUumB,EAAY,UAAEvH,EAAS,UAAEc,GA5C7CnhB,KAMA,MAAMqB,EAAoC,GACpCgf,EAAsC,GACtCc,EAAmB,GAEzB,IAAK,MAAM7R,KAAQtP,EACC,SAAdsP,EAAKphB,MAAiC,UAAdohB,EAAKphB,KAC/BmyB,EAAUx2B,KAAK69B,EAAoCpY,IAC5B,aAAdA,EAAKphB,KACdizB,EAAUt3B,KAAK,CACb0M,GAAI+Y,EAAK/Y,GACT/U,SAAU,CACR6B,KAAMisB,EAAKjsB,KACXid,UAAWhI,KAAKgF,UAAUgS,EAAK+R,UAGZ,gBAAd/R,EAAKphB,MACdmT,EAASxX,KAAK,CACZmV,KAAM,OACNY,aAAc0P,EAAKkY,YACnBxnB,QAASsP,EAAKtP,UAKpB,MAAO,CAAEqB,WAAUgf,YAAWc,YAAW,EAckB0G,CAA+BnoB,EAAQM,SAGhG,GAFAqB,EAASxX,QAAQ+9B,GAEbvH,EAAUp1B,OAAS,GAAKk2B,EAAUl2B,OAAS,EAAG,CAChD,MAAM02B,GAAc1B,EAAAA,EAAAA,IAAuB,CACzC/xB,KAAM,UACN8R,QAASqgB,EAAUp1B,OAAS,EAAIo1B,OAAYx0B,EAC5CmT,KAAMU,EAAQV,QACVmiB,EAAUl2B,OAAS,GAAK,CAAEkW,WAAYggB,KAExCQ,GAAatgB,EAASxX,KAAK83B,EACjC,CACF,CAEA,OAAOtgB,CAAQ,EAGJymB,EAA+BlI,IAC1C,KAAKrQ,EAAAA,EAAAA,UAASqQ,GACZ,OAAO,KAGT,GAAI,aAAcA,IAAO3a,EAAAA,EAAAA,SAAQ2a,EAAIve,WAAaue,EAAIve,SAAS4b,MAAMwK,GAA0B,CAC7F,MAAMpmB,EAAoC,GAE1C,IAAK,MAAM3B,KAAWkgB,EAAIve,SACxBA,EAASxX,QAAQ89B,EAAwBjoB,IAG3C,OAAO2B,CACT,CAEA,OAAO,IAAI,EAGA0mB,EAAgCnI,IACtCrQ,EAAAA,EAAAA,UAASqQ,KAIV9N,EAAAA,EAAAA,KAAI8N,EAAK,SAAwB,YAAbA,EAAI1xB,MAAsBu5B,EAAwB7H,GACjE+H,EAAwB/H,GAJxB,KCxJLoI,EAAuBpI,IACpBrQ,EAAAA,EAAAA,UAASqQ,IAAQ,SAAUA,IAAO1mB,EAAAA,EAAAA,UAAS0mB,EAAIxc,MAGlD6kB,EAAmBrI,IAErBrQ,EAAAA,EAAAA,UAASqQ,IACT,SAAUA,IACV1mB,EAAAA,EAAAA,UAAS0mB,EAAI5gB,OACb,CAAC,OAAQ,SAASvG,SAASmnB,EAAI5gB,QAC/B8S,EAAAA,EAAAA,KAAI8N,EAAK,UACT5a,MAAMC,QAAQ2a,EAAIsI,QAClBtI,EAAIsI,MAAMjL,MAAM+K,GAIdG,EAAqBvI,IAClBrQ,EAAAA,EAAAA,UAASqQ,IAAQ,YAAaA,GAAOqI,EAAgBrI,EAAI5f,SAGrDooB,EAA4BxI,IACvC,KAAKrQ,EAAAA,EAAAA,UAASqQ,GACZ,OAAO,KAGT,GAAI,aAAcA,EAAK,CACrB,IAAI1mB,EAAAA,EAAAA,UAAS0mB,EAAIsB,UAAW,CAC1B,MAAMxhB,GAAUugB,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,QAAS4f,EAAIsB,SAAUliB,KAAM,SACvF,OAAOU,GAAW,CAACA,EACrB,CAEA,IAAIuF,EAAAA,EAAAA,SAAQ2a,EAAIsB,WAAatB,EAAIsB,SAASjE,MAAMgL,GAC9C,OAAOh6B,EAAAA,EAAAA,SACL2xB,EAAIsB,SAAS/1B,KAAKmkB,IAChB,MAAMtQ,EAAqB,UAAdsQ,EAAKtQ,KAAmB,YAAcsQ,EAAKtQ,KACxD,OAAOihB,EAAAA,EAAAA,IAAuB,CAC5B/xB,KAAM,UACN8R,QAASsP,EAAK4Y,MAAM/8B,KAAKm1B,IAAI,CAAQpyB,KAAM,OAAQkV,KAAMkd,EAAKld,SAC9DpE,QACA,IAIV,CAEA,OAAO,IAAI,EAGAqpB,EAA6BzI,IACnCrQ,EAAAA,EAAAA,UAASqQ,IAIV,eAAgBA,IAAO3a,EAAAA,EAAAA,SAAQ2a,EAAI0I,aAAe1I,EAAI0I,WAAWrL,MAAMkL,IAClEl6B,EAAAA,EAAAA,SACL2xB,EAAI0I,WACD72B,SAAS6d,GAASA,EAAKtP,UACvB7U,KAAKmkB,IACJ,MAAMtQ,EAAqB,UAAdsQ,EAAKtQ,KAAmB,YAAcsQ,EAAKtQ,KACxD,OAAOihB,EAAAA,EAAAA,IAAuB,CAC5B/xB,KAAM,UACN8R,QAASsP,EAAK4Y,MAAM/8B,KAAKm1B,IAAI,CAAQpyB,KAAM,OAAQkV,KAAMkd,EAAKld,SAC9DpE,QACA,KAbD,K,eCvGJ,MAAMupB,EAAuC7oB,IAAiE,IAAD8oB,EAClH,IAAIxpB,EAwBAgB,EAvBJ,OAAQN,EAAQxR,MACd,IAAK,OACL,IAAK,QACH8Q,EAAO,OACP,MACF,IAAK,YACL,IAAK,KACHA,EAAO,YACP,MACF,IAAK,SACHA,EAAO,SACP,MACF,IAAK,OACHA,EAAO,OACP,MACF,IAAK,WACHA,EAAO,WACP,MACF,QACE,OAAO,KAKX,IAAI9F,EAAAA,EAAAA,UAASwG,EAAQM,SACnBA,EAAUN,EAAQM,aACb,GAAIgF,MAAMC,QAAQvF,EAAQM,SAAU,CAiBzCA,EAfqBN,EAAQM,QAC1B7U,KAAKm1B,IAAe,IAADmI,EAClB,OAAIvvB,EAAAA,EAAAA,UAASonB,GACJA,EACgB,SAAdA,EAAKpyB,MAAmBoyB,EAAKld,KAC/Bkd,EAAKld,KACW,cAAdkd,EAAKpyB,MAAsC,QAAlBu6B,EAAInI,EAAKU,iBAAS,IAAAyH,GAAdA,EAAgB3mC,IAE/C,OAAOw+B,EAAKU,UAAUl/B,OAExB,EAAE,IAEV6P,OAAO6G,SAGac,KAAK,OAC9B,MACE0G,OAAUnU,EAGZ,MAAM68B,EAA2C,CAC/C1oB,UACAhB,QAGImiB,EAAYzhB,EAAQyB,WACpBwnB,EAA+C,QAA5BH,EAAG9oB,EAAQkpB,yBAAiB,IAAAJ,OAAA,EAAzBA,EAA2BrnB,WA0BvD,QArBGxS,EAAAA,EAAAA,OAAMwyB,IACPnc,MAAMC,QAAQkc,IACdA,EAAUl2B,OAAS,GACnBk2B,EAAUlE,MAAM4L,GAIhBH,EAAkBvnB,YAAalT,EAAAA,EAAAA,SAAQkzB,EAAUh2B,IAAI29B,MAEpDn6B,EAAAA,EAAAA,OAAMg6B,IACP3jB,MAAMC,QAAQ0jB,IACdA,EAAoB19B,OAAS,GAC7B09B,EAAoB1L,MAAM8L,EAAAA,MAE1BL,EAAkBvnB,WAAawnB,EAAoBx9B,IAAIg1B,EAAAA,MAGpDxxB,EAAAA,EAAAA,OAAM+Q,EAAQE,gBACjB8oB,EAAkB9oB,aAAeF,EAAQE,cAGpC8oB,CAAiB,EAGbI,EAA8B3oB,IAClC,CACL5J,GAAI4J,EAAS5J,GACb/U,SAAU,CACR8e,UAAWhI,KAAKgF,UAAU6C,EAAS6oB,KAAM,KAAM,GAC/C3lC,KAAM8c,EAAS9c,QAKR4lC,EAA0BrJ,KAChCA,QAKAjxB,EAAAA,EAAAA,OAAMixB,EAAI5f,WAAa9G,EAAAA,EAAAA,UAAS0mB,EAAI5f,UAAagF,MAAMC,QAAQ2a,EAAI5f,WAKjE,CAAC,QAAS,OAAQ,YAAa,KAAM,SAAU,OAAQ,YAAYvH,SAASmnB,EAAI1xB,OAG5E26B,EAA8BjJ,GAClCA,IAAO1mB,EAAAA,EAAAA,UAAS0mB,EAAIv8B,QAASyuB,EAAAA,EAAAA,KAAI8N,EAAK,UAAW1mB,EAAAA,EAAAA,UAAS0mB,EAAIrpB,IAG1D2yB,EAA6BtJ,GACjCA,GAAOqJ,EAAuBrJ,EAAIlgB,SAI9BypB,EAA+BvJ,IAE1C,GACE5a,MAAMC,QAAQ2a,IACC,IAAfA,EAAI30B,QACJ+Z,MAAMC,QAAQ2a,EAAI,KAClBA,EAAI,GAAG30B,OAAS,GAChB20B,EAAI,GAAG3C,MAAMgM,GACb,CACA,MAAM5nB,EAAWue,EAAI,GAAGz0B,IAAIo9B,GAE5B,OAAIlnB,EAAS/N,MAAMoM,GAAwB,OAAZA,IACtB,KAGF2B,CACT,CAGA,GAAI2D,MAAMC,QAAW,OAAH2a,QAAG,IAAHA,OAAG,EAAHA,EAAKve,WAAaue,EAAIve,SAASpW,OAAS,GAAK20B,EAAIve,SAAS4b,MAAMgM,GAAyB,CACzG,MAAM5nB,EAAWue,EAAIve,SAASlW,IAAIo9B,GAElC,OAAIlnB,EAAS/N,MAAMoM,GAAwD,OAAZA,IACtD,KAGF2B,CACT,CAGA,GAAI2D,MAAMC,QAAQ2a,IAAQA,EAAI30B,OAAS,GAAK20B,EAAI3C,MAAMgM,GAAyB,CAC7E,MAAM5nB,EAAWue,EAAIz0B,IAAIo9B,GAEzB,OAAIlnB,EAAS/N,MAAMoM,GAAwB,OAAZA,IACtB,KAGF2B,CACT,CAEA,OAAO,IAAI,EAgBP+nB,EACJC,IAEA,MAAMhoB,EAAWgoB,EAAYl+B,KAAKm+B,GAChCf,EAAoCe,EAAW5pB,WAGjD,OAAI2B,EAAS/N,MAAMoM,GAAwB,OAAZA,IACtB,KAGF2B,CAAQ,EAIJkoB,EAAgC3J,GA5BTA,OAC7B5a,MAAMC,QAAQ2a,IAAQA,EAAI30B,OAAS,OAInC+Z,MAAMC,QAAQ2a,EAAI,KAAOA,EAAI,GAAG30B,OAAS,IAKvC20B,EAAI,GAAG3C,MAAMiM,GAmBhBM,CAA2B5J,GACtBwJ,EAAwCxJ,EAAI,IAIlD5a,MAAMC,QAAW,OAAH2a,QAAG,IAAHA,OAAG,EAAHA,EAAKyJ,cAClBzJ,EAAIyJ,YAAYp+B,OAAS,GAC1B20B,EAAIyJ,YAAY,GAAGpM,MAAMiM,GAKrBE,EAAwCxJ,EAAIyJ,YAAY,IAHtD,K,eCxOJ,MAAMI,EAA0B7J,IAErC,IAAI9N,EAAAA,EAAAA,KAAI8N,EAAK,cAAe3a,EAAAA,EAAAA,SAAS2a,EAAYve,UAAW,CAE1D,OADkBue,EAAYve,SAE3BlW,KAAKu+B,IAAazJ,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,QAAS0pB,EAAI1pB,QAAShB,KAAM0qB,EAAI1qB,SAC5FrN,OAAO6G,QACZ,CAEA,OAAO,IAAI,EAGAmxB,EAA2B/J,IAEtC,IAAI3a,EAAAA,EAAAA,SAAQ2a,IAAQA,EAAI30B,OAAS,GAAK20B,EAAI3C,MAAM/jB,EAAAA,UAAW,CAEzD,MAAM8G,EAAU4f,EAAItmB,KAAK,MACnBoG,GAAUugB,EAAAA,EAAAA,IAAuB,CAAE/xB,KAAM,UAAW8R,UAAShB,KAAM,cACzE,OAAOU,GAAW,CAACA,EACrB,CAEA,OAAO,IAAI,C","sources":["shared/web-shared/snippet/theme/databricks-duotone-dark.ts","shared/web-shared/model-trace-explorer/ModelTraceExplorerResizablePane.tsx","shared/web-shared/model-trace-explorer/ModelTraceExplorerSearchBox.tsx","shared/web-shared/model-trace-explorer/timeline-tree/TimelineTree.utils.ts","shared/web-shared/model-trace-explorer/ModelTraceExplorerViewStateContext.tsx","shared/web-shared/model-trace-explorer/hooks/useModelTraceSearch.tsx","shared/web-shared/model-trace-explorer/constants.ts","shared/web-shared/model-trace-explorer/ModelTraceExplorerHighlightedCodeSnippet.tsx","shared/web-shared/genai-markdown-renderer/TableRenderer.tsx","shared/web-shared/genai-markdown-renderer/GenAIMarkdownRenderer.tsx","shared/web-shared/model-trace-explorer/ModelTraceExplorerCodeSnippetBody.tsx","shared/web-shared/model-trace-explorer/ModelTraceExplorerHighlightedSnippetTitle.tsx","shared/web-shared/model-trace-explorer/ModelTraceExplorerCodeSnippet.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerAttributesTab.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerChatToolParam.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerChatTool.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerChatMessageHeader.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerToolCallMessage.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerChatMessage.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerChatRenderer.utils.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerConversation.tsx","shared/web-shared/model-trace-explorer/ModelTraceExplorerCollapsibleSection.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerChatTab.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerDefaultSpanView.tsx","shared/web-shared/model-trace-explorer/key-value-tag/KeyValueTag.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerRetrieverDocumentFull.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerRetrieverDocumentPreview.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerRetrieverDocument.tsx","shared/web-shared/model-trace-explorer/ModelTraceExplorerRenderModeToggle.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerRetrieverSpanView.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerContentTab.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerEventsTab.tsx","shared/web-shared/model-trace-explorer/ModelTraceExplorerBadge.tsx","shared/web-shared/model-trace-explorer/assessments-pane/AssessmentPaneToggle.tsx","shared/web-shared/model-trace-explorer/assessments-pane/AssessmentsPane.utils.tsx","shared/web-shared/model-trace-explorer/ModelTraceExplorer.request.utils.tsx","shared/web-shared/model-trace-explorer/api.ts","shared/web-shared/model-trace-explorer/trace-context/ModelTraceInfoRefetchContext.tsx","shared/web-shared/model-trace-explorer/assessments-pane/AssessmentCreateForm.tsx","shared/web-shared/model-trace-explorer/assessments-pane/AssessmentCreateButton.tsx","shared/web-shared/model-trace-explorer/assessments-pane/AssessmentActionsOverflowMenu.tsx","shared/web-shared/model-trace-explorer/assessments-pane/AssessmentDeleteModal.tsx","shared/web-shared/model-trace-explorer/hooks/useUpdateAssessment.tsx","shared/web-shared/model-trace-explorer/assessments-pane/AssessmentEditForm.tsx","shared/web-shared/model-trace-explorer/hooks/useOverrideAssessment.tsx","shared/web-shared/model-trace-explorer/assessments-pane/ExpectationValuePreview.tsx","shared/web-shared/model-trace-explorer/assessments-pane/SpanNameDetailViewLink.tsx","shared/web-shared/model-trace-explorer/assessments-pane/ExpectationItem.tsx","shared/web-shared/model-trace-explorer/assessments-pane/AssessmentDisplayValue.tsx","shared/web-shared/model-trace-explorer/assessments-pane/AssessmentSourceName.tsx","shared/web-shared/model-trace-explorer/assessments-pane/AssessmentItemHeader.tsx","shared/web-shared/model-trace-explorer/assessments-pane/FeedbackErrorItem.tsx","shared/web-shared/model-trace-explorer/assessments-pane/FeedbackHistoryItem.tsx","shared/web-shared/model-trace-explorer/assessments-pane/FeedbackHistoryModal.tsx","shared/web-shared/model-trace-explorer/assessments-pane/FeedbackItemContent.tsx","shared/web-shared/model-trace-explorer/assessments-pane/FeedbackItem.tsx","shared/web-shared/model-trace-explorer/assessments-pane/FeedbackValueGroupSourceCounts.tsx","shared/web-shared/model-trace-explorer/assessments-pane/FeedbackValueGroup.tsx","shared/web-shared/model-trace-explorer/assessments-pane/FeedbackGroup.tsx","shared/web-shared/model-trace-explorer/assessments-pane/AssessmentsPane.tsx","shared/web-shared/model-trace-explorer/right-pane/ModelTraceExplorerRightPaneTabs.tsx","shared/web-shared/model-trace-explorer/timeline-tree/TimelineTreeFilterButton.tsx","shared/web-shared/model-trace-explorer/timeline-tree/TimelineTreeHeader.tsx","shared/web-shared/model-trace-explorer/timeline-tree/TimelineTreeHierarchyBars.tsx","shared/web-shared/model-trace-explorer/timeline-tree/TimelineTreeSpanTooltip.tsx","shared/web-shared/model-trace-explorer/timeline-tree/TimelineTreeNode.tsx","shared/web-shared/model-trace-explorer/timeline-tree/gantt/TimelineTreeGanttNode.tsx","shared/web-shared/model-trace-explorer/timeline-tree/gantt/TimelineTreeGanttBars.tsx","shared/web-shared/model-trace-explorer/timeline-tree/TimelineTree.tsx","shared/web-shared/model-trace-explorer/ModelTraceExplorerDetailView.tsx","shared/web-shared/model-trace-explorer/ModelTraceExplorerSkeleton.tsx","shared/web-shared/model-trace-explorer/hooks/useGetModelTraceInfoV3.tsx","shared/web-shared/model-trace-explorer/field-renderers/ModelTraceExplorerChatToolsRenderer.tsx","shared/web-shared/model-trace-explorer/field-renderers/ModelTraceExplorerRetrieverFieldRenderer.tsx","shared/web-shared/model-trace-explorer/field-renderers/ModelTraceExplorerTextFieldRenderer.tsx","shared/web-shared/model-trace-explorer/field-renderers/ModelTraceExplorerFieldRenderer.tsx","shared/web-shared/model-trace-explorer/summary-view/ModelTraceExplorerSummaryViewExceptionsSection.tsx","shared/web-shared/model-trace-explorer/summary-view/ModelTraceExplorerSummaryIntermediateNode.tsx","shared/web-shared/model-trace-explorer/summary-view/ModelTraceExplorerSummarySpans.tsx","shared/web-shared/model-trace-explorer/summary-view/ModelTraceExplorerSummaryView.tsx","shared/web-shared/model-trace-explorer/ModelTraceExplorer.tsx","shared/web-shared/model-trace-explorer/chat-utils/autogen.ts","shared/web-shared/model-trace-explorer/chat-utils/bedrock.ts","shared/web-shared/snippet/theme/databricks-light.ts","shared/web-shared/model-trace-explorer/chat-utils/openai.ts","shared/web-shared/model-trace-explorer/chat-utils/llamaindex.ts","shared/web-shared/model-trace-explorer/ModelTraceExplorerIcon.tsx","shared/web-shared/model-trace-explorer/chat-utils/anthropic.ts","shared/web-shared/model-trace-explorer/chat-utils/gemini.ts","shared/web-shared/model-trace-explorer/chat-utils/langchain.ts","shared/web-shared/model-trace-explorer/chat-utils/dspy.ts"],"sourcesContent":["/**\n * Adapted from `duotone-dark`\n * Ref: https://github.com/react-syntax-highlighter/react-syntax-highlighter/blob/b2457268891948f7005ccf539a70c000f0695bde/src/styles/prism/duotone-dark.js\n */\n\nconst databricksDuotoneDarkTheme = {\n  'code[class*=\"language-\"]': {\n    fontFamily:\n      'Consolas, Menlo, Monaco, \"Andale Mono WT\", \"Andale Mono\", \"Lucida Console\", \"Lucida Sans Typewriter\", \"DejaVu Sans Mono\", \"Bitstream Vera Sans Mono\", \"Liberation Mono\", \"Nimbus Mono L\", \"Courier New\", Courier, monospace',\n    fontSize: '14px',\n    lineHeight: '1.375',\n    direction: 'ltr',\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n    background: '#2a2734',\n    color: '#5DFAFC', // D\n  },\n  'pre[class*=\"language-\"]': {\n    fontFamily:\n      'Consolas, Menlo, Monaco, \"Andale Mono WT\", \"Andale Mono\", \"Lucida Console\", \"Lucida Sans Typewriter\", \"DejaVu Sans Mono\", \"Bitstream Vera Sans Mono\", \"Liberation Mono\", \"Nimbus Mono L\", \"Courier New\", Courier, monospace',\n    fontSize: '14px',\n    lineHeight: '1.375',\n    direction: 'ltr',\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n    background: '#2a2734',\n    color: '#5DFAFC', // D\n    padding: '1em',\n    margin: '.5em 0',\n    overflow: 'auto',\n  },\n  'pre > code[class*=\"language-\"]': {\n    fontSize: '1em',\n  },\n  'pre[class*=\"language-\"]::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'pre[class*=\"language-\"] ::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"]::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"] ::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'pre[class*=\"language-\"]::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'pre[class*=\"language-\"] ::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"]::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"] ::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  ':not(pre) > code[class*=\"language-\"]': {\n    padding: '.1em',\n    borderRadius: '.3em',\n  },\n  comment: {\n    color: '#6c6783',\n  },\n  prolog: {\n    color: '#6c6783',\n  },\n  doctype: {\n    color: '#6c6783',\n  },\n  cdata: {\n    color: '#6c6783',\n  },\n  punctuation: {\n    color: '#6c6783',\n  },\n  namespace: {\n    Opacity: '.7',\n  },\n  tag: {\n    color: '#3AACE2', // D\n  },\n  operator: {\n    color: '#3AACE2', // D\n  },\n  number: {\n    color: '#3AACE2', // D\n  },\n  property: {\n    color: '#5DFAFC', // D\n  },\n  function: {\n    color: '#5DFAFC', // D\n  },\n  'tag-id': {\n    color: '#eeebff',\n  },\n  selector: {\n    color: '#eeebff',\n  },\n  'atrule-id': {\n    color: '#eeebff',\n  },\n  'code.language-javascript': {\n    color: '#c4b9fe',\n  },\n  'attr-name': {\n    color: '#c4b9fe',\n  },\n  'code.language-css': {\n    color: '#ffffff', // D\n  },\n  'code.language-scss': {\n    color: '#ffffff', // D\n  },\n  boolean: {\n    color: '#ffffff', // D\n  },\n  string: {\n    color: '#ffffff', // D\n  },\n  entity: {\n    color: '#ffffff', // D\n    cursor: 'help',\n  },\n  url: {\n    color: '#ffffff', // D\n  },\n  '.language-css .token.string': {\n    color: '#ffffff', // D\n  },\n  '.language-scss .token.string': {\n    color: '#ffffff', // D\n  },\n  '.style .token.string': {\n    color: '#ffffff', // D\n  },\n  'attr-value': {\n    color: '#ffffff', // D\n  },\n  keyword: {\n    color: '#ffffff', // D\n  },\n  control: {\n    color: '#ffffff', // D\n  },\n  directive: {\n    color: '#ffffff', // D\n  },\n  unit: {\n    color: '#ffffff', // D\n  },\n  statement: {\n    color: '#ffffff', // D\n  },\n  regex: {\n    color: '#ffffff', // D\n  },\n  atrule: {\n    color: '#ffffff', // D\n  },\n  placeholder: {\n    color: '#ffffff', // D\n  },\n  variable: {\n    color: '#ffffff', // D\n  },\n  deleted: {\n    textDecoration: 'line-through',\n  },\n  inserted: {\n    borderBottom: '1px dotted #eeebff',\n    textDecoration: 'none',\n  },\n  italic: {\n    fontStyle: 'italic',\n  },\n  important: {\n    fontWeight: 'bold',\n    color: '#c4b9fe',\n  },\n  bold: {\n    fontWeight: 'bold',\n  },\n  'pre > code.highlight': {\n    Outline: '.4em solid #8a75f5',\n    OutlineOffset: '.4em',\n  },\n  '.line-numbers.line-numbers .line-numbers-rows': {\n    borderRightColor: '#2c2937',\n  },\n  '.line-numbers .line-numbers-rows > span:before': {\n    color: '#3c3949',\n  },\n  '.line-highlight.line-highlight': {\n    background: 'linear-gradient(to right, rgba(224, 145, 66, 0.2) 70%, rgba(224, 145, 66, 0))',\n  },\n};\n\nexport default databricksDuotoneDarkTheme;\n","import { Global } from '@emotion/react';\nimport { clamp } from 'lodash';\nimport React, { forwardRef, useCallback, useImperativeHandle, useLayoutEffect, useRef, useState } from 'react';\nimport { ResizableBox } from 'react-resizable';\n\nimport { useDesignSystemTheme } from '@databricks/design-system';\n\nimport { useResizeObserver } from '../hooks';\n\ninterface ModelTraceExplorerResizablePaneProps {\n  initialRatio: number;\n  paneWidth: number;\n  setPaneWidth: (paneWidth: number) => void;\n  leftChild: React.ReactNode;\n  leftMinWidth: number;\n  rightChild: React.ReactNode;\n  rightMinWidth: number;\n}\n\nexport interface ModelTraceExplorerResizablePaneRef {\n  updateRatio: (newPaneWidth: number) => void;\n}\n\n/**\n * This component takes a left and right child, and adds\n * a draggable handle between them to resize. It handles\n * logic such as preserving the ratio of the pane width\n * when the container/window is resized, and also ensures\n * that the left and right panes conform to specified min\n * widths.\n */\nconst ModelTraceExplorerResizablePane = forwardRef<\n  ModelTraceExplorerResizablePaneRef,\n  ModelTraceExplorerResizablePaneProps\n>(({ initialRatio, paneWidth, setPaneWidth, leftChild, leftMinWidth, rightChild, rightMinWidth }, ref) => {\n  const [isResizing, setIsResizing] = useState(false);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const containerWidth = useResizeObserver({ ref: containerRef })?.width;\n  // if container width is not available, don't set a max width\n  const maxWidth = (containerWidth ?? Infinity) - rightMinWidth;\n\n  const ratio = useRef(initialRatio);\n  const { theme } = useDesignSystemTheme();\n\n  const updateRatio = useCallback(\n    // used by the parent component to update the ratio when\n    // the pane is resized via the show/hide gantt button\n    (newPaneWidth: number) => {\n      if (containerWidth) {\n        ratio.current = newPaneWidth / containerWidth;\n      }\n    },\n    [containerWidth],\n  );\n\n  useImperativeHandle(ref, () => ({\n    updateRatio,\n  }));\n\n  useLayoutEffect(() => {\n    // preserve the ratio of the pane width when the container is resized\n    if (containerWidth) {\n      setPaneWidth(clamp(containerWidth * ratio.current, leftMinWidth, maxWidth));\n    }\n  }, [containerWidth, maxWidth, leftMinWidth, rightMinWidth, setPaneWidth]);\n\n  return (\n    <div\n      ref={containerRef}\n      css={{\n        display: 'flex',\n        flex: 1,\n        overflow: 'hidden',\n        flexDirection: 'row',\n      }}\n    >\n      {isResizing && (\n        <Global\n          styles={{\n            'body, :host': {\n              userSelect: 'none',\n            },\n          }}\n        />\n      )}\n      <ResizableBox\n        axis=\"x\"\n        width={paneWidth}\n        css={{ display: 'flex', flex: `0 0 ${paneWidth}px` }}\n        handle={\n          <div css={{ width: 0, position: 'relative' }}>\n            <div\n              css={{\n                position: 'relative',\n                width: theme.spacing.sm,\n                marginLeft: -theme.spacing.xs,\n                minHeight: '100%',\n                cursor: 'ew-resize',\n                backgroundColor: `rgba(0,0,0,0)`,\n                zIndex: 1,\n                ':hover': {\n                  backgroundColor: `rgba(0,0,0,0.1)`,\n                },\n              }}\n            />\n          </div>\n        }\n        onResize={(e, { size }) => {\n          const clampedSize = clamp(size.width, leftMinWidth, maxWidth);\n          setPaneWidth(clampedSize);\n          if (containerWidth) {\n            ratio.current = clampedSize / containerWidth;\n          }\n        }}\n        onResizeStart={() => setIsResizing(true)}\n        onResizeStop={() => setIsResizing(false)}\n        minConstraints={[leftMinWidth, Infinity]}\n        maxConstraints={[maxWidth, Infinity]}\n      >\n        {leftChild}\n      </ResizableBox>\n      {rightChild}\n    </div>\n  );\n});\n\nexport default ModelTraceExplorerResizablePane;\n","import React, { useState } from 'react';\nimport { useDebouncedCallback } from 'use-debounce';\n\nimport {\n  Button,\n  ChevronDownIcon,\n  ChevronUpIcon,\n  Input,\n  SearchIcon,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\n\nimport type { SearchMatch } from './ModelTrace.types';\n\nconst ModelTraceExplorerSearchBox = ({\n  searchFilter,\n  setSearchFilter,\n  matchData,\n  handleNextSearchMatch,\n  handlePreviousSearchMatch,\n}: {\n  searchFilter: string;\n  setSearchFilter: (searchFilter: string) => void;\n  matchData: {\n    match: SearchMatch | null;\n    totalMatches: number;\n    currentMatchIndex: number;\n  };\n  handleNextSearchMatch: () => void;\n  handlePreviousSearchMatch: () => void;\n}) => {\n  const [searchValue, setSearchValue] = useState(searchFilter);\n  const debouncedSetSearchFilter = useDebouncedCallback(setSearchFilter, 350);\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'space-between',\n        gap: theme.spacing.sm,\n      }}\n    >\n      <Input\n        componentId=\"shared.model-trace-explorer.search-input\"\n        allowClear\n        placeholder=\"Search\"\n        value={searchValue}\n        onClear={() => {\n          setSearchFilter('');\n          setSearchValue('');\n        }}\n        onChange={(e) => {\n          setSearchValue(e.target.value);\n          debouncedSetSearchFilter(e.target.value.toLowerCase());\n        }}\n        prefix={<SearchIcon />}\n        css={{\n          width: '100%',\n          boxSizing: 'border-box',\n        }}\n      />\n      {matchData.match && (\n        <div\n          css={{\n            display: 'flex',\n            flexDirection: 'row',\n            marginLeft: theme.spacing.xs,\n            marginRight: theme.spacing.sm,\n            alignItems: 'center',\n          }}\n        >\n          <Typography.Text css={{ whiteSpace: 'nowrap', marginRight: theme.spacing.sm }}>\n            {matchData.currentMatchIndex + 1} / {matchData.totalMatches}\n          </Typography.Text>\n          <Button\n            data-testid=\"prev-search-match\"\n            icon={<ChevronUpIcon />}\n            onClick={handlePreviousSearchMatch}\n            componentId=\"shared.model-trace-explorer.prev-search-match\"\n          />\n          <Button\n            data-testid=\"next-search-match\"\n            icon={<ChevronDownIcon />}\n            onClick={handleNextSearchMatch}\n            componentId=\"shared.model-trace-explorer.next-search-match\"\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ModelTraceExplorerSearchBox;\n","import { values } from 'lodash';\nimport { useState } from 'react';\n\nimport type { TimelineTreeNode } from './TimelineTree.types';\nimport type { ModelTraceSpanNode } from '../ModelTrace.types';\n\n// expand all nodes by default\nexport const DEFAULT_EXPAND_DEPTH = Infinity;\nexport const SPAN_INDENT_WIDTH = 16;\nexport const SPAN_ROW_HEIGHT = 32;\nexport const TimelineTreeZIndex = {\n  HIGH: 5,\n  NORMAL: 3,\n  LOW: 1,\n};\n\n// Gets the min and max start and end times of the tree\nexport const getTimelineTreeSpanConstraints = (\n  nodes: TimelineTreeNode[],\n  constraints = { min: Number.MAX_SAFE_INTEGER, max: 0 },\n) => {\n  nodes.forEach((node) => {\n    const { start, end, children } = node;\n    if (start < constraints.min) {\n      constraints.min = start;\n    }\n    if (end > constraints.max) {\n      constraints.max = end;\n    }\n    getTimelineTreeSpanConstraints(children ?? [], constraints);\n  });\n\n  return constraints;\n};\n\n// Gets a flat list of all expanded nodes in the tree\nexport const getTimelineTreeExpandedNodesList = <T extends TimelineTreeNode & { children?: T[] }>(\n  nodes: T[],\n  expandedKeys: Set<string | number>,\n) => {\n  const expandedNodesFlat: T[] = [];\n  const traverseExpanded = (traversedNode: T | undefined) => {\n    if (!traversedNode) {\n      return;\n    }\n    expandedNodesFlat.push(traversedNode);\n    if (expandedKeys.has(traversedNode.key)) {\n      traversedNode.children?.forEach(traverseExpanded);\n    }\n  };\n\n  nodes.forEach(traverseExpanded);\n  return expandedNodesFlat;\n};\n\n// Gets a flat list of all nodes in the tree (regardless of expansion status)\nexport const getTimelineTreeNodesList = <T extends TimelineTreeNode & { children?: T[] }>(nodes: T[]) => {\n  const expandedNodesFlat: T[] = [];\n  const traverseExpanded = (traversedNode: T | undefined) => {\n    if (!traversedNode) {\n      return;\n    }\n    expandedNodesFlat.push(traversedNode);\n    traversedNode.children?.forEach(traverseExpanded);\n  };\n\n  nodes.forEach(traverseExpanded);\n  return expandedNodesFlat;\n};\n\nexport const getTimelineTreeNodesMap = <T extends TimelineTreeNode & { children?: T[] }>(\n  nodes: T[],\n  expandDepth = Infinity,\n) => {\n  const nodesMap: { [nodeId: string]: T } = {};\n\n  const traverse = (traversedNode: T | undefined, depth: number) => {\n    if (!traversedNode || depth > expandDepth) {\n      return;\n    }\n    nodesMap[traversedNode.key] = traversedNode;\n    traversedNode.children?.forEach((child: T) => traverse(child, depth + 1));\n  };\n\n  nodes.forEach(traverse, 0);\n  return nodesMap;\n};\n\nexport const useTimelineTreeExpandedNodes = <T extends ModelTraceSpanNode & { children?: T[] }>(\n  params: {\n    rootNodes?: T[];\n    // nodes beyond this depth will be collapsed\n    initialExpandDepth?: number;\n  } = {},\n) => {\n  const [expandedKeys, setExpandedKeys] = useState<Set<string | number>>(() => {\n    if (params.rootNodes) {\n      const list = values(getTimelineTreeNodesMap(params.rootNodes, params.initialExpandDepth)).map((node) => node.key);\n      return new Set(list);\n    }\n    return new Set();\n  });\n\n  return {\n    expandedKeys,\n    setExpandedKeys,\n  };\n};\n\nexport const useTimelineTreeSelectedNode = () => {\n  const [selectedNode, setSelectedNode] = useState<ModelTraceSpanNode | undefined>(undefined);\n\n  return {\n    selectedNode,\n    setSelectedNode,\n  };\n};\n\nexport const spanTimeFormatter = (executionTimeUs: number) => {\n  // Convert to different units based on the time scale\n  if (executionTimeUs === 0) {\n    return '0s';\n  } else if (executionTimeUs >= 60 * 1e6) {\n    // More than or equal to 1 minute\n    const executionTimeMin = executionTimeUs / 1e6 / 60;\n    return `${executionTimeMin.toFixed(2)}m`;\n  } else if (executionTimeUs >= 1e5) {\n    // More than or equal to 0.1 second. this\n    // is to avoid showing 3-digit ms numbers\n    const executionTimeSec = executionTimeUs / 1e6;\n    return `${executionTimeSec.toFixed(2)}s`;\n  } else {\n    // Less than 0.1 second (milliseconds)\n    const executionTimeMs = executionTimeUs / 1e3;\n    return `${executionTimeMs.toFixed(2)}ms`;\n  }\n};\n\nexport const getActiveChildIndex = (node: ModelTraceSpanNode, activeNodeId: string): number => {\n  if (node.key === activeNodeId) {\n    return 0;\n  }\n\n  return (node.children ?? []).findIndex((child) => getActiveChildIndex(child, activeNodeId) > -1);\n};\n\nexport const getModelTraceSpanNodeDepth = (node: ModelTraceSpanNode): number => {\n  if (!node.children || node.children?.length === 0) {\n    return 0;\n  }\n\n  const childDepths = node.children.map(getModelTraceSpanNodeDepth);\n  return Math.max(...childDepths) + 1;\n};\n\nexport const getSpanNodeParentIds = (node: ModelTraceSpanNode, nodeMap: { [nodeId: string]: ModelTraceSpanNode }) => {\n  const parents = new Set<string | number>();\n\n  let currentNode = node;\n  while (currentNode && currentNode.parentId) {\n    parents.add(currentNode.parentId);\n    currentNode = nodeMap[currentNode.parentId];\n  }\n\n  return parents;\n};\n","import { createContext, useContext, useMemo, useState } from 'react';\n\nimport type { ModelTrace, ModelTraceExplorerTab, ModelTraceSpanNode } from './ModelTrace.types';\nimport { parseModelTraceToTree, searchTreeBySpanId } from './ModelTraceExplorer.utils';\nimport { getTimelineTreeNodesMap } from './timeline-tree/TimelineTree.utils';\n\nexport type ModelTraceExplorerViewState = {\n  rootNode: ModelTraceSpanNode | null;\n  nodeMap: Record<string, ModelTraceSpanNode>;\n  activeView: 'summary' | 'detail';\n  setActiveView: (view: 'summary' | 'detail') => void;\n  selectedNode: ModelTraceSpanNode | undefined;\n  setSelectedNode: (node: ModelTraceSpanNode | undefined) => void;\n  activeTab: ModelTraceExplorerTab;\n  setActiveTab: (tab: ModelTraceExplorerTab) => void;\n  showTimelineTreeGantt: boolean;\n  setShowTimelineTreeGantt: (show: boolean) => void;\n  assessmentsPaneExpanded: boolean;\n  setAssessmentsPaneExpanded: (expanded: boolean) => void;\n  assessmentsPaneEnabled: boolean;\n};\n\nexport const ModelTraceExplorerViewStateContext = createContext<ModelTraceExplorerViewState>({\n  rootNode: null,\n  nodeMap: {},\n  activeView: 'summary',\n  setActiveView: () => {},\n  selectedNode: undefined,\n  setSelectedNode: () => {},\n  activeTab: 'content',\n  setActiveTab: () => {},\n  showTimelineTreeGantt: false,\n  setShowTimelineTreeGantt: () => {},\n  assessmentsPaneExpanded: false,\n  setAssessmentsPaneExpanded: () => {},\n  assessmentsPaneEnabled: true,\n});\n\nexport const useModelTraceExplorerViewState = () => {\n  return useContext(ModelTraceExplorerViewStateContext);\n};\n\nexport const ModelTraceExplorerViewStateProvider = ({\n  modelTrace,\n  initialActiveView,\n  selectedSpanIdOnRender,\n  // assessments pane is disabled if\n  // the trace doesn't exist in the backend\n  // (i.e. if the traceinfo fetch fails)\n  assessmentsPaneEnabled,\n  children,\n}: {\n  modelTrace: ModelTrace;\n  initialActiveView: 'summary' | 'detail';\n  selectedSpanIdOnRender?: string;\n  children: React.ReactNode;\n  assessmentsPaneEnabled: boolean;\n}) => {\n  const rootNode = useMemo(() => parseModelTraceToTree(modelTrace), [modelTrace]);\n  const nodeMap = useMemo(() => (rootNode ? getTimelineTreeNodesMap([rootNode]) : {}), [rootNode]);\n  const selectedSpanOnRender = searchTreeBySpanId(rootNode, selectedSpanIdOnRender);\n  const defaultSelectedNode = selectedSpanOnRender ?? rootNode ?? undefined;\n  const hasAssessments = (defaultSelectedNode?.assessments?.length ?? 0) > 0;\n\n  const [activeView, setActiveView] = useState<'summary' | 'detail'>(initialActiveView);\n  const [selectedNode, setSelectedNode] = useState<ModelTraceSpanNode | undefined>(defaultSelectedNode);\n  const [activeTab, setActiveTab] = useState<ModelTraceExplorerTab>(selectedNode?.chatMessages ? 'chat' : 'content');\n  const [showTimelineTreeGantt, setShowTimelineTreeGantt] = useState(false);\n  const [assessmentsPaneExpanded, setAssessmentsPaneExpanded] = useState(hasAssessments);\n\n  const value = useMemo(\n    () => ({\n      rootNode,\n      nodeMap,\n      activeView,\n      setActiveView,\n      activeTab,\n      setActiveTab,\n      selectedNode,\n      setSelectedNode,\n      showTimelineTreeGantt,\n      setShowTimelineTreeGantt,\n      assessmentsPaneExpanded,\n      setAssessmentsPaneExpanded,\n      assessmentsPaneEnabled,\n    }),\n    [\n      activeView,\n      nodeMap,\n      activeTab,\n      rootNode,\n      selectedNode,\n      showTimelineTreeGantt,\n      setShowTimelineTreeGantt,\n      assessmentsPaneExpanded,\n      setAssessmentsPaneExpanded,\n      assessmentsPaneEnabled,\n    ],\n  );\n\n  return (\n    <ModelTraceExplorerViewStateContext.Provider value={value}>{children}</ModelTraceExplorerViewStateContext.Provider>\n  );\n};\n","import { compact, isNil } from 'lodash';\nimport { useCallback, useLayoutEffect, useMemo, useState } from 'react';\n\nimport type {\n  ModelTraceExplorerTab,\n  ModelTraceSpanNode,\n  SearchMatch,\n  SpanFilterState,\n  ModelTrace,\n} from '../ModelTrace.types';\nimport { searchTree } from '../ModelTraceExplorer.utils';\nimport {\n  getSpanNodeParentIds,\n  getTimelineTreeNodesList,\n  getTimelineTreeNodesMap,\n} from '../timeline-tree/TimelineTree.utils';\n\nconst getDefaultSpanFilterState = (treeNode: ModelTraceSpanNode | null): SpanFilterState => {\n  const spanTypeDisplayState: Record<string, boolean> = {};\n\n  // populate the spanTypeDisplayState with\n  // all span types that exist on the trace\n  if (treeNode) {\n    const allSpanTypes = compact(getTimelineTreeNodesList<ModelTraceSpanNode>([treeNode]).map((node) => node.type));\n    allSpanTypes.forEach((spanType) => {\n      spanTypeDisplayState[spanType] = true;\n    });\n  }\n\n  return {\n    showParents: true,\n    showExceptions: true,\n    spanTypeDisplayState,\n  };\n};\n\nconst getTabForMatch = (match: SearchMatch): ModelTraceExplorerTab => {\n  switch (match.section) {\n    case 'inputs':\n    case 'outputs':\n      return 'content';\n    case 'attributes':\n      return 'attributes';\n    case 'events':\n      return 'events';\n    default:\n      // shouldn't happen\n      return 'content';\n  }\n};\n\nexport const useModelTraceSearch = ({\n  treeNode,\n  selectedNode,\n  setSelectedNode,\n  setActiveTab,\n  setExpandedKeys,\n  modelTraceInfo,\n}: {\n  treeNode: ModelTraceSpanNode | null;\n  selectedNode: ModelTraceSpanNode | undefined;\n  setSelectedNode: (node: ModelTraceSpanNode) => void;\n  setActiveTab: (tab: ModelTraceExplorerTab) => void;\n  setExpandedKeys: React.Dispatch<React.SetStateAction<Set<string | number>>>;\n  modelTraceInfo: ModelTrace['info'] | null;\n}): {\n  searchFilter: string;\n  setSearchFilter: (filter: string) => void;\n  spanFilterState: SpanFilterState;\n  setSpanFilterState: (state: SpanFilterState) => void;\n  filteredTreeNodes: ModelTraceSpanNode[];\n  matchData: {\n    match: SearchMatch | null;\n    totalMatches: number;\n    currentMatchIndex: number;\n  };\n  handleNextSearchMatch: () => void;\n  handlePreviousSearchMatch: () => void;\n} => {\n  const [searchFilter, setSearchFilter] = useState<string>('');\n  const [spanFilterState, setSpanFilterState] = useState<SpanFilterState>(() => getDefaultSpanFilterState(treeNode));\n  const [activeMatchIndex, setActiveMatchIndex] = useState(0);\n  const { filteredTreeNodes, matches } = useMemo(() => {\n    if (isNil(treeNode)) {\n      return {\n        filteredTreeNodes: [],\n        matches: [],\n      };\n    }\n\n    return searchTree(treeNode, searchFilter, spanFilterState);\n    // use the span ID to determine whether the state should be recomputed.\n    // using the whole object seems to cause the state to be reset at\n    // unexpected times.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [treeNode?.key, searchFilter, spanFilterState, modelTraceInfo]);\n\n  const nodeMap = useMemo(() => {\n    return getTimelineTreeNodesMap(filteredTreeNodes);\n  }, [filteredTreeNodes]);\n\n  const selectMatch = useCallback(\n    (newMatchIndex: number) => {\n      if (newMatchIndex >= matches.length || newMatchIndex < 0) {\n        return;\n      }\n      setActiveMatchIndex(newMatchIndex);\n      const match = matches[newMatchIndex];\n      setSelectedNode(match.span);\n      setActiveTab(getTabForMatch(match));\n      // Make sure parents are expanded\n      const parents = getSpanNodeParentIds(match.span, nodeMap);\n      setExpandedKeys((expandedKeys) => {\n        // set.union seems to not be available in all environments\n        return new Set([...expandedKeys, ...parents]);\n      });\n    },\n    [matches, setSelectedNode, setActiveTab, nodeMap, setExpandedKeys],\n  );\n\n  const handleNextSearchMatch = useCallback(() => {\n    selectMatch(activeMatchIndex + 1);\n  }, [activeMatchIndex, selectMatch]);\n\n  const handlePreviousSearchMatch = useCallback(() => {\n    selectMatch(activeMatchIndex - 1);\n  }, [activeMatchIndex, selectMatch]);\n\n  useLayoutEffect(() => {\n    if (filteredTreeNodes.length === 0) {\n      return;\n    }\n\n    // this case can trigger on two conditions:\n    // 1. the search term is cleared, therefore there are no matches\n    // 2. the search term only matches on span names, which don't count\n    //    as matches since we don't support jumping to them.\n    if (matches.length === 0) {\n      // if the selected node is no longer in the tree, then select\n      // the first node. this can occur from condition #2 above\n      const selectedNodeKey = selectedNode?.key ?? '';\n      if (!(selectedNodeKey in nodeMap)) {\n        const newSpan = filteredTreeNodes[0];\n        setSelectedNode(newSpan);\n        setActiveTab(newSpan?.chatMessages ? 'chat' : 'content');\n      } else {\n        // another reason the tree can change is if modelTraceInfo changes.\n        // (e.g. tags/assessments were updated). if this happens, we need\n        // to reselect the updated node from the node map, otherwise the\n        // updates will not be reflected in the UI.\n        setSelectedNode(nodeMap[selectedNodeKey]);\n      }\n\n      // otherwise, if search was cleared, then we don't want to\n      // do anything. this is to preserve the user's context\n      // (e.g. they've jumped to a span and now want to dive deeper)\n      return;\n    }\n\n    // when matches update, select the first match\n    setActiveMatchIndex(0);\n    setSelectedNode(matches[0].span);\n    setActiveTab(getTabForMatch(matches[0]));\n    // don't subscribe to selectedNode to prevent infinite loop\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [filteredTreeNodes, matches, setSelectedNode]);\n\n  return {\n    matchData: {\n      match: matches[activeMatchIndex] ?? null,\n      totalMatches: matches.length,\n      currentMatchIndex: activeMatchIndex,\n    },\n    searchFilter: searchFilter.toLowerCase().trim(),\n    setSearchFilter,\n    spanFilterState,\n    setSpanFilterState,\n    filteredTreeNodes,\n    handleNextSearchMatch,\n    handlePreviousSearchMatch,\n  };\n};\n","export const ACTIVE_HIGHLIGHT_COLOR = 'yellow500';\nexport const INACTIVE_HIGHLIGHT_COLOR = 'yellow200';\n","import React, { useCallback, useMemo } from 'react';\n\nimport { useDesignSystemTheme } from '@databricks/design-system';\n\nimport type { SearchMatch } from './ModelTrace.types';\nimport { getHighlightedSpanComponents } from './ModelTraceExplorer.utils';\nimport { ACTIVE_HIGHLIGHT_COLOR, INACTIVE_HIGHLIGHT_COLOR } from './constants';\n\nexport const ModelTraceExplorerHighlightedCodeSnippet = ({\n  searchFilter,\n  data,\n  activeMatch,\n  containsActiveMatch,\n}: {\n  searchFilter: string;\n  data: string;\n  activeMatch: SearchMatch;\n  containsActiveMatch: boolean;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const scrollToActiveMatch = useCallback((node: HTMLElement | null) => {\n    node?.scrollIntoView({ block: 'nearest', inline: 'nearest' });\n  }, []);\n\n  const spans = useMemo(() => {\n    if (!searchFilter) {\n      return [];\n    }\n\n    return getHighlightedSpanComponents({\n      data,\n      searchFilter,\n      activeMatchBackgroundColor: theme.colors[ACTIVE_HIGHLIGHT_COLOR],\n      inactiveMatchBackgroundColor: theme.colors[INACTIVE_HIGHLIGHT_COLOR],\n      containsActiveMatch,\n      activeMatch,\n      scrollToActiveMatch,\n    });\n  }, [searchFilter, data, theme, containsActiveMatch, activeMatch, scrollToActiveMatch]);\n\n  return (\n    <pre\n      css={{\n        whiteSpace: 'pre-wrap',\n        backgroundColor: theme.colors.backgroundSecondary,\n        padding: theme.spacing.sm,\n        fontSize: theme.typography.fontSizeSm,\n      }}\n    >\n      {spans}\n    </pre>\n  );\n};\n","import React from 'react';\nimport { useVirtual } from 'react-virtual';\n\nimport { Table, TableCell, TableHeader, TableRow, useDesignSystemTheme } from '@databricks/design-system';\n\nimport type { ReactMarkdownProps } from './types';\n\nexport function useParsedTableComponents({ children }: ReactMarkdownProps<'table'>): {\n  header: React.ReactNode | undefined;\n  rows: React.ReactElement[];\n  isValid: boolean;\n} {\n  if (!children) {\n    return {\n      header: undefined,\n      rows: [],\n      isValid: false,\n    };\n  }\n\n  const childArray = React.Children.toArray(children);\n\n  const header = childArray[0] ?? undefined;\n\n  // Parse rows, expect all children after the header to be tbody element containing the rows\n  const rows: React.ReactElement[] = childArray.slice(1).flatMap((child) => {\n    if (React.isValidElement(child)) {\n      return React.Children.toArray(child.props.children).filter((c): c is React.ReactElement =>\n        React.isValidElement(c),\n      );\n    }\n    return [];\n  });\n\n  return {\n    header,\n    rows,\n    isValid: true,\n  };\n}\n\nconst BasicTable = ({ children }: ReactMarkdownProps<'table'>) => {\n  return (\n    // Tables with many columns were not scrollable but instead become squished rendering the content unreadable\n    // Fixed by wrapping the table in a div with overflow auto and setting the table to display inline-flex\n    <div data-testid=\"basic-table\" css={{ overflow: 'auto' }}>\n      {/* Table has a \"height: 100%\" style that causes layout issues in some cases */}\n      <Table\n        scrollable\n        css={{\n          height: 'auto',\n          minHeight: 'initial',\n          display: 'inline-flex',\n          // Tables in tool call responses were not taking up the full width of the container\n          minWidth: '100%',\n          zIndex: 0, // Ensure the raised header doesn't cover elements outside the table\n        }}\n        children={children}\n      />\n    </div>\n  );\n};\n\nexport const TableRenderer = ({ children, node }: ReactMarkdownProps<'table'>) => {\n  const { header, rows, isValid } = useParsedTableComponents({ children, node });\n\n  if (!isValid) {\n    // If for some reason the table is not valid, fall back to the basic table\n    return <BasicTable children={children} node={node} />;\n  }\n\n  return <VirtualizedTable header={header} rows={rows} />;\n};\n\nconst MAX_TABLE_HEIGHT = 420;\n\nconst OVERSCAN = 20;\n\nconst VirtualizedTable = ({ header, rows }: { header: React.ReactNode; rows: React.ReactNode[] }) => {\n  const { theme } = useDesignSystemTheme();\n\n  const parentRef = React.useRef<HTMLDivElement>(null);\n\n  const rowVirtualizer = useVirtual({\n    size: rows.length,\n    parentRef,\n    overscan: OVERSCAN,\n  });\n\n  const { virtualItems, totalSize } = rowVirtualizer;\n\n  return (\n    <div\n      data-testid=\"virtualized-table\"\n      ref={parentRef}\n      css={{\n        overflow: 'auto',\n        maxHeight: MAX_TABLE_HEIGHT,\n        border: '1px solid',\n        borderColor: theme.colors.border,\n        borderRadius: theme.borders.borderRadiusMd,\n        marginBottom: theme.spacing.md,\n        zIndex: 0, // Ensure the raised header doesn't cover elements outside the table\n      }}\n    >\n      <Table\n        css={{\n          height: 'auto',\n          minHeight: 'initial',\n          display: 'inline-flex',\n          minWidth: '100%',\n        }}\n      >\n        {header}\n        <div\n          css={{\n            position: 'relative',\n            height: `${totalSize}px`,\n            width: '100%',\n            // Remove bottom border from the last row\n            '& > div:last-child [role=\"cell\"]': { borderBottom: 'none' },\n          }}\n        >\n          {virtualItems.map((virtualRow) => {\n            const rowIndex = virtualRow.index;\n            const rowElement = rows[rowIndex];\n\n            return (\n              <div\n                ref={virtualRow.measureRef}\n                key={rowIndex}\n                css={{\n                  position: 'absolute',\n                  top: `${virtualRow.start}px`,\n                  width: '100%',\n                }}\n              >\n                {rowElement}\n              </div>\n            );\n          })}\n        </div>\n      </Table>\n    </div>\n  );\n};\n\nexport const VirtualizedTableRow = ({ children, node }: ReactMarkdownProps<'tr'>) => {\n  const isHeader = node?.children.some((child) => child.tagName === 'th');\n  const { theme } = useDesignSystemTheme();\n  return (\n    <TableRow\n      style={\n        isHeader\n          ? { position: 'sticky', top: 0, zIndex: 1, backgroundColor: theme.colors.backgroundPrimary }\n          : undefined\n      }\n      children={children}\n      isHeader={isHeader}\n    />\n  );\n};\n\nexport const VirtualizedTableCell = ({ children, node }: ReactMarkdownProps<'td' | 'th'>) => {\n  const isHeader = node?.tagName === 'th';\n  const { theme } = useDesignSystemTheme();\n\n  if (isHeader) {\n    return (\n      <TableHeader\n        data-testid=\"virtualized-table-header\"\n        componentId=\"virtualized-table-header\"\n        css={{ paddingLeft: theme.spacing.sm, borderColor: theme.colors.border, color: theme.colors.textPrimary }}\n        children={children}\n      />\n    );\n  }\n\n  return <TableCell children={children} />;\n};\n","import React, { type ComponentType, useMemo } from 'react';\nimport type { Components, Options, UrlTransform } from 'react-markdown-10';\nimport ReactMarkdown, { defaultUrlTransform } from 'react-markdown-10';\nimport remarkGfm from 'remark-gfm-4';\n\nimport { TableCell, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport type { CodeSnippetLanguage } from '@databricks/web-shared/snippet';\nimport { CodeSnippet, SnippetCopyAction } from '@databricks/web-shared/snippet';\n\nimport { TableRenderer, VirtualizedTableCell, VirtualizedTableRow } from './TableRenderer';\nimport type { ReactMarkdownComponent, ReactMarkdownComponents, ReactMarkdownProps } from './types';\n\n/**\n * NOTE: react-markdown sanitizes urls by default, including `data:` urls, with the `urlTransform` prop, documented here: https://github.com/remarkjs/react-markdown?tab=readme-ov-file#defaulturltransformurl\n * It uses `micromark-util-sanitize-uri` package under the hood to escape urls and prevent injection: https://github.com/micromark/micromark/tree/main/packages/micromark-util-sanitize-uri#readme\n * We can allow jpeg and png data urls, and use the default transformer for everything else.\n */\nconst urlTransform: UrlTransform = (value) => {\n  if (value.startsWith('data:image/png') || value.startsWith('data:image/jpeg')) {\n    return value;\n  }\n  return defaultUrlTransform(value);\n};\n\nexport const GenAIMarkdownRenderer = (props: { children: string; components?: ExtendedComponents }) => {\n  const components: Components = useMemo(\n    () => getMarkdownComponents({ extensions: props.components }),\n    [props.components],\n  );\n  return (\n    <ReactMarkdown components={components} remarkPlugins={RemarkPlugins} urlTransform={urlTransform}>\n      {props.children}\n    </ReactMarkdown>\n  );\n};\n\nconst CodeMarkdownComponent = ({\n  codeBlock,\n  codeInline,\n  node,\n  ...codeProps\n}: Required<ExtededCodeRenderers> & ReactMarkdownProps<'code'>) => {\n  const language = React.useMemo(() => {\n    const match = /language-(\\w+)/.exec(codeProps.className ?? '');\n    return match && match[1] ? match[1] : undefined;\n  }, [codeProps.className]);\n\n  if (node?.position?.start.line === node?.position?.end.line) {\n    return React.createElement(codeInline, codeProps);\n  }\n\n  return React.createElement(codeBlock, { ...codeProps, language });\n};\n\nconst InlineCode = ({ children }: ReactMarkdownProps<'code'>) => <Typography.Text code>{children}</Typography.Text>;\n\n/**\n * Since this component is quite expensive to render we memoize it so if multiple\n * code blocks are being rendered, we only update the code blocks with changing props\n */\nconst CodeBlock = React.memo(({ children, language }: ReactMarkdownProps<'code'> & { language?: string }) => {\n  const { theme } = useDesignSystemTheme();\n  const code = String(children).replace(/\\n$/, '');\n  return (\n    <div css={{ position: 'relative' }}>\n      <CodeSnippet\n        actions={<SnippetCopyAction componentId=\"genai.util.markdown-copy-code-block\" copyText={code} />}\n        theme={theme.isDarkMode ? 'duotoneDark' : 'light'}\n        children={code}\n        language={language && isCodeSnippetLanguage(language) ? language : 'text'}\n        style={{\n          padding: '8px 0',\n          borderRadius: 8,\n          width: '100%',\n          boxSizing: 'border-box',\n          // Setting a reasonable max height to avoid long code blocks taking up the entire screen.\n          // Component handles scrolling inside it gracefully\n          maxHeight: 640,\n          // Using column-reverse flex layout so the scroll position will stick to the bottom\n          // as new content is streamed in.\n          display: 'flex',\n          flexDirection: 'column-reverse',\n        }}\n        showLineNumbers\n      />\n    </div>\n  );\n});\n\nconst RemarkPlugins: Options['remarkPlugins'] = [remarkGfm];\n\n// react-markdown handles both inline and block code rendering in the same component\n// however, we want to render them differently so we need to split them into two components.\n// This also allows callees to override the default renderers separately\ntype ExtededCodeRenderers = {\n  codeInline?: ReactMarkdownComponent<'code'>;\n  codeBlock?: ComponentType<Omit<ReactMarkdownProps<'code'>, 'ref'> & { language?: string }>;\n};\n\ntype ExtendedComponents = Omit<ReactMarkdownComponents, 'code'> & ExtededCodeRenderers;\n\nexport const getMarkdownComponents = (props: { extensions?: ExtendedComponents }) =>\n  ({\n    a: ({ href, children }) => (\n      <Typography.Link\n        componentId=\"codegen_webapp_js_genai_util_markdown.tsx_71\"\n        href={href}\n        // If the link is to the footnote (starts with #user-content-fn), set id so footnote can link back to it\n        id={\n          href?.startsWith('#user-content-fn-') ? href.replace('#user-content-fn-', 'user-content-fnref-') : undefined\n        }\n        disabled={href?.startsWith('.')}\n        // If the link is to the footnote, add brackets around the children to make it appear as a footnote reference\n        children={href?.startsWith('#user-content-fn-') ? <>[{children}]</> : children}\n        // If the link is an id link, don't open in new tab\n        openInNewTab={!(href && href.startsWith('#'))}\n      />\n    ),\n    code: (codeProps) => (\n      <CodeMarkdownComponent\n        {...codeProps}\n        codeBlock={props.extensions?.codeBlock ?? CodeBlock} // Optionally override the default code block renderer\n        codeInline={props.extensions?.codeInline ?? InlineCode} // Optionally override the default inline code renderer\n      />\n    ),\n    p: ({ children }) => <Typography.Paragraph children={children} />,\n    h1: ({ children }) => <Typography.Title level={1} children={children} />,\n    h2: ({ children }) => <Typography.Title level={2} children={children} />,\n    h3: ({ children }) => <Typography.Title level={3} children={children} />,\n    h4: ({ children }) => <Typography.Title level={4} children={children} />,\n    h5: ({ children }) => <Typography.Title level={5} children={children} />,\n    table: ({ children, node }) => <TableRenderer children={children} node={node} />,\n    tr: ({ children, node }) => <VirtualizedTableRow children={children} node={node} />,\n    th: ({ children, node }) => <VirtualizedTableCell children={children} node={node} />,\n    // Without the multiline prop, the table cell will add ellipsis to the text effictively hiding the content\n    // for long text. This is not the desired behavior for markdown tables.\n    td: ({ children }) => <TableCell children={children} multiline />,\n    // Design system's table does not use thead and tbody elements\n    thead: ({ children }) => <>{children}</>,\n    tbody: ({ children }) => <>{children}</>,\n    img: ({ src, alt }) => <img src={src} alt={alt} css={{ maxWidth: '100%' }} />,\n  } satisfies ReactMarkdownComponents);\n\nconst isCodeSnippetLanguage = (languageString: string): languageString is CodeSnippetLanguage => {\n  // Casting the string to string literal so we can exhaust the union\n  const typeCast = languageString as CodeSnippetLanguage;\n  switch (typeCast) {\n    case 'go':\n    case 'java':\n    case 'javascript':\n    case 'json':\n    case 'python':\n    case 'sql':\n    case 'text':\n    case 'yaml':\n      return true;\n    default:\n      return false;\n  }\n};\n","import { isNil, isString } from 'lodash';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { Button, ChevronDownIcon, ChevronUpIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport type { SearchMatch } from './ModelTrace.types';\nimport { CodeSnippetRenderMode } from './ModelTrace.types';\nimport { ModelTraceExplorerHighlightedCodeSnippet } from './ModelTraceExplorerHighlightedCodeSnippet';\nimport { GenAIMarkdownRenderer } from '../genai-markdown-renderer';\n// eslint-disable-next-line import/no-deprecated\nimport { CodeSnippet, SnippetCopyAction } from '../snippet';\n\nconst MAX_LINES_FOR_PREVIEW = 4;\n// the `isContentLong` check does not work for\n// markdown rendering, since the content is wrapped\nconst MAX_CHARS_FOR_PREVIEW = 300;\n\nexport function ModelTraceExplorerCodeSnippetBody({\n  data,\n  searchFilter = '',\n  activeMatch = null,\n  containsActiveMatch = false,\n  renderMode = CodeSnippetRenderMode.JSON,\n}: {\n  data: string;\n  searchFilter?: string;\n  activeMatch?: SearchMatch | null;\n  containsActiveMatch?: boolean;\n  renderMode?: CodeSnippetRenderMode;\n}) {\n  const containsMatches = Boolean(searchFilter) && !isNil(activeMatch) && data.toLowerCase().includes(searchFilter);\n  const { theme } = useDesignSystemTheme();\n  const [isContentLong, setIsContentLong] = useState(renderMode === 'json');\n  const [expanded, setExpanded] = useState(containsMatches);\n  const snippetRef = useRef<HTMLPreElement>(null);\n  // if the data is rendered in text / markdown mode, then\n  // we need to parse it so that the newlines are unescaped\n  const dataToTruncate: string = useMemo(() => {\n    if (renderMode === 'json') {\n      return data;\n    }\n\n    const parsedData = JSON.parse(data);\n    if (isString(parsedData)) {\n      return parsedData;\n    }\n\n    return data;\n  }, [data, renderMode]);\n\n  const expandable =\n    isContentLong ||\n    dataToTruncate.split('\\n').length > MAX_LINES_FOR_PREVIEW ||\n    dataToTruncate.length > MAX_CHARS_FOR_PREVIEW;\n\n  // Truncate after first 3 lines if not expanded\n  const displayedData = useMemo(() => {\n    if (expandable && !expanded) {\n      const split = dataToTruncate.split('\\n').slice(0, MAX_LINES_FOR_PREVIEW).join('\\n');\n      return split.length > MAX_CHARS_FOR_PREVIEW ? split.slice(0, MAX_CHARS_FOR_PREVIEW) : split;\n    }\n\n    return dataToTruncate;\n  }, [dataToTruncate, expandable, expanded]);\n\n  useEffect(() => {\n    if (snippetRef.current) {\n      setIsContentLong(snippetRef.current.scrollWidth > snippetRef.current.clientWidth);\n    }\n  }, [data]);\n\n  // add a ref to the <pre> component within <CodeSnippet>.\n  // we use the ref to check whether the <pre>'s content is overflowing\n  const PreWithRef = useCallback((preProps: any) => <pre {...preProps} ref={snippetRef} />, []);\n\n  if (containsMatches) {\n    return (\n      // if the snippet contains matches, render the search-highlighted version\n      <ModelTraceExplorerHighlightedCodeSnippet\n        data={data}\n        searchFilter={searchFilter}\n        activeMatch={activeMatch}\n        containsActiveMatch={!activeMatch.isKeyMatch && containsActiveMatch}\n      />\n    );\n  }\n\n  return (\n    <div css={{ position: 'relative' }}>\n      {renderMode === 'markdown' ? (\n        <div\n          css={{\n            padding: theme.spacing.md,\n            backgroundColor: theme.colors.backgroundSecondary,\n            marginBottom: -theme.spacing.md,\n          }}\n        >\n          <GenAIMarkdownRenderer>{displayedData}</GenAIMarkdownRenderer>\n        </div>\n      ) : (\n        <>\n          <SnippetCopyAction\n            key=\"copy-snippet\"\n            componentId=\"shared.model-trace-explorer.copy-snippet\"\n            copyText={data}\n            size=\"small\"\n            css={{ position: 'absolute', top: theme.spacing.xs, right: theme.spacing.xs, zIndex: 1 }}\n          />\n          {/* eslint-disable-next-line import/no-deprecated */}\n          <CodeSnippet\n            PreTag={PreWithRef}\n            showLineNumbers\n            language={renderMode}\n            lineProps={{ style: { wordBreak: 'break-word', whiteSpace: 'pre-wrap' } }}\n            wrapLines={expanded}\n            theme={theme.isDarkMode ? 'duotoneDark' : 'light'}\n            style={{\n              backgroundColor: theme.colors.backgroundSecondary,\n              padding: theme.spacing.sm,\n              paddingBottom: expandable ? 0 : theme.spacing.sm,\n              paddingRight: theme.spacing.md * 2,\n              overflow: expanded ? 'auto' : 'hidden',\n              textOverflow: 'ellipsis',\n              fontSize: theme.typography.fontSizeSm,\n              lineHeight: theme.typography.lineHeightBase,\n            }}\n          >\n            {displayedData}\n          </CodeSnippet>\n        </>\n      )}\n      {expandable && (\n        <div css={{ backgroundColor: theme.colors.backgroundSecondary }}>\n          <Button\n            css={{ width: '100%', padding: 0 }}\n            componentId={\n              expanded ? 'shared.model-trace-explorer.snippet-see-less' : 'shared.model-trace-explorer.snippet-see-more'\n            }\n            icon={expanded ? <ChevronUpIcon /> : <ChevronDownIcon />}\n            type=\"tertiary\"\n            onClick={() => setExpanded(!expanded)}\n          >\n            {expanded ? (\n              <FormattedMessage\n                defaultMessage=\"See less\"\n                description=\"Model trace explorer > selected span > code snippet > see less button\"\n              />\n            ) : (\n              <FormattedMessage\n                defaultMessage=\"See more\"\n                description=\"Model trace explorer > selected span > code snippet > see more button\"\n              />\n            )}\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n}\n","import React, { useCallback } from 'react';\n\nimport { useDesignSystemTheme } from '@databricks/design-system';\n\nimport { ACTIVE_HIGHLIGHT_COLOR, INACTIVE_HIGHLIGHT_COLOR } from './constants';\n\nexport const ModelTraceExplorerHighlightedSnippetTitle = ({\n  title,\n  searchFilter,\n  isActiveMatch,\n}: {\n  title: string;\n  searchFilter: string;\n  isActiveMatch: boolean;\n}): React.ReactElement => {\n  const { theme } = useDesignSystemTheme();\n  const scrollToActiveMatch = useCallback((node: HTMLElement | null) => {\n    node?.scrollIntoView({ block: 'nearest', inline: 'nearest' });\n  }, []);\n\n  const titleLower = title.toLowerCase();\n  if (!titleLower.includes(searchFilter)) {\n    return <div>{title}</div>;\n  }\n\n  const startIdx = titleLower.indexOf(searchFilter);\n  const endIdx = startIdx + searchFilter.length;\n  const backgroundColor = isActiveMatch ? theme.colors[ACTIVE_HIGHLIGHT_COLOR] : theme.colors[INACTIVE_HIGHLIGHT_COLOR];\n\n  return (\n    <div>\n      {title.slice(0, startIdx)}\n      <span ref={isActiveMatch ? scrollToActiveMatch : null} css={{ backgroundColor, scrollMarginTop: 50 }}>\n        {title.slice(startIdx, endIdx)}\n      </span>\n      {title.slice(endIdx)}\n    </div>\n  );\n};\n","import { isString } from 'lodash';\nimport { useEffect, useMemo, useState } from 'react';\n\nimport { ChevronDownIcon, DropdownMenu, Tag, Typography, useDesignSystemTheme } from '@databricks/design-system';\n\nimport type { SearchMatch } from './ModelTrace.types';\nimport { CodeSnippetRenderMode } from './ModelTrace.types';\nimport { ModelTraceExplorerCodeSnippetBody } from './ModelTraceExplorerCodeSnippetBody';\nimport { ModelTraceExplorerHighlightedSnippetTitle } from './ModelTraceExplorerHighlightedSnippetTitle';\n\n// return the initial render mode if specified, otherwise\n// default to markdown for string data and json for non-string data\nfunction getInitialRenderMode(dataIsString: boolean, initialRenderMode?: CodeSnippetRenderMode) {\n  if (initialRenderMode) {\n    return initialRenderMode;\n  }\n\n  if (dataIsString) {\n    return CodeSnippetRenderMode.MARKDOWN;\n  }\n\n  return CodeSnippetRenderMode.JSON;\n}\n\nfunction getRenderModeDisplayText(renderMode: CodeSnippetRenderMode) {\n  switch (renderMode) {\n    case CodeSnippetRenderMode.JSON:\n      return 'JSON';\n    case CodeSnippetRenderMode.TEXT:\n      return 'Text';\n    case CodeSnippetRenderMode.MARKDOWN:\n      return 'Markdown';\n  }\n}\n\nexport function ModelTraceExplorerCodeSnippet({\n  title,\n  tokens,\n  data,\n  searchFilter = '',\n  activeMatch = null,\n  containsActiveMatch = false,\n  initialRenderMode,\n}: {\n  title: string;\n  tokens?: number;\n  data: string;\n  searchFilter?: string;\n  // the current active search match\n  activeMatch?: SearchMatch | null;\n  // whether the snippet being rendered contains the\n  // current active match (either in the key or value)\n  containsActiveMatch?: boolean;\n  initialRenderMode?: CodeSnippetRenderMode;\n}) {\n  const parsedData = useMemo(() => JSON.parse(data), [data]);\n  const dataIsString = isString(parsedData);\n  const { theme } = useDesignSystemTheme();\n  // string data can be rendered in multiple formats\n  const [renderMode, setRenderMode] = useState<CodeSnippetRenderMode>(\n    getInitialRenderMode(dataIsString, initialRenderMode),\n  );\n  const isTitleMatch = containsActiveMatch && (activeMatch?.isKeyMatch ?? false);\n  const shouldShowRenderModeDropdown = dataIsString && !searchFilter;\n\n  // we need to reset the render mode when the data changes\n  useEffect(() => {\n    setRenderMode(getInitialRenderMode(dataIsString, initialRenderMode));\n  }, [dataIsString, initialRenderMode]);\n\n  return (\n    <div\n      css={{\n        position: 'relative',\n      }}\n    >\n      <div\n        css={{\n          borderRadius: theme.borders.borderRadiusSm,\n          border: `1px solid ${theme.colors.border}`,\n          overflow: 'hidden',\n        }}\n      >\n        {(title || shouldShowRenderModeDropdown) && (\n          <div\n            css={{\n              display: 'flex',\n              flexDirection: 'row',\n              justifyContent: 'space-between',\n              alignItems: 'center',\n              padding: theme.spacing.sm,\n            }}\n          >\n            {/* TODO: support other types of formatting, e.g. markdown */}\n            <Typography.Title\n              css={{\n                maxWidth: '100%',\n                overflow: 'hidden',\n                textOverflow: 'ellipsis',\n                whiteSpace: 'nowrap',\n              }}\n              level={4}\n              color=\"secondary\"\n              withoutMargins\n            >\n              <ModelTraceExplorerHighlightedSnippetTitle\n                title={title}\n                searchFilter={searchFilter}\n                isActiveMatch={isTitleMatch}\n              />\n            </Typography.Title>\n            <div css={{ display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n              {shouldShowRenderModeDropdown && (\n                <DropdownMenu.Root>\n                  <DropdownMenu.Trigger asChild>\n                    <Tag\n                      componentId=\"shared.model-trace-explorer.snippet-render-mode-tag\"\n                      css={{\n                        height: 'min-content',\n                        margin: 0,\n                      }}\n                    >\n                      {/* for some reason `cursor: pointer` doesn't work if you set it on the Tag css */}\n                      <div css={{ paddingLeft: theme.spacing.xs, marginRight: theme.spacing.xs, cursor: 'pointer' }}>\n                        <Typography.Text size=\"sm\" color=\"secondary\">\n                          {getRenderModeDisplayText(renderMode)}\n                        </Typography.Text>\n                        <ChevronDownIcon />\n                      </div>\n                    </Tag>\n                  </DropdownMenu.Trigger>\n                  <DropdownMenu.Content>\n                    <DropdownMenu.RadioGroup\n                      componentId=\"shared.model-trace-explorer.snippet-render-mode-radio\"\n                      value={renderMode}\n                      onValueChange={(value) => setRenderMode(value as CodeSnippetRenderMode)}\n                    >\n                      {Object.values(CodeSnippetRenderMode).map((mode) => (\n                        <DropdownMenu.RadioItem key={mode} value={mode}>\n                          <DropdownMenu.ItemIndicator />\n                          {getRenderModeDisplayText(mode)}\n                        </DropdownMenu.RadioItem>\n                      ))}\n                    </DropdownMenu.RadioGroup>\n                    <DropdownMenu.Arrow />\n                  </DropdownMenu.Content>\n                </DropdownMenu.Root>\n              )}\n            </div>\n          </div>\n        )}\n        <ModelTraceExplorerCodeSnippetBody\n          data={data}\n          searchFilter={searchFilter}\n          activeMatch={activeMatch}\n          containsActiveMatch={containsActiveMatch}\n          renderMode={renderMode}\n        />\n      </div>\n    </div>\n  );\n}\n","import { isNil, keys } from 'lodash';\n\nimport { Empty, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport type { ModelTraceSpanNode, SearchMatch } from '../ModelTrace.types';\nimport { ModelTraceExplorerCodeSnippet } from '../ModelTraceExplorerCodeSnippet';\n\nexport function ModelTraceExplorerAttributesTab({\n  activeSpan,\n  searchFilter,\n  activeMatch,\n}: {\n  activeSpan: ModelTraceSpanNode;\n  searchFilter: string;\n  activeMatch: SearchMatch | null;\n}) {\n  const { theme } = useDesignSystemTheme();\n  const { attributes } = activeSpan;\n  const containsAttributes = keys(attributes).length > 0;\n  const isActiveMatchSpan = !isNil(activeMatch) && activeMatch.span.key === activeSpan.key;\n\n  if (!containsAttributes || isNil(attributes)) {\n    return (\n      <div css={{ marginTop: theme.spacing.md }}>\n        <Empty\n          description={\n            <FormattedMessage\n              defaultMessage=\"No attributes found\"\n              description=\"Empty state for the attributes tab in the model trace explorer. Attributes are properties of a span that the user defines.\"\n            />\n          }\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        gap: theme.spacing.sm,\n        padding: theme.spacing.md,\n      }}\n    >\n      {Object.entries(attributes).map(([key, value]) => (\n        <ModelTraceExplorerCodeSnippet\n          key={key}\n          title={key}\n          data={JSON.stringify(value, null, 2)}\n          searchFilter={searchFilter}\n          activeMatch={activeMatch}\n          containsActiveMatch={isActiveMatchSpan && activeMatch.section === 'attributes' && activeMatch.key === key}\n        />\n      ))}\n    </div>\n  );\n}\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport type { ModelTraceChatToolParamProperty } from '../ModelTrace.types';\n\nexport function ModelTraceExplorerChatToolParam({\n  paramName,\n  paramProperties,\n  isRequired,\n}: {\n  paramName: string;\n  paramProperties: ModelTraceChatToolParamProperty;\n  isRequired: boolean;\n}) {\n  const { theme } = useDesignSystemTheme();\n\n  const { type, description, enum: enumValues } = paramProperties;\n\n  const hasAdditionalInfo = type || description || enumValues;\n\n  const borderStyles = hasAdditionalInfo\n    ? {\n        borderTopLeftRadius: theme.borders.borderRadiusMd,\n        borderTopRightRadius: theme.borders.borderRadiusMd,\n        borderBottom: `1px solid ${theme.colors.border}`,\n      }\n    : {\n        borderRadius: theme.borders.borderRadiusMd,\n      };\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        width: '100%',\n        borderRadius: theme.borders.borderRadiusMd,\n        border: `1px solid ${theme.colors.border}`,\n      }}\n    >\n      <div\n        css={{\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n          backgroundColor: theme.colors.backgroundSecondary,\n          padding: `${theme.spacing.sm}px ${theme.spacing.md}px`,\n          gap: theme.spacing.sm,\n          ...borderStyles,\n        }}\n      >\n        <Typography.Title withoutMargins style={{ whiteSpace: 'nowrap', textOverflow: 'ellipsis', overflow: 'hidden' }}>\n          {paramName}\n        </Typography.Title>\n        {isRequired && (\n          <Typography.Text withoutMargins color=\"error\">\n            <FormattedMessage\n              defaultMessage=\"required\"\n              description=\"Text displayed next to a function parameter to indicate that it is required\"\n            />\n          </Typography.Text>\n        )}\n      </div>\n      {hasAdditionalInfo && (\n        <div\n          css={{\n            display: 'grid',\n            gridTemplateColumns: 'auto 1fr',\n            gridTemplateRows: 'auto',\n            gap: theme.spacing.md,\n            padding: `${theme.spacing.sm}px ${theme.spacing.md}px`,\n          }}\n        >\n          {type && (\n            <>\n              <Typography.Text withoutMargins bold>\n                <FormattedMessage\n                  defaultMessage=\"Type\"\n                  description=\"Row heading in a table that contains the type of a function parameter (e.g. string, boolean)\"\n                />\n              </Typography.Text>\n              <Typography.Text withoutMargins code>\n                {type}\n              </Typography.Text>\n            </>\n          )}\n          {description && (\n            <>\n              <Typography.Text withoutMargins bold>\n                <FormattedMessage\n                  defaultMessage=\"Description\"\n                  description=\"Row heading in a table that contains the description of a function parameter.\"\n                />\n              </Typography.Text>\n              <Typography.Text withoutMargins>{description}</Typography.Text>\n            </>\n          )}\n          {enumValues && (\n            <>\n              <Typography.Text withoutMargins bold>\n                <FormattedMessage\n                  defaultMessage=\"Enum Values\"\n                  description=\"Row heading in a table that contains the potential enum values that a function parameter can have.\"\n                />\n              </Typography.Text>\n              <div css={{ display: 'flex', flexDirection: 'row', gap: theme.spacing.sm, flexWrap: 'wrap' }}>\n                {enumValues.map((value) => (\n                  <Typography.Text withoutMargins code key={value}>\n                    {value}\n                  </Typography.Text>\n                ))}\n              </div>\n            </>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","import { useState } from 'react';\n\nimport { ChevronDownIcon, ChevronRightIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\n\nimport { ModelTraceExplorerChatToolParam } from './ModelTraceExplorerChatToolParam';\nimport type { ModelTraceChatTool } from '../ModelTrace.types';\n\nexport function ModelTraceExplorerChatTool({ tool }: { tool: ModelTraceChatTool }) {\n  const { theme } = useDesignSystemTheme();\n  const [expanded, setExpanded] = useState(false);\n\n  const description = tool.function.description;\n  const paramProperties = tool.function.parameters?.properties;\n  const requiredParams = tool.function.parameters?.required ?? [];\n\n  // tools only need to have names, so it's\n  // possible that no additional info exists\n  const isExpandable = description || paramProperties;\n\n  const hoverStyles = isExpandable\n    ? { ':hover': { backgroundColor: theme.colors.actionIconBackgroundHover, cursor: 'pointer' } }\n    : {};\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        width: '100%',\n        borderRadius: theme.borders.borderRadiusMd,\n        border: `1px solid ${theme.colors.border}`,\n        backgroundColor: theme.colors.backgroundPrimary,\n      }}\n      data-testid=\"model-trace-explorer-chat-tool\"\n    >\n      <div\n        role=\"button\"\n        css={{\n          display: 'flex',\n          flexDirection: 'row',\n          gap: theme.spacing.sm,\n          alignItems: 'center',\n          borderBottom: isExpandable && expanded ? `1px solid ${theme.colors.border}` : 'none',\n          padding: theme.spacing.sm,\n          ...hoverStyles,\n        }}\n        onClick={() => setExpanded(!expanded)}\n        data-testid=\"model-trace-explorer-chat-tool-toggle\"\n      >\n        {isExpandable && (expanded ? <ChevronDownIcon /> : <ChevronRightIcon />)}\n        <Typography.Text\n          bold\n          withoutMargins\n          style={{ whiteSpace: 'nowrap', textOverflow: 'ellipsis', overflow: 'hidden' }}\n        >\n          {tool.function.name}\n        </Typography.Text>\n      </div>\n      {isExpandable && expanded && (\n        <div css={{ padding: theme.spacing.sm }}>\n          {description && (\n            <Typography.Paragraph\n              style={{ whiteSpace: 'pre-wrap', marginBottom: theme.spacing.sm, padding: `0px ${theme.spacing.xs}px` }}\n            >\n              {tool.function.description}\n            </Typography.Paragraph>\n          )}\n          {paramProperties && (\n            <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.sm }}>\n              {Object.keys(paramProperties).map((key) => (\n                <ModelTraceExplorerChatToolParam\n                  key={key}\n                  paramName={key}\n                  paramProperties={paramProperties[key]}\n                  isRequired={requiredParams.includes(key)}\n                />\n              ))}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","import {\n  ChevronRightIcon,\n  ChevronDownIcon,\n  Typography,\n  useDesignSystemTheme,\n  Tooltip,\n} from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport type { ModelTraceChatMessage } from '../ModelTrace.types';\nimport { ModelIconType } from '../ModelTrace.types';\nimport { ModelTraceExplorerIcon } from '../ModelTraceExplorerIcon';\n\nconst getRoleIcon = (role: string) => {\n  switch (role) {\n    case 'system':\n      return <ModelTraceExplorerIcon type={ModelIconType.SYSTEM} />;\n    case 'user':\n      return <ModelTraceExplorerIcon type={ModelIconType.USER} />;\n    case 'tool':\n    case 'function':\n      return <ModelTraceExplorerIcon type={ModelIconType.WRENCH} />;\n    default:\n      return <ModelTraceExplorerIcon type={ModelIconType.MODELS} />;\n  }\n};\n\nconst getRoleDisplayText = (message: ModelTraceChatMessage) => {\n  switch (message.role) {\n    case 'system':\n      return (\n        <FormattedMessage\n          defaultMessage=\"System\"\n          description=\"Display text for the 'system' role in a GenAI chat message.\"\n        />\n      );\n    case 'user':\n      return (\n        <FormattedMessage\n          defaultMessage=\"User\"\n          description=\"Display text for the 'user' role in a GenAI chat message.\"\n        />\n      );\n    case 'assistant':\n      return (\n        <FormattedMessage\n          defaultMessage=\"Assistant\"\n          description=\"Display text for the 'assistant' role in a GenAI chat message.\"\n        />\n      );\n    case 'tool':\n      if (message.name) {\n        return message.name;\n      }\n      return (\n        <FormattedMessage\n          defaultMessage=\"Tool\"\n          description=\"Display text for the 'tool' role in a GenAI chat message.\"\n        />\n      );\n    case 'function':\n      return (\n        <FormattedMessage\n          defaultMessage=\"Function\"\n          description=\"Display text for the 'function' role in a GenAI chat message.\"\n        />\n      );\n    default:\n      return message.role;\n  }\n};\n\nexport const ModelTraceExplorerChatMessageHeader = ({\n  isExpandable,\n  expanded,\n  setExpanded,\n  message,\n}: {\n  isExpandable: boolean;\n  expanded: boolean;\n  setExpanded: (expanded: boolean) => void;\n  message: ModelTraceChatMessage;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const hoverStyles = isExpandable\n    ? {\n        ':hover': {\n          backgroundColor: theme.colors.actionIconBackgroundHover,\n          cursor: 'pointer',\n        },\n      }\n    : {};\n\n  return (\n    <div\n      role=\"button\"\n      css={{\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        padding: theme.spacing.sm,\n        gap: theme.spacing.sm,\n        ...hoverStyles,\n      }}\n      onClick={() => setExpanded(!expanded)}\n    >\n      {isExpandable && (expanded ? <ChevronDownIcon /> : <ChevronRightIcon />)}\n      {getRoleIcon(message.role)}\n      {message.tool_call_id ? (\n        <Typography.Text\n          color=\"secondary\"\n          css={{\n            whiteSpace: 'nowrap',\n            display: 'inline-flex',\n            alignItems: 'center',\n            flex: 1,\n            minWidth: 0,\n          }}\n        >\n          <FormattedMessage\n            defaultMessage=\"{toolName} was called in {toolCallId}\"\n            description=\"A message that shows the tool call ID of a tool call chat message.\"\n            values={{\n              toolName: (\n                <Typography.Text css={{ marginRight: theme.spacing.xs }} bold>\n                  {getRoleDisplayText(message)}\n                </Typography.Text>\n              ),\n              toolCallId: (\n                <Tooltip componentId=\"test\" content={message.tool_call_id}>\n                  <div\n                    css={{ display: 'inline-flex', flexShrink: 1, overflow: 'hidden', marginLeft: theme.spacing.xs }}\n                  >\n                    <Typography.Text css={{ textOverflow: 'ellipsis', overflow: 'hidden', whiteSpace: 'nowrap' }} code>\n                      {message.tool_call_id}\n                    </Typography.Text>\n                  </div>\n                </Tooltip>\n              ),\n            }}\n          />\n        </Typography.Text>\n      ) : (\n        <Typography.Text bold>{getRoleDisplayText(message)}</Typography.Text>\n      )}\n    </div>\n  );\n};\n","import { FunctionIcon, Tag, Tooltip, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport type { ModelTraceToolCall } from '../ModelTrace.types';\nimport { ModelTraceExplorerCodeSnippetBody } from '../ModelTraceExplorerCodeSnippetBody';\n\nexport function ModelTraceExplorerToolCallMessage({ toolCall }: { toolCall: ModelTraceToolCall }) {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div key={toolCall.id} css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.sm }}>\n      <Typography.Text\n        color=\"secondary\"\n        css={{\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n          padding: `0px ${theme.spacing.sm + theme.spacing.xs}px`,\n        }}\n      >\n        <FormattedMessage\n          defaultMessage=\"called {functionName} in {toolCallId}\"\n          description=\"A message that shows the tool calls that an AI assistant made. The full message reads (for example): 'Assistant called get_weather in id_123'.\"\n          values={{\n            functionName: (\n              <Tag\n                color=\"purple\"\n                componentId=\"shared.model-trace-explorer.function-name-tag\"\n                css={{ margin: `0px ${theme.spacing.xs}px` }}\n              >\n                <FunctionIcon />\n                <Typography.Text css={{ whiteSpace: 'nowrap', marginLeft: theme.spacing.xs }}>\n                  {toolCall.function.name}\n                </Typography.Text>\n              </Tag>\n            ),\n            toolCallId: (\n              <Tooltip componentId=\"test\" content={toolCall.id}>\n                <div css={{ display: 'inline-flex', flexShrink: 1, overflow: 'hidden', marginLeft: theme.spacing.xs }}>\n                  <Typography.Text\n                    css={{\n                      textOverflow: 'ellipsis',\n                      overflow: 'hidden',\n                      whiteSpace: 'nowrap',\n                    }}\n                    code\n                    color=\"secondary\"\n                  >\n                    {toolCall.id}\n                  </Typography.Text>\n                </div>\n              </Tooltip>\n            ),\n          }}\n        />\n      </Typography.Text>\n      <ModelTraceExplorerCodeSnippetBody data={toolCall.function.arguments} />\n    </div>\n  );\n}\n","import { isNil } from 'lodash';\nimport { useState } from 'react';\n\nimport { Button, ChevronDownIcon, ChevronUpIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\nimport { GenAIMarkdownRenderer } from '@databricks/web-shared/genai-markdown-renderer';\n\nimport { ModelTraceExplorerChatMessageHeader } from './ModelTraceExplorerChatMessageHeader';\nimport { CONTENT_TRUNCATION_LIMIT } from './ModelTraceExplorerChatRenderer.utils';\nimport { ModelTraceExplorerToolCallMessage } from './ModelTraceExplorerToolCallMessage';\nimport { CodeSnippetRenderMode, type ModelTraceChatMessage } from '../ModelTrace.types';\nimport { ModelTraceExplorerCodeSnippetBody } from '../ModelTraceExplorerCodeSnippetBody';\n\nconst tryGetJsonContent = (content: string) => {\n  try {\n    return {\n      content: JSON.stringify(JSON.parse(content), null, 2),\n      isJson: true,\n    };\n  } catch (error) {\n    return {\n      content,\n      isJson: false,\n    };\n  }\n};\n\nfunction ModelTraceExplorerChatMessageContent({\n  content,\n  shouldDisplayCodeSnippet,\n}: {\n  content: string;\n  shouldDisplayCodeSnippet: boolean;\n}) {\n  const { theme } = useDesignSystemTheme();\n\n  if (!content) {\n    return null;\n  }\n\n  if (shouldDisplayCodeSnippet) {\n    return (\n      <ModelTraceExplorerCodeSnippetBody\n        data={content}\n        searchFilter=\"\"\n        activeMatch={null}\n        containsActiveMatch={false}\n        renderMode={CodeSnippetRenderMode.JSON}\n      />\n    );\n  }\n\n  return (\n    <div\n      css={{\n        padding: theme.spacing.sm,\n        paddingTop: 0,\n        // genai markdown renderer uses default paragraph sizing which has\n        // a bottom margin that we can't get rid of. workaround by setting\n        // negative margin in a wrapper.\n        marginBottom: -theme.typography.fontSizeBase,\n      }}\n    >\n      <GenAIMarkdownRenderer>{content}</GenAIMarkdownRenderer>\n    </div>\n  );\n}\n\nexport function ModelTraceExplorerChatMessage({\n  message,\n  className,\n}: {\n  message: ModelTraceChatMessage;\n  className?: string;\n}) {\n  const { theme } = useDesignSystemTheme();\n  const [expanded, setExpanded] = useState(false);\n  const { content, isJson } = tryGetJsonContent(message.content ?? '');\n\n  // tool call responses can be JSON, and in these cases\n  // it's more helpful to display the message as JSON\n  const shouldDisplayCodeSnippet = isJson && (message.role === 'tool' || message.role === 'function');\n\n  const isImageContent = message.content?.startsWith('![');\n\n  // if the content is JSON, truncation will be handled by the code\n  // snippet. otherwise, we need to truncate the content manually.\n  const isExpandable = !shouldDisplayCodeSnippet && !isImageContent && content.length > CONTENT_TRUNCATION_LIMIT;\n\n  const displayedContent = isExpandable && !expanded ? `${content.slice(0, CONTENT_TRUNCATION_LIMIT)}...` : content;\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        width: '100%',\n        borderRadius: theme.borders.borderRadiusSm,\n        border: `1px solid ${theme.colors.border}`,\n        backgroundColor: theme.colors.backgroundPrimary,\n        overflow: 'hidden',\n      }}\n      className={className}\n    >\n      <ModelTraceExplorerChatMessageHeader\n        isExpandable={isExpandable}\n        expanded={expanded}\n        setExpanded={setExpanded}\n        message={message}\n      />\n      <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.sm }}>\n        {!isNil(message.tool_calls) &&\n          message.tool_calls.map((toolCall) => (\n            <ModelTraceExplorerToolCallMessage key={toolCall.id} toolCall={toolCall} />\n          ))}\n        <ModelTraceExplorerChatMessageContent\n          content={displayedContent}\n          shouldDisplayCodeSnippet={shouldDisplayCodeSnippet}\n        />\n      </div>\n      {isExpandable && (\n        <Button\n          componentId={\n            expanded\n              ? 'shared.model-trace-explorer.chat-message-see-less'\n              : 'shared.model-trace-explorer.chat-message-see-more'\n          }\n          icon={expanded ? <ChevronUpIcon /> : <ChevronDownIcon />}\n          type=\"tertiary\"\n          onClick={() => setExpanded(!expanded)}\n          css={{\n            display: 'flex',\n            width: '100%',\n            padding: theme.spacing.md,\n            borderRadius: '0px !important',\n          }}\n        >\n          {expanded ? (\n            <FormattedMessage\n              defaultMessage=\"See less\"\n              description=\"A button label in a message renderer that truncates long content when clicked.\"\n            />\n          ) : (\n            <FormattedMessage\n              defaultMessage=\"See more\"\n              description=\"A button label in a message renderer that expands truncated content when clicked.\"\n            />\n          )}\n        </Button>\n      )}\n    </div>\n  );\n}\n","export const CONTENT_TRUNCATION_LIMIT = 300;\n","import { isNil } from 'lodash';\n\nimport { useDesignSystemTheme } from '@databricks/design-system';\n\nimport { ModelTraceExplorerChatMessage } from './ModelTraceExplorerChatMessage';\nimport type { ModelTraceChatMessage } from '../ModelTrace.types';\n\nexport function ModelTraceExplorerConversation({ messages }: { messages: ModelTraceChatMessage[] | null }) {\n  const { theme } = useDesignSystemTheme();\n\n  if (isNil(messages)) {\n    return null;\n  }\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        gap: theme.spacing.sm,\n      }}\n    >\n      {messages.map((message, index) => (\n        <ModelTraceExplorerChatMessage key={index} message={message} />\n      ))}\n    </div>\n  );\n}\n","import { useState } from 'react';\n\nimport { Button, ChevronDownIcon, ChevronRightIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\n\nexport const ModelTraceExplorerCollapsibleSection = ({\n  sectionKey,\n  title,\n  children,\n  withBorder = false,\n  className,\n}: {\n  sectionKey: string;\n  title: React.ReactNode;\n  children: React.ReactNode;\n  withBorder?: boolean;\n  className?: string;\n}) => {\n  const [expanded, setExpanded] = useState(true);\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div\n      className={className}\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        borderRadius: theme.borders.borderRadiusMd,\n      }}\n    >\n      <div\n        css={{\n          alignItems: 'center',\n          display: 'flex',\n          flexDirection: 'row',\n          gap: theme.spacing.xs,\n          padding: withBorder ? theme.spacing.sm : 0,\n          background: withBorder ? theme.colors.backgroundSecondary : undefined,\n          borderTopLeftRadius: theme.borders.borderRadiusMd,\n          borderTopRightRadius: theme.borders.borderRadiusMd,\n          borderBottomLeftRadius: expanded ? 0 : theme.borders.borderRadiusMd,\n          borderBottomRightRadius: expanded ? 0 : theme.borders.borderRadiusMd,\n          border: withBorder ? `1px solid ${theme.colors.border}` : undefined,\n          marginBottom: withBorder ? 0 : theme.spacing.sm,\n        }}\n      >\n        <Button\n          size=\"small\"\n          componentId={`shared.model-trace-explorer.expand-${sectionKey}`}\n          type=\"tertiary\"\n          icon={expanded ? <ChevronDownIcon /> : <ChevronRightIcon />}\n          onClick={() => setExpanded(!expanded)}\n        />\n        <Typography.Title withoutMargins level={4} css={{ width: '100%' }}>\n          {title}\n        </Typography.Title>\n      </div>\n      {expanded && (\n        <div\n          css={{\n            border: withBorder ? `1px solid ${theme.colors.border}` : undefined,\n            borderTop: 'none',\n            borderBottomLeftRadius: withBorder ? theme.borders.borderRadiusMd : undefined,\n            borderBottomRightRadius: withBorder ? theme.borders.borderRadiusMd : undefined,\n            padding: withBorder ? theme.spacing.sm : 0,\n          }}\n        >\n          {children}\n        </div>\n      )}\n    </div>\n  );\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { ModelTraceExplorerChatTool } from './ModelTraceExplorerChatTool';\nimport { ModelTraceExplorerConversation } from './ModelTraceExplorerConversation';\nimport type { ModelTraceChatMessage, ModelTraceChatTool } from '../ModelTrace.types';\nimport { ModelTraceExplorerCollapsibleSection } from '../ModelTraceExplorerCollapsibleSection';\n\nexport function ModelTraceExplorerChatTab({\n  chatMessages,\n  chatTools,\n}: {\n  chatMessages: ModelTraceChatMessage[];\n  chatTools?: ModelTraceChatTool[];\n}) {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        overflowY: 'auto',\n        padding: theme.spacing.md,\n      }}\n      data-testid=\"model-trace-explorer-chat-tab\"\n    >\n      {chatTools && (\n        <ModelTraceExplorerCollapsibleSection\n          css={{ marginBottom: theme.spacing.sm }}\n          title={\n            <FormattedMessage\n              defaultMessage=\"Tools\"\n              description=\"Section header in the chat tab that displays all tools that were available for the chat model to call during execution\"\n            />\n          }\n          sectionKey=\"messages\"\n        >\n          <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.sm }}>\n            {chatTools.map((tool) => (\n              <ModelTraceExplorerChatTool key={tool.function.name} tool={tool} />\n            ))}\n          </div>\n        </ModelTraceExplorerCollapsibleSection>\n      )}\n\n      <ModelTraceExplorerCollapsibleSection\n        title={\n          <FormattedMessage\n            defaultMessage=\"Messages\"\n            description=\"Section header in the chat tab that displays the message history between the user and the chat model\"\n          />\n        }\n        sectionKey=\"messages\"\n      >\n        <ModelTraceExplorerConversation messages={chatMessages} />\n      </ModelTraceExplorerCollapsibleSection>\n    </div>\n  );\n}\n","import { isNil } from 'lodash';\nimport { useMemo } from 'react';\n\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport type { ModelTraceSpanNode, SearchMatch } from '../ModelTrace.types';\nimport { createListFromObject } from '../ModelTraceExplorer.utils';\nimport { ModelTraceExplorerCodeSnippet } from '../ModelTraceExplorerCodeSnippet';\nimport { ModelTraceExplorerCollapsibleSection } from '../ModelTraceExplorerCollapsibleSection';\n\nexport function ModelTraceExplorerDefaultSpanView({\n  activeSpan,\n  className,\n  searchFilter,\n  activeMatch,\n}: {\n  activeSpan: ModelTraceSpanNode | undefined;\n  className?: string;\n  searchFilter: string;\n  activeMatch: SearchMatch | null;\n}) {\n  const { theme } = useDesignSystemTheme();\n  const inputList = useMemo(() => createListFromObject(activeSpan?.inputs), [activeSpan]);\n  const outputList = useMemo(() => createListFromObject(activeSpan?.outputs), [activeSpan]);\n\n  if (isNil(activeSpan)) {\n    return null;\n  }\n\n  const containsInputs = inputList.length > 0;\n  const containsOutputs = outputList.length > 0;\n\n  const isActiveMatchSpan = !isNil(activeMatch) && activeMatch.span.key === activeSpan.key;\n\n  return (\n    <div data-testid=\"model-trace-explorer-default-span-view\">\n      {containsInputs && (\n        <ModelTraceExplorerCollapsibleSection\n          withBorder\n          css={{ marginBottom: theme.spacing.sm }}\n          sectionKey=\"input\"\n          title={\n            <div\n              css={{\n                display: 'flex',\n                flexDirection: 'row',\n                alignItems: 'center',\n                justifyContent: 'space-between',\n                width: '100%',\n              }}\n            >\n              <FormattedMessage\n                defaultMessage=\"Inputs\"\n                description=\"Model trace explorer > selected span > inputs header\"\n              />\n            </div>\n          }\n        >\n          <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.sm }}>\n            {inputList.map(({ key, value }, index) => (\n              <ModelTraceExplorerCodeSnippet\n                key={key || index}\n                title={key}\n                data={value}\n                searchFilter={searchFilter}\n                activeMatch={activeMatch}\n                containsActiveMatch={isActiveMatchSpan && activeMatch.section === 'inputs' && activeMatch.key === key}\n              />\n            ))}\n          </div>\n        </ModelTraceExplorerCollapsibleSection>\n      )}\n      {containsOutputs && (\n        <ModelTraceExplorerCollapsibleSection\n          withBorder\n          sectionKey=\"output\"\n          title={\n            <div css={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-between', width: '100%' }}>\n              <FormattedMessage\n                defaultMessage=\"Outputs\"\n                description=\"Model trace explorer > selected span > outputs header\"\n              />\n            </div>\n          }\n        >\n          <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.sm }}>\n            {outputList.map(({ key, value }) => (\n              <ModelTraceExplorerCodeSnippet\n                key={key}\n                title={key}\n                data={value}\n                searchFilter={searchFilter}\n                activeMatch={activeMatch}\n                containsActiveMatch={isActiveMatchSpan && activeMatch.section === 'outputs' && activeMatch.key === key}\n              />\n            ))}\n          </div>\n        </ModelTraceExplorerCollapsibleSection>\n      )}\n    </div>\n  );\n}\n","import type { Interpolation, Theme } from '@emotion/react';\n\nimport { Tag, Tooltip, Typography } from '@databricks/design-system';\n\n// max characters for key + value before truncation\nconst MAX_CHARS_LENGTH = 18;\n\nconst getTruncatedStyles = (shouldTruncate: boolean): Interpolation<Theme> =>\n  shouldTruncate\n    ? {\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        whiteSpace: 'nowrap',\n      }\n    : { whiteSpace: 'nowrap' };\n\n/**\n * A <Tag /> wrapper used for displaying key-value entity\n */\nexport const KeyValueTag = ({\n  itemKey,\n  itemValue,\n  charLimit = MAX_CHARS_LENGTH,\n  maxWidth = 150,\n  className,\n}: {\n  itemKey: string;\n  itemValue: string;\n  charLimit?: number;\n  maxWidth?: number;\n  className?: string;\n}) => {\n  const { shouldTruncateKey, shouldTruncateValue } = getKeyAndValueComplexTruncation(itemKey, itemValue, charLimit);\n\n  return (\n    <Tooltip componentId=\"shared.model-trace-explorer.key-value-tag.hover-tooltip\" content={`${itemKey}: ${itemValue}`}>\n      <Tag componentId=\"shared.model-trace-explorer.key-value-tag\" className={className}>\n        <span css={{ maxWidth, display: 'inline-flex' }}>\n          <Typography.Text bold css={getTruncatedStyles(shouldTruncateKey)} size=\"sm\">\n            {itemKey}\n          </Typography.Text>\n          :&nbsp;\n          <Typography.Text css={getTruncatedStyles(shouldTruncateValue)} size=\"sm\">\n            {itemValue}\n          </Typography.Text>\n        </span>\n      </Tag>\n    </Tooltip>\n  );\n};\n\nexport function getKeyAndValueComplexTruncation(\n  key: string,\n  value: string,\n  charLimit: number,\n): { shouldTruncateKey: boolean; shouldTruncateValue: boolean } {\n  const fullLength = key.length + value.length;\n  const isKeyLonger = key.length > value.length;\n  const shorterLength = isKeyLonger ? value.length : key.length;\n\n  // No need to truncate if tag is short enough\n  if (fullLength <= charLimit) return { shouldTruncateKey: false, shouldTruncateValue: false };\n  // If the shorter string is too long, truncate both key and value.\n  if (shorterLength > charLimit / 2) return { shouldTruncateKey: true, shouldTruncateValue: true };\n\n  // Otherwise truncate the longer string\n  return {\n    shouldTruncateKey: isKeyLonger,\n    shouldTruncateValue: !isKeyLonger,\n  };\n}\n","import { Button, ChevronUpIcon, FileDocumentIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { GenAIMarkdownRenderer } from '../../genai-markdown-renderer';\nimport { KeyValueTag } from '../key-value-tag/KeyValueTag';\n\nexport function ModelTraceExplorerRetrieverDocumentFull({\n  text,\n  metadataTags,\n  setExpanded,\n  logDocumentClick,\n}: {\n  text: string;\n  metadataTags: { key: string; value: string }[];\n  setExpanded: (expanded: boolean) => void;\n  logDocumentClick?: (action: string) => void;\n}) {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ display: 'flex', flexDirection: 'column' }}>\n      <div\n        role=\"button\"\n        onClick={() => {\n          setExpanded(false);\n          logDocumentClick?.('collapse');\n        }}\n        css={{\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n          cursor: 'pointer',\n          padding: `${theme.spacing.sm}px ${theme.spacing.md}px`,\n          height: theme.typography.lineHeightBase,\n          boxSizing: 'content-box',\n          '&:hover': {\n            backgroundColor: theme.colors.backgroundSecondary,\n          },\n        }}\n      >\n        <FileDocumentIcon />\n      </div>\n      <div css={{ padding: theme.spacing.md, paddingBottom: 0 }}>\n        <GenAIMarkdownRenderer>{text}</GenAIMarkdownRenderer>\n      </div>\n      <div css={{ padding: theme.spacing.md, paddingTop: 0 }}>\n        {metadataTags.map(({ key, value }) => (\n          <KeyValueTag key={key} itemKey={key} itemValue={value} />\n        ))}\n      </div>\n      <Button\n        css={{ width: '100%', padding: theme.spacing.sm }}\n        componentId=\"shared.model-trace-explorer.retriever-document-collapse\"\n        icon={<ChevronUpIcon />}\n        type=\"tertiary\"\n        onClick={() => setExpanded(false)}\n      >\n        <FormattedMessage\n          defaultMessage=\"See less\"\n          description=\"Model trace explorer > selected span > code snippet > see less button\"\n        />\n      </Button>\n    </div>\n  );\n}\n","import { FileDocumentIcon, Tag, Tooltip, Typography, useDesignSystemTheme } from '@databricks/design-system';\n\nimport { KeyValueTag } from '../key-value-tag/KeyValueTag';\n\nexport function ModelTraceExplorerRetrieverDocumentPreview({\n  text,\n  metadataTags,\n  setExpanded,\n  logDocumentClick,\n}: {\n  text: string;\n  metadataTags: { key: string; value: string }[];\n  setExpanded: (expanded: boolean) => void;\n  logDocumentClick?: (action: string) => void;\n}) {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      role=\"button\"\n      onClick={() => {\n        setExpanded(true);\n        logDocumentClick?.('expand');\n      }}\n      css={{\n        display: 'flex',\n        flexDirection: 'row',\n        padding: `${theme.spacing.sm}px ${theme.spacing.md}px`,\n        gap: theme.spacing.sm,\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        cursor: 'pointer',\n        '&:hover': {\n          backgroundColor: theme.colors.backgroundSecondary,\n        },\n      }}\n    >\n      <div\n        css={{\n          display: 'flex',\n          flexDirection: 'row',\n          gap: theme.spacing.sm,\n          alignItems: 'center',\n          minWidth: 0,\n          flexShrink: 1,\n        }}\n      >\n        <FileDocumentIcon />\n        <Typography.Text ellipsis size=\"md\">\n          {text}\n        </Typography.Text>\n      </div>\n      <div\n        css={{\n          display: 'flex',\n          flexDirection: 'row',\n          gap: theme.spacing.sm,\n        }}\n      >\n        {metadataTags.length > 0 ? (\n          <KeyValueTag css={{ margin: 0 }} itemKey={metadataTags[0].key} itemValue={metadataTags[0].value} />\n        ) : null}\n        {metadataTags.length > 1 ? (\n          <Tooltip\n            componentId=\"shared.model-trace-explorer.tag-count.hover-tooltip\"\n            content={metadataTags.slice(1).map(({ key, value }) => (\n              <span key={key} css={{ display: 'inline-block' }}>\n                {`${key}: ${value}`}\n              </span>\n            ))}\n          >\n            <Tag componentId=\"shared.model-trace-explorer.tag-count\" css={{ whiteSpace: 'nowrap', margin: 0 }}>\n              +{metadataTags.length - 1}\n            </Tag>\n          </Tooltip>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n","import { useCallback, useState } from 'react';\n\nimport { ModelTraceExplorerRetrieverDocumentFull } from './ModelTraceExplorerRetrieverDocumentFull';\nimport { ModelTraceExplorerRetrieverDocumentPreview } from './ModelTraceExplorerRetrieverDocumentPreview';\nimport { createListFromObject } from '../ModelTraceExplorer.utils';\n\nexport function ModelTraceExplorerRetrieverDocument({\n  text,\n  metadata,\n}: {\n  text: string;\n  metadata: { [key: string]: any };\n}) {\n  const [expanded, setExpanded] = useState(false);\n  const metadataTags = createListFromObject(metadata);\n\n  return expanded ? (\n    <ModelTraceExplorerRetrieverDocumentFull\n      // comment to prevent copybara formatting\n      text={text}\n      metadataTags={metadataTags}\n      setExpanded={setExpanded}\n    />\n  ) : (\n    <ModelTraceExplorerRetrieverDocumentPreview\n      // comment to prevent copybara formatting\n      text={text}\n      metadataTags={metadataTags}\n      setExpanded={setExpanded}\n    />\n  );\n}\n","import {\n  MIcon,\n  SegmentedControlButton,\n  SegmentedControlGroup,\n  TextBoxIcon,\n  Tooltip,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nexport function ModelTraceExplorerRenderModeToggle({\n  shouldRenderMarkdown,\n  setShouldRenderMarkdown,\n}: {\n  shouldRenderMarkdown: boolean;\n  setShouldRenderMarkdown: (value: boolean) => void;\n}) {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <SegmentedControlGroup\n      data-testid=\"model-trace-explorer-render-mode-toggle\"\n      name=\"render-mode\"\n      size=\"small\"\n      componentId={`shared.model-trace-explorer.toggle-markdown-rendering-${!shouldRenderMarkdown}`}\n      value={shouldRenderMarkdown}\n      onChange={(event) => {\n        setShouldRenderMarkdown(event.target.value);\n      }}\n    >\n      <SegmentedControlButton data-testid=\"model-trace-explorer-render-raw-input-button\" value={false}>\n        <Tooltip\n          componentId=\"shared.model-trace-explorer.raw-input-rendering-tooltip\"\n          content={\n            <FormattedMessage\n              defaultMessage=\"Raw input\"\n              description=\"Tooltip content for a button that changes the render mode of the data to raw input (JSON)\"\n            />\n          }\n        >\n          <div css={{ display: 'flex', alignItems: 'center' }}>\n            <TextBoxIcon css={{ fontSize: theme.typography.fontSizeLg }} />\n          </div>\n        </Tooltip>\n      </SegmentedControlButton>\n      <SegmentedControlButton data-testid=\"model-trace-explorer-render-default-button\" value>\n        <Tooltip\n          componentId=\"shared.model-trace-explorer.default-rendering-tooltip\"\n          content={\n            <FormattedMessage\n              defaultMessage=\"Default rendering\"\n              description=\"Tooltip content for a button that changes the render mode to default\"\n            />\n          }\n        >\n          <div css={{ display: 'flex', alignItems: 'center' }}>\n            <MIcon css={{ fontSize: theme.typography.fontSizeLg }} />\n          </div>\n        </Tooltip>\n      </SegmentedControlButton>\n    </SegmentedControlGroup>\n  );\n}\n","import { isNil } from 'lodash';\nimport { useMemo, useState } from 'react';\n\nimport { Tag, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { ModelTraceExplorerRetrieverDocument } from './ModelTraceExplorerRetrieverDocument';\nimport type { ModelTraceSpanNode, RetrieverDocument, SearchMatch } from '../ModelTrace.types';\nimport { createListFromObject } from '../ModelTraceExplorer.utils';\nimport { ModelTraceExplorerCodeSnippet } from '../ModelTraceExplorerCodeSnippet';\nimport { ModelTraceExplorerCollapsibleSection } from '../ModelTraceExplorerCollapsibleSection';\nimport { ModelTraceExplorerRenderModeToggle } from '../ModelTraceExplorerRenderModeToggle';\n\nexport function ModelTraceExplorerRetrieverSpanView({\n  activeSpan,\n  className,\n  searchFilter,\n  activeMatch,\n}: {\n  activeSpan: ModelTraceSpanNode;\n  className?: string;\n  searchFilter: string;\n  activeMatch: SearchMatch | null;\n}) {\n  const { theme } = useDesignSystemTheme();\n  const [shouldRenderMarkdown, setShouldRenderMarkdown] = useState(true);\n  const inputList = useMemo(() => createListFromObject(activeSpan.inputs), [activeSpan]);\n\n  const outputs = activeSpan.outputs as RetrieverDocument[];\n\n  const containsInputs = inputList.length > 0;\n\n  // search highlighting is not supported in markdown rendering, so\n  // if there is an active match in the documents, we have to render\n  // them as code snippets.\n  const isActiveMatchSpan = !isNil(activeMatch) && activeMatch.span.key === activeSpan.key;\n  const outputsContainsActiveMatch = isActiveMatchSpan && activeMatch.section === 'outputs';\n\n  return (\n    <div className={className} data-testid=\"model-trace-explorer-retriever-span-view\">\n      {containsInputs && (\n        <ModelTraceExplorerCollapsibleSection\n          sectionKey=\"input\"\n          css={{ marginBottom: theme.spacing.sm }}\n          title={\n            <FormattedMessage\n              defaultMessage=\"Inputs\"\n              description=\"Model trace explorer > selected span > inputs header\"\n            />\n          }\n        >\n          <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.sm }}>\n            {inputList.map(({ key, value }, index) => (\n              <ModelTraceExplorerCodeSnippet\n                key={key || index}\n                title={key}\n                data={value}\n                searchFilter={searchFilter}\n                activeMatch={activeMatch}\n                containsActiveMatch={isActiveMatchSpan && activeMatch.section === 'inputs' && activeMatch.key === key}\n              />\n            ))}\n          </div>\n        </ModelTraceExplorerCollapsibleSection>\n      )}\n\n      <ModelTraceExplorerCollapsibleSection\n        sectionKey=\"output\"\n        title={\n          <div\n            css={{\n              display: 'flex',\n              flexDirection: 'row',\n              alignItems: 'center',\n              justifyContent: 'space-between',\n              width: '100%',\n            }}\n          >\n            <div css={{ display: 'flex', flexDirection: 'row', gap: theme.spacing.sm }}>\n              <FormattedMessage\n                defaultMessage=\"Documents\"\n                description=\"Model trace explorer > retriever span > documents header\"\n              />\n              <Tag componentId=\"shared.model-trace-explorer.document-count\">{outputs.length}</Tag>\n            </div>\n            {!outputsContainsActiveMatch && (\n              <ModelTraceExplorerRenderModeToggle\n                shouldRenderMarkdown={shouldRenderMarkdown}\n                setShouldRenderMarkdown={setShouldRenderMarkdown}\n              />\n            )}\n          </div>\n        }\n      >\n        {shouldRenderMarkdown && !outputsContainsActiveMatch ? (\n          <div\n            css={{\n              border: `1px solid ${theme.colors.border}`,\n              borderRadius: theme.legacyBorders.borderRadiusMd,\n            }}\n          >\n            {outputs.map((document, idx) => (\n              <div\n                key={idx}\n                css={{ borderBottom: idx !== outputs.length - 1 ? `1px solid ${theme.colors.border}` : '' }}\n              >\n                <ModelTraceExplorerRetrieverDocument\n                  key={idx}\n                  text={document.page_content}\n                  metadata={document.metadata}\n                />\n              </div>\n            ))}\n          </div>\n        ) : (\n          <div\n            css={{\n              border: `1px solid ${theme.colors.border}`,\n              borderRadius: theme.legacyBorders.borderRadiusMd,\n              padding: theme.spacing.md,\n            }}\n          >\n            <ModelTraceExplorerCodeSnippet\n              title=\"\"\n              data={JSON.stringify(outputs, null, 2)}\n              searchFilter={searchFilter}\n              activeMatch={activeMatch}\n              containsActiveMatch={isActiveMatchSpan && activeMatch.section === 'outputs'}\n            />\n          </div>\n        )}\n      </ModelTraceExplorerCollapsibleSection>\n    </div>\n  );\n}\n","import { isNil } from 'lodash';\n\nimport { useDesignSystemTheme } from '@databricks/design-system';\n\nimport { ModelTraceExplorerDefaultSpanView } from './ModelTraceExplorerDefaultSpanView';\nimport { ModelTraceExplorerRetrieverSpanView } from './ModelTraceExplorerRetrieverSpanView';\nimport type { ModelTraceSpanNode, SearchMatch } from '../ModelTrace.types';\nimport { isRenderableRetrieverSpan } from '../ModelTraceExplorer.utils';\n\nexport function ModelTraceExplorerContentTab({\n  activeSpan,\n  className,\n  searchFilter,\n  activeMatch,\n}: {\n  activeSpan: ModelTraceSpanNode | undefined;\n  className?: string;\n  searchFilter: string;\n  activeMatch: SearchMatch | null;\n}) {\n  const { theme } = useDesignSystemTheme();\n\n  if (!isNil(activeSpan) && isRenderableRetrieverSpan(activeSpan)) {\n    return (\n      <div\n        css={{\n          overflowY: 'auto',\n          padding: theme.spacing.md,\n        }}\n        className={className}\n        data-testid=\"model-trace-explorer-content-tab\"\n      >\n        <ModelTraceExplorerRetrieverSpanView\n          activeSpan={activeSpan}\n          className={className}\n          searchFilter={searchFilter}\n          activeMatch={activeMatch}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div\n      css={{\n        overflowY: 'auto',\n        padding: theme.spacing.md,\n      }}\n      className={className}\n      data-testid=\"model-trace-explorer-content-tab\"\n    >\n      <ModelTraceExplorerDefaultSpanView\n        activeSpan={activeSpan}\n        className={className}\n        searchFilter={searchFilter}\n        activeMatch={activeMatch}\n      />\n    </div>\n  );\n}\n","import { isNil } from 'lodash';\n\nimport { Empty, Typography, useDesignSystemTheme, XCircleIcon } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { CodeSnippetRenderMode, type ModelTraceSpanNode, type SearchMatch } from '../ModelTrace.types';\nimport { getEventAttributeKey } from '../ModelTraceExplorer.utils';\nimport { ModelTraceExplorerCodeSnippet } from '../ModelTraceExplorerCodeSnippet';\nimport { ModelTraceExplorerCollapsibleSection } from '../ModelTraceExplorerCollapsibleSection';\n\nexport function ModelTraceExplorerEventsTab({\n  activeSpan,\n  searchFilter,\n  activeMatch,\n}: {\n  activeSpan: ModelTraceSpanNode;\n  searchFilter: string;\n  activeMatch: SearchMatch | null;\n}) {\n  const { theme } = useDesignSystemTheme();\n  const { events } = activeSpan;\n  const isActiveMatchSpan = !isNil(activeMatch) && activeMatch.span.key === activeSpan.key;\n\n  if (!Array.isArray(events) || events.length === 0) {\n    return (\n      <div css={{ marginTop: theme.spacing.md }}>\n        <Empty\n          description={\n            <FormattedMessage\n              defaultMessage=\"No events found\"\n              description=\"Empty state for the events tab in the model trace explorer. Events are logs of arbitrary things (e.g. exceptions) that occur during the execution of a span, and can be user-defined.\"\n            />\n          }\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div css={{ padding: theme.spacing.md }}>\n      {events.map((event, index) => {\n        const attributes = event.attributes;\n        const title =\n          event.name === 'exception' ? (\n            <>\n              <XCircleIcon css={{ marginRight: theme.spacing.sm }} color=\"danger\" />\n              <Typography.Text color=\"error\" bold>\n                Exception\n              </Typography.Text>\n            </>\n          ) : (\n            event.name\n          );\n\n        if (!attributes) return null;\n\n        return (\n          <ModelTraceExplorerCollapsibleSection\n            key={`${event.name}-${index}`}\n            sectionKey={event.name}\n            title={title}\n            withBorder\n          >\n            <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.sm }}>\n              {Object.keys(attributes).map((attribute) => {\n                const key = getEventAttributeKey(event.name, index, attribute);\n\n                return (\n                  <ModelTraceExplorerCodeSnippet\n                    key={key}\n                    title={attribute}\n                    data={JSON.stringify(attributes[attribute], null, 2)}\n                    searchFilter={searchFilter}\n                    activeMatch={activeMatch}\n                    containsActiveMatch={\n                      isActiveMatchSpan && activeMatch.section === 'events' && activeMatch.key === key\n                    }\n                    initialRenderMode={CodeSnippetRenderMode.TEXT}\n                  />\n                );\n              })}\n            </div>\n          </ModelTraceExplorerCollapsibleSection>\n        );\n      })}\n    </div>\n  );\n}\n","import { useDesignSystemTheme } from '@databricks/design-system';\n\nexport function ModelTraceExplorerBadge({ count }: { count: number }) {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        borderRadius: theme.typography.fontSizeBase,\n        height: theme.typography.fontSizeBase,\n        backgroundColor: theme.colors.actionDangerPrimaryBackgroundDefault,\n        padding: theme.spacing.xs,\n        marginLeft: theme.spacing.xs,\n        boxSizing: 'border-box',\n      }}\n    >\n      <span css={{ color: theme.colors.actionPrimaryTextDefault, fontSize: 11 }}>{count}</span>\n    </div>\n  );\n}\n","import { GavelIcon, SegmentedControlGroup, SegmentedControlButton } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { useModelTraceExplorerViewState } from '../ModelTraceExplorerViewStateContext';\n\nexport const AssessmentPaneToggle = () => {\n  const { assessmentsPaneExpanded, setAssessmentsPaneExpanded, assessmentsPaneEnabled } =\n    useModelTraceExplorerViewState();\n\n  return (\n    <SegmentedControlGroup\n      css={{ display: 'block' }}\n      name=\"shared.model-trace-explorer.assessments-pane-toggle\"\n      componentId=\"shared.model-trace-explorer.assessments-pane-toggle\"\n      value={assessmentsPaneExpanded}\n      size=\"small\"\n    >\n      <SegmentedControlButton\n        value\n        disabled={!assessmentsPaneEnabled}\n        icon={<GavelIcon />}\n        onClick={() => setAssessmentsPaneExpanded?.(!assessmentsPaneExpanded)}\n        css={{\n          '& > span': {\n            display: 'flex',\n            alignItems: 'center',\n          },\n        }}\n      >\n        {!assessmentsPaneExpanded && (\n          <FormattedMessage\n            defaultMessage=\"Assessments\"\n            description=\"Label for the assessments pane of the model trace explorer.\"\n          />\n        )}\n      </SegmentedControlButton>\n    </SegmentedControlGroup>\n  );\n};\n","import { FormattedMessage } from '@databricks/i18n';\n\nimport type { Expectation, Feedback } from '../ModelTrace.types';\n\nexport type AssessmentFormInputDataType = 'string' | 'boolean' | 'number' | 'json';\n\nexport const ASSESSMENT_PANE_MIN_WIDTH = 250;\n\n// assessment names from databricks judges can sometimes have several\n// prefixes that function like namespaces. for example:\n//\n// metric/global_guideline_adherence/api_code\n//\n// in this case, we only want to display the last element, as that\n// is the most helpful name to the user (and to save ui space).\n// if there are more slashes beyond that, we assume the user added\n// it themselves, so we retain them.\nexport const getAssessmentDisplayName = (name: string): string => {\n  const split = name.split('/');\n  if (split.length === 1) {\n    return name;\n  } else if (split.length === 2) {\n    return split[1];\n  }\n  return split.slice(2).join('/');\n};\n\n// forked from mlflow/web/js/src/common/utils/Utils.tsx\nexport const timeSinceStr = (date: any, referenceDate = new Date()) => {\n  const seconds = Math.max(0, Math.floor((referenceDate.getTime() - date) / 1000));\n  let interval = Math.floor(seconds / 31536000);\n\n  if (interval >= 1) {\n    return (\n      <FormattedMessage\n        defaultMessage=\"{timeSince, plural, =1 {1 year} other {# years}} ago\"\n        description=\"Text for time in years since given date for MLflow views\"\n        values={{ timeSince: interval }}\n      />\n    );\n  }\n  interval = Math.floor(seconds / 2592000);\n  if (interval >= 1) {\n    return (\n      <FormattedMessage\n        defaultMessage=\"{timeSince, plural, =1 {1 month} other {# months}} ago\"\n        description=\"Text for time in months since given date for MLflow views\"\n        values={{ timeSince: interval }}\n      />\n    );\n  }\n  interval = Math.floor(seconds / 86400);\n  if (interval >= 1) {\n    return (\n      <FormattedMessage\n        defaultMessage=\"{timeSince, plural, =1 {1 day} other {# days}} ago\"\n        description=\"Text for time in days since given date for MLflow views\"\n        values={{ timeSince: interval }}\n      />\n    );\n  }\n  interval = Math.floor(seconds / 3600);\n  if (interval >= 1) {\n    return (\n      <FormattedMessage\n        defaultMessage=\"{timeSince, plural, =1 {1 hour} other {# hours}} ago\"\n        description=\"Text for time in hours since given date for MLflow views\"\n        values={{ timeSince: interval }}\n      />\n    );\n  }\n  interval = Math.floor(seconds / 60);\n  if (interval >= 1) {\n    return (\n      <FormattedMessage\n        defaultMessage=\"{timeSince, plural, =1 {1 minute} other {# minutes}} ago\"\n        description=\"Text for time in minutes since given date for MLflow views\"\n        values={{ timeSince: interval }}\n      />\n    );\n  }\n  return (\n    <FormattedMessage\n      defaultMessage=\"{timeSince, plural, =1 {1 second} other {# seconds}} ago\"\n      description=\"Text for time in seconds since given date for MLflow views\"\n      values={{ timeSince: seconds }}\n    />\n  );\n};\n\nexport const getParsedExpectationValue = (expectation: Expectation) => {\n  if ('value' in expectation) {\n    return expectation.value;\n  }\n\n  try {\n    // at the moment, \"JSON_FORMAT\" is the only serialization format\n    // that is supported. in the future, we may switch on the\n    // expectation.serialized_value.serialization_format field\n    // to determine how to parse the value.\n    return JSON.parse(expectation.serialized_value.value);\n  } catch (e) {\n    return expectation.serialized_value.value;\n  }\n};\n\nexport const getCreateAssessmentPayloadValue = ({\n  formValue,\n  dataType,\n  isFeedback,\n}: {\n  formValue: string | boolean | number | null;\n  dataType: AssessmentFormInputDataType;\n  isFeedback: boolean;\n}): { feedback: Feedback } | { expectation: Expectation } => {\n  if (isFeedback) {\n    return { feedback: { value: formValue } };\n  }\n\n  if (dataType === 'json') {\n    return { expectation: { serialized_value: { value: String(formValue), serialization_format: 'JSON_FORMAT' } } };\n  }\n\n  return { expectation: { value: formValue } };\n};\n","import { matchPredefinedError } from '@databricks/web-shared/errors';\n\n// eslint-disable-next-line no-restricted-globals -- See go/spog-fetch\nconst fetchFn = fetch;\n\nfunction serializeRequestBody(payload: any | FormData | Blob) {\n  if (payload === undefined) {\n    return undefined;\n  }\n  return typeof payload === 'string' || payload instanceof FormData || payload instanceof Blob\n    ? payload\n    : JSON.stringify(payload);\n}\n\nexport const fetchAPI = async (url: string, method: 'POST' | 'GET' | 'PATCH' | 'DELETE' = 'GET', body?: any) => {\n  const response = await fetchFn(url, {\n    method,\n    body: serializeRequestBody(body),\n    headers: body ? { 'Content-Type': 'application/json' } : {},\n  });\n  if (!response.ok) {\n    const predefinedError = matchPredefinedError(response);\n    if (predefinedError) {\n      try {\n        // Attempt to use message from the response\n        const message = (await response.json()).message;\n        predefinedError.message = message ?? predefinedError.message;\n      } catch {\n        // If the message can't be parsed, use default one\n      }\n      throw predefinedError;\n    }\n  }\n  return response.json();\n};\n","import type { Assessment, Expectation, Feedback } from './ModelTrace.types';\nimport { fetchAPI } from './ModelTraceExplorer.request.utils';\n\nexport const deleteAssessment = ({ traceId, assessmentId }: { traceId: string; assessmentId: string }) =>\n  fetchAPI(`/ajax-api/3.0/mlflow/traces/${traceId}/assessments/${assessmentId}`, 'DELETE');\n\n// these fields are set by the server on create\nexport type CreateAssessmentPayload = {\n  assessment: Omit<Assessment, 'assessment_id' | 'create_time' | 'last_update_time'>;\n};\n\nexport const createAssessment = ({ payload }: { payload: CreateAssessmentPayload }) =>\n  fetchAPI(`/ajax-api/3.0/mlflow/traces/${payload.assessment.trace_id}/assessments`, 'POST', payload);\n\nexport const fetchTraceInfoV3 = ({ traceId }: { traceId: string }) =>\n  fetchAPI(`/ajax-api/3.0/mlflow/traces/${traceId}`);\n\nexport type UpdateAssessmentPayload = {\n  // we only support updating these fields\n  assessment: {\n    feedback?: Feedback;\n    expectation?: Expectation;\n    rationale?: string;\n    metadata?: Record<string, string>;\n  };\n  // comma-separated list of fields to update\n  update_mask: string;\n};\n\nexport const updateAssessment = ({\n  traceId,\n  assessmentId,\n  payload,\n}: {\n  traceId: string;\n  assessmentId: string;\n  payload: UpdateAssessmentPayload;\n}) => fetchAPI(`/ajax-api/3.0/mlflow/traces/${traceId}/assessments/${assessmentId}`, 'PATCH', payload);\n","import { createContext, useContext } from 'react';\n\nexport interface ModelTraceInfoRefetchContextType {\n  // the result of the refetch is not used, it\n  // is meant to refresh the trace info before\n  // it is passed into the ModelTraceExplorer component\n  refetchTraceInfo: null | (() => Promise<any>);\n}\n\nexport const ModelTraceInfoRefetchContext = createContext<ModelTraceInfoRefetchContextType>({\n  refetchTraceInfo: null,\n});\n\nexport const useModelTraceInfoRefetchContext = () => {\n  return useContext(ModelTraceInfoRefetchContext);\n};\n","import { isNil } from 'lodash';\nimport { useCallback, useState } from 'react';\n\nimport {\n  Button,\n  FormUI,\n  Input,\n  SegmentedControlButton,\n  SegmentedControlGroup,\n  SimpleSelect,\n  SimpleSelectOption,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { FormattedMessage, useIntl } from '@databricks/i18n';\nimport { useMutation } from '@databricks/web-shared/query-client';\n\nimport type { AssessmentFormInputDataType } from './AssessmentsPane.utils';\nimport { getCreateAssessmentPayloadValue } from './AssessmentsPane.utils';\nimport { displayErrorNotification, getCurrentUser } from '../ModelTraceExplorer.utils';\nimport type { CreateAssessmentPayload } from '../api';\nimport { createAssessment } from '../api';\nimport { useModelTraceInfoRefetchContext } from '../trace-context/ModelTraceInfoRefetchContext';\n\nexport const AssessmentCreateForm = ({\n  assessmentName,\n  spanId,\n  traceId,\n  // used to close the form\n  // after the assessment is created\n  setExpanded,\n}: {\n  assessmentName?: string;\n  spanId?: string;\n  traceId: string;\n  setExpanded: (expanded: boolean) => void;\n}) => {\n  const intl = useIntl();\n  const { theme } = useDesignSystemTheme();\n\n  const [name, setName] = useState('');\n  const [assessmentType, setAssessmentType] = useState<'feedback' | 'expectation'>('feedback');\n  const [dataType, setDataType] = useState<AssessmentFormInputDataType>('boolean');\n  const [value, setValue] = useState<string | boolean | number>(true);\n  const [rationale, setRationale] = useState('');\n  const [valueError, setValueError] = useState<React.ReactNode | null>(null);\n\n  const { refetchTraceInfo } = useModelTraceInfoRefetchContext();\n\n  const { mutate: createAssessmentMutation, isLoading } = useMutation({\n    mutationFn: (payload: CreateAssessmentPayload) => createAssessment({ payload }),\n    onSuccess: () => {\n      refetchTraceInfo?.();\n    },\n    onError: (error) => {\n      displayErrorNotification(\n        intl.formatMessage(\n          {\n            defaultMessage: 'Failed to create assessment. Error: {error}',\n            description: 'Error message when creating an assessment fails',\n          },\n          {\n            error: error instanceof Error ? error.message : String(error),\n          },\n        ),\n      );\n    },\n    onSettled: () => {\n      setExpanded(false);\n    },\n  });\n\n  const isNamePrefilled = !isNil(assessmentName);\n\n  const handleCreate = useCallback(async () => {\n    if (dataType === 'json') {\n      try {\n        // validate JSON\n        JSON.parse(value as string);\n      } catch (e) {\n        setValueError(\n          <FormattedMessage\n            defaultMessage=\"The provided value is not valid JSON\"\n            description=\"Error message for invalid JSON in an assessment creation form\"\n          />,\n        );\n        return;\n      }\n    }\n\n    const valueObj = getCreateAssessmentPayloadValue({\n      formValue: value,\n      dataType,\n      isFeedback: assessmentType === 'feedback',\n    });\n\n    const payload: CreateAssessmentPayload = {\n      assessment: {\n        assessment_name: isNamePrefilled ? assessmentName : name,\n        trace_id: traceId,\n        source: {\n          source_type: 'HUMAN',\n          source_id: getCurrentUser(),\n        },\n        span_id: spanId,\n        rationale,\n        ...valueObj,\n      },\n    };\n\n    await createAssessmentMutation(payload);\n  }, [\n    dataType,\n    value,\n    assessmentType,\n    isNamePrefilled,\n    assessmentName,\n    name,\n    traceId,\n    spanId,\n    rationale,\n    createAssessmentMutation,\n  ]);\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        gap: theme.spacing.xs,\n        marginTop: theme.spacing.sm,\n        border: `1px solid ${theme.colors.border}`,\n        padding: theme.spacing.sm,\n        borderRadius: theme.borders.borderRadiusSm,\n      }}\n    >\n      <Typography.Text size=\"sm\" color=\"secondary\">\n        <FormattedMessage\n          defaultMessage=\"Assessment Type\"\n          description=\"Field label for assessment type in a creation form\"\n        />\n      </Typography.Text>\n      <SimpleSelect\n        id=\"shared.model-trace-explorer.assessment-type-select\"\n        componentId=\"shared.model-trace-explorer.assessment-type-select\"\n        value={assessmentType}\n        disabled={isLoading}\n        onChange={(e) => setAssessmentType(e.target.value as 'feedback' | 'expectation')}\n      >\n        <SimpleSelectOption value=\"feedback\">\n          <FormattedMessage defaultMessage=\"Feedback\" description=\"Feedback select menu option for assessment type\" />\n        </SimpleSelectOption>\n        <SimpleSelectOption value=\"expectation\">\n          <FormattedMessage\n            defaultMessage=\"Expectation\"\n            description=\"Expectation select menu option for assessment type\"\n          />\n        </SimpleSelectOption>\n      </SimpleSelect>\n      <Typography.Text css={{ marginTop: theme.spacing.xs }} size=\"sm\" color=\"secondary\">\n        <FormattedMessage\n          defaultMessage=\"Assessment Name\"\n          description=\"Field label for assessment name in a creation form\"\n        />\n      </Typography.Text>\n      {isNamePrefilled ? (\n        <Typography.Text>{assessmentName}</Typography.Text>\n      ) : (\n        <Input\n          componentId=\"shared.model-trace-explorer.assessment-name-input\"\n          value={name}\n          disabled={isLoading}\n          onKeyDown={(e) => e.stopPropagation()}\n          onChange={(e) => setName(e.target.value)}\n        />\n      )}\n      <Typography.Text css={{ marginTop: theme.spacing.xs }} size=\"sm\" color=\"secondary\">\n        <FormattedMessage\n          defaultMessage=\"Data Type\"\n          description=\"Field label for assessment data type in a creation form\"\n        />\n      </Typography.Text>\n      <SimpleSelect\n        id=\"shared.model-trace-explorer.assessment-data-type-select\"\n        componentId=\"shared.model-trace-explorer.assessment-data-type-select\"\n        value={dataType}\n        disabled={isLoading}\n        onChange={(e) => {\n          setDataType(e.target.value as AssessmentFormInputDataType);\n          setValueError(null);\n        }}\n      >\n        {assessmentType === 'expectation' && (\n          <SimpleSelectOption value=\"json\">\n            <FormattedMessage defaultMessage=\"JSON\" description=\"JSON select menu option for assessment data type\" />\n          </SimpleSelectOption>\n        )}\n        <SimpleSelectOption value=\"string\">\n          <FormattedMessage defaultMessage=\"String\" description=\"String select menu option for assessment data type\" />\n        </SimpleSelectOption>\n        <SimpleSelectOption value=\"boolean\">\n          <FormattedMessage\n            defaultMessage=\"Boolean\"\n            description=\"Boolean select menu option for assessment data type\"\n          />\n        </SimpleSelectOption>\n        <SimpleSelectOption value=\"number\">\n          <FormattedMessage defaultMessage=\"Number\" description=\"Numeric select menu option for assessment data type\" />\n        </SimpleSelectOption>\n      </SimpleSelect>\n      <Typography.Text css={{ marginTop: theme.spacing.xs }} size=\"sm\" color=\"secondary\">\n        <FormattedMessage defaultMessage=\"Value\" description=\"Field label for assessment value in a creation form\" />\n      </Typography.Text>\n      {dataType === 'json' && (\n        <>\n          <Input.TextArea\n            componentId=\"shared.model-trace-explorer.assessment-edit-value-string-input\"\n            value={String(value)}\n            autoSize={{ minRows: 1, maxRows: 5 }}\n            onKeyDown={(e) => e.stopPropagation()}\n            onChange={(e) => {\n              setValue(e.target.value);\n              setValueError(null);\n            }}\n            validationState={valueError ? 'error' : undefined}\n            disabled={isLoading}\n          />\n          {valueError && (\n            <FormUI.Message\n              id=\"shared.model-trace-explorer.assessment-edit-value-json-error\"\n              message={valueError}\n              type=\"error\"\n            />\n          )}\n        </>\n      )}\n      {dataType === 'string' && (\n        <Input\n          componentId=\"shared.model-trace-explorer.assessment-value-string-input\"\n          value={String(value)}\n          onKeyDown={(e) => e.stopPropagation()}\n          onChange={(e) => {\n            setValue(e.target.value);\n            setValueError(null);\n          }}\n          disabled={isLoading}\n          allowClear\n        />\n      )}\n      {dataType === 'boolean' && (\n        <SegmentedControlGroup\n          componentId=\"shared.model-trace-explorer.assessment-value-boolean-input\"\n          name=\"shared.model-trace-explorer.assessment-value-boolean-input\"\n          value={value}\n          disabled={isLoading}\n          onChange={(e) => {\n            setValue(e.target.value);\n            setValueError(null);\n          }}\n        >\n          <SegmentedControlButton value>True</SegmentedControlButton>\n          <SegmentedControlButton value={false}>False</SegmentedControlButton>\n        </SegmentedControlGroup>\n      )}\n      {dataType === 'number' && (\n        <Input\n          componentId=\"shared.model-trace-explorer.assessment-value-number-input\"\n          value={String(value)}\n          onKeyDown={(e) => e.stopPropagation()}\n          onChange={(e) => {\n            setValue(e.target.value ? Number(e.target.value) : '');\n            setValueError(null);\n          }}\n          type=\"number\"\n          disabled={isLoading}\n          allowClear\n        />\n      )}\n      <Typography.Text css={{ marginTop: theme.spacing.xs }} size=\"sm\" color=\"secondary\">\n        <FormattedMessage\n          defaultMessage=\"Rationale\"\n          description=\"Field label for assessment rationale in a creation form\"\n        />\n      </Typography.Text>\n      <Input.TextArea\n        componentId=\"shared.model-trace-explorer.assessment-rationale-input\"\n        value={rationale}\n        autoSize={{ minRows: 1, maxRows: 5 }}\n        disabled={isLoading}\n        onKeyDown={(e) => e.stopPropagation()}\n        onChange={(e) => setRationale(e.target.value)}\n      />\n      <div css={{ display: 'flex', justifyContent: 'flex-end', marginTop: theme.spacing.xs }}>\n        <Button\n          componentId=\"shared.model-trace-explorer.assessment-create-button\"\n          disabled={isLoading}\n          onClick={() => setExpanded(false)}\n        >\n          <FormattedMessage\n            defaultMessage=\"Cancel\"\n            description=\"Button label for cancelling the creation of an assessment\"\n          />\n        </Button>\n        <Button\n          css={{ marginLeft: theme.spacing.sm }}\n          type=\"primary\"\n          componentId=\"shared.model-trace-explorer.assessment-create-button\"\n          onClick={handleCreate}\n          loading={isLoading}\n        >\n          <FormattedMessage defaultMessage=\"Create\" description=\"Button label for creating an assessment\" />\n        </Button>\n      </div>\n    </div>\n  );\n};\n","import { useState } from 'react';\n\nimport { Button, PlusIcon } from '@databricks/design-system';\n\nimport { AssessmentCreateForm } from './AssessmentCreateForm';\n\nexport const AssessmentCreateButton = ({\n  title,\n  assessmentName,\n  spanId,\n  traceId,\n}: {\n  title: string;\n  assessmentName?: string;\n  spanId?: string;\n  traceId: string;\n}) => {\n  const [expanded, setExpanded] = useState(false);\n\n  return (\n    <div>\n      <Button\n        size=\"small\"\n        componentId=\"shared.model-trace-explorer.add-new-assessment\"\n        icon={<PlusIcon />}\n        onClick={() => setExpanded(true)}\n      >\n        {title}\n      </Button>\n      {expanded && (\n        <AssessmentCreateForm\n          assessmentName={assessmentName}\n          spanId={spanId}\n          traceId={traceId}\n          setExpanded={setExpanded}\n        />\n      )}\n    </div>\n  );\n};\n","import { PencilIcon, TrashIcon, OverflowIcon, Button, DropdownMenu } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { shouldEnableAssessmentEditing } from '../FeatureUtils';\nimport type { Assessment } from '../ModelTrace.types';\nimport { getCurrentUser } from '../ModelTraceExplorer.utils';\n\nexport const AssessmentActionsOverflowMenu = ({\n  assessment,\n  setIsEditing,\n  setShowDeleteModal,\n}: {\n  assessment: Assessment;\n  setIsEditing?: (isEditing: boolean) => void;\n  setShowDeleteModal: (showDeleteModal: boolean) => void;\n}) => {\n  const isFeedback = 'feedback' in assessment;\n  const user = getCurrentUser();\n  // humans are not allowed to edit other humans' assessments\n  const isEditEnabled = shouldEnableAssessmentEditing();\n  const doesUserHavePermissions =\n    user === assessment.source.source_id || (isFeedback && assessment.source.source_type !== 'HUMAN');\n  const showEditButton = isEditEnabled && doesUserHavePermissions && setIsEditing;\n\n  return (\n    <DropdownMenu.Root>\n      <DropdownMenu.Trigger asChild>\n        <Button componentId=\"shared.model-trace-explorer.assessment-more-button\" icon={<OverflowIcon />} size=\"small\" />\n      </DropdownMenu.Trigger>\n      <DropdownMenu.Content minWidth={100}>\n        {showEditButton && (\n          <DropdownMenu.Item\n            componentId=\"shared.model-trace-explorer.assessment-edit-button\"\n            onClick={() => setIsEditing?.(true)}\n          >\n            <DropdownMenu.IconWrapper>\n              <PencilIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage defaultMessage=\"Edit\" description=\"Edit assessment menu item\" />\n          </DropdownMenu.Item>\n        )}\n        <DropdownMenu.Item\n          componentId=\"shared.model-trace-explorer.assessment-delete-button\"\n          onClick={() => setShowDeleteModal(true)}\n        >\n          <DropdownMenu.IconWrapper>\n            <TrashIcon />\n          </DropdownMenu.IconWrapper>\n          <FormattedMessage defaultMessage=\"Delete\" description=\"Delete assessment menu item\" />\n        </DropdownMenu.Item>\n      </DropdownMenu.Content>\n    </DropdownMenu.Root>\n  );\n};\n","import { useCallback } from 'react';\n\nimport { Modal } from '@databricks/design-system';\nimport { FormattedMessage, useIntl } from '@databricks/i18n';\nimport { useMutation } from '@databricks/web-shared/query-client';\n\nimport type { Assessment } from '../ModelTrace.types';\nimport { displayErrorNotification } from '../ModelTraceExplorer.utils';\nimport { deleteAssessment } from '../api';\nimport { useModelTraceInfoRefetchContext } from '../trace-context/ModelTraceInfoRefetchContext';\n\nexport const AssessmentDeleteModal = ({\n  assessment,\n  isModalVisible,\n  setIsModalVisible,\n}: {\n  assessment: Assessment;\n  isModalVisible: boolean;\n  setIsModalVisible: (isModalVisible: boolean) => void;\n}) => {\n  const intl = useIntl();\n  const { refetchTraceInfo } = useModelTraceInfoRefetchContext();\n\n  const { mutate: deleteAssessmentMutation, isLoading } = useMutation({\n    mutationFn: () => deleteAssessment({ traceId: assessment.trace_id, assessmentId: assessment.assessment_id }),\n    onSuccess: () => {\n      refetchTraceInfo?.();\n    },\n    onError: (error) => {\n      displayErrorNotification(\n        intl.formatMessage(\n          {\n            defaultMessage: 'Failed to delete assessment. Error: {error}',\n            description: 'Error message when deleting an assessment fails.',\n          },\n          {\n            error: error instanceof Error ? error.message : String(error),\n          },\n        ),\n      );\n    },\n    onSettled: () => {\n      setIsModalVisible(false);\n    },\n  });\n\n  const handleDelete = useCallback(async () => {\n    await deleteAssessmentMutation();\n  }, [deleteAssessmentMutation]);\n\n  return (\n    <Modal\n      componentId=\"shared.model-trace-explorer.assessment-delete-modal\"\n      visible={isModalVisible}\n      onOk={handleDelete}\n      okButtonProps={{ danger: true, loading: isLoading }}\n      okText={<FormattedMessage defaultMessage=\"Delete\" description=\"Delete assessment modal button text\" />}\n      onCancel={() => {\n        setIsModalVisible(false);\n      }}\n      cancelText={<FormattedMessage defaultMessage=\"Cancel\" description=\"Delete assessment modal cancel button text\" />}\n      confirmLoading={isLoading}\n      title={<FormattedMessage defaultMessage=\"Delete assessment\" description=\"Delete assessments modal title\" />}\n    >\n      <FormattedMessage\n        defaultMessage=\"Are you sure you want to delete this assessment?\"\n        description=\"Delete assessments modal confirmation text\"\n      />\n    </Modal>\n  );\n};\n","import { useIntl } from '@databricks/i18n';\nimport { useMutation } from '@databricks/web-shared/query-client';\n\nimport type { Assessment } from '../ModelTrace.types';\nimport { displayErrorNotification } from '../ModelTraceExplorer.utils';\nimport type { UpdateAssessmentPayload } from '../api';\nimport { updateAssessment } from '../api';\n\n// This API is used to update an assessment in place.\n// To override an assessment (preserving the original)\n// use `useOverrideAssessment` instead\nexport const useUpdateAssessment = ({\n  assessment,\n  refetchTraceInfo,\n  onSuccess,\n  onError,\n  onSettled,\n}: {\n  assessment: Assessment;\n  refetchTraceInfo: (() => Promise<any>) | null;\n  onSuccess?: () => void;\n  onError?: (error: any) => void;\n  onSettled?: () => void;\n}) => {\n  const intl = useIntl();\n  const { mutate: updateAssessmentMutation, isLoading } = useMutation({\n    mutationFn: (payload: UpdateAssessmentPayload) =>\n      updateAssessment({ traceId: assessment.trace_id, assessmentId: assessment.assessment_id, payload }),\n    onError: (error) => {\n      displayErrorNotification(\n        intl.formatMessage(\n          {\n            defaultMessage: 'Failed to update assessment. Error: {error}',\n            description: 'Error message when updating an assessment fails',\n          },\n          {\n            error: error instanceof Error ? error.message : String(error),\n          },\n        ),\n      );\n      onError?.(error);\n    },\n    onSuccess: () => {\n      refetchTraceInfo?.();\n      onSuccess?.();\n    },\n    onSettled: () => {\n      onSettled?.();\n    },\n  });\n\n  return {\n    updateAssessmentMutation,\n    isLoading,\n  };\n};\n","import { useCallback, useState } from 'react';\n\nimport {\n  Typography,\n  useDesignSystemTheme,\n  SimpleSelect,\n  SimpleSelectOption,\n  SegmentedControlGroup,\n  SegmentedControlButton,\n  Input,\n  Button,\n  FormUI,\n} from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport type { AssessmentFormInputDataType } from './AssessmentsPane.utils';\nimport { getCreateAssessmentPayloadValue } from './AssessmentsPane.utils';\nimport type { Assessment } from '../ModelTrace.types';\nimport { getCurrentUser } from '../ModelTraceExplorer.utils';\nimport type { UpdateAssessmentPayload } from '../api';\nimport { useOverrideAssessment } from '../hooks/useOverrideAssessment';\nimport { useUpdateAssessment } from '../hooks/useUpdateAssessment';\nimport { useModelTraceInfoRefetchContext } from '../trace-context/ModelTraceInfoRefetchContext';\n\n// default to the original type of the value if possible. however,\n// we only support editing simple types in the UI (i.e. not arrays / objects)\n// so if the value does not fit, we just default to boolean for simplicity\nconst getDefaultType = (value: any, isFeedback: boolean): AssessmentFormInputDataType => {\n  if (typeof value === 'string') {\n    // treat empty strings as null, default to boolean\n    if (value === '') {\n      return 'boolean';\n    }\n\n    if (isFeedback) {\n      return 'string';\n    }\n\n    try {\n      JSON.parse(value);\n      return 'json';\n    } catch (e) {\n      // not valid JSON, default to string\n      return 'string';\n    }\n  }\n\n  if (typeof value === 'boolean' || typeof value === 'number') {\n    return typeof value as 'boolean' | 'number';\n  }\n  return 'boolean';\n};\n\nconst getDefaultValue = (value: any): string | boolean | number | null => {\n  if (typeof value === 'string') {\n    // treat empty strings as null\n    return value || null;\n  }\n  if (typeof value === 'boolean' || typeof value === 'number') {\n    return value;\n  }\n  return null;\n};\n\nconst getAssessmentValue = (assessment: Assessment) => {\n  if ('feedback' in assessment) {\n    return assessment.feedback.value;\n  }\n\n  if ('value' in assessment.expectation) {\n    return assessment.expectation.value;\n  }\n\n  return assessment.expectation.serialized_value.value;\n};\n\nexport const AssessmentEditForm = ({\n  assessment,\n  onSuccess,\n  onSettled,\n  onCancel,\n}: {\n  assessment: Assessment;\n  onSuccess?: () => void;\n  onSettled?: () => void;\n  onCancel: () => void;\n}) => {\n  const isFeedback = 'feedback' in assessment;\n  const initialValue = getAssessmentValue(assessment);\n  const defaultType = getDefaultType(initialValue, isFeedback);\n  const defaultValue = getDefaultValue(initialValue);\n  const user = getCurrentUser();\n\n  const { theme } = useDesignSystemTheme();\n  const [dataType, setDataType] = useState<AssessmentFormInputDataType>(defaultType);\n  const [value, setValue] = useState<string | boolean | number | null>(defaultValue);\n  const [rationale, setRationale] = useState(assessment.rationale);\n  const [valueError, setValueError] = useState<React.ReactNode | null>(null);\n  const { refetchTraceInfo } = useModelTraceInfoRefetchContext();\n\n  const { updateAssessmentMutation, isLoading: isUpdating } = useUpdateAssessment({\n    assessment,\n    refetchTraceInfo,\n    onSuccess,\n    onSettled,\n  });\n\n  const { overrideAssessmentMutation, isLoading: isOverwriting } = useOverrideAssessment({\n    refetchTraceInfo,\n    onSuccess,\n    onSettled,\n  });\n\n  const isLoading = isUpdating || isOverwriting;\n\n  const handleUpdate = useCallback(async () => {\n    if (dataType === 'json') {\n      try {\n        JSON.parse(value as string);\n      } catch (e) {\n        setValueError(\n          <FormattedMessage\n            defaultMessage=\"The provided value is not valid JSON\"\n            description=\"Error message for invalid JSON in an assessment edit form\"\n          />,\n        );\n        return;\n      }\n    }\n\n    const valueObj = getCreateAssessmentPayloadValue({\n      formValue: value,\n      dataType,\n      isFeedback,\n    });\n\n    // if a user edits their own assessment, we update it in\n    // place as they are likely just correcting a mistake.\n    // expectation edits should always call the update API\n    if (user === assessment.source.source_id || !isFeedback) {\n      const payload: UpdateAssessmentPayload = {\n        assessment: {\n          ...valueObj,\n          rationale,\n        },\n        update_mask: `${isFeedback ? 'feedback' : 'expectation'},rationale`,\n      };\n\n      await updateAssessmentMutation(payload);\n    } else {\n      await overrideAssessmentMutation({\n        oldAssessment: assessment,\n        value: valueObj,\n        ...(rationale ? { rationale } : {}),\n      });\n    }\n  }, [dataType, value, isFeedback, user, assessment, rationale, updateAssessmentMutation, overrideAssessmentMutation]);\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        gap: theme.spacing.xs,\n        marginTop: theme.spacing.sm,\n        border: `1px solid ${theme.colors.border}`,\n        padding: theme.spacing.sm,\n        borderRadius: theme.borders.borderRadiusSm,\n      }}\n    >\n      <Typography.Text css={{ marginTop: theme.spacing.xs }} size=\"sm\" color=\"secondary\">\n        <FormattedMessage\n          defaultMessage=\"Data Type\"\n          description=\"Field label for assessment data type in an edit form\"\n        />\n      </Typography.Text>\n      <SimpleSelect\n        id=\"shared.model-trace-explorer.assessment-edit-data-type-select\"\n        componentId=\"shared.model-trace-explorer.assessment-edit-data-type-select\"\n        value={dataType}\n        disabled={isLoading}\n        onChange={(e) => {\n          setDataType(e.target.value as AssessmentFormInputDataType);\n          setValueError(null);\n        }}\n      >\n        {!isFeedback && (\n          <SimpleSelectOption value=\"json\">\n            <FormattedMessage defaultMessage=\"JSON\" description=\"JSON select menu option for assessment data type\" />\n          </SimpleSelectOption>\n        )}\n        <SimpleSelectOption value=\"string\">\n          <FormattedMessage defaultMessage=\"String\" description=\"String select menu option for assessment data type\" />\n        </SimpleSelectOption>\n        <SimpleSelectOption value=\"boolean\">\n          <FormattedMessage\n            defaultMessage=\"Boolean\"\n            description=\"Boolean select menu option for assessment data type\"\n          />\n        </SimpleSelectOption>\n        <SimpleSelectOption value=\"number\">\n          <FormattedMessage defaultMessage=\"Number\" description=\"Numeric select menu option for assessment data type\" />\n        </SimpleSelectOption>\n      </SimpleSelect>\n      <Typography.Text css={{ marginTop: theme.spacing.xs }} size=\"sm\" color=\"secondary\">\n        <FormattedMessage defaultMessage=\"Value\" description=\"Field label for assessment value in an edit form\" />\n      </Typography.Text>\n      {dataType === 'json' && (\n        <>\n          <Input.TextArea\n            componentId=\"shared.model-trace-explorer.assessment-edit-value-string-input\"\n            value={String(value)}\n            rows={3}\n            onKeyDown={(e) => e.stopPropagation()}\n            onChange={(e) => {\n              setValue(e.target.value);\n              setValueError(null);\n            }}\n            validationState={valueError ? 'error' : undefined}\n            disabled={isLoading}\n          />\n          {valueError && (\n            <FormUI.Message\n              id=\"shared.model-trace-explorer.assessment-edit-value-json-error\"\n              message={valueError}\n              type=\"error\"\n            />\n          )}\n        </>\n      )}\n      {dataType === 'string' && (\n        <Input\n          componentId=\"shared.model-trace-explorer.assessment-edit-value-string-input\"\n          value={String(value)}\n          onKeyDown={(e) => e.stopPropagation()}\n          onChange={(e) => {\n            setValue(e.target.value);\n            setValueError(null);\n          }}\n          disabled={isLoading}\n          allowClear\n        />\n      )}\n      {dataType === 'boolean' && (\n        <SegmentedControlGroup\n          componentId=\"shared.model-trace-explorer.assessment-edit-value-boolean-input\"\n          name=\"shared.model-trace-explorer.assessment-edit-value-boolean-input\"\n          value={value}\n          disabled={isLoading}\n          onChange={(e) => {\n            setValue(e.target.value);\n            setValueError(null);\n          }}\n        >\n          <SegmentedControlButton value>True</SegmentedControlButton>\n          <SegmentedControlButton value={false}>False</SegmentedControlButton>\n        </SegmentedControlGroup>\n      )}\n      {dataType === 'number' && (\n        <Input\n          componentId=\"shared.model-trace-explorer.assessment-edit-value-number-input\"\n          value={String(value)}\n          onKeyDown={(e) => e.stopPropagation()}\n          onChange={(e) => {\n            setValue(e.target.value ? Number(e.target.value) : '');\n            setValueError(null);\n          }}\n          type=\"number\"\n          disabled={isLoading}\n          allowClear\n        />\n      )}\n      <Typography.Text css={{ marginTop: theme.spacing.xs }} size=\"sm\" color=\"secondary\">\n        <FormattedMessage\n          defaultMessage=\"Rationale\"\n          description=\"Field label for assessment rationale in an edit form\"\n        />\n      </Typography.Text>\n      <Input.TextArea\n        componentId=\"shared.model-trace-explorer.assessment-edit-rationale-input\"\n        value={rationale}\n        autoSize={{ minRows: 1, maxRows: 5 }}\n        disabled={isLoading}\n        onKeyDown={(e) => e.stopPropagation()}\n        onChange={(e) => setRationale(e.target.value)}\n      />\n      <div css={{ display: 'flex', justifyContent: 'flex-end', marginTop: theme.spacing.xs }}>\n        <Button\n          componentId=\"shared.model-trace-explorer.assessment-edit-cancel-button\"\n          disabled={isLoading}\n          onClick={onCancel}\n        >\n          <FormattedMessage\n            defaultMessage=\"Cancel\"\n            description=\"Button label for cancelling the edit of an assessment\"\n          />\n        </Button>\n        <Button\n          css={{ marginLeft: theme.spacing.sm }}\n          type=\"primary\"\n          componentId=\"shared.model-trace-explorer.assessment-edit-save-button\"\n          onClick={handleUpdate}\n          loading={isLoading}\n        >\n          <FormattedMessage defaultMessage=\"Save\" description=\"Button label for saving an edit to an assessment\" />\n        </Button>\n      </div>\n    </div>\n  );\n};\n","import { omit } from 'lodash';\n\nimport { useIntl } from '@databricks/i18n';\nimport { useMutation } from '@databricks/web-shared/query-client';\n\nimport type { Assessment, Expectation, Feedback } from '../ModelTrace.types';\nimport { displayErrorNotification, getCurrentUser } from '../ModelTraceExplorer.utils';\nimport type { CreateAssessmentPayload } from '../api';\nimport { createAssessment } from '../api';\n\nexport const useOverrideAssessment = ({\n  refetchTraceInfo,\n  onSuccess,\n  onError,\n  onSettled,\n}: {\n  refetchTraceInfo: (() => Promise<any>) | null;\n  onSuccess?: () => void;\n  onError?: (error: any) => void;\n  onSettled?: () => void;\n}) => {\n  const intl = useIntl();\n\n  const { mutate: overrideAssessmentMutation, isLoading } = useMutation({\n    mutationFn: ({\n      oldAssessment,\n      value,\n      rationale,\n    }: {\n      oldAssessment: Assessment;\n      value: { feedback: Feedback } | { expectation: Expectation };\n      rationale?: string;\n    }) => {\n      const newAssessment: Assessment = {\n        ...oldAssessment,\n        ...value,\n        rationale,\n        source: {\n          source_id: getCurrentUser(),\n          source_type: 'HUMAN',\n        },\n        overrides: oldAssessment.assessment_id,\n      };\n      const payload: CreateAssessmentPayload = {\n        assessment: omit(newAssessment, 'assessment_id', 'create_time', 'last_update_time', 'overriddenAssessments'),\n      };\n      return createAssessment({ payload });\n    },\n    onError: (error) => {\n      displayErrorNotification(\n        intl.formatMessage(\n          {\n            defaultMessage: 'Failed to override assessment. Error: {error}',\n            description: 'Error message when overriding an assessment fails',\n          },\n          {\n            error: error instanceof Error ? error.message : String(error),\n          },\n        ),\n      );\n      onError?.(error);\n    },\n    onSuccess: () => {\n      refetchTraceInfo?.();\n      onSuccess?.();\n    },\n    onSettled: () => {\n      onSettled?.();\n    },\n  });\n\n  return {\n    overrideAssessmentMutation,\n    isLoading,\n  };\n};\n","import { isString } from 'lodash';\n\nimport { Tag, Tooltip, Typography, useDesignSystemTheme } from '@databricks/design-system';\n\nexport const ExpectationValuePreview = ({ objectKey, value }: { objectKey?: string; value: any }) => {\n  const { theme } = useDesignSystemTheme();\n  const displayValue = isString(value) ? value : JSON.stringify(value);\n\n  return (\n    <Tooltip content={displayValue} componentId=\"shared.model-trace-explorer.expectation-value-preview-tooltip\">\n      <Tag\n        color=\"indigo\"\n        componentId=\"shared.model-trace-explorer.expectation-array-item-tag\"\n        css={{ width: 'min-content', maxWidth: '100%' }}\n      >\n        <Typography.Text css={{ overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>\n          {objectKey && (\n            <Typography.Text bold css={{ marginRight: theme.spacing.xs }}>\n              {objectKey}:\n            </Typography.Text>\n          )}\n          {displayValue}\n        </Typography.Text>\n      </Tag>\n    </Tooltip>\n  );\n};\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\n\nimport type { ModelTraceSpanNode } from '../ModelTrace.types';\nimport { ModelSpanType } from '../ModelTrace.types';\nimport { getIconTypeForSpan, getSpanExceptionCount } from '../ModelTraceExplorer.utils';\nimport { ModelTraceExplorerIcon } from '../ModelTraceExplorerIcon';\nimport { useModelTraceExplorerViewState } from '../ModelTraceExplorerViewStateContext';\n\nexport const SpanNameDetailViewLink = ({ node }: { node: ModelTraceSpanNode }) => {\n  const { theme } = useDesignSystemTheme();\n  const { setSelectedNode, setActiveView, setShowTimelineTreeGantt } = useModelTraceExplorerViewState();\n  const hasException = getSpanExceptionCount(node) > 0;\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        alignItems: 'center',\n        marginRight: theme.spacing.xs,\n        gap: theme.spacing.xs,\n        '&:hover': {\n          textDecoration: 'underline',\n          textDecorationColor: hasException\n            ? theme.colors.actionDangerDefaultTextDefault\n            : theme.colors.actionDefaultTextDefault,\n          cursor: 'pointer',\n        },\n      }}\n      onClick={() => {\n        setSelectedNode(node);\n        setActiveView('detail');\n        setShowTimelineTreeGantt(false);\n      }}\n    >\n      <ModelTraceExplorerIcon\n        hasException={hasException}\n        type={getIconTypeForSpan(node.type ?? ModelSpanType.UNKNOWN)}\n      />\n      <Typography.Text\n        color={hasException ? 'error' : 'primary'}\n        css={{ marginLeft: theme.spacing.xs, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}\n      >\n        {node.title}\n      </Typography.Text>\n    </div>\n  );\n};\n","import { isObject } from 'lodash';\nimport { useState } from 'react';\n\nimport { Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { AssessmentActionsOverflowMenu } from './AssessmentActionsOverflowMenu';\nimport { AssessmentDeleteModal } from './AssessmentDeleteModal';\nimport { AssessmentEditForm } from './AssessmentEditForm';\nimport { getParsedExpectationValue } from './AssessmentsPane.utils';\nimport { ExpectationValuePreview } from './ExpectationValuePreview';\nimport { SpanNameDetailViewLink } from './SpanNameDetailViewLink';\nimport type { ExpectationAssessment } from '../ModelTrace.types';\nimport { useModelTraceExplorerViewState } from '../ModelTraceExplorerViewStateContext';\n\nconst getValuePreview = (parsedValue: any) => {\n  if (Array.isArray(parsedValue)) {\n    return parsedValue.map((item, index) => <ExpectationValuePreview value={item} key={index} />);\n  }\n\n  if (isObject(parsedValue)) {\n    return Object.entries(parsedValue).map(([key, value]) => (\n      <ExpectationValuePreview key={key} objectKey={key} value={value} />\n    ));\n  }\n\n  return <ExpectationValuePreview value={parsedValue} />;\n};\n\nexport const ExpectationItem = ({ expectation }: { expectation: ExpectationAssessment }) => {\n  const { theme } = useDesignSystemTheme();\n  const [isEditing, setIsEditing] = useState(false);\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\n  const { nodeMap, activeView } = useModelTraceExplorerViewState();\n\n  const associatedSpan = expectation.span_id ? nodeMap[expectation.span_id] : null;\n  // the summary view displays all assessments regardless of span, so\n  // we need some way to indicate which span an assessment is associated with.\n  const showAssociatedSpan = activeView === 'summary' && associatedSpan;\n\n  const parsedValue = getParsedExpectationValue(expectation.expectation);\n\n  return (\n    <div\n      css={{\n        padding: theme.spacing.sm + theme.spacing.xs,\n        paddingTop: theme.spacing.sm,\n        border: `1px solid ${theme.colors.border}`,\n        borderRadius: theme.borders.borderRadiusMd,\n        display: 'flex',\n        flexDirection: 'column',\n        gap: theme.spacing.sm,\n      }}\n    >\n      <div css={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n        <Typography.Text bold css={{ overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>\n          {expectation.assessment_name}\n        </Typography.Text>\n        <AssessmentActionsOverflowMenu\n          assessment={expectation}\n          setIsEditing={setIsEditing}\n          setShowDeleteModal={setShowDeleteModal}\n        />\n        <AssessmentDeleteModal\n          assessment={expectation}\n          isModalVisible={showDeleteModal}\n          setIsModalVisible={setShowDeleteModal}\n        />\n      </div>\n      {isEditing ? (\n        <AssessmentEditForm\n          assessment={expectation}\n          onSuccess={() => setIsEditing(false)}\n          onCancel={() => setIsEditing(false)}\n        />\n      ) : (\n        getValuePreview(parsedValue)\n      )}\n      {showAssociatedSpan && (\n        <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.xs }}>\n          <Typography.Text size=\"sm\" color=\"secondary\">\n            <FormattedMessage defaultMessage=\"Span\" description=\"Label for the associated span of an assessment\" />\n          </Typography.Text>\n          <SpanNameDetailViewLink node={associatedSpan} />\n        </div>\n      )}\n    </div>\n  );\n};\n","import React from 'react';\n\nimport type { TagColors } from '@databricks/design-system';\nimport {\n  CheckCircleIcon,\n  DangerIcon,\n  Tag,\n  Tooltip,\n  useDesignSystemTheme,\n  XCircleIcon,\n} from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\n// displays a single JSON-strigified assessment value as a tag\nexport const AssessmentDisplayValue = ({ jsonValue }: { jsonValue: string }) => {\n  const { theme } = useDesignSystemTheme();\n\n  // treat empty strings as null\n  if (!jsonValue || jsonValue === '\"\"') {\n    return null;\n  }\n\n  let parsedValue: any;\n  try {\n    parsedValue = JSON.parse(jsonValue);\n  } catch (e) {\n    // if the value is not valid JSON, just use the string value\n    parsedValue = jsonValue;\n  }\n\n  let color: TagColors = 'default';\n  let children: React.ReactNode = JSON.stringify(parsedValue, null, 2);\n  if (parsedValue === 'yes') {\n    color = 'lime';\n    children = (\n      <>\n        <CheckCircleIcon css={{ marginRight: theme.spacing.xs }} />\n        <FormattedMessage defaultMessage=\"Yes\" description=\"Label for an assessment with a 'yes' value\" />\n      </>\n    );\n  } else if (parsedValue === 'no') {\n    color = 'coral';\n    children = (\n      <>\n        <XCircleIcon css={{ marginRight: theme.spacing.xs }} />\n        <FormattedMessage defaultMessage=\"No\" description=\"Label for an assessment with a 'no' value\" />\n      </>\n    );\n  } else if (typeof parsedValue === 'string') {\n    children = parsedValue;\n  } else if (parsedValue === null) {\n    // feedback can only have null values if they are errors\n    color = 'coral';\n    children = (\n      <>\n        <DangerIcon css={{ marginRight: theme.spacing.xs }} />\n        <FormattedMessage defaultMessage=\"Error\" description=\"Label for an assessment with an error\" />\n      </>\n    );\n  } else if (parsedValue === true) {\n    color = 'lime';\n    children = (\n      <>\n        <CheckCircleIcon css={{ marginRight: theme.spacing.xs }} />\n        <FormattedMessage defaultMessage=\"True\" description=\"Label for an assessment with a 'true' boolean value\" />\n      </>\n    );\n  } else if (parsedValue === false) {\n    color = 'coral';\n    children = (\n      <>\n        <XCircleIcon css={{ marginRight: theme.spacing.xs }} />\n        <FormattedMessage defaultMessage=\"False\" description=\"Label for an assessment with a 'false' boolean value\" />\n      </>\n    );\n  }\n\n  return (\n    <Tooltip componentId=\"shared.model-trace-explorer.assesment-value-tooltip\" content={children}>\n      <Tag\n        css={{ display: 'inline-flex', maxWidth: '100%', minWidth: theme.spacing.md, marginRight: 0 }}\n        componentId=\"shared.model-trace-explorer.assesment-value-tag\"\n        color={color}\n      >\n        <span\n          css={{\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            textWrap: 'nowrap',\n          }}\n        >\n          {children}\n        </span>\n      </Tag>\n    </Tooltip>\n  );\n};\n","import { Tooltip, useDesignSystemTheme, Typography } from '@databricks/design-system';\n\nimport type { AssessmentSource } from '../ModelTrace.types';\n\nexport const AssessmentSourceName = ({ source }: { source: AssessmentSource }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <Tooltip componentId=\"shared.model-trace-explorer.assessment-source-name\" content={source.source_id}>\n      {/* wrap in span so the tooltip can show up */}\n      <span\n        css={{\n          flexShrink: 1,\n          overflow: 'hidden',\n          textOverflow: 'ellipsis',\n          textWrap: 'nowrap',\n          marginLeft: theme.spacing.sm,\n          minWidth: theme.spacing.md,\n        }}\n      >\n        <Typography.Text>\n          <span css={{ color: theme.colors.blue500 }}>{source.source_id}</span>\n        </Typography.Text>\n      </span>\n    </Tooltip>\n  );\n};\n","import { useState } from 'react';\n\nimport { useDesignSystemTheme, Typography, SparkleIcon, UserIcon, CodeIcon } from '@databricks/design-system';\n\nimport { AssessmentActionsOverflowMenu } from './AssessmentActionsOverflowMenu';\nimport { AssessmentDeleteModal } from './AssessmentDeleteModal';\nimport { AssessmentSourceName } from './AssessmentSourceName';\nimport { timeSinceStr } from './AssessmentsPane.utils';\nimport type { Assessment } from '../ModelTrace.types';\n\nconst getSourceIcon = (source: Assessment['source']) => {\n  switch (source.source_type) {\n    case 'HUMAN':\n      return UserIcon;\n    case 'LLM_JUDGE':\n      return SparkleIcon;\n    default:\n      return CodeIcon;\n  }\n};\n\nexport const AssessmentItemHeader = ({\n  // connector is not displayed in history items\n  renderConnector = true,\n  assessment,\n  setIsEditing,\n}: {\n  renderConnector?: boolean;\n  assessment: Assessment;\n  setIsEditing?: (isEditing: boolean) => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\n\n  const SourceIcon = getSourceIcon(assessment.source);\n\n  return (\n    <div css={{ display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n      {renderConnector && (\n        <div\n          css={{\n            position: 'absolute',\n            left: -1,\n            top: 0,\n            width: 10,\n            height: theme.typography.lineHeightBase,\n            boxSizing: 'border-box',\n            borderBottomLeftRadius: theme.borders.borderRadiusMd,\n            borderBottom: `1px solid ${theme.colors.border}`,\n            borderLeft: `1px solid ${theme.colors.border}`,\n          }}\n        />\n      )}\n      <SourceIcon\n        size={theme.typography.fontSizeSm}\n        css={{\n          padding: 2,\n          backgroundColor: theme.colors.actionIconBackgroundHover,\n          borderRadius: theme.borders.borderRadiusFull,\n        }}\n      />\n      <AssessmentSourceName source={assessment.source} />\n      <div\n        css={{\n          marginLeft: 'auto',\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n          gap: theme.spacing.xs,\n        }}\n      >\n        {assessment.last_update_time && (\n          <Typography.Text\n            color=\"secondary\"\n            size=\"sm\"\n            css={{\n              marginLeft: theme.spacing.sm,\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n              textWrap: 'nowrap',\n            }}\n          >\n            {timeSinceStr(new Date(assessment.last_update_time))}\n          </Typography.Text>\n        )}\n        <AssessmentActionsOverflowMenu\n          assessment={assessment}\n          setIsEditing={setIsEditing}\n          setShowDeleteModal={setShowDeleteModal}\n        />\n        <AssessmentDeleteModal\n          assessment={assessment}\n          isModalVisible={showDeleteModal}\n          setIsModalVisible={setShowDeleteModal}\n        />\n      </div>\n    </div>\n  );\n};\n","import { useState } from 'react';\n\nimport { Alert, Modal, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { CodeSnippetRenderMode, type AssessmentError } from '../ModelTrace.types';\nimport { ModelTraceExplorerCodeSnippet } from '../ModelTraceExplorerCodeSnippet';\n\nexport const FeedbackErrorItem = ({ error }: { error: AssessmentError }) => {\n  const { theme } = useDesignSystemTheme();\n  const [isModalVisible, setIsModalVisible] = useState(false);\n\n  return (\n    <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.xs }}>\n      <Alert\n        type=\"error\"\n        closable={false}\n        message={error.error_code}\n        componentId=\"shared.model-trace-explorer.feedback-error-item\"\n        description={\n          <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.xs }}>\n            <span>{error.error_message}</span>\n            {error.stack_trace && (\n              <Typography.Link\n                componentId=\"shared.model-trace-explorer.feedback-error-item-stack-trace-link\"\n                onClick={() => setIsModalVisible(true)}\n              >\n                <FormattedMessage\n                  defaultMessage=\"View stack trace\"\n                  description=\"Link to view the stack trace for an assessment error\"\n                />\n              </Typography.Link>\n            )}\n          </div>\n        }\n      />\n      {error.stack_trace && (\n        <Modal\n          title={\n            <FormattedMessage\n              defaultMessage=\"Error stack trace\"\n              description=\"Title of the assessment error stack trace modal\"\n            />\n          }\n          visible={isModalVisible}\n          componentId=\"shared.model-trace-explorer.feedback-error-stack-trace-modal\"\n          footer={null}\n          onCancel={() => setIsModalVisible(false)}\n        >\n          <ModelTraceExplorerCodeSnippet\n            data={JSON.stringify(error.stack_trace)}\n            title=\"\"\n            initialRenderMode={CodeSnippetRenderMode.TEXT}\n          />\n        </Modal>\n      )}\n    </div>\n  );\n};\n","import { isNil } from 'lodash';\n\nimport { Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\nimport { GenAIMarkdownRenderer } from '@databricks/web-shared/genai-markdown-renderer';\n\nimport { AssessmentDisplayValue } from './AssessmentDisplayValue';\nimport { AssessmentItemHeader } from './AssessmentItemHeader';\nimport { FeedbackErrorItem } from './FeedbackErrorItem';\nimport type { FeedbackAssessment } from '../ModelTrace.types';\n\n// this is mostly a copy of FeedbackItem, but with\n// different styling and no ability to edit.\nexport const FeedbackHistoryItem = ({ feedback }: { feedback: FeedbackAssessment }) => {\n  const { theme } = useDesignSystemTheme();\n  const value = feedback.feedback.value;\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        position: 'relative',\n      }}\n    >\n      <AssessmentItemHeader renderConnector={false} assessment={feedback} />\n      <div\n        css={{\n          display: 'flex',\n          flexDirection: 'column',\n          gap: theme.spacing.xs,\n          marginLeft: 10,\n          paddingLeft: theme.spacing.md,\n          paddingTop: theme.spacing.sm,\n          paddingBottom: theme.spacing.md,\n          paddingRight: theme.spacing.lg,\n          borderLeft: `1px solid ${theme.colors.border}`,\n        }}\n      >\n        {!isNil(feedback.feedback.error) ? (\n          <FeedbackErrorItem error={feedback.feedback.error} />\n        ) : (\n          <>\n            <Typography.Text size=\"sm\" color=\"secondary\">\n              <FormattedMessage defaultMessage=\"Feedback\" description=\"Label for the value of an feedback assessment\" />\n            </Typography.Text>\n            <div>\n              <AssessmentDisplayValue jsonValue={JSON.stringify(value)} />\n            </div>\n          </>\n        )}\n        {feedback.rationale && (\n          <>\n            <Typography.Text size=\"sm\" color=\"secondary\" css={{ marginTop: theme.spacing.xs }}>\n              <FormattedMessage\n                defaultMessage=\"Rationale\"\n                description=\"Label for the rationale of an expectation assessment\"\n              />\n            </Typography.Text>\n            <GenAIMarkdownRenderer>{feedback.rationale}</GenAIMarkdownRenderer>\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n","import { useMemo } from 'react';\n\nimport { Modal } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { FeedbackHistoryItem } from './FeedbackHistoryItem';\nimport type { Assessment, FeedbackAssessment } from '../ModelTrace.types';\n\n// helper function to traverse the linked list of overridden\n// assessments. this function handles cycles by keeping track\n// of the assessments we've seen. the backend should prevent\n// such cases from existing, but we should be defensive.\nconst flattenOverrides = (assessment: Assessment) => {\n  const seen = new Set<string>();\n  const flattened = [];\n\n  let currentAssessment: Assessment | undefined = assessment;\n  while (currentAssessment && !seen.has(currentAssessment.assessment_id)) {\n    seen.add(currentAssessment.assessment_id);\n    flattened.push(currentAssessment);\n    currentAssessment = currentAssessment.overriddenAssessment;\n  }\n\n  return flattened;\n};\n\nexport const FeedbackHistoryModal = ({\n  isModalVisible,\n  setIsModalVisible,\n  feedback,\n}: {\n  isModalVisible: boolean;\n  setIsModalVisible: (isModalVisible: boolean) => void;\n  feedback: FeedbackAssessment;\n}) => {\n  const assessmentHistory = useMemo(() => flattenOverrides(feedback), [feedback]);\n\n  return (\n    <Modal\n      componentId=\"shared.model-trace-explorer.feedback-history-modal\"\n      visible={isModalVisible}\n      footer={null}\n      onCancel={() => {\n        setIsModalVisible(false);\n      }}\n      title={\n        <FormattedMessage\n          defaultMessage=\"Edit history\"\n          description=\"Title of a modal that shows the edit history of an assessment\"\n        />\n      }\n    >\n      {assessmentHistory.map((assessment) =>\n        'feedback' in assessment ? <FeedbackHistoryItem key={assessment.assessment_id} feedback={assessment} /> : null,\n      )}\n    </Modal>\n  );\n};\n","import { isNil } from 'lodash';\nimport { useState } from 'react';\n\nimport { Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\nimport { GenAIMarkdownRenderer } from '@databricks/web-shared/genai-markdown-renderer';\n\nimport { AssessmentDisplayValue } from './AssessmentDisplayValue';\nimport { FeedbackErrorItem } from './FeedbackErrorItem';\nimport { FeedbackHistoryModal } from './FeedbackHistoryModal';\nimport { SpanNameDetailViewLink } from './SpanNameDetailViewLink';\nimport type { FeedbackAssessment } from '../ModelTrace.types';\nimport { useModelTraceExplorerViewState } from '../ModelTraceExplorerViewStateContext';\n\nexport const FeedbackItemContent = ({ feedback }: { feedback: FeedbackAssessment }) => {\n  const [isHistoryModalVisible, setIsHistoryModalVisible] = useState(false);\n  const { theme } = useDesignSystemTheme();\n  const { nodeMap, activeView } = useModelTraceExplorerViewState();\n\n  const value = feedback.feedback.value;\n\n  const associatedSpan = feedback.span_id ? nodeMap[feedback.span_id] : null;\n  // the summary view displays all assessments regardless of span, so\n  // we need some way to indicate which span an assessment is associated with.\n  const showAssociatedSpan = activeView === 'summary' && associatedSpan;\n\n  return (\n    <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.sm, marginLeft: theme.spacing.lg }}>\n      {!isNil(feedback.feedback.error) && <FeedbackErrorItem error={feedback.feedback.error} />}\n      {showAssociatedSpan && (\n        <div\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n            gap: theme.spacing.xs,\n          }}\n        >\n          <Typography.Text size=\"sm\" color=\"secondary\">\n            <FormattedMessage defaultMessage=\"Span\" description=\"Label for the associated span of an assessment\" />\n          </Typography.Text>\n          <SpanNameDetailViewLink node={associatedSpan} />\n        </div>\n      )}\n      {isNil(feedback.feedback.error) && (\n        <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.xs }}>\n          <Typography.Text size=\"sm\" color=\"secondary\">\n            <FormattedMessage defaultMessage=\"Feedback\" description=\"Label for the value of an feedback assessment\" />\n          </Typography.Text>\n          <div css={{ display: 'flex', gap: theme.spacing.xs }}>\n            <AssessmentDisplayValue jsonValue={JSON.stringify(value)} />\n            {feedback.overriddenAssessment && (\n              <>\n                <span onClick={() => setIsHistoryModalVisible(true)}>\n                  <Typography.Text\n                    css={{\n                      '&:hover': {\n                        textDecoration: 'underline',\n                        cursor: 'pointer',\n                      },\n                    }}\n                    color=\"secondary\"\n                  >\n                    <FormattedMessage\n                      defaultMessage=\"(edited)\"\n                      description=\"Link text in an edited assessment that allows the user to click to see the previous value\"\n                    />\n                  </Typography.Text>\n                </span>\n                <FeedbackHistoryModal\n                  isModalVisible={isHistoryModalVisible}\n                  setIsModalVisible={setIsHistoryModalVisible}\n                  feedback={feedback}\n                />\n              </>\n            )}\n          </div>\n        </div>\n      )}\n      {feedback.rationale && (\n        <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.xs }}>\n          <Typography.Text size=\"sm\" color=\"secondary\">\n            <FormattedMessage\n              defaultMessage=\"Rationale\"\n              description=\"Label for the rationale of an expectation assessment\"\n            />\n          </Typography.Text>\n          <div css={{ '& > div:last-of-type': { marginBottom: 0 } }}>\n            <GenAIMarkdownRenderer>{feedback.rationale}</GenAIMarkdownRenderer>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n","import { useState } from 'react';\n\nimport { useDesignSystemTheme } from '@databricks/design-system';\n\nimport { AssessmentEditForm } from './AssessmentEditForm';\nimport { AssessmentItemHeader } from './AssessmentItemHeader';\nimport { FeedbackItemContent } from './FeedbackItemContent';\nimport type { FeedbackAssessment } from '../ModelTrace.types';\n\nexport const FeedbackItem = ({ feedback }: { feedback: FeedbackAssessment }) => {\n  const { theme } = useDesignSystemTheme();\n  const [isEditing, setIsEditing] = useState(false);\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        gap: theme.spacing.xs,\n        paddingLeft: theme.spacing.lg / 2,\n        marginLeft: theme.spacing.lg / 2,\n        paddingTop: theme.spacing.sm,\n        paddingBottom: theme.spacing.sm,\n        borderLeft: `1px solid ${theme.colors.border}`,\n        position: 'relative',\n      }}\n    >\n      <AssessmentItemHeader assessment={feedback} setIsEditing={setIsEditing} />\n      {isEditing ? (\n        <AssessmentEditForm\n          assessment={feedback}\n          onSuccess={() => setIsEditing(false)}\n          onCancel={() => setIsEditing(false)}\n        />\n      ) : (\n        <FeedbackItemContent feedback={feedback} />\n      )}\n    </div>\n  );\n};\n","import { countBy } from 'lodash';\n\nimport { CodeIcon, SparkleIcon, Tag, Typography, useDesignSystemTheme, UserIcon } from '@databricks/design-system';\n\nimport type { AssessmentSourceType, FeedbackAssessment } from '../ModelTrace.types';\n\nconst getSourceTypeIcon = (sourceType: AssessmentSourceType) => {\n  const smallIconStyles = {\n    '& > svg': {\n      width: 12,\n      height: 12,\n    },\n  };\n  switch (sourceType) {\n    case 'HUMAN':\n      return <UserIcon css={smallIconStyles} />;\n    case 'LLM_JUDGE':\n      return <SparkleIcon css={smallIconStyles} />;\n    case 'CODE':\n      return <CodeIcon css={smallIconStyles} />;\n    default:\n      return null;\n  }\n};\n\nexport const FeedbackValueGroupSourceCounts = ({ feedbacks }: { feedbacks: FeedbackAssessment[] }) => {\n  const { theme } = useDesignSystemTheme();\n\n  if (feedbacks.length < 2) {\n    return null;\n  }\n\n  const sourceCounts = countBy(feedbacks, (feedback) => feedback.source.source_type);\n  return (\n    <div css={{ display: 'flex', gap: theme.spacing.xs, alignItems: 'center', marginLeft: theme.spacing.xs }}>\n      {Object.entries(sourceCounts).map(([sourceType, count]) => (\n        <Tag\n          componentId={`shared.model-trace-explorer.feedback-source-count-${sourceType}`}\n          css={{\n            margin: 0,\n          }}\n          key={sourceType}\n        >\n          <div css={{ display: 'flex', alignItems: 'center', gap: theme.spacing.xs }}>\n            {getSourceTypeIcon(sourceType as AssessmentSourceType)}\n            <Typography.Text>{count}</Typography.Text>\n          </div>\n        </Tag>\n      ))}\n    </div>\n  );\n};\n","import { useState } from 'react';\n\nimport { Button, ChevronDownIcon, ChevronRightIcon, useDesignSystemTheme } from '@databricks/design-system';\n\nimport { AssessmentDisplayValue } from './AssessmentDisplayValue';\nimport { FeedbackItem } from './FeedbackItem';\nimport { FeedbackValueGroupSourceCounts } from './FeedbackValueGroupSourceCounts';\nimport type { FeedbackAssessment } from '../ModelTrace.types';\n\nexport const FeedbackValueGroup = ({\n  jsonValue,\n  feedbacks,\n}: {\n  jsonValue: string;\n  feedbacks: FeedbackAssessment[];\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const [expanded, setExpanded] = useState(false);\n\n  return (\n    <div css={{ display: 'flex', flexDirection: 'column' }}>\n      <div css={{ display: 'flex', gap: theme.spacing.xs, alignItems: 'center' }}>\n        <Button\n          componentId=\"shared.model-trace-explorer.toggle-assessment-expanded\"\n          css={{ flexShrink: 0 }}\n          size=\"small\"\n          icon={expanded ? <ChevronDownIcon /> : <ChevronRightIcon />}\n          onClick={() => setExpanded(!expanded)}\n        />\n        <AssessmentDisplayValue jsonValue={jsonValue} />\n        <FeedbackValueGroupSourceCounts feedbacks={feedbacks} />\n      </div>\n      {expanded && (\n        <div\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n          }}\n        >\n          {feedbacks.map((feedback) =>\n            // don't display assessments that have been overridden\n            feedback?.valid === false ? null : <FeedbackItem feedback={feedback} key={feedback.assessment_id} />,\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n","import { isNil } from 'lodash';\nimport { useState } from 'react';\n\nimport { useDesignSystemTheme, Typography, Button, PlusIcon, Tooltip, DangerIcon } from '@databricks/design-system';\n\nimport { AssessmentCreateForm } from './AssessmentCreateForm';\nimport { getAssessmentDisplayName } from './AssessmentsPane.utils';\nimport { FeedbackValueGroup } from './FeedbackValueGroup';\nimport type { FeedbackAssessment } from '../ModelTrace.types';\n\nexport const FeedbackGroup = ({\n  name,\n  valuesMap,\n  traceId,\n  activeSpanId,\n}: {\n  name: string;\n  valuesMap: { [value: string]: FeedbackAssessment[] };\n  traceId: string;\n  activeSpanId?: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const displayName = getAssessmentDisplayName(name);\n  const [showCreateForm, setShowCreateForm] = useState(false);\n  const hasError = Object.values(valuesMap)\n    .flat()\n    .some((feedback) => !isNil(feedback.feedback.error));\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        marginBottom: theme.spacing.sm,\n        border: `1px solid ${theme.colors.border}`,\n        borderRadius: theme.borders.borderRadiusMd,\n        padding: theme.spacing.sm + theme.spacing.xs,\n        paddingTop: theme.spacing.sm,\n        gap: theme.spacing.sm,\n      }}\n    >\n      <div\n        css={{\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n          gap: theme.spacing.sm,\n        }}\n      >\n        <div css={{ display: 'flex', alignItems: 'center', gap: theme.spacing.sm, flex: 1, minWidth: 0 }}>\n          <Typography.Text bold css={{ overflow: 'hidden', textOverflow: 'ellipsis', textWrap: 'nowrap' }}>\n            {displayName}\n          </Typography.Text>\n          {hasError && <DangerIcon css={{ flexShrink: 0 }} color=\"danger\" />}\n        </div>\n        <Tooltip content=\"Add new feedback\" componentId=\"shared.model-trace-explorer.add-feedback-in-group-tooltip\">\n          <Button\n            componentId=\"shared.model-trace-explorer.add-feedback\"\n            css={{ flexShrink: 0, marginRight: -theme.spacing.xs }}\n            size=\"small\"\n            icon={<PlusIcon />}\n            onClick={() => setShowCreateForm(true)}\n          />\n        </Tooltip>\n      </div>\n      {Object.entries(valuesMap).map(([jsonValue, feedbacks]) => (\n        <FeedbackValueGroup jsonValue={jsonValue} feedbacks={feedbacks} key={jsonValue} />\n      ))}\n      {showCreateForm && (\n        <AssessmentCreateForm\n          assessmentName={name}\n          spanId={activeSpanId}\n          traceId={traceId}\n          setExpanded={setShowCreateForm}\n        />\n      )}\n    </div>\n  );\n};\n","import { isNil, partition } from 'lodash';\nimport { useMemo } from 'react';\n\nimport { Button, CloseIcon, Tooltip, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { AssessmentCreateButton } from './AssessmentCreateButton';\nimport { ASSESSMENT_PANE_MIN_WIDTH } from './AssessmentsPane.utils';\nimport { ExpectationItem } from './ExpectationItem';\nimport { FeedbackGroup } from './FeedbackGroup';\nimport type { Assessment, FeedbackAssessment } from '../ModelTrace.types';\nimport { useModelTraceExplorerViewState } from '../ModelTraceExplorerViewStateContext';\n\ntype GroupedFeedbacksByValue = { [value: string]: FeedbackAssessment[] };\n\ntype GroupedFeedbacks = [assessmentName: string, feedbacks: GroupedFeedbacksByValue][];\n\nconst groupFeedbacks = (feedbacks: FeedbackAssessment[]): GroupedFeedbacks => {\n  const aggregated: Record<string, GroupedFeedbacksByValue> = {};\n  feedbacks.forEach((feedback) => {\n    if (feedback.valid === false) {\n      return;\n    }\n\n    let value = null;\n    if (feedback.feedback.value !== '') {\n      value = JSON.stringify(feedback.feedback.value);\n    }\n\n    const { assessment_name } = feedback;\n    if (!aggregated[assessment_name]) {\n      aggregated[assessment_name] = {};\n    }\n\n    const group = aggregated[assessment_name];\n    if (!isNil(value)) {\n      if (!group[value]) {\n        group[value] = [];\n      }\n      group[value].push(feedback);\n    }\n  });\n\n  return Object.entries(aggregated).toSorted(([leftName], [rightName]) => leftName.localeCompare(rightName));\n};\n\nexport const AssessmentsPane = ({\n  assessments,\n  traceId,\n  activeSpanId,\n}: {\n  assessments: Assessment[];\n  traceId: string;\n  activeSpanId?: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const { setAssessmentsPaneExpanded } = useModelTraceExplorerViewState();\n  const [feedbacks, expectations] = useMemo(\n    () => partition(assessments, (assessment) => 'feedback' in assessment),\n    [assessments],\n  );\n  const groupedFeedbacks = useMemo(() => groupFeedbacks(feedbacks), [feedbacks]);\n  const sortedExpectations = expectations.toSorted((left, right) =>\n    left.assessment_name.localeCompare(right.assessment_name),\n  );\n\n  return (\n    <div\n      data-testid=\"assessments-pane\"\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        padding: theme.spacing.sm,\n        paddingTop: theme.spacing.xs,\n        height: '100%',\n        borderLeft: `1px solid ${theme.colors.border}`,\n        overflowY: 'scroll',\n        minWidth: ASSESSMENT_PANE_MIN_WIDTH,\n        width: '100%',\n        boxSizing: 'border-box',\n      }}\n    >\n      <div css={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-between' }}>\n        <Typography.Text css={{ marginBottom: theme.spacing.sm }} bold>\n          <FormattedMessage defaultMessage=\"Assessments\" description=\"Label for the assessments pane\" />\n        </Typography.Text>\n        {setAssessmentsPaneExpanded && (\n          <Tooltip\n            componentId=\"shared.model-trace-explorer.close-assessments-pane-tooltip\"\n            content={\n              <FormattedMessage\n                defaultMessage=\"Hide assessments\"\n                description=\"Tooltip for a button that closes the assessments pane\"\n              />\n            }\n          >\n            <Button\n              data-testid=\"close-assessments-pane-button\"\n              componentId=\"shared.model-trace-explorer.close-assessments-pane\"\n              size=\"small\"\n              icon={<CloseIcon />}\n              onClick={() => setAssessmentsPaneExpanded(false)}\n            />\n          </Tooltip>\n        )}\n      </div>\n      {groupedFeedbacks.map(([name, valuesMap]) => (\n        <FeedbackGroup key={name} name={name} valuesMap={valuesMap} traceId={traceId} activeSpanId={activeSpanId} />\n      ))}\n      {sortedExpectations.length > 0 && (\n        <>\n          <Typography.Text color=\"secondary\" css={{ marginBottom: theme.spacing.sm }}>\n            <FormattedMessage\n              defaultMessage=\"Expectations\"\n              description=\"Label for the expectations section in the assessments pane\"\n            />\n          </Typography.Text>\n          <div\n            css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.sm, marginBottom: theme.spacing.sm }}\n          >\n            {sortedExpectations.map((expectation) => (\n              <ExpectationItem expectation={expectation} key={expectation.assessment_id} />\n            ))}\n          </div>\n        </>\n      )}\n      <AssessmentCreateButton title=\"Add new assessment\" spanId={activeSpanId} traceId={traceId} />\n    </div>\n  );\n};\n","import type { Interpolation, Theme } from '@emotion/react';\nimport { isNil } from 'lodash';\nimport React, { useState } from 'react';\n\nimport { Empty, Tabs, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { ModelTraceExplorerAttributesTab } from './ModelTraceExplorerAttributesTab';\nimport { ModelTraceExplorerChatTab } from './ModelTraceExplorerChatTab';\nimport { ModelTraceExplorerContentTab } from './ModelTraceExplorerContentTab';\nimport { ModelTraceExplorerEventsTab } from './ModelTraceExplorerEventsTab';\nimport type { ModelTraceExplorerTab, ModelTraceSpanNode, SearchMatch } from '../ModelTrace.types';\nimport { getSpanExceptionCount } from '../ModelTraceExplorer.utils';\nimport { ModelTraceExplorerBadge } from '../ModelTraceExplorerBadge';\nimport ModelTraceExplorerResizablePane from '../ModelTraceExplorerResizablePane';\nimport { useModelTraceExplorerViewState } from '../ModelTraceExplorerViewStateContext';\nimport { AssessmentPaneToggle } from '../assessments-pane/AssessmentPaneToggle';\nimport { AssessmentsPane } from '../assessments-pane/AssessmentsPane';\nimport { ASSESSMENT_PANE_MIN_WIDTH } from '../assessments-pane/AssessmentsPane.utils';\n\nexport const CONTENT_PANE_MIN_WIDTH = 250;\n// used by the parent component to set min-width on the resizable box\nexport const RIGHT_PANE_MIN_WIDTH = CONTENT_PANE_MIN_WIDTH + ASSESSMENT_PANE_MIN_WIDTH;\nconst DEFAULT_SPLIT_RATIO = 0.7;\n\nfunction ModelTraceExplorerRightPaneTabsImpl({\n  activeSpan,\n  searchFilter,\n  activeMatch,\n  activeTab,\n  setActiveTab,\n}: {\n  activeSpan: ModelTraceSpanNode | undefined;\n  searchFilter: string;\n  activeMatch: SearchMatch | null;\n  activeTab: ModelTraceExplorerTab;\n  setActiveTab: (tab: ModelTraceExplorerTab) => void;\n}) {\n  const { theme } = useDesignSystemTheme();\n  const [paneWidth, setPaneWidth] = useState(500);\n  const contentStyle: Interpolation<Theme> = { flex: 1, marginTop: -theme.spacing.md, overflowY: 'auto' };\n  const { assessmentsPaneExpanded, assessmentsPaneEnabled } = useModelTraceExplorerViewState();\n\n  if (isNil(activeSpan)) {\n    return <Empty description=\"Please select a span to view more information\" />;\n  }\n\n  const exceptionCount = getSpanExceptionCount(activeSpan);\n  const hasException = exceptionCount > 0;\n  const tabContent = (\n    <Tabs.Root\n      componentId=\"shared.model-trace-explorer.right-pane-tabs\"\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        flex: 1,\n        borderLeft: `1px solid ${theme.colors.border}`,\n        minWidth: 200,\n        position: 'relative',\n      }}\n      value={activeTab}\n      onValueChange={(tab: string) => setActiveTab(tab as ModelTraceExplorerTab)}\n    >\n      <div\n        css={{\n          position: 'absolute',\n          right: assessmentsPaneExpanded ? theme.spacing.xs : theme.spacing.md,\n          top: theme.spacing.xs,\n        }}\n      >\n        <AssessmentPaneToggle />\n      </div>\n      <Tabs.List\n        css={{\n          padding: 0,\n          paddingLeft: theme.spacing.md,\n          paddingRight: theme.spacing.sm,\n          boxSizing: 'border-box',\n          width: '100%',\n        }}\n      >\n        {activeSpan.chatMessages && (\n          <Tabs.Trigger value=\"chat\">\n            <FormattedMessage defaultMessage=\"Chat\" description=\"Label for the chat tab of the model trace explorer.\" />\n          </Tabs.Trigger>\n        )}\n        <Tabs.Trigger value=\"content\">\n          <FormattedMessage\n            defaultMessage=\"Inputs / Outputs\"\n            description=\"Label for the inputs and outputs tab of the model trace explorer.\"\n          />\n        </Tabs.Trigger>\n        {/* no i18n for attributes and events as these are properties specified by code,\n            and it might be confusing for users to have different labels here */}\n        <Tabs.Trigger value=\"attributes\">Attributes</Tabs.Trigger>\n        <Tabs.Trigger value=\"events\">\n          Events {hasException && <ModelTraceExplorerBadge count={exceptionCount} />}\n        </Tabs.Trigger>\n      </Tabs.List>\n      {activeSpan.chatMessages && (\n        <Tabs.Content css={contentStyle} value=\"chat\">\n          <ModelTraceExplorerChatTab chatMessages={activeSpan.chatMessages} chatTools={activeSpan.chatTools} />\n        </Tabs.Content>\n      )}\n      <Tabs.Content css={contentStyle} value=\"content\">\n        <ModelTraceExplorerContentTab activeSpan={activeSpan} searchFilter={searchFilter} activeMatch={activeMatch} />\n      </Tabs.Content>\n      <Tabs.Content css={contentStyle} value=\"attributes\">\n        <ModelTraceExplorerAttributesTab\n          activeSpan={activeSpan}\n          searchFilter={searchFilter}\n          activeMatch={activeMatch}\n        />\n      </Tabs.Content>\n      <Tabs.Content css={contentStyle} value=\"events\">\n        <ModelTraceExplorerEventsTab activeSpan={activeSpan} searchFilter={searchFilter} activeMatch={activeMatch} />\n      </Tabs.Content>\n    </Tabs.Root>\n  );\n\n  return assessmentsPaneEnabled && assessmentsPaneExpanded ? (\n    <ModelTraceExplorerResizablePane\n      initialRatio={DEFAULT_SPLIT_RATIO}\n      paneWidth={paneWidth}\n      setPaneWidth={setPaneWidth}\n      leftChild={tabContent}\n      leftMinWidth={CONTENT_PANE_MIN_WIDTH}\n      rightChild={\n        <AssessmentsPane\n          assessments={activeSpan.assessments}\n          traceId={activeSpan.traceId}\n          activeSpanId={activeSpan.parentId ? String(activeSpan.key) : undefined}\n        />\n      }\n      rightMinWidth={ASSESSMENT_PANE_MIN_WIDTH}\n    />\n  ) : (\n    tabContent\n  );\n}\n\nexport const ModelTraceExplorerRightPaneTabs = React.memo(ModelTraceExplorerRightPaneTabsImpl);\n","import {\n  Button,\n  Checkbox,\n  FilterIcon,\n  InfoTooltip,\n  Popover,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport type { SpanFilterState } from '../ModelTrace.types';\nimport { getDisplayNameForSpanType, getIconTypeForSpan } from '../ModelTraceExplorer.utils';\nimport { ModelTraceExplorerIcon } from '../ModelTraceExplorerIcon';\n\nexport const TimelineTreeFilterButton = ({\n  spanFilterState,\n  setSpanFilterState,\n}: {\n  spanFilterState: SpanFilterState;\n  setSpanFilterState: (state: SpanFilterState) => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <Popover.Root componentId=\"shared.model-trace-explorer.timeline-tree-filter-popover\">\n      <Popover.Trigger asChild>\n        <Button\n          componentId=\"shared.model-trace-explorer.timeline-tree-filter-button\"\n          icon={<FilterIcon />}\n          size=\"small\"\n        >\n          <FormattedMessage defaultMessage=\"Filter\" description=\"Label for the filter button in the trace explorer.\" />\n        </Button>\n      </Popover.Trigger>\n      <Popover.Content align=\"start\">\n        <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.sm, paddingBottom: theme.spacing.xs }}>\n          <Typography.Text bold>\n            <FormattedMessage\n              defaultMessage=\"Filter\"\n              description=\"Label for the span filters popover in the trace explorer.\"\n            />\n          </Typography.Text>\n          <Typography.Text color=\"secondary\">\n            <FormattedMessage\n              defaultMessage=\"Span type\"\n              description=\"Section label for span type filters in the trace explorer.\"\n            />\n          </Typography.Text>\n          {Object.entries(spanFilterState.spanTypeDisplayState).map(([spanType, shouldDisplay]) => {\n            const icon = <ModelTraceExplorerIcon type={getIconTypeForSpan(spanType)} />;\n            return (\n              <Checkbox\n                key={spanType}\n                componentId={`shared.model-trace-explorer.toggle-span-filter_${spanType}-${!shouldDisplay}`}\n                style={{ width: '100%' }}\n                isChecked={shouldDisplay}\n                onChange={() =>\n                  setSpanFilterState({\n                    ...spanFilterState,\n                    spanTypeDisplayState: {\n                      ...spanFilterState.spanTypeDisplayState,\n                      [spanType]: !shouldDisplay,\n                    },\n                  })\n                }\n              >\n                {icon}\n                <Typography.Text css={{ marginLeft: theme.spacing.xs }}>\n                  {getDisplayNameForSpanType(spanType)}\n                </Typography.Text>\n              </Checkbox>\n            );\n          })}\n          <Typography.Text color=\"secondary\">\n            <FormattedMessage\n              defaultMessage=\"Settings\"\n              description=\"Section label for filter settings in the trace explorer.\"\n            />\n          </Typography.Text>\n          <Checkbox\n            componentId={`shared.model-trace-explorer.toggle-show-parents_${!spanFilterState.showParents}`}\n            style={{ width: '100%' }}\n            isChecked={spanFilterState.showParents}\n            onChange={() =>\n              setSpanFilterState({\n                ...spanFilterState,\n                showParents: !spanFilterState.showParents,\n              })\n            }\n          >\n            <Typography.Text css={{ marginRight: theme.spacing.xs }}>\n              <FormattedMessage\n                defaultMessage=\"Show all parent spans\"\n                description=\"Checkbox label for a setting that enables showing all parent spans in the trace explorer regardless of filter conditions.\"\n              />\n            </Typography.Text>\n            <InfoTooltip\n              componentId=\"shared.model-trace-explorer.show-parents-tooltip\"\n              content={\n                <FormattedMessage\n                  defaultMessage=\"Always show parents of matched spans, regardless of filter conditions\"\n                  description=\"Tooltip for a span filter setting that enables showing parents of matched spans\"\n                />\n              }\n            />\n          </Checkbox>\n          <Checkbox\n            componentId={`shared.model-trace-explorer.toggle-show-parents_${!spanFilterState.showExceptions}`}\n            style={{ width: '100%' }}\n            isChecked={spanFilterState.showExceptions}\n            onChange={() =>\n              setSpanFilterState({\n                ...spanFilterState,\n                showExceptions: !spanFilterState.showExceptions,\n              })\n            }\n          >\n            <Typography.Text css={{ marginRight: theme.spacing.xs }}>\n              <FormattedMessage\n                defaultMessage=\"Show exceptions\"\n                description=\"Checkbox label for a setting that enables showing spans with exceptions in the trace explorer regardless of filter conditions.\"\n              />\n            </Typography.Text>\n            <InfoTooltip\n              componentId=\"shared.model-trace-explorer.show-exceptions-tooltip\"\n              content={\n                <FormattedMessage\n                  defaultMessage=\"Always show spans with exceptions, regardless of filter conditions\"\n                  description=\"Tooltip for a span filter setting that enables showing spans with exceptions\"\n                />\n              }\n            />\n          </Checkbox>\n        </div>\n      </Popover.Content>\n    </Popover.Root>\n  );\n};\n","import {\n  BarsAscendingVerticalIcon,\n  ListBorderIcon,\n  SegmentedControlButton,\n  SegmentedControlGroup,\n  Tooltip,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { TimelineTreeFilterButton } from './TimelineTreeFilterButton';\nimport type { SpanFilterState } from '../ModelTrace.types';\n\nexport const TimelineTreeHeader = ({\n  showTimelineInfo,\n  setShowTimelineInfo,\n  spanFilterState,\n  setSpanFilterState,\n}: {\n  showTimelineInfo: boolean;\n  setShowTimelineInfo: (showTimelineInfo: boolean) => void;\n  spanFilterState: SpanFilterState;\n  setSpanFilterState: (state: SpanFilterState) => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        padding: `${theme.spacing.xs}px ${theme.spacing.sm}px`,\n        paddingBottom: 3,\n        borderBottom: `1px solid ${theme.colors.border}`,\n        boxSizing: 'border-box',\n        paddingLeft: theme.spacing.sm,\n        alignItems: 'center',\n        display: 'flex',\n        justifyContent: 'space-between',\n      }}\n    >\n      <Typography.Text bold>\n        <FormattedMessage\n          defaultMessage=\"Trace breakdown\"\n          description=\"Header for the span tree within the MLflow trace UI\"\n        />\n      </Typography.Text>\n      <div css={{ display: 'flex', flexDirection: 'row', gap: theme.spacing.sm }}>\n        <TimelineTreeFilterButton spanFilterState={spanFilterState} setSpanFilterState={setSpanFilterState} />\n        <SegmentedControlGroup\n          name=\"size-story\"\n          value={showTimelineInfo}\n          onChange={(event) => {\n            setShowTimelineInfo(event.target.value);\n          }}\n          size=\"small\"\n          componentId=\"shared.model-trace-explorer.toggle-show-timeline\"\n        >\n          <SegmentedControlButton\n            data-testid=\"hide-timeline-info-button\"\n            icon={\n              <Tooltip\n                componentId=\"shared.model-trace-explorer.hide-timeline-info-tooltip\"\n                content={\n                  <FormattedMessage\n                    defaultMessage=\"Show span tree\"\n                    description=\"Tooltip for a button that show the span tree view of the trace UI.\"\n                  />\n                }\n              >\n                <ListBorderIcon />\n              </Tooltip>\n            }\n            value={false}\n          />\n          <SegmentedControlButton\n            data-testid=\"show-timeline-info-button\"\n            icon={\n              <Tooltip\n                componentId=\"shared.model-trace-explorer.show-timeline-info-tooltip\"\n                content={\n                  <FormattedMessage\n                    defaultMessage=\"Show execution timeline\"\n                    description=\"Tooltip for a button that shows execution timeline info in the trace UI.\"\n                  />\n                }\n              >\n                <BarsAscendingVerticalIcon />\n              </Tooltip>\n            }\n            value\n          />\n        </SegmentedControlGroup>\n      </div>\n    </div>\n  );\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\n\nimport type { HierarchyBar } from './TimelineTree.types';\nimport { SPAN_INDENT_WIDTH, SPAN_ROW_HEIGHT, TimelineTreeZIndex } from './TimelineTree.utils';\n\nconst IconBottomConnector = ({ active }: { active: boolean }) => {\n  const { theme } = useDesignSystemTheme();\n  const borderColor = active ? theme.colors.blue500 : theme.colors.border;\n\n  return (\n    <div\n      css={{\n        position: 'absolute',\n        left: '100%',\n        bottom: 0,\n        // not sure why the +1 is necessary but\n        // there is a 1 pixel misalignment with the\n        // left connector otherwise\n        width: SPAN_INDENT_WIDTH / 2 + 1,\n        height: theme.spacing.md,\n        boxSizing: 'border-box',\n        borderTopRightRadius: theme.borders.borderRadiusMd,\n        borderTop: `1px solid ${borderColor}`,\n        borderRight: `1px solid ${borderColor}`,\n        zIndex: TimelineTreeZIndex.LOW, // render behind the span's icon\n      }}\n    />\n  );\n};\n\nconst IconLeftConnector = ({ active }: { active: boolean }) => {\n  const { theme } = useDesignSystemTheme();\n  const borderColor = active ? theme.colors.blue500 : theme.colors.border;\n\n  return (\n    <div\n      css={{\n        position: 'absolute',\n        left: '50%',\n        top: 0,\n        width: SPAN_INDENT_WIDTH / 2,\n        height: theme.spacing.md,\n        boxSizing: 'border-box',\n        borderBottomLeftRadius: theme.borders.borderRadiusMd,\n        borderBottom: `1px solid ${borderColor}`,\n        borderLeft: `1px solid ${borderColor}`,\n        zIndex: active ? TimelineTreeZIndex.NORMAL : TimelineTreeZIndex.LOW,\n      }}\n    />\n  );\n};\n\nconst VerticalConnector = ({ active }: { active: boolean }) => {\n  const { theme } = useDesignSystemTheme();\n  const borderColor = active ? theme.colors.blue500 : theme.colors.border;\n\n  return (\n    <div\n      css={{\n        position: 'absolute',\n        width: SPAN_INDENT_WIDTH / 2,\n        left: '50%',\n        height: SPAN_ROW_HEIGHT,\n        borderLeft: `1px solid ${borderColor}`,\n        boxSizing: 'border-box',\n        zIndex: active ? TimelineTreeZIndex.NORMAL : TimelineTreeZIndex.LOW,\n      }}\n    />\n  );\n};\n\n/**\n * This component renders the bars that represent the hierarchical\n * connections in the span tree.\n */\nexport const TimelineTreeHierarchyBars = ({\n  isActiveSpan,\n  isInActiveChain,\n  linesToRender,\n  hasChildren,\n  isExpanded,\n}: {\n  // whether or not the current span is active\n  isActiveSpan: boolean;\n  // true if the span is either active or a parent of the active span\n  isInActiveChain: boolean;\n  // an array of bars to render to the left of the span icon / name\n  linesToRender: Array<HierarchyBar>;\n  hasChildren: boolean;\n  isExpanded: boolean;\n}) => {\n  if (linesToRender.length === 0) {\n    return (\n      <div\n        css={{\n          width: 0,\n          height: SPAN_ROW_HEIGHT,\n          boxSizing: 'border-box',\n          position: 'relative',\n        }}\n      >\n        {hasChildren && <IconBottomConnector active={isInActiveChain && !isActiveSpan} />}\n      </div>\n    );\n  }\n\n  return (\n    <>\n      {linesToRender.map(({ shouldRender, isActive }, idx) => (\n        // for each depth level, render a spacer. depending on the span's\n        // position within the tree, the spacer might be empty or contain\n        // a vertical bar\n        <div\n          key={idx}\n          css={{\n            width: SPAN_INDENT_WIDTH,\n            height: SPAN_ROW_HEIGHT,\n            boxSizing: 'border-box',\n            position: 'relative',\n          }}\n        >\n          {shouldRender && (\n            // render a vertical bar in the middle of the spacer\n            <VerticalConnector active={isActive} />\n          )}\n          {idx === linesToRender.length - 1 && (\n            // at the last spacer, render a curved\n            // line that connects up to the parent\n            <>\n              <IconLeftConnector active={isInActiveChain} />\n              {hasChildren && isExpanded && <IconBottomConnector active={isInActiveChain && !isActiveSpan} />}\n            </>\n          )}\n        </div>\n      ))}\n    </>\n  );\n};\n","import React from 'react';\n\nimport { Tooltip, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { spanTimeFormatter } from './TimelineTree.utils';\nimport type { ModelTraceSpanNode } from '../ModelTrace.types';\nimport { ModelSpanType } from '../ModelTrace.types';\nimport { getIconTypeForSpan } from '../ModelTraceExplorer.utils';\nimport { ModelTraceExplorerIcon } from '../ModelTraceExplorerIcon';\n\nexport const TimelineTreeSpanTooltip = ({\n  span,\n  children,\n}: {\n  span: ModelTraceSpanNode;\n  children: React.ReactNode;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const iconType = getIconTypeForSpan(span.type ?? ModelSpanType.UNKNOWN);\n  const primaryTextColor = theme.isDarkMode ? theme.colors.grey800 : theme.colors.grey100;\n  const secondaryTextColor = theme.isDarkMode ? theme.colors.grey500 : theme.colors.grey350;\n\n  return (\n    <Tooltip\n      componentId=\"shared.model-trace-explorer.timeline-tree-node-tooltip\"\n      hideWhenDetached={false}\n      content={\n        <div\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n          }}\n        >\n          <div\n            css={{\n              display: 'flex',\n              flexDirection: 'row',\n              gap: theme.spacing.xs,\n              alignItems: 'center',\n              overflow: 'hidden',\n              wordBreak: 'break-all',\n            }}\n          >\n            <ModelTraceExplorerIcon type={iconType} isInTooltip />\n            <span css={{ color: primaryTextColor }}>{span.title}</span>\n            <span\n              css={{ marginLeft: theme.spacing.xs, color: secondaryTextColor, fontSize: theme.typography.fontSizeSm }}\n            >\n              {spanTimeFormatter(span.end - span.start)}\n            </span>\n          </div>\n          <div css={{ display: 'flex', flexDirection: 'row', color: primaryTextColor }}>\n            <FormattedMessage defaultMessage=\"Start:\" description=\"Label for the start time of a span\" />{' '}\n            {spanTimeFormatter(span.start)}\n            {' | '}\n            <FormattedMessage defaultMessage=\"End:\" description=\"Label for the end time of a span\" />{' '}\n            {spanTimeFormatter(span.end)}\n          </div>\n        </div>\n      }\n      side=\"right\"\n      maxWidth={700}\n    >\n      {children}\n    </Tooltip>\n  );\n};\n","import {\n  Button,\n  Typography,\n  useDesignSystemTheme,\n  ChevronDownIcon,\n  ChevronRightIcon,\n  Tag,\n  GavelIcon,\n} from '@databricks/design-system';\n\nimport type { HierarchyBar } from './TimelineTree.types';\nimport { getActiveChildIndex, TimelineTreeZIndex } from './TimelineTree.utils';\nimport { TimelineTreeHierarchyBars } from './TimelineTreeHierarchyBars';\nimport { TimelineTreeSpanTooltip } from './TimelineTreeSpanTooltip';\nimport { type ModelTraceSpanNode } from '../ModelTrace.types';\nimport { getSpanExceptionCount } from '../ModelTraceExplorer.utils';\nimport { useModelTraceExplorerViewState } from '../ModelTraceExplorerViewStateContext';\n\nexport const TimelineTreeNode = ({\n  node,\n  selectedKey,\n  expandedKeys,\n  setExpandedKeys,\n  traceStartTime,\n  traceEndTime,\n  onSelect,\n  linesToRender,\n}: {\n  node: ModelTraceSpanNode;\n  selectedKey: string | number;\n  expandedKeys: Set<string | number>;\n  setExpandedKeys: (keys: Set<string | number>) => void;\n  traceStartTime: number;\n  traceEndTime: number;\n  onSelect: ((node: ModelTraceSpanNode) => void) | undefined;\n  // a boolean array that signifies whether or not a vertical\n  // connecting line is supposed to in at the `i`th spacer. see\n  // TimelineTreeHierarchyBars for more details.\n  linesToRender: Array<HierarchyBar>;\n}) => {\n  const expanded = expandedKeys.has(node.key);\n  const { theme } = useDesignSystemTheme();\n  const hasChildren = (node.children ?? []).length > 0;\n  const { setAssessmentsPaneExpanded } = useModelTraceExplorerViewState();\n\n  const isActive = selectedKey === node.key;\n  const activeChildIndex = getActiveChildIndex(node, String(selectedKey));\n  // true if a span has active children OR is the active span\n  const isInActiveChain = activeChildIndex > -1;\n\n  const hasException = getSpanExceptionCount(node) > 0;\n\n  const backgroundColor = isActive ? theme.colors.actionDefaultBackgroundHover : 'transparent';\n\n  return (\n    <>\n      <TimelineTreeSpanTooltip span={node}>\n        <div\n          data-testid={`timeline-tree-node-${node.key}`}\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n            width: '100%',\n            cursor: 'pointer',\n            boxSizing: 'border-box',\n            backgroundColor,\n            ':hover': {\n              backgroundColor: theme.colors.actionDefaultBackgroundHover,\n            },\n            ':active': {\n              backgroundColor: theme.colors.actionDefaultBackgroundPress,\n            },\n          }}\n          onClick={() => {\n            onSelect?.(node);\n          }}\n        >\n          <div\n            css={{\n              display: 'flex',\n              flexDirection: 'row',\n              alignItems: 'center',\n              // add padding to root nodes, because they have no connecting lines\n              padding: `0px ${theme.spacing.sm}px`,\n              justifyContent: 'space-between',\n              overflow: 'hidden',\n              flex: 1,\n            }}\n          >\n            <div css={{ display: 'flex', flexDirection: 'row', alignItems: 'center', overflow: 'hidden', flex: 1 }}>\n              {hasChildren ? (\n                <Button\n                  size=\"small\"\n                  data-testid={`toggle-span-expanded-${node.key}`}\n                  css={{ flexShrink: 0, marginRight: theme.spacing.xs }}\n                  icon={expanded ? <ChevronDownIcon /> : <ChevronRightIcon />}\n                  onClick={(event) => {\n                    // prevent the node from being selected when the expand button is clicked\n                    event.stopPropagation();\n                    const newExpandedKeys = new Set(expandedKeys);\n                    if (expanded) {\n                      newExpandedKeys.delete(node.key);\n                    } else {\n                      newExpandedKeys.add(node.key);\n                    }\n                    setExpandedKeys(newExpandedKeys);\n                  }}\n                  componentId=\"shared.model-trace-explorer.toggle-span\"\n                />\n              ) : (\n                <div css={{ width: 24, marginRight: theme.spacing.xs }} />\n              )}\n              <TimelineTreeHierarchyBars\n                isActiveSpan={isActive}\n                isInActiveChain={isInActiveChain}\n                linesToRender={linesToRender}\n                hasChildren={hasChildren}\n                isExpanded={expanded}\n              />\n              <span\n                css={{\n                  flexShrink: 0,\n                  marginRight: theme.spacing.xs,\n                  borderRadius: theme.borders.borderRadiusSm,\n                  border: `1px solid ${\n                    activeChildIndex > -1 ? theme.colors.blue500 : theme.colors.backgroundSecondary\n                  }`,\n                  zIndex: TimelineTreeZIndex.NORMAL,\n                }}\n              >\n                {node.icon}\n              </span>\n              <Typography.Text\n                color={hasException ? 'error' : 'primary'}\n                css={{\n                  overflow: 'hidden',\n                  whiteSpace: 'nowrap',\n                  textOverflow: 'ellipsis',\n                  flex: 1,\n                }}\n              >\n                {node.title}\n              </Typography.Text>\n              {node.assessments.length > 0 && (\n                <Tag\n                  color=\"indigo\"\n                  data-testid={`assessment-tag-${node.key}`}\n                  componentId=\"shared.model-trace-explorer.assessment-count\"\n                  css={{\n                    margin: 0,\n                    borderRadius: theme.borders.borderRadiusSm,\n                  }}\n                  onClick={() => setAssessmentsPaneExpanded?.(true)}\n                >\n                  <GavelIcon />\n                  <Typography.Text css={{ marginLeft: theme.spacing.xs }}>{node.assessments.length}</Typography.Text>\n                </Tag>\n              )}\n            </div>\n          </div>\n        </div>\n      </TimelineTreeSpanTooltip>\n      {expanded &&\n        node.children?.map((child, idx) => (\n          <TimelineTreeNode\n            key={child.key}\n            node={child}\n            expandedKeys={expandedKeys}\n            setExpandedKeys={setExpandedKeys}\n            selectedKey={selectedKey}\n            traceStartTime={traceStartTime}\n            traceEndTime={traceEndTime}\n            onSelect={onSelect}\n            linesToRender={linesToRender.concat({\n              // render the connecting line at this depth\n              // if there are more children to render\n              shouldRender: idx < (node.children?.length ?? 0) - 1,\n              // make the vertical line blue if the active span\n              // is below this child\n              isActive: idx < activeChildIndex,\n            })}\n          />\n        ))}\n    </>\n  );\n};\n","import { useLayoutEffect, useRef } from 'react';\n\nimport { useDesignSystemTheme, Typography, Button, ChevronDownIcon, ChevronRightIcon } from '@databricks/design-system';\n\nimport type { ModelTraceSpanNode } from '../../ModelTrace.types';\nimport { spanTimeFormatter, TimelineTreeZIndex } from '../TimelineTree.utils';\nimport { TimelineTreeSpanTooltip } from '../TimelineTreeSpanTooltip';\n\nexport const TimelineTreeGanttNode = ({\n  node,\n  selectedKey,\n  leftOffset,\n  width,\n  onSelect,\n  expandedKeys,\n  setExpandedKeys,\n}: {\n  node: ModelTraceSpanNode;\n  selectedKey: string | number;\n  leftOffset: number;\n  width: number;\n  onSelect: ((node: ModelTraceSpanNode) => void) | undefined;\n  expandedKeys: Set<string | number>;\n  setExpandedKeys: (keys: Set<string | number>) => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const titleInBarRef = useRef<HTMLSpanElement>(null);\n  const titleBesideBarRef = useRef<HTMLSpanElement>(null);\n  const isActive = selectedKey === node.key;\n  const backgroundColor = isActive ? theme.colors.actionDefaultBackgroundHover : 'transparent';\n  const hasChildren = (node.children ?? []).length > 0;\n  const expanded = expandedKeys.has(node.key);\n\n  useLayoutEffect(() => {\n    if (!titleInBarRef.current || !titleBesideBarRef.current) {\n      return;\n    }\n\n    const spanWidth = Math.max(titleInBarRef.current.offsetWidth, titleBesideBarRef.current.offsetWidth);\n\n    if (spanWidth < width - theme.spacing.sm) {\n      titleInBarRef.current.style.display = 'inline';\n      titleBesideBarRef.current.style.display = 'none';\n    } else {\n      titleInBarRef.current.style.display = 'none';\n      titleBesideBarRef.current.style.display = 'inline';\n    }\n  }, [theme.spacing.sm, width]);\n\n  return (\n    <TimelineTreeSpanTooltip span={node}>\n      <div\n        key={node.key}\n        css={{\n          display: 'flex',\n          flexDirection: 'row',\n          cursor: 'pointer',\n          boxSizing: 'border-box',\n          paddingLeft: theme.spacing.xs,\n          paddingRight: theme.spacing.sm,\n          paddingTop: theme.spacing.xs,\n          paddingBottom: theme.spacing.xs,\n          backgroundColor: backgroundColor,\n          alignItems: 'center',\n          ':hover': {\n            backgroundColor: theme.colors.actionDefaultBackgroundHover,\n          },\n          ':active': {\n            backgroundColor: theme.colors.actionDefaultBackgroundPress,\n          },\n          zIndex: TimelineTreeZIndex.NORMAL,\n        }}\n        onClick={() => onSelect?.(node)}\n      >\n        {hasChildren ? (\n          <Button\n            size=\"small\"\n            data-testid={`toggle-timeline-span-expanded-${node.key}`}\n            css={{ flexShrink: 0, marginRight: theme.spacing.xs }}\n            icon={expanded ? <ChevronDownIcon /> : <ChevronRightIcon />}\n            onClick={(event) => {\n              // prevent the node from being selected when the expand button is clicked\n              event.stopPropagation();\n              const newExpandedKeys = new Set(expandedKeys);\n              if (expanded) {\n                newExpandedKeys.delete(node.key);\n              } else {\n                newExpandedKeys.add(node.key);\n              }\n              setExpandedKeys(newExpandedKeys);\n            }}\n            componentId=\"shared.model-trace-explorer.toggle-timeline-span\"\n          />\n        ) : (\n          <div css={{ width: 24, marginRight: theme.spacing.xs }} />\n        )}\n        <div css={{ width: leftOffset, flexShrink: 0 }} />\n        <div\n          css={{\n            position: 'relative',\n            width,\n            height: theme.typography.lineHeightBase,\n            backgroundColor: theme.colors.blue600,\n            borderRadius: theme.borders.borderRadiusSm,\n            flexShrink: 0,\n          }}\n        >\n          <Typography.Text>\n            <span\n              ref={titleInBarRef}\n              css={{\n                marginLeft: theme.spacing.xs,\n                color: theme.colors.white,\n                display: 'none',\n              }}\n            >\n              {node.title}\n            </span>\n          </Typography.Text>\n        </div>\n        <div css={{ flex: 1, overflow: 'hidden', whiteSpace: 'nowrap', textOverflow: 'ellipsis' }}>\n          <Typography.Text>\n            <span\n              ref={titleBesideBarRef}\n              css={{\n                marginLeft: theme.spacing.xs,\n                color: theme.colors.textPrimary,\n              }}\n            >\n              {node.title}\n            </span>\n          </Typography.Text>\n          <Typography.Text css={{ marginLeft: theme.spacing.xs }} color=\"secondary\">\n            {spanTimeFormatter(node.end - node.start)}\n          </Typography.Text>\n        </div>\n      </div>\n    </TimelineTreeSpanTooltip>\n  );\n};\n","import { useMemo, useRef } from 'react';\n\nimport { Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { useResizeObserver } from '@databricks/web-shared/hooks';\n\nimport { TimelineTreeGanttNode } from './TimelineTreeGanttNode';\nimport type { ModelTraceSpanNode } from '../../ModelTrace.types';\nimport { spanTimeFormatter, TimelineTreeZIndex } from '../TimelineTree.utils';\n\n// the amount of space required to accomodate the collapse buttons\nconst TIMELINE_BAR_LEFT_OFFSET = 32;\n\n// this function generates an array of \"nice\" x-ticks (e.g. nearest 0.1, 0.2, 0.5 to the value)\nfunction getNiceXTicks(left: number, right: number, graphWidth: number, minPixelsBetweenTicks = 60): number[] {\n  const range = right - left;\n  if (range <= 0 || graphWidth <= 0) return [];\n\n  const maxTickCount = Math.floor(graphWidth / minPixelsBetweenTicks);\n  if (maxTickCount < 1) return [];\n\n  // Step 1: raw interval\n  const rawInterval = range / maxTickCount;\n\n  // Step 2: round to a \"nice\" interval\n  const magnitude = Math.pow(10, Math.floor(Math.log10(rawInterval)));\n  const residual = rawInterval / magnitude;\n\n  let niceFraction;\n  if (residual <= 1) niceFraction = 1;\n  else if (residual <= 2) niceFraction = 2;\n  else if (residual <= 5) niceFraction = 5;\n  else niceFraction = 10;\n\n  const niceInterval = niceFraction * magnitude;\n\n  // Step 3: extend right bound so we always overshoot it\n  // this guarantees that there will be enough space to\n  // render the span labels.\n  const extendedRight = right + 2 * niceInterval;\n\n  // Step 4: Generate tick positions\n  const firstTick = Math.ceil(left / niceInterval) * niceInterval;\n  const ticks: number[] = [];\n\n  for (let tick = firstTick; tick <= extendedRight; tick += niceInterval) {\n    ticks.push(Number(tick.toFixed(10))); // Avoid float errors\n  }\n\n  return ticks;\n}\n\n// converts timestamp numbers to real pixel values\nfunction scaleX(value: number, left: number, right: number, width: number) {\n  return ((value - left) / (right - left)) * width;\n}\n\nexport const TimelineTreeGanttBars = ({\n  nodes,\n  selectedKey,\n  onSelect,\n  traceStartTime,\n  traceEndTime,\n  expandedKeys,\n  setExpandedKeys,\n}: {\n  nodes: ModelTraceSpanNode[];\n  selectedKey: string | number;\n  onSelect: ((node: ModelTraceSpanNode) => void) | undefined;\n  traceStartTime: number;\n  traceEndTime: number;\n  expandedKeys: Set<string | number>;\n  setExpandedKeys: (keys: Set<string | number>) => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const treeContainerRef = useRef<HTMLDivElement>(null);\n  const treeElementWidth = useResizeObserver({ ref: treeContainerRef })?.width ?? 0;\n  const initialXTicks = useMemo(\n    () => getNiceXTicks(traceStartTime, traceEndTime, treeElementWidth),\n    [traceEndTime, traceStartTime, treeElementWidth],\n  );\n  const left = Math.min(...initialXTicks);\n  // for the right limit of the graph, we take the average of the last\n  // two ticks so that the graph does not end directly on a line. if\n  // the graph ends on the line, the ticklabel at the top might render\n  // slightly off screen, which looks bad\n  const right = (initialXTicks[initialXTicks.length - 1] + initialXTicks[initialXTicks.length - 2]) / 2;\n  // pop the last tick since we will not render it (it's beyond the right limit)\n  const xTicks = initialXTicks.slice(0, -1);\n\n  const scaleDurationToTreeWidth = (value: number) => scaleX(value, left, right, treeElementWidth);\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        position: 'relative',\n        boxSizing: 'border-box',\n      }}\n    >\n      {/* gantt bar header with the tick labels */}\n      <div\n        ref={treeContainerRef}\n        css={{\n          display: 'flex',\n          width: '100%',\n          flexDirection: 'row',\n          height: theme.typography.lineHeightBase,\n          paddingLeft: TIMELINE_BAR_LEFT_OFFSET,\n          paddingRight: theme.spacing.lg,\n          boxSizing: 'border-box',\n          position: 'sticky',\n          top: 0,\n          backgroundColor: theme.colors.backgroundPrimary,\n          zIndex: TimelineTreeZIndex.HIGH,\n        }}\n      >\n        <div\n          data-testid=\"time-marker-area\"\n          css={{\n            position: 'relative',\n          }}\n        >\n          {xTicks.map((n) => (\n            <Typography.Text\n              css={{\n                position: 'absolute',\n                transform: `translateX(-50%)`,\n                left: scaleDurationToTreeWidth(n),\n                whiteSpace: 'nowrap',\n              }}\n              key={n}\n            >\n              {spanTimeFormatter(n)}\n            </Typography.Text>\n          ))}\n        </div>\n      </div>\n      {/* vertical gantt markers */}\n      <div\n        css={{\n          flex: 1,\n          pointerEvents: 'none',\n          zIndex: TimelineTreeZIndex.LOW,\n        }}\n      >\n        <div\n          css={{\n            position: 'absolute',\n            height: '100%',\n            width: '100%',\n          }}\n        >\n          {xTicks.map((n) => (\n            <div\n              key={n}\n              css={{\n                position: 'absolute',\n                left: scaleDurationToTreeWidth(n) + TIMELINE_BAR_LEFT_OFFSET,\n                borderRight: `1px solid ${theme.colors.border}`,\n                height: '100%',\n              }}\n            />\n          ))}\n        </div>\n      </div>\n      {/* colored horizontal gantt bars */}\n      {nodes.map((node) => {\n        const leftOffset = scaleDurationToTreeWidth(node.start);\n        const width = scaleDurationToTreeWidth(node.end) - leftOffset;\n        return (\n          <TimelineTreeGanttNode\n            key={node.key}\n            selectedKey={selectedKey}\n            onSelect={onSelect}\n            node={node}\n            leftOffset={leftOffset}\n            width={width}\n            expandedKeys={expandedKeys}\n            setExpandedKeys={setExpandedKeys}\n          />\n        );\n      })}\n    </div>\n  );\n};\n","import { useCallback, useMemo } from 'react';\n\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { getTimelineTreeExpandedNodesList } from './TimelineTree.utils';\nimport { TimelineTreeHeader } from './TimelineTreeHeader';\nimport { TimelineTreeNode } from './TimelineTreeNode';\nimport { TimelineTreeGanttBars } from './gantt/TimelineTreeGanttBars';\nimport type { ModelTraceSpanNode, SpanFilterState } from '../ModelTrace.types';\nimport { useModelTraceExplorerViewState } from '../ModelTraceExplorerViewStateContext';\n\nexport const TimelineTree = <NodeType extends ModelTraceSpanNode & { children?: NodeType[] }>({\n  rootNodes,\n  selectedNode,\n  setSelectedNode,\n  traceStartTime,\n  traceEndTime,\n  expandedKeys,\n  setExpandedKeys,\n  spanFilterState,\n  setSpanFilterState,\n  className,\n}: {\n  selectedNode?: NodeType;\n  setSelectedNode: (node: ModelTraceSpanNode) => void;\n  traceStartTime: number;\n  traceEndTime: number;\n  rootNodes: NodeType[];\n  expandedKeys: Set<string | number>;\n  setExpandedKeys: (keys: Set<string | number>) => void;\n  spanFilterState: SpanFilterState;\n  setSpanFilterState: (state: SpanFilterState) => void;\n  className?: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  const onSpanClick = useCallback(\n    (node) => {\n      setSelectedNode?.(node);\n    },\n    [\n      // comment to prevent prettier format after copybara\n      setSelectedNode,\n    ],\n  );\n\n  const { showTimelineTreeGantt: showTimelineInfo, setShowTimelineTreeGantt: setShowTimelineInfo } =\n    useModelTraceExplorerViewState();\n\n  const expandedNodesList = useMemo(\n    () => getTimelineTreeExpandedNodesList(rootNodes, expandedKeys),\n    [rootNodes, expandedKeys],\n  );\n\n  const treeElement = useMemo(\n    () => (\n      <div\n        css={{\n          flex: 1,\n          overflow: 'auto',\n          minHeight: '100%',\n          boxSizing: 'border-box',\n          display: 'flex',\n          flexDirection: 'column',\n        }}\n      >\n        {showTimelineInfo ? (\n          <TimelineTreeGanttBars\n            nodes={expandedNodesList}\n            selectedKey={selectedNode?.key ?? ''}\n            onSelect={onSpanClick}\n            traceStartTime={traceStartTime}\n            traceEndTime={traceEndTime}\n            expandedKeys={expandedKeys}\n            setExpandedKeys={setExpandedKeys}\n          />\n        ) : (\n          rootNodes.map((node) => (\n            <TimelineTreeNode\n              key={node.key}\n              node={node}\n              expandedKeys={expandedKeys}\n              setExpandedKeys={setExpandedKeys}\n              selectedKey={selectedNode?.key ?? ''}\n              traceStartTime={traceStartTime}\n              traceEndTime={traceEndTime}\n              onSelect={onSpanClick}\n              linesToRender={[]}\n            />\n          ))\n        )}\n      </div>\n    ),\n    [\n      showTimelineInfo,\n      expandedNodesList,\n      selectedNode?.key,\n      onSpanClick,\n      traceStartTime,\n      traceEndTime,\n      rootNodes,\n      expandedKeys,\n      setExpandedKeys,\n    ],\n  );\n\n  return (\n    <div\n      css={{\n        height: '100%',\n        borderRadius: theme.legacyBorders.borderRadiusMd,\n        overflow: 'hidden',\n        display: 'flex',\n      }}\n      className={className}\n    >\n      <div\n        css={{\n          overflow: 'hidden',\n          display: 'flex',\n          flexDirection: 'column',\n          flex: 1,\n        }}\n      >\n        <div css={{ display: 'flex', flexDirection: 'column', height: '100%' }}>\n          <TimelineTreeHeader\n            showTimelineInfo={showTimelineInfo}\n            setShowTimelineInfo={setShowTimelineInfo}\n            spanFilterState={spanFilterState}\n            setSpanFilterState={setSpanFilterState}\n          />\n          {rootNodes.length > 0 ? (\n            <div css={{ flex: 1, overflowY: 'auto', display: 'flex' }}>{treeElement}</div>\n          ) : (\n            <div\n              css={{\n                flex: 1,\n                display: 'flex',\n                justifyContent: 'center',\n                padding: theme.spacing.md,\n                paddingTop: theme.spacing.lg,\n              }}\n            >\n              <FormattedMessage\n                defaultMessage=\"No results found. Try using a different search term.\"\n                description=\"Model trace explorer > no results found\"\n              />\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n","import { values, isString } from 'lodash';\nimport { useLayoutEffect, useMemo, useRef, useState } from 'react';\n\nimport { useDesignSystemTheme } from '@databricks/design-system';\n\nimport type { ModelTrace, ModelTraceSpanNode } from './ModelTrace.types';\nimport type { ModelTraceExplorerResizablePaneRef } from './ModelTraceExplorerResizablePane';\nimport ModelTraceExplorerResizablePane from './ModelTraceExplorerResizablePane';\nimport ModelTraceExplorerSearchBox from './ModelTraceExplorerSearchBox';\nimport { useModelTraceExplorerViewState } from './ModelTraceExplorerViewStateContext';\nimport { useModelTraceSearch } from './hooks/useModelTraceSearch';\nimport { ModelTraceExplorerRightPaneTabs, RIGHT_PANE_MIN_WIDTH } from './right-pane/ModelTraceExplorerRightPaneTabs';\nimport { TimelineTree } from './timeline-tree';\nimport {\n  DEFAULT_EXPAND_DEPTH,\n  getModelTraceSpanNodeDepth,\n  getTimelineTreeNodesMap,\n  SPAN_INDENT_WIDTH,\n  useTimelineTreeExpandedNodes,\n} from './timeline-tree/TimelineTree.utils';\n\n// this is the number of large spacings we need in order to\n// properly calculate the min width for the left pane. it's:\n// - 1 for left and right padding\n// - 4 for the right collapse button + time marker\n// - 1 for span icon\n// - 1 for buffer (leave some space to render text)\nconst LEFT_PANE_MIN_WIDTH_LARGE_SPACINGS = 7;\nconst LEFT_PANE_HEADER_MIN_WIDTH_PX = 275;\n\nconst getDefaultSplitRatio = (): number => {\n  if (window.innerWidth <= 768) {\n    return 0.33;\n  }\n\n  return 0.25;\n};\n\nexport const ModelTraceExplorerDetailView = ({\n  modelTrace,\n  className,\n  selectedSpanId,\n  onSelectSpan,\n}: {\n  modelTrace: ModelTrace;\n  className?: string;\n  selectedSpanId?: string;\n  onSelectSpan?: (selectedSpanId?: string) => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const initialRatio = getDefaultSplitRatio();\n  const paneRef = useRef<ModelTraceExplorerResizablePaneRef>(null);\n  const [paneWidth, setPaneWidth] = useState(500);\n\n  const {\n    rootNode: treeNode,\n    selectedNode,\n    setSelectedNode,\n    activeTab,\n    setActiveTab,\n  } = useModelTraceExplorerViewState();\n\n  const { expandedKeys, setExpandedKeys } = useTimelineTreeExpandedNodes({\n    rootNodes: treeNode ? [treeNode] : [],\n    // nodes beyond this depth will be collapsed\n    initialExpandDepth: DEFAULT_EXPAND_DEPTH,\n  });\n\n  const {\n    matchData,\n    searchFilter,\n    setSearchFilter,\n    spanFilterState,\n    setSpanFilterState,\n    filteredTreeNodes,\n    handleNextSearchMatch,\n    handlePreviousSearchMatch,\n  } = useModelTraceSearch({\n    treeNode,\n    selectedNode,\n    setSelectedNode,\n    setActiveTab,\n    setExpandedKeys,\n    modelTraceInfo: modelTrace?.info,\n  });\n\n  const onSelectNode = (node?: ModelTraceSpanNode) => {\n    setSelectedNode(node);\n    // Open left most tab when a span is clicked\n    setActiveTab(node?.chatMessages ? 'chat' : 'content');\n    if (isString(node?.key)) {\n      onSelectSpan?.(node?.key);\n    }\n  };\n\n  // initial render\n  useLayoutEffect(() => {\n    // expand all nodes up to the default depth when the tree changes\n    const list = values(getTimelineTreeNodesMap(filteredTreeNodes, DEFAULT_EXPAND_DEPTH)).map((node) => node.key);\n    setExpandedKeys(new Set(list));\n  }, [filteredTreeNodes, setExpandedKeys]);\n\n  const leftPaneMinWidth = useMemo(() => {\n    // min width necessary to render all the spans in the tree accounting for indentation\n    const minWidthForSpans =\n      Math.max(...filteredTreeNodes.map(getModelTraceSpanNodeDepth)) * SPAN_INDENT_WIDTH +\n      LEFT_PANE_MIN_WIDTH_LARGE_SPACINGS * theme.spacing.lg;\n    // min width necessary to render the header, given that it has a bunch of buttons\n    return Math.max(LEFT_PANE_HEADER_MIN_WIDTH_PX, minWidthForSpans);\n  }, [filteredTreeNodes, theme.spacing.lg]);\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        flex: 1,\n        minHeight: 0,\n      }}\n      className={className}\n    >\n      <div\n        css={{\n          padding: theme.spacing.xs,\n          borderBottom: `1px solid ${theme.colors.border}`,\n        }}\n      >\n        <ModelTraceExplorerSearchBox\n          searchFilter={searchFilter}\n          setSearchFilter={setSearchFilter}\n          matchData={matchData}\n          handleNextSearchMatch={handleNextSearchMatch}\n          handlePreviousSearchMatch={handlePreviousSearchMatch}\n        />\n      </div>\n      <ModelTraceExplorerResizablePane\n        ref={paneRef}\n        initialRatio={initialRatio}\n        paneWidth={paneWidth}\n        setPaneWidth={setPaneWidth}\n        leftChild={\n          <div\n            css={{\n              display: 'flex',\n              flexDirection: 'column',\n              flex: 1,\n              minWidth: leftPaneMinWidth,\n            }}\n          >\n            <TimelineTree\n              rootNodes={filteredTreeNodes}\n              selectedNode={selectedNode}\n              traceStartTime={treeNode?.start ?? 0}\n              traceEndTime={treeNode?.end ?? 0}\n              setSelectedNode={onSelectNode}\n              css={{ flex: 1 }}\n              expandedKeys={expandedKeys}\n              setExpandedKeys={setExpandedKeys}\n              spanFilterState={spanFilterState}\n              setSpanFilterState={setSpanFilterState}\n            />\n          </div>\n        }\n        leftMinWidth={leftPaneMinWidth}\n        rightChild={\n          <ModelTraceExplorerRightPaneTabs\n            activeSpan={selectedNode}\n            searchFilter={searchFilter}\n            activeMatch={matchData.match}\n            activeTab={activeTab}\n            setActiveTab={setActiveTab}\n          />\n        }\n        rightMinWidth={RIGHT_PANE_MIN_WIDTH}\n      />\n    </div>\n  );\n};\n","import { TableSkeleton, TitleSkeleton, useDesignSystemTheme } from '@databricks/design-system';\n\nexport const ModelTraceExplorerSkeleton = ({ label }: { label?: React.ReactNode }) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div css={{ display: 'flex', height: '100%' }}>\n      <div css={{ flex: 1 }}>\n        <div css={{ padding: theme.spacing.sm, borderBottom: `1px solid ${theme.colors.border}` }}>\n          <TitleSkeleton label={label} />\n        </div>\n        <div\n          css={{\n            borderRadius: theme.legacyBorders.borderRadiusMd,\n            overflow: 'hidden',\n            display: 'flex',\n          }}\n        >\n          <div css={{ flex: 1, padding: theme.spacing.sm, borderRight: `1px solid ${theme.colors.border}` }}>\n            <TableSkeleton lines={5} />\n          </div>\n          <div css={{ flex: 2, padding: theme.spacing.sm }}>\n            <TableSkeleton lines={5} />\n          </div>\n        </div>\n      </div>\n      <div css={{ padding: theme.spacing.md, overflowY: 'auto', flex: 1 }}>\n        <TableSkeleton lines={12} />\n      </div>\n    </div>\n  );\n};\n","import { useQuery } from '@databricks/web-shared/query-client';\n\nimport type { ModelTrace } from '../ModelTrace.types';\nimport { fetchTraceInfoV3 } from '../api';\n\nexport const useGetModelTraceInfoV3 = ({\n  traceId,\n  setModelTrace,\n  setAssessmentsPaneEnabled,\n}: {\n  traceId: string;\n  setModelTrace: React.Dispatch<React.SetStateAction<ModelTrace>>;\n  setAssessmentsPaneEnabled: React.Dispatch<React.SetStateAction<boolean>>;\n}) => {\n  return useQuery({\n    queryFn: () => fetchTraceInfoV3({ traceId }),\n    onSuccess: (response) => {\n      setModelTrace((prevModelTrace: ModelTrace) => ({\n        data: prevModelTrace.data,\n        info: response?.trace?.trace_info ?? {},\n      }));\n      setAssessmentsPaneEnabled(true);\n    },\n    onError: () => {\n      setAssessmentsPaneEnabled(false);\n    },\n  });\n};\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\n\nimport type { ModelTraceChatTool } from '../ModelTrace.types';\nimport { ModelTraceExplorerChatTool } from '../right-pane/ModelTraceExplorerChatTool';\n\nexport const ModelTraceExplorerChatToolsRenderer = ({\n  title,\n  tools,\n}: {\n  title: string;\n  tools: ModelTraceChatTool[];\n}) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        gap: theme.spacing.sm,\n        padding: theme.spacing.sm,\n        border: `1px solid ${theme.colors.border}`,\n        borderRadius: theme.borders.borderRadiusSm,\n      }}\n    >\n      {title && (\n        <Typography.Text css={{ marginLeft: theme.spacing.xs }} bold>\n          {title}\n        </Typography.Text>\n      )}\n      {tools.map((tool) => (\n        <ModelTraceExplorerChatTool key={tool.function.name} tool={tool} />\n      ))}\n    </div>\n  );\n};\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\n\nimport type { RetrieverDocument } from '../ModelTrace.types';\nimport { ModelTraceExplorerRetrieverDocument } from '../right-pane/ModelTraceExplorerRetrieverDocument';\n\nexport const ModelTraceExplorerRetrieverFieldRenderer = ({\n  title,\n  documents,\n}: {\n  title: string;\n  documents: RetrieverDocument[];\n}) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div\n      css={{\n        backgroundColor: theme.colors.backgroundPrimary,\n        borderRadius: theme.borders.borderRadiusSm,\n        border: `1px solid ${theme.colors.border}`,\n      }}\n    >\n      {title && (\n        <div\n          css={{\n            padding: `${theme.spacing.xs}px ${theme.spacing.sm}px`,\n            borderBottom: `1px solid ${theme.colors.border}`,\n          }}\n        >\n          <Typography.Text bold>{title}</Typography.Text>\n        </div>\n      )}\n      {documents.map((document, idx) => (\n        <div key={idx} css={{ borderBottom: idx !== documents.length - 1 ? `1px solid ${theme.colors.border}` : '' }}>\n          <ModelTraceExplorerRetrieverDocument key={idx} text={document.page_content} metadata={document.metadata} />\n        </div>\n      ))}\n    </div>\n  );\n};\n","import { useState } from 'react';\n\nimport { ChevronDownIcon, ChevronRightIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\nimport { GenAIMarkdownRenderer } from '@databricks/web-shared/genai-markdown-renderer';\n\nconst STRING_TRUNCATION_LIMIT = 400;\n\nexport const ModelTraceExplorerTextFieldRenderer = ({ title, value }: { title: string; value: string }) => {\n  const { theme } = useDesignSystemTheme();\n  const [expanded, setExpanded] = useState(false);\n\n  const isExpandable = value.length > STRING_TRUNCATION_LIMIT;\n  const displayValue =\n    !expanded && value.length > STRING_TRUNCATION_LIMIT ? value.slice(0, STRING_TRUNCATION_LIMIT) + '...' : value;\n\n  const hoverStyles = isExpandable\n    ? { ':hover': { backgroundColor: theme.colors.actionIconBackgroundHover, cursor: 'pointer' } }\n    : {};\n\n  return (\n    <div\n      css={{\n        border: `1px solid ${theme.colors.border}`,\n        borderRadius: theme.borders.borderRadiusSm,\n      }}\n    >\n      {title && (\n        <div\n          role=\"button\"\n          css={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            padding: `${theme.spacing.sm}px ${theme.spacing.sm + theme.spacing.xs}px`,\n            ...hoverStyles,\n          }}\n          onClick={() => setExpanded(!expanded)}\n        >\n          <Typography.Text bold>{title}</Typography.Text>\n          {isExpandable && (expanded ? <ChevronDownIcon /> : <ChevronRightIcon />)}\n        </div>\n      )}\n      <div\n        css={{\n          display: 'flex',\n          flexDirection: 'column',\n          gap: theme.spacing.sm,\n          paddingLeft: theme.spacing.sm + theme.spacing.xs,\n          paddingRight: theme.spacing.sm + theme.spacing.xs,\n          paddingTop: title ? 0 : theme.spacing.sm,\n          paddingBottom: theme.spacing.sm,\n          // get rid of last margin in markdown renderer\n          '& > div:last-of-type': {\n            marginBottom: 0,\n          },\n        }}\n      >\n        <GenAIMarkdownRenderer>{displayValue}</GenAIMarkdownRenderer>\n        {isExpandable && (\n          <Typography.Link\n            onClick={() => setExpanded(!expanded)}\n            componentId=\"shared.model-trace-explorer.text-field-see-more-link\"\n          >\n            {expanded ? (\n              <FormattedMessage\n                defaultMessage=\"See less\"\n                description=\"Button to collapse a long text field in the trace explorer summary field renderer\"\n              />\n            ) : (\n              <FormattedMessage\n                defaultMessage=\"See more\"\n                description=\"Button to expand a long text field in the trace explorer summary field renderer\"\n              />\n            )}\n          </Typography.Link>\n        )}\n      </div>\n    </div>\n  );\n};\n","import { every, isString } from 'lodash';\nimport { useMemo } from 'react';\n\nimport { ModelTraceExplorerChatToolsRenderer } from './ModelTraceExplorerChatToolsRenderer';\nimport { ModelTraceExplorerRetrieverFieldRenderer } from './ModelTraceExplorerRetrieverFieldRenderer';\nimport { ModelTraceExplorerTextFieldRenderer } from './ModelTraceExplorerTextFieldRenderer';\nimport { CodeSnippetRenderMode } from '../ModelTrace.types';\nimport { isModelTraceChatTool, isRetrieverDocument, normalizeConversation } from '../ModelTraceExplorer.utils';\nimport { ModelTraceExplorerCodeSnippet } from '../ModelTraceExplorerCodeSnippet';\nimport { ModelTraceExplorerConversation } from '../right-pane/ModelTraceExplorerConversation';\n\nexport const ModelTraceExplorerFieldRenderer = ({\n  title,\n  data,\n  renderMode,\n}: {\n  title: string;\n  data: string;\n  renderMode: 'default' | 'json' | 'text';\n}) => {\n  const parsedData = useMemo(() => {\n    try {\n      return JSON.parse(data);\n    } catch (e) {\n      return data;\n    }\n  }, [data]);\n\n  const dataIsString = isString(parsedData);\n  const chatMessages = normalizeConversation(parsedData);\n  const isChatTools = Array.isArray(parsedData) && parsedData.length > 0 && every(parsedData, isModelTraceChatTool);\n  const isRetrieverDocuments =\n    Array.isArray(parsedData) && parsedData.length > 0 && every(parsedData, isRetrieverDocument);\n\n  if (renderMode === 'json') {\n    return <ModelTraceExplorerCodeSnippet title={title} data={data} initialRenderMode={CodeSnippetRenderMode.JSON} />;\n  }\n\n  if (renderMode === 'text') {\n    return <ModelTraceExplorerCodeSnippet title={title} data={data} initialRenderMode={CodeSnippetRenderMode.TEXT} />;\n  }\n\n  if (dataIsString) {\n    return <ModelTraceExplorerTextFieldRenderer title={title} value={parsedData} />;\n  }\n\n  if (chatMessages && chatMessages.length > 0) {\n    return <ModelTraceExplorerConversation messages={chatMessages} />;\n  }\n\n  if (isChatTools) {\n    return <ModelTraceExplorerChatToolsRenderer title={title} tools={parsedData} />;\n  }\n\n  if (isRetrieverDocuments) {\n    return <ModelTraceExplorerRetrieverFieldRenderer title={title} documents={parsedData} />;\n  }\n\n  return <ModelTraceExplorerCodeSnippet title={title} data={data} />;\n};\n","import { Typography, XCircleIcon, useDesignSystemTheme } from '@databricks/design-system';\n\nimport type { ModelTraceSpanNode } from '../ModelTrace.types';\nimport { getSpanExceptionEvents } from '../ModelTraceExplorer.utils';\nimport { ModelTraceExplorerCollapsibleSection } from '../ModelTraceExplorerCollapsibleSection';\nimport { ModelTraceExplorerFieldRenderer } from '../field-renderers/ModelTraceExplorerFieldRenderer';\n\nexport const ModelTraceExplorerSummaryViewExceptionsSection = ({ node }: { node: ModelTraceSpanNode }) => {\n  const { theme } = useDesignSystemTheme();\n  const exceptionEvents = getSpanExceptionEvents(node);\n  const isRoot = !node.parentId;\n  // to prevent excessive nesting, we only show the first exception.\n  // it is likely that any given span only has one exception,\n  // since execution usually stops after throwing.\n  const firstException = exceptionEvents[0];\n\n  if (!firstException) {\n    return null;\n  }\n\n  return (\n    <ModelTraceExplorerCollapsibleSection\n      css={{ marginBottom: isRoot ? theme.spacing.sm : 0 }}\n      withBorder={isRoot}\n      key={firstException.name}\n      sectionKey={firstException.name}\n      title={\n        <div css={{ display: 'flex', alignItems: 'center', gap: theme.spacing.sm }}>\n          <XCircleIcon color=\"danger\" />\n          <Typography.Text color=\"error\" bold>\n            Exception\n          </Typography.Text>\n        </div>\n      }\n    >\n      <div\n        css={{\n          display: 'flex',\n          flexDirection: 'column',\n          gap: theme.spacing.sm,\n          paddingBottom: theme.spacing.sm,\n          paddingLeft: isRoot ? 0 : theme.spacing.lg,\n        }}\n      >\n        {Object.entries(firstException.attributes ?? {}).map(([attribute, value]) => (\n          <ModelTraceExplorerFieldRenderer\n            key={attribute}\n            title={attribute}\n            data={JSON.stringify(value, null, 2)}\n            renderMode=\"text\"\n          />\n        ))}\n      </div>\n    </ModelTraceExplorerCollapsibleSection>\n  );\n};\n","import { useMemo, useState } from 'react';\n\nimport { Button, ChevronRightIcon, ChevronDownIcon, useDesignSystemTheme, Typography } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { ModelTraceExplorerSummaryViewExceptionsSection } from './ModelTraceExplorerSummaryViewExceptionsSection';\nimport { type ModelTraceSpanNode } from '../ModelTrace.types';\nimport { createListFromObject, getSpanExceptionEvents } from '../ModelTraceExplorer.utils';\nimport { ModelTraceExplorerCollapsibleSection } from '../ModelTraceExplorerCollapsibleSection';\nimport { useModelTraceExplorerViewState } from '../ModelTraceExplorerViewStateContext';\nimport { SpanNameDetailViewLink } from '../assessments-pane/SpanNameDetailViewLink';\nimport { ModelTraceExplorerFieldRenderer } from '../field-renderers/ModelTraceExplorerFieldRenderer';\nimport { spanTimeFormatter } from '../timeline-tree/TimelineTree.utils';\n\nconst CONNECTOR_WIDTH = 12;\nconst ROW_HEIGHT = 48;\n\nexport const ModelTraceExplorerSummaryIntermediateNode = ({\n  node,\n  renderMode,\n}: {\n  node: ModelTraceSpanNode;\n  renderMode: 'default' | 'json';\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const [expanded, setExpanded] = useState(false);\n  const inputList = useMemo(() => createListFromObject(node.inputs), [node]);\n  const outputList = useMemo(() => createListFromObject(node.outputs), [node]);\n  const exceptionEvents = getSpanExceptionEvents(node);\n\n  const hasException = exceptionEvents.length > 0;\n  const containsInputs = inputList.length > 0;\n  const containsOutputs = outputList.length > 0;\n\n  const { setSelectedNode, setActiveView, setShowTimelineTreeGantt } = useModelTraceExplorerViewState();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'row',\n        minHeight: ROW_HEIGHT,\n        flexShrink: 0,\n      }}\n    >\n      <div css={{ height: ROW_HEIGHT, display: 'flex', alignItems: 'center' }}>\n        <Button\n          size=\"small\"\n          data-testid={`toggle-span-expanded-${node.key}`}\n          css={{ flexShrink: 0, marginRight: theme.spacing.xs }}\n          icon={expanded ? <ChevronDownIcon /> : <ChevronRightIcon />}\n          onClick={() => setExpanded(!expanded)}\n          componentId=\"shared.model-trace-explorer.toggle-span\"\n        />\n      </div>\n      <div\n        css={{\n          position: 'relative',\n          boxSizing: 'border-box',\n          height: '100%',\n          borderLeft: `2px solid ${theme.colors.border}`,\n          width: CONNECTOR_WIDTH,\n        }}\n      >\n        <div\n          css={{\n            position: 'absolute',\n            left: -2,\n            top: 14,\n            height: CONNECTOR_WIDTH,\n            width: CONNECTOR_WIDTH,\n            boxSizing: 'border-box',\n            borderBottomLeftRadius: theme.borders.borderRadiusMd,\n            borderBottom: `2px solid ${theme.colors.border}`,\n            borderLeft: `2px solid ${theme.colors.border}`,\n          }}\n        />\n      </div>\n      <div css={{ display: 'flex', flexDirection: 'column', flex: 1, minWidth: 0 }}>\n        <div css={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n          <Typography.Text color=\"secondary\" css={{ display: 'inline-flex', alignItems: 'center', height: ROW_HEIGHT }}>\n            <FormattedMessage\n              defaultMessage=\"{spanName} was called\"\n              description=\"Label for an intermediate node in the trace explorer summary view, indicating that a span/function was called in the course of execution.\"\n              values={{\n                spanName: <SpanNameDetailViewLink node={node} />,\n              }}\n            />\n          </Typography.Text>\n          <span\n            onClick={() => {\n              setSelectedNode(node);\n              setActiveView('detail');\n              setShowTimelineTreeGantt(true);\n            }}\n          >\n            <Typography.Text\n              css={{\n                '&:hover': {\n                  textDecoration: 'underline',\n                  cursor: 'pointer',\n                },\n              }}\n              color=\"secondary\"\n            >\n              {spanTimeFormatter(node.end - node.start)}\n            </Typography.Text>\n          </span>\n        </div>\n        {expanded && (\n          <div>\n            {hasException && <ModelTraceExplorerSummaryViewExceptionsSection node={node} />}\n            {containsInputs && (\n              <ModelTraceExplorerCollapsibleSection\n                sectionKey=\"input\"\n                title={\n                  <FormattedMessage\n                    defaultMessage=\"Inputs\"\n                    description=\"Model trace explorer > selected span > inputs header\"\n                  />\n                }\n              >\n                <div\n                  css={{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    gap: theme.spacing.sm,\n                    paddingLeft: theme.spacing.lg,\n                    marginBottom: containsOutputs ? 0 : theme.spacing.sm,\n                  }}\n                >\n                  {inputList.map(({ key, value }, index) => (\n                    <ModelTraceExplorerFieldRenderer\n                      key={key || index}\n                      title={key}\n                      data={value}\n                      renderMode={renderMode}\n                    />\n                  ))}\n                </div>\n              </ModelTraceExplorerCollapsibleSection>\n            )}\n            {containsOutputs && (\n              <ModelTraceExplorerCollapsibleSection\n                sectionKey=\"output\"\n                title={\n                  <FormattedMessage\n                    defaultMessage=\"Outputs\"\n                    description=\"Model trace explorer > selected span > outputs header\"\n                  />\n                }\n              >\n                <div\n                  css={{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    gap: theme.spacing.sm,\n                    paddingLeft: theme.spacing.lg,\n                    marginBottom: theme.spacing.sm,\n                  }}\n                >\n                  {outputList.map(({ key, value }) => (\n                    <ModelTraceExplorerFieldRenderer key={key} title={key} data={value} renderMode={renderMode} />\n                  ))}\n                </div>\n              </ModelTraceExplorerCollapsibleSection>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n","import { useState } from 'react';\n\nimport { SegmentedControlButton, SegmentedControlGroup, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { ModelTraceExplorerSummaryIntermediateNode } from './ModelTraceExplorerSummaryIntermediateNode';\nimport { ModelTraceExplorerSummaryViewExceptionsSection } from './ModelTraceExplorerSummaryViewExceptionsSection';\nimport type { ModelTraceExplorerRenderMode, ModelTraceSpanNode } from '../ModelTrace.types';\nimport { createListFromObject, getSpanExceptionEvents } from '../ModelTraceExplorer.utils';\nimport { ModelTraceExplorerCollapsibleSection } from '../ModelTraceExplorerCollapsibleSection';\nimport { AssessmentPaneToggle } from '../assessments-pane/AssessmentPaneToggle';\nimport { ModelTraceExplorerFieldRenderer } from '../field-renderers/ModelTraceExplorerFieldRenderer';\n\nexport const SUMMARY_SPANS_MIN_WIDTH = 400;\n\nexport const ModelTraceExplorerSummarySpans = ({\n  rootNode,\n  intermediateNodes,\n}: {\n  rootNode: ModelTraceSpanNode;\n  intermediateNodes: ModelTraceSpanNode[];\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const [renderMode, setRenderMode] = useState<ModelTraceExplorerRenderMode>('default');\n\n  const rootInputs = rootNode.inputs;\n  const rootOutputs = rootNode.outputs;\n  const exceptions = getSpanExceptionEvents(rootNode);\n  const hasIntermediateNodes = intermediateNodes.length > 0;\n  const hasExceptions = exceptions.length > 0;\n\n  const inputList = createListFromObject(rootInputs);\n  const outputList = createListFromObject(rootOutputs);\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        flex: 1,\n        minHeight: 0,\n        padding: theme.spacing.md,\n        paddingTop: theme.spacing.sm,\n        overflow: 'auto',\n        minWidth: SUMMARY_SPANS_MIN_WIDTH,\n      }}\n    >\n      <div css={{ display: 'flex', flexDirection: 'row', justifyContent: 'flex-end', marginBottom: theme.spacing.sm }}>\n        <div css={{ display: 'flex', gap: theme.spacing.sm }}>\n          <SegmentedControlGroup\n            name=\"render-mode\"\n            componentId=\"shared.model-trace-explorer.summary-view.render-mode\"\n            value={renderMode}\n            size=\"small\"\n            onChange={(event) => setRenderMode(event.target.value)}\n          >\n            <SegmentedControlButton value=\"default\">\n              <FormattedMessage\n                defaultMessage=\"Default\"\n                description=\"Label for the default render mode selector in the model trace explorer summary view\"\n              />\n            </SegmentedControlButton>\n            <SegmentedControlButton value=\"json\">\n              <FormattedMessage\n                defaultMessage=\"JSON\"\n                description=\"Label for the JSON render mode selector in the model trace explorer summary view\"\n              />\n            </SegmentedControlButton>\n          </SegmentedControlGroup>\n          <AssessmentPaneToggle />\n        </div>\n      </div>\n      {hasExceptions && <ModelTraceExplorerSummaryViewExceptionsSection node={rootNode} />}\n      <ModelTraceExplorerCollapsibleSection\n        withBorder\n        title={\n          <FormattedMessage\n            defaultMessage=\"Inputs\"\n            description=\"Model trace explorer > selected span > inputs header\"\n          />\n        }\n        css={{ marginBottom: hasIntermediateNodes ? 0 : theme.spacing.md }}\n        sectionKey=\"summary-inputs\"\n      >\n        <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.sm }}>\n          {inputList.map(({ key, value }, index) => (\n            <ModelTraceExplorerFieldRenderer key={key || index} title={key} data={value} renderMode={renderMode} />\n          ))}\n        </div>\n      </ModelTraceExplorerCollapsibleSection>\n      {hasIntermediateNodes &&\n        intermediateNodes.map((node) => (\n          <ModelTraceExplorerSummaryIntermediateNode key={node.key} node={node} renderMode={renderMode} />\n        ))}\n      <ModelTraceExplorerCollapsibleSection\n        withBorder\n        title={\n          <FormattedMessage\n            defaultMessage=\"Outputs\"\n            description=\"Model trace explorer > selected span > outputs header\"\n          />\n        }\n        sectionKey=\"summary-outputs\"\n      >\n        <div css={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.sm }}>\n          {outputList.map(({ key, value }, index) => (\n            <ModelTraceExplorerFieldRenderer key={key || index} title={key} data={value} renderMode={renderMode} />\n          ))}\n        </div>\n      </ModelTraceExplorerCollapsibleSection>\n    </div>\n  );\n};\n","import { useMemo, useState } from 'react';\n\nimport { Empty, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { ModelTraceExplorerSummarySpans, SUMMARY_SPANS_MIN_WIDTH } from './ModelTraceExplorerSummarySpans';\nimport { ModelSpanType } from '../ModelTrace.types';\nimport type { ModelTraceSpanNode, ModelTrace } from '../ModelTrace.types';\nimport { getSpanExceptionCount } from '../ModelTraceExplorer.utils';\nimport ModelTraceExplorerResizablePane from '../ModelTraceExplorerResizablePane';\nimport { useModelTraceExplorerViewState } from '../ModelTraceExplorerViewStateContext';\nimport { AssessmentsPane } from '../assessments-pane/AssessmentsPane';\nimport { ASSESSMENT_PANE_MIN_WIDTH } from '../assessments-pane/AssessmentsPane.utils';\nimport { getTimelineTreeNodesList } from '../timeline-tree/TimelineTree.utils';\n\nconst isNodeImportant = (node: ModelTraceSpanNode) => {\n  // root node is shown at top level, so we don't need to\n  // show it in the intermediate nodes list\n  if (!node.parentId) {\n    return false;\n  }\n\n  return (\n    [\n      ModelSpanType.AGENT,\n      ModelSpanType.RETRIEVER,\n      ModelSpanType.CHAT_MODEL,\n      ModelSpanType.TOOL,\n      ModelSpanType.LLM,\n    ].includes(node.type ?? ModelSpanType.UNKNOWN) || getSpanExceptionCount(node) > 0\n  );\n};\n\nexport const ModelTraceExplorerSummaryView = ({ modelTrace }: { modelTrace: ModelTrace }) => {\n  const { theme } = useDesignSystemTheme();\n  const [paneWidth, setPaneWidth] = useState(500);\n  const { rootNode, nodeMap, assessmentsPaneEnabled, assessmentsPaneExpanded } = useModelTraceExplorerViewState();\n\n  const allAssessments = useMemo(() => Object.values(nodeMap).flatMap((node) => node.assessments), [nodeMap]);\n\n  const intermediateNodes = useMemo(() => {\n    if (!rootNode) {\n      return [];\n    }\n\n    // the summary view is meant to be a high-level view of the trace,\n    // so we show \"important\" nodes as a flat list between the inputs\n    // and outputs of the root node.\n    const nodes = getTimelineTreeNodesList([rootNode]);\n    const intermediateNodes = nodes.filter(isNodeImportant);\n\n    return intermediateNodes;\n  }, [rootNode]);\n\n  if (!rootNode) {\n    return (\n      <div css={{ marginTop: theme.spacing.lg }}>\n        <Empty\n          description={\n            <FormattedMessage\n              defaultMessage=\"No span data to display\"\n              description=\"Title for the empty state in the model trace explorer summary view\"\n            />\n          }\n        />\n      </div>\n    );\n  }\n\n  return assessmentsPaneEnabled && assessmentsPaneExpanded ? (\n    <ModelTraceExplorerResizablePane\n      initialRatio={0.75}\n      paneWidth={paneWidth}\n      setPaneWidth={setPaneWidth}\n      leftChild={<ModelTraceExplorerSummarySpans rootNode={rootNode} intermediateNodes={intermediateNodes} />}\n      rightChild={<AssessmentsPane assessments={allAssessments} traceId={rootNode.traceId} activeSpanId={undefined} />}\n      leftMinWidth={SUMMARY_SPANS_MIN_WIDTH}\n      rightMinWidth={ASSESSMENT_PANE_MIN_WIDTH}\n    />\n  ) : (\n    <ModelTraceExplorerSummarySpans rootNode={rootNode} intermediateNodes={intermediateNodes} />\n  );\n};\n","import { useEffect, useMemo, useState } from 'react';\n\nimport { Tabs, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from '@databricks/i18n';\n\nimport { shouldEnableSummaryView } from './FeatureUtils';\nimport type { ModelTrace } from './ModelTrace.types';\nimport { getModelTraceId } from './ModelTraceExplorer.utils';\nimport { ModelTraceExplorerDetailView } from './ModelTraceExplorerDetailView';\nimport { ModelTraceExplorerSkeleton } from './ModelTraceExplorerSkeleton';\nimport {\n  ModelTraceExplorerViewStateProvider,\n  useModelTraceExplorerViewState,\n} from './ModelTraceExplorerViewStateContext';\nimport { useGetModelTraceInfoV3 } from './hooks/useGetModelTraceInfoV3';\nimport { ModelTraceExplorerSummaryView } from './summary-view/ModelTraceExplorerSummaryView';\nimport type { ModelTraceInfoRefetchContextType } from './trace-context/ModelTraceInfoRefetchContext';\nimport { ModelTraceInfoRefetchContext } from './trace-context/ModelTraceInfoRefetchContext';\n\nconst ModelTraceExplorerImpl = ({\n  modelTrace,\n  className,\n  selectedSpanId,\n  onSelectSpan,\n}: {\n  modelTrace: ModelTrace;\n  className?: string;\n  selectedSpanId?: string;\n  onSelectSpan?: (selectedSpanId?: string) => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const enableSummaryView = shouldEnableSummaryView();\n  const { activeView, setActiveView } = useModelTraceExplorerViewState();\n\n  if (!enableSummaryView) {\n    return (\n      <div css={{ display: 'flex', flexDirection: 'column', height: '100%', overflow: 'hidden' }}>\n        <ModelTraceExplorerDetailView\n          modelTrace={modelTrace}\n          className={className}\n          selectedSpanId={selectedSpanId}\n          onSelectSpan={onSelectSpan}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <Tabs.Root\n      componentId=\"model-trace-explorer\"\n      value={activeView}\n      onValueChange={(value) => setActiveView(value as 'summary' | 'detail')}\n      css={{\n        '& > div:first-of-type': {\n          marginBottom: 0,\n          flexShrink: 0,\n        },\n        display: 'flex',\n        flexDirection: 'column',\n        height: '100%',\n        overflow: 'hidden',\n      }}\n    >\n      <Tabs.List css={{ paddingLeft: theme.spacing.md, flexShrink: 0 }}>\n        <Tabs.Trigger value=\"summary\">\n          <FormattedMessage\n            defaultMessage=\"Summary\"\n            description=\"Label for the summary view tab in the model trace explorer\"\n          />\n        </Tabs.Trigger>\n        <Tabs.Trigger value=\"detail\">\n          <FormattedMessage\n            defaultMessage=\"Details & Timeline\"\n            description=\"Label for the details & timeline view tab in the model trace explorer\"\n          />\n        </Tabs.Trigger>\n      </Tabs.List>\n      <Tabs.Content\n        value=\"summary\"\n        css={{\n          display: 'flex',\n          flexDirection: 'column',\n          flex: 1,\n          minHeight: 0,\n        }}\n      >\n        <ModelTraceExplorerSummaryView modelTrace={modelTrace} />\n      </Tabs.Content>\n      <Tabs.Content\n        value=\"detail\"\n        css={{\n          display: 'flex',\n          flexDirection: 'column',\n          flex: 1,\n          minHeight: 0,\n        }}\n      >\n        <ModelTraceExplorerDetailView\n          modelTrace={modelTrace}\n          className={className}\n          selectedSpanId={selectedSpanId}\n          onSelectSpan={onSelectSpan}\n        />\n      </Tabs.Content>\n    </Tabs.Root>\n  );\n};\n\nconst ContextProviders = ({\n  refetchContextValue,\n  children,\n}: {\n  traceId: string;\n  refetchContextValue: ModelTraceInfoRefetchContextType;\n  children: React.ReactNode;\n}) => {\n  return (\n    <ModelTraceInfoRefetchContext.Provider value={refetchContextValue}>\n      {children}\n    </ModelTraceInfoRefetchContext.Provider>\n  );\n};\n\nexport const ModelTraceExplorer = ({\n  modelTrace: initialModelTrace,\n  className,\n  initialActiveView = 'summary',\n  selectedSpanId,\n  onSelectSpan,\n}: {\n  modelTrace: ModelTrace;\n  className?: string;\n  initialActiveView?: 'summary' | 'detail';\n  selectedSpanId?: string;\n  onSelectSpan?: (selectedSpanId?: string) => void;\n}) => {\n  const [modelTrace, setModelTrace] = useState(initialModelTrace);\n  const [assessmentsPaneEnabled, setAssessmentsPaneEnabled] = useState(true);\n  const traceId = getModelTraceId(initialModelTrace);\n  const { refetch } = useGetModelTraceInfoV3({\n    traceId,\n    setModelTrace,\n    setAssessmentsPaneEnabled,\n  });\n  const refetchContextValue = useMemo(() => ({ refetchTraceInfo: refetch }), [refetch]);\n\n  useEffect(() => {\n    setModelTrace(initialModelTrace);\n    refetch();\n    // reset the model trace when the traceId changes\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [traceId]);\n\n  return (\n    <ContextProviders traceId={traceId} refetchContextValue={refetchContextValue}>\n      <ModelTraceExplorerViewStateProvider\n        modelTrace={modelTrace}\n        initialActiveView={initialActiveView}\n        selectedSpanIdOnRender={selectedSpanId}\n        assessmentsPaneEnabled={assessmentsPaneEnabled}\n      >\n        <ModelTraceExplorerImpl\n          modelTrace={modelTrace}\n          className={className}\n          selectedSpanId={selectedSpanId}\n          onSelectSpan={onSelectSpan}\n        />\n      </ModelTraceExplorerViewStateProvider>\n    </ContextProviders>\n  );\n};\n\nModelTraceExplorer.Skeleton = ModelTraceExplorerSkeleton;\n","import { compact, get, has, isArray, isNil, isObject, isString } from 'lodash';\nimport { ModelTraceChatMessage } from '../ModelTrace.types';\nimport { prettyPrintChatMessage, prettyPrintToolCall } from '../ModelTraceExplorer.utils';\n\n// Type definitions for autogen messages\ninterface AutogenFunctionCall {\n  id: string;\n  name: string;\n  arguments: string;\n}\n\ninterface AutogenSystemMessage {\n  source: 'system';\n  content: string;\n}\n\ninterface AutogenUserMessage {\n  source: 'user';\n  content: string | any[];\n}\n\ninterface AutogenAssistantMessage {\n  source: 'assistant';\n  content: string | AutogenFunctionCall[];\n}\n\ninterface AutogenFunctionExecutionResultMessage {\n  source: 'function';\n  content: any;\n}\n\ntype AutogenMessage =\n  | AutogenSystemMessage\n  | AutogenUserMessage\n  | AutogenAssistantMessage\n  | AutogenFunctionExecutionResultMessage;\n\nconst isAutogenFunctionCall = (obj: unknown): obj is AutogenFunctionCall => {\n  return isObject(obj) && isString(get(obj, 'id')) && isString(get(obj, 'name')) && isString(get(obj, 'arguments'));\n};\n\nconst isAutogenMessage = (obj: unknown): obj is AutogenMessage => {\n  if (!isObject(obj)) {\n    return false;\n  }\n\n  // Handle messages with 'type' field (new format)\n  const messageType = get(obj, 'type');\n  if (messageType) {\n    if (messageType === 'SystemMessage') {\n      return isString(get(obj, 'content'));\n    }\n    if (messageType === 'UserMessage') {\n      return has(obj, 'content') && has(obj, 'source');\n    }\n    if (messageType === 'AssistantMessage') {\n      return has(obj, 'content') && has(obj, 'source');\n    }\n    if (messageType === 'FunctionMessage') {\n      return has(obj, 'content') && has(obj, 'source');\n    }\n  }\n\n  // Handle messages with 'source' field (old format)\n  if (has(obj, 'source') && ['system', 'user', 'assistant', 'function'].includes(get(obj, 'source'))) {\n    return has(obj, 'content');\n  }\n\n  return false;\n};\n\nconst convertAssistantMessageToChatMessage = (\n  content: string | AutogenFunctionCall[],\n): ModelTraceChatMessage | null => {\n  if (isString(content)) {\n    return prettyPrintChatMessage({ type: 'message', content, role: 'assistant' });\n  }\n\n  if (isArray(content) && content.every(isAutogenFunctionCall)) {\n    return {\n      role: 'assistant',\n      tool_calls: content.map((f) =>\n        prettyPrintToolCall({\n          id: f.id,\n          function: {\n            name: f.name,\n            arguments: f.arguments,\n          },\n        }),\n      ),\n    };\n  }\n\n  return null;\n};\n\nconst normalizeAutogenMessage = (message: any): ModelTraceChatMessage | null => {\n  // Handle messages with 'type' field (new format)\n  if (message.type === 'SystemMessage') {\n    return prettyPrintChatMessage({ type: 'message', content: message.content, role: 'system' });\n  }\n\n  if (message.type === 'UserMessage') {\n    if (isString(message.content)) {\n      return prettyPrintChatMessage({ type: 'message', content: message.content, role: 'user' });\n    }\n\n    if (isArray(message.content)) {\n      // Handle content that might be an array of text/image parts\n      const textParts = message.content\n        .filter((part: any) => isString(part) || (isObject(part) && (part as any).type === 'text'))\n        .map((part: any) => (isString(part) ? { type: 'text' as const, text: part } : part));\n\n      if (textParts.length > 0) {\n        return prettyPrintChatMessage({ type: 'message', content: textParts, role: 'user' });\n      }\n    }\n  }\n\n  if (message.type === 'AssistantMessage') {\n    return convertAssistantMessageToChatMessage(message.content);\n  }\n\n  if (message.type === 'FunctionMessage') {\n    // Function execution result messages are typically logged as user messages\n    return prettyPrintChatMessage({ type: 'message', content: JSON.stringify(message.content), role: 'user' });\n  }\n\n  // Handle messages with 'source' field (old format)\n  if (message.source === 'system') {\n    return prettyPrintChatMessage({ type: 'message', content: message.content, role: 'system' });\n  }\n\n  if (message.source === 'user') {\n    if (isString(message.content)) {\n      return prettyPrintChatMessage({ type: 'message', content: message.content, role: 'user' });\n    }\n\n    if (isArray(message.content)) {\n      // Handle content that might be an array of text/image parts\n      const textParts = message.content\n        .filter((part: any) => isString(part))\n        .map((part: any) => ({ type: 'text' as const, text: part }));\n\n      if (textParts.length > 0) {\n        return prettyPrintChatMessage({ type: 'message', content: textParts, role: 'user' });\n      }\n    }\n  }\n\n  if (message.source === 'assistant') {\n    return convertAssistantMessageToChatMessage(message.content);\n  }\n\n  if (message.source === 'function') {\n    // Function execution result messages are typically logged as user messages\n    return prettyPrintChatMessage({ type: 'message', content: JSON.stringify(message.content), role: 'user' });\n  }\n\n  return null;\n};\n\nexport const normalizeAutogenChatInput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  if (isNil(obj)) {\n    return null;\n  }\n\n  // Handle case where input is directly an array of messages\n  if (isArray(obj) && obj.length > 0 && obj.every(isAutogenMessage)) {\n    return compact(obj.map(normalizeAutogenMessage));\n  }\n\n  // Handle case where input is wrapped in an object with 'messages' key\n  if (isObject(obj) && 'messages' in obj) {\n    const messages = (obj as any).messages;\n    if (isArray(messages) && messages.length > 0 && messages.every(isAutogenMessage)) {\n      return compact(messages.map(normalizeAutogenMessage));\n    }\n  }\n\n  return null;\n};\n\nexport const normalizeAutogenChatOutput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  if (isNil(obj)) {\n    return null;\n  }\n\n  // Handle case where output is directly an array of messages\n  if (isArray(obj) && obj.length > 0 && obj.every(isAutogenMessage)) {\n    return compact(obj.map(normalizeAutogenMessage));\n  }\n\n  // Handle case where output is wrapped in an object with 'messages' key\n  if (isObject(obj) && 'content' in obj) {\n    const message = prettyPrintChatMessage({ role: 'assistant', content: obj.content as string, type: 'message' });\n    return message ? [message] : null;\n  }\n\n  return null;\n};\n","import { compact, get, has, isArray, isNil, isObject, isString } from 'lodash';\nimport { ModelTraceChatMessage, ModelTraceContentParts } from '../ModelTrace.types';\nimport { prettyPrintChatMessage, prettyPrintToolCall } from '../ModelTraceExplorer.utils';\n\n// Type definitions for Bedrock messages\ninterface BedrockToolUse {\n  toolUseId: string;\n  name: string;\n  input: string | Record<string, any>;\n}\n\ninterface BedrockToolResult {\n  toolUseId: string;\n  content: BedrockContentBlock[];\n}\n\ninterface BedrockContentBlock {\n  text?: string;\n  json?: any;\n  image?: {\n    source: {\n      bytes: string | Uint8Array;\n    };\n    format: string;\n  };\n  toolUse?: BedrockToolUse;\n  toolResult?: BedrockToolResult;\n}\n\ninterface BedrockMessage {\n  role: 'user' | 'assistant' | 'system';\n  content: BedrockContentBlock[];\n}\n\nconst parseBedrockContent = (content: BedrockContentBlock): ModelTraceContentParts | null => {\n  if (content.text) {\n    return { type: 'text', text: content.text };\n  }\n\n  if (content.json) {\n    return { type: 'text', text: JSON.stringify(content.json) };\n  }\n\n  if (content.image) {\n    const bytes = content.image.source.bytes;\n    const format = content.image.format;\n    let data: string;\n\n    if (typeof bytes === 'string') {\n      data = bytes;\n    } else {\n      // Convert Uint8Array to base64 string\n      const buffer = Buffer.from(bytes);\n      data = buffer.toString('base64');\n    }\n\n    const imageFormat = `image/${format}`;\n    return {\n      type: 'image_url',\n      image_url: { url: `data:${imageFormat};base64,${data}` },\n    };\n  }\n\n  // Unsupported content types (video, document) are ignored\n  return null;\n};\n\nconst convertBedrockMessageToChatMessage = (message: BedrockMessage): ModelTraceChatMessage => {\n  let role: 'user' | 'assistant' | 'system' | 'tool' = message.role;\n  const contents: ModelTraceContentParts[] = [];\n  const toolCalls: any[] = [];\n  let toolCallId: string | undefined;\n\n  for (const content of message.content) {\n    if (content.toolUse) {\n      const toolCall = content.toolUse;\n      const input = typeof toolCall.input === 'string' ? toolCall.input : JSON.stringify(toolCall.input);\n\n      toolCalls.push(\n        prettyPrintToolCall({\n          id: toolCall.toolUseId,\n          function: {\n            name: toolCall.name,\n            arguments: input,\n          },\n        }),\n      );\n    } else if (content.toolResult) {\n      toolCallId = content.toolResult.toolUseId;\n      role = 'tool';\n\n      for (const resultContent of content.toolResult.content) {\n        const parsedContent = parseBedrockContent(resultContent);\n        if (parsedContent) {\n          contents.push(parsedContent);\n        }\n      }\n    } else {\n      const parsedContent = parseBedrockContent(content);\n      if (parsedContent) {\n        contents.push(parsedContent);\n      }\n    }\n  }\n\n  // Convert content parts to string\n  let contentString = '';\n  if (contents.length > 0) {\n    contentString = contents\n      .map((part) => {\n        if (part.type === 'text') {\n          return part.text;\n        } else if (part.type === 'image_url') {\n          return `[Image: ${part.image_url.url}]`;\n        }\n        return '';\n      })\n      .filter((text) => text.length > 0)\n      .join(' ');\n  }\n\n  const chatMessage: ModelTraceChatMessage = {\n    role: role,\n    content: contentString,\n  };\n\n  if (toolCalls.length > 0) {\n    chatMessage.tool_calls = toolCalls;\n  }\n\n  if (toolCallId) {\n    chatMessage.tool_call_id = toolCallId;\n  }\n\n  return chatMessage;\n};\n\nconst isBedrockMessage = (obj: unknown): obj is BedrockMessage => {\n  if (!isObject(obj)) {\n    return false;\n  }\n\n  const hasRole = has(obj, 'role') && isString(obj.role) && ['user', 'assistant', 'system'].includes(obj.role);\n  const hasContent = has(obj, 'content') && isArray(obj.content);\n\n  return hasRole && hasContent;\n};\n\nexport const normalizeBedrockChatInput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  if (isNil(obj)) {\n    return null;\n  }\n\n  // Handle case where input has 'messages' key\n  if (isObject(obj) && 'messages' in obj) {\n    const messages = (obj as any).messages;\n    if (isArray(messages) && messages.length > 0 && messages.every(isBedrockMessage)) {\n      return compact(messages.map(convertBedrockMessageToChatMessage));\n    }\n  }\n\n  return null;\n};\n\nexport const normalizeBedrockChatOutput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  if (isNil(obj)) {\n    return null;\n  }\n\n  // Handle case where output has 'output' -> 'message' structure\n  if (isObject(obj) && 'output' in obj) {\n    const output = (obj as any).output;\n    if (isObject(output) && 'message' in output) {\n      const message = output.message;\n      if (isBedrockMessage(message)) {\n        return [convertBedrockMessageToChatMessage(message)];\n      }\n    }\n  }\n\n  return null;\n};\n","/**\n * Adapted from `material-light`\n * Ref: https://github.com/react-syntax-highlighter/react-syntax-highlighter/blob/b2457268891948f7005ccf539a70c000f0695bde/src/styles/prism/material-light.js#L1\n *\n * This theme overwrites colors to be similiar to the `@databricks/editor` theme.\n */\n\nconst databricksLightTheme = {\n  'code[class*=\"language-\"]': {\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    wordWrap: 'normal',\n    color: 'rgb(77, 77, 76)', // D\n    background: '#fafafa',\n    fontFamily: 'Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro, monospace',\n    fontSize: '12px', // D\n    lineHeight: '1.5em',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n  },\n  'pre[class*=\"language-\"]': {\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    wordWrap: 'normal',\n    color: 'rgb(77, 77, 76)', // D\n    background: '#fafafa',\n    fontFamily: 'Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro, monospace',\n    fontSize: '12px', // D\n    lineHeight: '1.5em',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n    overflow: 'auto',\n    position: 'relative',\n    margin: '0.5em 0',\n    padding: '1.25em 1em',\n  },\n  'code[class*=\"language-\"]::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"]::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'code[class*=\"language-\"] ::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"] ::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'code[class*=\"language-\"]::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"]::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'code[class*=\"language-\"] ::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"] ::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  ':not(pre) > code[class*=\"language-\"]': {\n    whiteSpace: 'normal',\n    borderRadius: '0.2em',\n    padding: '0.1em',\n  },\n  '.language-css > code': {\n    color: '#f5871f', // D\n  },\n  '.language-sass > code': {\n    color: '#f5871f', // D\n  },\n  '.language-scss > code': {\n    color: '#f5871f', // D\n  },\n  '[class*=\"language-\"] .namespace': {\n    Opacity: '0.7',\n  },\n  atrule: {\n    color: '#7c4dff',\n  },\n  'attr-name': {\n    color: '#39adb5',\n  },\n  'attr-value': {\n    color: '#f6a434',\n  },\n  attribute: {\n    color: '#f6a434',\n  },\n  boolean: {\n    color: '#7c4dff', // D\n  },\n  builtin: {\n    color: '#39adb5',\n  },\n  cdata: {\n    color: '#39adb5',\n  },\n  char: {\n    color: '#39adb5',\n  },\n  class: {\n    color: '#39adb5',\n  },\n  'class-name': {\n    color: '#6182b8',\n  },\n  comment: {\n    color: '#8e908c', // D\n  },\n  constant: {\n    color: '#7c4dff', // D\n  },\n  deleted: {\n    color: '#e53935',\n  },\n  doctype: {\n    color: '#aabfc9',\n  },\n  entity: {\n    color: '#e53935',\n  },\n  function: {\n    color: '#4271ae', // D\n  },\n  hexcode: {\n    color: '#f5871f', // D\n  },\n  id: {\n    color: '#7c4dff',\n    fontWeight: 'bold',\n  },\n  important: {\n    color: '#7c4dff',\n    fontWeight: 'bold',\n  },\n  inserted: {\n    color: '#39adb5',\n  },\n  keyword: {\n    color: '#8959a8', // D\n  },\n  number: {\n    color: '#f5871f', // D\n  },\n  operator: {\n    color: '#3e999f', // D\n  },\n  prolog: {\n    color: '#aabfc9',\n  },\n  property: {\n    color: '#39adb5',\n  },\n  'pseudo-class': {\n    color: '#f6a434',\n  },\n  'pseudo-element': {\n    color: '#f6a434',\n  },\n  punctuation: {\n    color: 'rgb(77, 77, 76)', // D\n  },\n  regex: {\n    color: '#6182b8',\n  },\n  selector: {\n    color: '#e53935',\n  },\n  string: {\n    color: '#3ba85f', // D\n  },\n  symbol: {\n    color: '#7c4dff',\n  },\n  tag: {\n    color: '#e53935',\n  },\n  unit: {\n    color: '#f5871f', // D\n  },\n  url: {\n    color: '#e53935',\n  },\n  variable: {\n    color: '#c72d4c', // D\n  },\n};\n\nexport default databricksLightTheme;\n","import { compact, get, has, isArray, isNil, isObject, isString } from 'lodash';\nimport { ModelTraceChatMessage } from '../ModelTrace.types';\nimport {\n  isModelTraceChatResponse,\n  isModelTraceChoices,\n  isRawModelTraceChatMessage,\n  prettyPrintChatMessage,\n  prettyPrintToolCall,\n} from '../ModelTraceExplorer.utils';\nimport {\n  OpenAIResponsesInput,\n  OpenAIResponsesInputFile,\n  OpenAIResponsesInputImage,\n  OpenAIResponsesInputMessage,\n  OpenAIResponsesInputMessageRole,\n  OpenAIResponsesInputText,\n  OpenAIResponsesOutputItem,\n} from '../chat-utils/openai.types';\n\n// normalize the OpenAI chat input format (object with 'messages' or 'input' key)\nexport const normalizeOpenAIChatInput = (obj: any): ModelTraceChatMessage[] | null => {\n  if (!obj) {\n    return null;\n  }\n\n  const messages = obj.messages ?? obj.input;\n  if (!Array.isArray(messages) || messages.length === 0 || !messages.every(isRawModelTraceChatMessage)) {\n    return null;\n  }\n\n  return compact(messages.map(prettyPrintChatMessage));\n};\n\n// normalize the OpenAI chat response format (object with 'choices' key)\nexport const normalizeOpenAIChatResponse = (obj: any): ModelTraceChatMessage[] | null => {\n  if (isModelTraceChoices(obj)) {\n    return obj.map((choice) => ({\n      ...choice.message,\n      tool_calls: choice.message.tool_calls?.map(prettyPrintToolCall),\n    }));\n  }\n\n  if (!isModelTraceChatResponse(obj)) {\n    return null;\n  }\n\n  return obj.choices.map((choice) => ({\n    ...choice.message,\n    tool_calls: choice.message.tool_calls?.map(prettyPrintToolCall),\n  }));\n};\n\nconst isOpenAIResponsesInputMessage = (obj: unknown): obj is OpenAIResponsesInputMessage => {\n  if (has(obj, 'role') && has(obj, 'content') && ['user', 'assistant', 'system', 'developer'].includes(obj.role)) {\n    return (\n      isString(obj.content) ||\n      (isArray(obj.content) &&\n        obj.content.every(\n          (item: unknown) => has(item, 'type') && ['input_text', 'input_image', 'input_file'].includes(item.type),\n        ))\n    );\n  }\n\n  return false;\n};\n\nexport const isOpenAIResponsesInput = (obj: unknown): obj is OpenAIResponsesInput => {\n  return isString(obj) || isOpenAIResponsesInputMessage(obj);\n};\n\nexport const isOpenAIResponsesOutputItem = (obj: unknown): obj is OpenAIResponsesOutputItem => {\n  if (!isObject(obj)) {\n    return false;\n  }\n\n  if (get(obj, 'type') === 'message') {\n    return isRawModelTraceChatMessage(obj);\n  }\n\n  if (get(obj, 'type') === 'function_call') {\n    return isString(get(obj, 'call_id')) && isString(get(obj, 'name')) && isString(get(obj, 'arguments'));\n  }\n\n  if (get(obj, 'type') === 'function_call_output') {\n    return isString(get(obj, 'call_id')) && isString(get(obj, 'output'));\n  }\n\n  if (get(obj, 'type') === 'image_generation_call') {\n    const outputFormat = get(obj, 'output_format');\n    return isString(get(obj, 'result')) && isString(outputFormat) && ['png', 'jpeg', 'webp'].includes(outputFormat);\n  }\n\n  if (get(obj, 'type') === 'reasoning') {\n    return has(obj, 'id') && isArray(get(obj, 'summary'));\n  }\n\n  return false;\n};\n\nconst normalizeOpenAIResponsesInputItem = (\n  obj: OpenAIResponsesInputText | OpenAIResponsesInputFile | OpenAIResponsesInputImage,\n  role: OpenAIResponsesInputMessageRole,\n): ModelTraceChatMessage | null => {\n  const text = get(obj, 'text');\n  if (get(obj, 'type') === 'input_text' && isString(text)) {\n    return prettyPrintChatMessage({\n      type: 'message',\n      content: [{ type: 'text', text }],\n      role: role,\n    });\n  }\n\n  const imageUrl = get(obj, 'image_url');\n  if (get(obj, 'type') === 'input_image' && isString(imageUrl)) {\n    return prettyPrintChatMessage({\n      type: 'message',\n      content: [{ type: 'image_url', image_url: { url: imageUrl } }],\n      role: role,\n    });\n  }\n\n  // TODO: file input not supported yet\n  // if ('type' in obj && obj.type === 'input_file') {\n  //   return prettyPrintChatMessage({ type: 'message', content: obj.file_url, role: role });\n  // }\n\n  return null;\n};\n\nconst normalizeOpenAIResponsesInputMessage = (obj: OpenAIResponsesInputMessage): ModelTraceChatMessage[] | null => {\n  if (isString(obj.content)) {\n    const message = prettyPrintChatMessage({ type: 'message', content: obj.content, role: obj.role });\n    return message && [message];\n  } else {\n    return obj.content.map((item) => normalizeOpenAIResponsesInputItem(item, obj.role)).filter((item) => item !== null);\n  }\n};\n\nexport const normalizeOpenAIResponsesInput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  const input: unknown = get(obj, 'input');\n\n  if (isString(input)) {\n    const message = prettyPrintChatMessage({ type: 'message', content: input, role: 'user' });\n    return message && [message];\n  }\n\n  if (isArray(input) && input.every(isOpenAIResponsesInputMessage)) {\n    return compact(input.flatMap(normalizeOpenAIResponsesInputMessage));\n  }\n\n  return null;\n};\n\nexport const normalizeOpenAIResponsesOutputItem = (obj: OpenAIResponsesOutputItem): ModelTraceChatMessage | null => {\n  if (obj.type === 'message') {\n    return prettyPrintChatMessage(obj);\n  }\n\n  if (obj.type === 'function_call') {\n    return {\n      role: 'assistant',\n      tool_calls: [\n        prettyPrintToolCall({\n          id: obj.call_id,\n          function: {\n            arguments: obj.arguments,\n            name: obj.name,\n          },\n        }),\n      ],\n    };\n  }\n\n  if (obj.type === 'function_call_output') {\n    return {\n      role: 'tool',\n      tool_call_id: obj.call_id,\n      content: obj.output,\n    };\n  }\n\n  if (obj.type === 'image_generation_call') {\n    return prettyPrintChatMessage({\n      type: 'message',\n      content: [{ type: 'image_url', image_url: { url: `data:image/${obj.output_format};base64,${obj.result}` } }],\n      role: 'tool',\n    });\n  }\n\n  if (obj.type === 'reasoning') {\n    // Skip reasoning entries as they don't translate to chat messages\n    return null;\n  }\n\n  return null;\n};\n\nexport const normalizeOpenAIResponsesOutput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  if (isNil(obj)) {\n    return null;\n  }\n\n  const output: unknown = get(obj, 'output');\n\n  // list of output items\n  if (isArray(output) && output.length > 0 && output.every(isOpenAIResponsesOutputItem)) {\n    return compact(output.map(normalizeOpenAIResponsesOutputItem).filter(Boolean));\n  }\n\n  // list of output chunks\n  if (\n    isArray(output) &&\n    output.length > 0 &&\n    output.every((chunk) => chunk.type === 'response.output_item.done' && isOpenAIResponsesOutputItem(chunk.item))\n  ) {\n    return compact(output.map((chunk) => normalizeOpenAIResponsesOutputItem(chunk.item)));\n  }\n\n  return null;\n};\n\n// New functions for OpenAI agent chat pattern\n\nconst isOpenAIAgentMessage = (obj: unknown): boolean => {\n  if (!isObject(obj)) {\n    return false;\n  }\n\n  // Check for regular message format (with optional id, status, type fields)\n  if (has(obj, 'role') && has(obj, 'content') && ['user', 'assistant', 'system', 'tool'].includes(obj.role)) {\n    return true;\n  }\n\n  // Check for function call format (with optional id, status fields)\n  if (get(obj, 'type') === 'function_call') {\n    return isString(get(obj, 'call_id')) && isString(get(obj, 'name')) && isString(get(obj, 'arguments'));\n  }\n\n  // Check for function call output format\n  if (get(obj, 'type') === 'function_call_output') {\n    return isString(get(obj, 'call_id')) && isString(get(obj, 'output'));\n  }\n\n  return false;\n};\n\nconst normalizeOpenAIAgentMessage = (obj: any): ModelTraceChatMessage | null => {\n  // Handle regular message format\n  if (has(obj, 'role') && has(obj, 'content')) {\n    // Handle content that might be an array with output_text objects\n    if (isArray(obj.content)) {\n      const textContent = obj.content\n        .filter((item: any) => item.type === 'output_text' && isString(item.text))\n        .map((item: any) => item.text)\n        .join(' ');\n\n      if (textContent) {\n        return prettyPrintChatMessage({\n          ...obj,\n          content: textContent,\n        });\n      }\n    }\n\n    // Fall back to regular prettyPrintChatMessage for string content\n    return prettyPrintChatMessage(obj);\n  }\n\n  // Handle function call format\n  if (get(obj, 'type') === 'function_call') {\n    const callId = get(obj, 'call_id');\n    const arguments_ = get(obj, 'arguments');\n    const name = get(obj, 'name');\n\n    if (isString(callId) && isString(arguments_) && isString(name)) {\n      return {\n        role: 'assistant',\n        tool_calls: [\n          prettyPrintToolCall({\n            id: callId,\n            function: {\n              arguments: arguments_,\n              name: name,\n            },\n          }),\n        ],\n      };\n    }\n  }\n\n  // Handle function call output format\n  if (get(obj, 'type') === 'function_call_output') {\n    const callId = get(obj, 'call_id');\n    const output = get(obj, 'output');\n\n    if (isString(callId) && isString(output)) {\n      return {\n        role: 'tool',\n        tool_call_id: callId,\n        content: output,\n      };\n    }\n  }\n\n  return null;\n};\n\nexport const normalizeOpenAIAgentInput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  if (isNil(obj)) {\n    return null;\n  }\n\n  // Handle array of messages directly\n  if (isArray(obj) && obj.length > 0 && obj.every(isOpenAIAgentMessage)) {\n    return compact(obj.map(normalizeOpenAIAgentMessage));\n  }\n\n  return null;\n};\n\nexport const normalizeOpenAIAgentOutput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  if (isNil(obj)) {\n    return null;\n  }\n\n  // Handle array of messages directly\n  if (isArray(obj) && obj.length > 0 && obj.every(isOpenAIAgentMessage)) {\n    return compact(obj.map(normalizeOpenAIAgentMessage));\n  }\n\n  return null;\n};\n","import { compact, get, has, isArray, isString } from 'lodash';\nimport { ModelTraceChatMessage } from '../ModelTrace.types';\nimport { prettyPrintChatMessage } from '../ModelTraceExplorer.utils';\n\nexport type LlamaIndexChatResponse = {\n  message: LlamaIndexChatMessage;\n};\n\ntype LlamaIndexChatMessage = {\n  role: 'assistant' | 'system' | 'user';\n  blocks: LlamaIndexChatMessageBlock[];\n};\n\ntype LlamaIndexChatMessageBlock = {\n  block_type: 'text';\n  text: 'string';\n};\n\nexport type LlamaIndexChatInput = {\n  messages: LlamaIndexChatMessage[];\n};\n\nconst isLlamaIndexChatMessageBlock = (obj: unknown): obj is LlamaIndexChatMessageBlock => {\n  const text = get(obj, 'text');\n  return get(obj, 'block_type') === 'text' && isString(text);\n};\n\nconst isLlamaIndexChatMessage = (message: unknown): message is LlamaIndexChatMessage => {\n  const blocks: unknown = get(message, 'blocks');\n  const role: unknown = get(message, 'role');\n  return (\n    isString(role) &&\n    ['assistant', 'system', 'user'].includes(role) &&\n    isArray(blocks) &&\n    blocks.every(isLlamaIndexChatMessageBlock)\n  );\n};\n\nconst isLlamaIndexChatResponse = (obj: unknown): obj is LlamaIndexChatResponse => {\n  return isLlamaIndexChatMessage(get(obj, 'message'));\n};\n\nconst isLlamaIndexChatInput = (obj: unknown): obj is LlamaIndexChatInput => {\n  const messages: unknown = get(obj, 'messages');\n  return isArray(messages) && messages.every(isLlamaIndexChatMessage);\n};\n\nconst prettyPrintMessage = (message: LlamaIndexChatMessage) => {\n  return prettyPrintChatMessage({\n    role: message.role,\n    content: message.blocks.map((block) => ({ type: 'text', text: block.text })),\n  });\n};\n\nexport const normalizeLlamaIndexChatResponse = (obj: unknown): ModelTraceChatMessage[] | null => {\n  if (!isLlamaIndexChatResponse(obj)) {\n    return null;\n  }\n\n  const message = prettyPrintMessage(obj.message);\n  return message && [message];\n};\n\nexport const normalizeLlamaIndexChatInput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  if (!isLlamaIndexChatInput(obj)) {\n    return null;\n  }\n\n  return compact(obj.messages.map(prettyPrintMessage));\n};\n","import {\n  ModelsIcon,\n  ConnectIcon,\n  FileDocumentIcon,\n  useDesignSystemTheme,\n  SortUnsortedIcon,\n  QuestionMarkIcon,\n  CodeIcon,\n  FunctionIcon,\n  NumbersIcon,\n  SearchIcon,\n  WrenchIcon,\n  UserSparkleIcon,\n  ChainIcon,\n  UserIcon,\n  GearIcon,\n} from '@databricks/design-system';\n\nimport { ModelIconType } from './ModelTrace.types';\n\nexport const ModelTraceExplorerIcon = ({\n  type = ModelIconType.CONNECT,\n  // tooltips have inverted colors so the icon should match it\n  isInTooltip = false,\n  hasException = false,\n  isRootSpan = false,\n}: {\n  type?: ModelIconType;\n  isInTooltip?: boolean;\n  hasException?: boolean;\n  isRootSpan?: boolean;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  // base icon colors depending on span attributes\n  let iconColor: 'ai' | 'danger' | undefined;\n  if (isRootSpan) {\n    iconColor = 'ai';\n  } else if (hasException) {\n    iconColor = 'danger';\n  }\n\n  const iconMap = {\n    [ModelIconType.MODELS]: <ModelsIcon color={iconColor} />,\n    [ModelIconType.DOCUMENT]: <FileDocumentIcon color={iconColor} />,\n    [ModelIconType.CONNECT]: <ConnectIcon color={iconColor} />,\n    [ModelIconType.CODE]: <CodeIcon color={iconColor} />,\n    [ModelIconType.FUNCTION]: <FunctionIcon color={iconColor} />,\n    [ModelIconType.NUMBERS]: <NumbersIcon color={iconColor} />,\n    [ModelIconType.SEARCH]: <SearchIcon color={iconColor} />,\n    [ModelIconType.SORT]: <SortUnsortedIcon color={iconColor} />,\n    [ModelIconType.UNKNOWN]: <QuestionMarkIcon color={iconColor} />,\n    [ModelIconType.WRENCH]: <WrenchIcon color={iconColor} />,\n    [ModelIconType.AGENT]: <UserSparkleIcon color={iconColor} />,\n    [ModelIconType.CHAIN]: <ChainIcon color={iconColor} />,\n    [ModelIconType.USER]: <UserIcon color={iconColor} />,\n    [ModelIconType.SYSTEM]: <GearIcon color={iconColor} />,\n  };\n\n  // custom colors depending on span type\n  // these are not official props on the\n  // icon components, so they must be set\n  // via the `css` prop on the parent\n  let color: string = theme.colors.actionDefaultIconDefault;\n  let tooltipColor: string = theme.colors.actionPrimaryIcon;\n  let backgroundColor: string = theme.colors.backgroundSecondary;\n  switch (type) {\n    case ModelIconType.SEARCH:\n      color = theme.colors.textValidationSuccess;\n      tooltipColor = theme.colors.green500;\n      backgroundColor = theme.isDarkMode ? theme.colors.green800 : theme.colors.green100;\n      break;\n    case ModelIconType.MODELS:\n      color = theme.isDarkMode ? theme.colors.blue500 : theme.colors.turquoise;\n      tooltipColor = theme.isDarkMode ? theme.colors.turquoise : theme.colors.blue500;\n      backgroundColor = theme.isDarkMode ? theme.colors.blue800 : theme.colors.blue100;\n      break;\n    case ModelIconType.WRENCH:\n      color = theme.isDarkMode ? theme.colors.red500 : theme.colors.red700;\n      tooltipColor = theme.isDarkMode ? theme.colors.red700 : theme.colors.red500;\n      backgroundColor = theme.isDarkMode ? theme.colors.red800 : theme.colors.red100;\n      break;\n  }\n\n  return (\n    <div\n      css={{\n        position: 'relative',\n        width: theme.general.iconSize,\n        height: theme.general.iconSize,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        borderRadius: theme.borders.borderRadiusSm,\n        background: isInTooltip ? theme.colors.tooltipBackgroundTooltip : backgroundColor,\n        color: isInTooltip ? tooltipColor : color,\n        svg: { width: theme.general.iconFontSize, height: theme.general.iconFontSize },\n        flexShrink: 0,\n      }}\n    >\n      {hasException && (\n        <div\n          css={{\n            position: 'absolute',\n            top: -theme.spacing.xs,\n            right: -theme.spacing.xs,\n            height: theme.spacing.sm,\n            width: theme.spacing.sm,\n            borderRadius: theme.borders.borderRadiusSm,\n            backgroundColor: theme.colors.actionDangerPrimaryBackgroundDefault,\n            zIndex: 5,\n          }}\n        />\n      )}\n      {iconMap[type]}\n    </div>\n  );\n};\n","import { compact, has, isArray, isNil, isObject, isString } from 'lodash';\nimport { ModelTraceChatMessage, ModelTraceContentParts } from '../ModelTrace.types';\nimport { prettyPrintChatMessage } from '../ModelTraceExplorer.utils';\n\nexport type AnthropicMessagesInput = {\n  messages: AnthropicMessageParam[];\n};\n\nexport type AnthropicMessagesOutput = {\n  id: string;\n  content: AnthropicContentBlock[];\n  role: 'assistant';\n  type: 'message';\n  // model: Model;\n  // stop_reason: StopReason | null;\n  // stop_sequence: string | null;\n  // usage: Usage;\n};\n\ntype AnthropicContentBlock = AnthropicTextBlock | AnthropicToolUseBlock;\n// | ThinkingBlock\n// | RedactedThinkingBlock\n// | ServerToolUseBlock\n// | WebSearchToolResultBlock;\n\ntype AnthropicMessageParam = {\n  content: string | AnthropicContentBlockParam[];\n  role: 'user' | 'assistant';\n};\n\ntype AnthropicContentBlockParam =\n  | AnthropicTextBlockParam\n  | AnthropicImageBlockParam\n  | AnthropicToolUseBlockParam\n  | AnthropicToolResultBlockParam;\n// | DocumentBlockParam\n// | ThinkingBlockParam\n// | RedactedThinkingBlockParam\n// | ServerToolUseBlockParam\n// | WebSearchToolResultBlockParam;\n\ntype AnthropicTextBlockParam = {\n  text: string;\n  type: 'text';\n};\n\ntype AnthropicTextBlock = {\n  text: string;\n  type: 'text';\n};\n\ntype AnthropicImageBlockParam = {\n  source: AnthropicBase64ImageSource | AnthropicURLImageSource;\n  type: 'image';\n};\n\ntype AnthropicBase64ImageSource = {\n  type: 'base64';\n  data: string;\n  media_type: 'image/jpeg' | 'image/png' | 'image/gif' | 'image/webp';\n};\n\ntype AnthropicURLImageSource = {\n  type: 'url';\n  url: string;\n};\n\ntype AnthropicToolUseBlockParam = {\n  id: string;\n  input: Record<string, any>;\n  name: string;\n  type: 'tool_use';\n};\n\ntype AnthropicToolUseBlock = {\n  id: string;\n  input: Record<string, any>;\n  name: string;\n  type: 'tool_use';\n};\n\ntype AnthropicToolResultBlockParam = {\n  content: string;\n  tool_use_id: string;\n  type: 'tool_result';\n};\n\nconst isAnthropicContentBlockParam = (obj: unknown): obj is AnthropicContentBlockParam => {\n  if (isNil(obj)) {\n    return false;\n  }\n\n  if (has(obj, 'type')) {\n    if (obj.type === 'text' && has(obj, 'text') && isString(obj.text)) {\n      return true;\n    }\n\n    if (obj.type === 'image' && has(obj, 'source') && has(obj.source, 'type')) {\n      if (\n        obj.source.type === 'base64' &&\n        has(obj.source, 'media_type') &&\n        isString(obj.source.media_type) &&\n        ['image/jpeg', 'image/png', 'image/gif', 'image/webp'].includes(obj.source.media_type) &&\n        has(obj.source, 'data') &&\n        isString(obj.source.data)\n      ) {\n        return true;\n      }\n\n      if (obj.source.type === 'url' && has(obj.source, 'url') && isString(obj.source.url)) {\n        return true;\n      }\n    }\n\n    if (obj.type === 'tool_use' && has(obj, 'id') && has(obj, 'name') && has(obj, 'input')) {\n      return isString(obj.id) && isString(obj.name) && isObject(obj.input);\n    }\n\n    if (obj.type === 'tool_result' && has(obj, 'tool_use_id') && has(obj, 'content')) {\n      return isString(obj.tool_use_id) && isString(obj.content);\n    }\n  }\n  return false;\n};\n\nconst isAnthropicMessageParam = (obj: unknown): obj is AnthropicMessageParam => {\n  if (!isObject(obj)) {\n    return false;\n  }\n\n  const hasRole = has(obj, 'role') && isString(obj.role) && ['user', 'assistant'].includes(obj.role);\n  const hasContent =\n    'content' in obj &&\n    (isString(obj.content) || (isArray(obj.content) && obj.content.every(isAnthropicContentBlockParam)));\n\n  return hasRole && hasContent;\n};\n\nconst normalizeAnthropicContentBlockParam = (item: AnthropicContentBlockParam): ModelTraceContentParts => {\n  switch (item.type) {\n    case 'text': {\n      return { type: 'text', text: item.text };\n    }\n    case 'image': {\n      switch (item.source.type) {\n        case 'base64': {\n          return {\n            type: 'image_url',\n            image_url: { url: `data:${item.source.media_type};base64,${item.source.data}` },\n          };\n        }\n        case 'url': {\n          return { type: 'image_url', image_url: { url: item.source.url } };\n        }\n      }\n    }\n  }\n  throw new Error(`Unsupported content block type: ${(item as any).type}`);\n};\n\nconst processAnthropicMessageContent = (\n  content: AnthropicContentBlockParam[],\n): {\n  messages: ModelTraceChatMessage[];\n  textParts: ModelTraceContentParts[];\n  toolCalls: any[];\n} => {\n  const messages: ModelTraceChatMessage[] = [];\n  const textParts: ModelTraceContentParts[] = [];\n  const toolCalls: any[] = [];\n\n  for (const item of content) {\n    if (item.type === 'text' || item.type === 'image') {\n      textParts.push(normalizeAnthropicContentBlockParam(item));\n    } else if (item.type === 'tool_use') {\n      toolCalls.push({\n        id: item.id,\n        function: {\n          name: item.name,\n          arguments: JSON.stringify(item.input),\n        },\n      });\n    } else if (item.type === 'tool_result') {\n      messages.push({\n        role: 'tool',\n        tool_call_id: item.tool_use_id,\n        content: item.content,\n      });\n    }\n  }\n\n  return { messages, textParts, toolCalls };\n};\n\nconst processAnthropicMessage = (message: AnthropicMessageParam): ModelTraceChatMessage[] => {\n  const messages: ModelTraceChatMessage[] = [];\n\n  if (typeof message.content === 'string') {\n    const chatMessage = prettyPrintChatMessage({\n      type: 'message',\n      content: message.content,\n      role: message.role,\n    });\n    if (chatMessage) messages.push(chatMessage);\n  } else {\n    const { messages: toolMessages, textParts, toolCalls } = processAnthropicMessageContent(message.content);\n    messages.push(...toolMessages);\n\n    if (textParts.length > 0 || toolCalls.length > 0) {\n      const chatMessage = prettyPrintChatMessage({\n        type: 'message',\n        content: textParts.length > 0 ? textParts : undefined,\n        role: message.role,\n        ...(toolCalls.length > 0 && { tool_calls: toolCalls }),\n      });\n      if (chatMessage) messages.push(chatMessage);\n    }\n  }\n\n  return messages;\n};\n\nexport const normalizeAnthropicChatInput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  if (!isObject(obj)) {\n    return null;\n  }\n\n  if ('messages' in obj && isArray(obj.messages) && obj.messages.every(isAnthropicMessageParam)) {\n    const messages: ModelTraceChatMessage[] = [];\n\n    for (const message of obj.messages) {\n      messages.push(...processAnthropicMessage(message));\n    }\n\n    return messages;\n  }\n\n  return null;\n};\n\nexport const normalizeAnthropicChatOutput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  if (!isObject(obj)) {\n    return null;\n  }\n\n  if (has(obj, 'type') && obj.type === 'message' && isAnthropicMessageParam(obj)) {\n    return processAnthropicMessage(obj);\n  }\n\n  return null;\n};\n","import { compact, has, isArray, isObject, isString } from 'lodash';\nimport { ModelTraceChatMessage } from '../ModelTrace.types';\nimport { prettyPrintChatMessage } from '../ModelTraceExplorer.utils';\n\nexport type GeminiChatInput = {\n  contents: string | GeminiContent[];\n};\n\nexport type GeminiChatOutput = {\n  candidates: GeminiCandidate[];\n  // propmtFeedback: GeminiPropmptFeedback;\n  // usageMetadata: GeminiUsageMetadata;\n  modelVersion: string;\n  responseId: string;\n};\n\ntype GeminiCandidate = {\n  content: GeminiContent;\n  finishReason:\n    | 'FINISH_REASON_UNSPECIFIED'\n    | 'STOP'\n    | 'MAX_TOKENS'\n    | 'SAFETY'\n    | 'RECITATION'\n    | 'LANGUAGE'\n    | 'OTHER'\n    | 'BLOCKLIST'\n    | 'PROHIBITED_CONTENT'\n    | 'SPII'\n    | 'MALFORMED_FUNCTION_CAL'\n    | 'IMAGE_SAFETY'\n    | 'UNEXPECTED_TOOL_CAL';\n  // safetyRatings: GeminiSafetyRating[]\n  // citationMetadata: GeminiCitationMetadata\n  // tokenCount: number\n  // groundingAttributions: GeminiGroundingAttribution[]\n  // groundingMetadata: GeminiGroundingMetadata\n  // avgLogprobs: number\n  // logprobsResult: GeminiLogprobsResult\n  // urlContextMetadata: GeminiUrlContextMetadata\n  // index: number\n};\n\ntype GeminiContent = {\n  role: 'user' | 'model';\n  parts: GeminiContentPart[];\n};\n\ntype GeminiContentPart = { text: string };\n// | { inlineData: GeminiBlob }\n// | { functionCall: GeminiFunctionCall }\n// | { functionResponse: GeminiFunctionResponse }\n// | { fileData: GeminiFileData }\n// | { executableCode: GeminiExecutableCode }\n// | { codeExecutionResult: GeminiCodeExecutionResult };\n\n// type GeminiBlob = {\n//   mimeType: string;\n//   data: string;\n// };\n\n// type GeminiFunctionCall = {\n//   id: string;\n//   name: string;\n//   args: Record<string, string>;\n// };\n\n// type GeminiFunctionResponse = {\n//   id: string;\n//   name: string;\n//   response: Record<string, string>;\n//   willContinue: boolean;\n//   scheduling: 'SCHEDULING_UNSPECIFIED' | 'SILENT' | 'WHEN_IDLE' | 'INTERRUPT';\n// };\n\n// type GeminiFileData = {\n//   mimeType: string;\n//   fileUri: string;\n// };\n\n// type GeminiExecutableCode = {\n//   language: 'LANGUAGE_UNSPECIFIED' | 'PYTHON';\n//   code: string;\n// };\n\n// type GeminiCodeExecutionResult = {\n//   outcome: 'OUTCOME_UNSPECIFIED' | 'OUTCOME_OK' | 'OUTCOME_FAILED' | 'OUTCOME_DEADLINE_EXCEEDED';\n//   output: string;\n// };\n\nconst isGeminiContentPart = (obj: unknown): obj is GeminiContentPart => {\n  return isObject(obj) && 'text' in obj && isString(obj.text);\n};\n\nconst isGeminiContent = (obj: unknown): obj is GeminiContent => {\n  return (\n    isObject(obj) &&\n    'role' in obj &&\n    isString(obj.role) &&\n    ['user', 'model'].includes(obj.role) &&\n    has(obj, 'parts') &&\n    Array.isArray(obj.parts) &&\n    obj.parts.every(isGeminiContentPart)\n  );\n};\n\nconst isGeminiCandidate = (obj: unknown): obj is GeminiCandidate => {\n  return isObject(obj) && 'content' in obj && isGeminiContent(obj.content);\n};\n\nexport const normalizeGeminiChatInput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  if (!isObject(obj)) {\n    return null;\n  }\n\n  if ('contents' in obj) {\n    if (isString(obj.contents)) {\n      const message = prettyPrintChatMessage({ type: 'message', content: obj.contents, role: 'user' });\n      return message && [message];\n    }\n\n    if (isArray(obj.contents) && obj.contents.every(isGeminiContent)) {\n      return compact(\n        obj.contents.map((item) => {\n          const role = item.role === 'model' ? 'assistant' : item.role;\n          return prettyPrintChatMessage({\n            type: 'message',\n            content: item.parts.map((part) => ({ type: 'text', text: part.text })),\n            role,\n          });\n        }),\n      );\n    }\n  }\n\n  return null;\n};\n\nexport const normalizeGeminiChatOutput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  if (!isObject(obj)) {\n    return null;\n  }\n\n  if ('candidates' in obj && isArray(obj.candidates) && obj.candidates.every(isGeminiCandidate)) {\n    return compact(\n      obj.candidates\n        .flatMap((item) => item.content)\n        .map((item) => {\n          const role = item.role === 'model' ? 'assistant' : item.role;\n          return prettyPrintChatMessage({\n            type: 'message',\n            content: item.parts.map((part) => ({ type: 'text', text: part.text })),\n            role,\n          });\n        }),\n    );\n  }\n\n  return null;\n};\n","import { compact, has, isNil, isString } from 'lodash';\nimport { ModelTraceChatMessage, ModelTraceToolCall } from '../ModelTrace.types';\nimport { isModelTraceToolCall, prettyPrintToolCall } from '../ModelTraceExplorer.utils';\n\ntype LangchainContentPart = {\n  type: 'text' | 'image_url';\n  text?: string;\n  image_url?: {\n    url: string;\n  };\n};\n\n// it has other fields, but we only care about these for now\nexport type LangchainBaseMessage = {\n  content?: string | LangchainContentPart[];\n  type: 'human' | 'user' | 'assistant' | 'ai' | 'system' | 'tool' | 'function';\n  tool_calls?: LangchainToolCallMessage[];\n  tool_call_id?: string;\n  additional_kwargs?: {\n    // some langchain models have tool_calls specified in additional_kwargs in\n    // OpenAI format. this appears to be a bug, but we should still try to handle it\n    tool_calls?: ModelTraceToolCall[];\n  };\n};\n\nexport type LangchainToolCallMessage = {\n  name: string;\n  // an object with the arguments to the tool call.\n  // should be stringified before display.\n  args: any;\n  id: string;\n};\n\nexport type LangchainChatGeneration = {\n  message: LangchainBaseMessage;\n};\n\nexport const langchainMessageToModelTraceMessage = (message: LangchainBaseMessage): ModelTraceChatMessage | null => {\n  let role: ModelTraceChatMessage['role'];\n  switch (message.type) {\n    case 'user':\n    case 'human':\n      role = 'user';\n      break;\n    case 'assistant':\n    case 'ai':\n      role = 'assistant';\n      break;\n    case 'system':\n      role = 'system';\n      break;\n    case 'tool':\n      role = 'tool';\n      break;\n    case 'function':\n      role = 'function';\n      break;\n    default:\n      return null;\n  }\n\n  // Handle content that could be a string or an array of content parts\n  let content: string | undefined;\n  if (isString(message.content)) {\n    content = message.content;\n  } else if (Array.isArray(message.content)) {\n    // Convert array of content parts to string representation\n    const contentParts = message.content\n      .map((part: any) => {\n        if (isString(part)) {\n          return part;\n        } else if (part.type === 'text' && part.text) {\n          return part.text;\n        } else if (part.type === 'image_url' && part.image_url?.url) {\n          // Convert to markdown image format with spacing\n          return `![](${part.image_url.url})`;\n        }\n        return '';\n      })\n      .filter(Boolean);\n\n    // Join with double line breaks for better visual separation\n    content = contentParts.join('\\n\\n');\n  } else {\n    content = undefined;\n  }\n\n  const normalizedMessage: ModelTraceChatMessage = {\n    content,\n    role,\n  };\n\n  const toolCalls = message.tool_calls;\n  const toolCallsFromKwargs = message.additional_kwargs?.tool_calls;\n\n  // attempt to parse tool calls from the top-level field,\n  // otherwise fall back to the additional_kwargs field if it exists\n  if (\n    !isNil(toolCalls) &&\n    Array.isArray(toolCalls) &&\n    toolCalls.length > 0 &&\n    toolCalls.every(isLangchainToolCallMessage)\n  ) {\n    // compact for typing. the coercion should not fail since we\n    // check that the type is correct in the if condition above\n    normalizedMessage.tool_calls = compact(toolCalls.map(normalizeLangchainToolCall));\n  } else if (\n    !isNil(toolCallsFromKwargs) &&\n    Array.isArray(toolCallsFromKwargs) &&\n    toolCallsFromKwargs.length > 0 &&\n    toolCallsFromKwargs.every(isModelTraceToolCall)\n  ) {\n    normalizedMessage.tool_calls = toolCallsFromKwargs.map(prettyPrintToolCall);\n  }\n\n  if (!isNil(message.tool_call_id)) {\n    normalizedMessage.tool_call_id = message.tool_call_id;\n  }\n\n  return normalizedMessage;\n};\n\nexport const normalizeLangchainToolCall = (toolCall: LangchainToolCallMessage): ModelTraceToolCall | null => {\n  return {\n    id: toolCall.id,\n    function: {\n      arguments: JSON.stringify(toolCall.args, null, 2),\n      name: toolCall.name,\n    },\n  };\n};\n\nexport const isLangchainBaseMessage = (obj: any): obj is LangchainBaseMessage => {\n  if (!obj) {\n    return false;\n  }\n\n  // content can be undefined/null, string, or array of content parts\n  if (!isNil(obj.content) && !isString(obj.content) && !Array.isArray(obj.content)) {\n    return false;\n  }\n\n  // tool call validation is handled by the normalization function\n  return ['human', 'user', 'assistant', 'ai', 'system', 'tool', 'function'].includes(obj.type);\n};\n\nexport const isLangchainToolCallMessage = (obj: any): obj is LangchainToolCallMessage => {\n  return obj && isString(obj.name) && has(obj, 'args') && isString(obj.id);\n};\n\nexport const isLangchainChatGeneration = (obj: any): obj is LangchainChatGeneration => {\n  return obj && isLangchainBaseMessage(obj.message);\n};\n\n// normalize langchain chat input format\nexport const normalizeLangchainChatInput = (obj: any): ModelTraceChatMessage[] | null => {\n  // it could be a list of list of messages\n  if (\n    Array.isArray(obj) &&\n    obj.length === 1 &&\n    Array.isArray(obj[0]) &&\n    obj[0].length > 0 &&\n    obj[0].every(isLangchainBaseMessage)\n  ) {\n    const messages = obj[0].map(langchainMessageToModelTraceMessage);\n    // if we couldn't convert all the messages, then consider the input invalid\n    if (messages.some((message) => message === null)) {\n      return null;\n    }\n\n    return messages as ModelTraceChatMessage[];\n  }\n\n  // it could also be an object with the `messages` key\n  if (Array.isArray(obj?.messages) && obj.messages.length > 0 && obj.messages.every(isLangchainBaseMessage)) {\n    const messages = obj.messages.map(langchainMessageToModelTraceMessage);\n\n    if (messages.some((message: ModelTraceChatMessage[] | null) => message === null)) {\n      return null;\n    }\n\n    return messages as ModelTraceChatMessage[];\n  }\n\n  // it could also just be a plain array that is in the correct format\n  if (Array.isArray(obj) && obj.length > 0 && obj.every(isLangchainBaseMessage)) {\n    const messages = obj.map(langchainMessageToModelTraceMessage);\n\n    if (messages.some((message) => message === null)) {\n      return null;\n    }\n\n    return messages as ModelTraceChatMessage[];\n  }\n\n  return null;\n};\n\nconst isLangchainChatGenerations = (obj: any): obj is LangchainChatGeneration[][] => {\n  if (!Array.isArray(obj) || obj.length < 1) {\n    return false;\n  }\n\n  if (!Array.isArray(obj[0]) || obj[0].length < 1) {\n    return false;\n  }\n\n  // langchain chat generations are a list of lists of messages\n  return obj[0].every(isLangchainChatGeneration);\n};\n\nconst getMessagesFromLangchainChatGenerations = (\n  generations: LangchainChatGeneration[],\n): ModelTraceChatMessage[] | null => {\n  const messages = generations.map((generation: LangchainChatGeneration) =>\n    langchainMessageToModelTraceMessage(generation.message),\n  );\n\n  if (messages.some((message) => message === null)) {\n    return null;\n  }\n\n  return messages as ModelTraceChatMessage[];\n};\n\n// detect if an object is a langchain ChatResult, and normalize it to a list of messages\nexport const normalizeLangchainChatResult = (obj: any): ModelTraceChatMessage[] | null => {\n  if (isLangchainChatGenerations(obj)) {\n    return getMessagesFromLangchainChatGenerations(obj[0]);\n  }\n\n  if (\n    !Array.isArray(obj?.generations) ||\n    !(obj.generations.length > 0) ||\n    !obj.generations[0].every(isLangchainChatGeneration)\n  ) {\n    return null;\n  }\n\n  return getMessagesFromLangchainChatGenerations(obj.generations[0]);\n};\n","import { has, isArray, isString } from 'lodash';\nimport { ModelTraceChatMessage } from '../ModelTrace.types';\nimport { prettyPrintChatMessage } from '../ModelTraceExplorer.utils';\n\nexport const normalizeDspyChatInput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  // Handle DSPy format with messages array\n  if (has(obj, 'messages') && isArray((obj as any).messages)) {\n    const messages = (obj as any).messages;\n    return messages\n      .map((msg: any) => prettyPrintChatMessage({ type: 'message', content: msg.content, role: msg.role }))\n      .filter(Boolean);\n  }\n\n  return null;\n};\n\nexport const normalizeDspyChatOutput = (obj: unknown): ModelTraceChatMessage[] | null => {\n  // Handle DSPy format with array output\n  if (isArray(obj) && obj.length > 0 && obj.every(isString)) {\n    // Join all output strings into one assistant message\n    const content = obj.join('\\n');\n    const message = prettyPrintChatMessage({ type: 'message', content, role: 'assistant' });\n    return message && [message];\n  }\n\n  return null;\n};\n"],"names":["fontFamily","fontSize","lineHeight","direction","textAlign","whiteSpace","wordSpacing","wordBreak","MozTabSize","OTabSize","tabSize","WebkitHyphens","MozHyphens","msHyphens","hyphens","background","color","padding","margin","overflow","textShadow","borderRadius","comment","prolog","doctype","cdata","punctuation","namespace","Opacity","tag","operator","number","property","function","selector","boolean","string","entity","cursor","url","keyword","control","directive","unit","statement","regex","atrule","placeholder","variable","deleted","textDecoration","inserted","borderBottom","italic","fontStyle","important","fontWeight","bold","Outline","OutlineOffset","borderRightColor","_ref","name","styles","_ref2","_ref3","forwardRef","initialRatio","paneWidth","setPaneWidth","leftChild","leftMinWidth","rightChild","rightMinWidth","ref","_useResizeObserver","isResizing","setIsResizing","useState","containerRef","useRef","containerWidth","useResizeObserver","width","maxWidth","Infinity","ratio","theme","useDesignSystemTheme","updateRatio","useCallback","newPaneWidth","current","useImperativeHandle","useLayoutEffect","clamp","_jsxs","css","children","_jsx","Global","ResizableBox","axis","_css","display","flex","handle","position","spacing","sm","marginLeft","xs","minHeight","backgroundColor","zIndex","onResize","e","size","clampedSize","onResizeStart","onResizeStop","minConstraints","maxConstraints","ModelTraceExplorerSearchBox","searchFilter","setSearchFilter","matchData","handleNextSearchMatch","handlePreviousSearchMatch","searchValue","setSearchValue","debouncedSetSearchFilter","useDebouncedCallback","flexDirection","justifyContent","gap","Input","componentId","allowClear","value","onClear","onChange","target","toLowerCase","prefix","SearchIcon","match","marginRight","alignItems","Typography","Text","currentMatchIndex","totalMatches","Button","icon","ChevronUpIcon","onClick","ChevronDownIcon","DEFAULT_EXPAND_DEPTH","TimelineTreeZIndex","getTimelineTreeNodesList","nodes","expandedNodesFlat","traverseExpanded","traversedNode","_traversedNode$childr2","push","forEach","getTimelineTreeNodesMap","expandDepth","nodesMap","traverse","depth","_traversedNode$childr3","key","child","spanTimeFormatter","executionTimeUs","toFixed","getActiveChildIndex","node","activeNodeId","_node$children","findIndex","getModelTraceSpanNodeDepth","_node$children2","length","childDepths","map","Math","max","ModelTraceExplorerViewStateContext","createContext","rootNode","nodeMap","activeView","setActiveView","selectedNode","undefined","setSelectedNode","activeTab","setActiveTab","showTimelineTreeGantt","setShowTimelineTreeGantt","assessmentsPaneExpanded","setAssessmentsPaneExpanded","assessmentsPaneEnabled","useModelTraceExplorerViewState","useContext","ModelTraceExplorerViewStateProvider","modelTrace","initialActiveView","selectedSpanIdOnRender","_defaultSelectedNode$","_defaultSelectedNode$2","useMemo","parseModelTraceToTree","selectedSpanOnRender","searchTreeBySpanId","defaultSelectedNode","hasAssessments","assessments","chatMessages","Provider","getTabForMatch","section","useModelTraceSearch","treeNode","setExpandedKeys","modelTraceInfo","_matches$activeMatchI","spanFilterState","setSpanFilterState","spanTypeDisplayState","compact","type","spanType","showParents","showExceptions","getDefaultSpanFilterState","activeMatchIndex","setActiveMatchIndex","filteredTreeNodes","matches","isNil","searchTree","selectMatch","newMatchIndex","span","parents","getSpanNodeParentIds","Set","currentNode","parentId","add","expandedKeys","_selectedNode$key","selectedNodeKey","newSpan","trim","ACTIVE_HIGHLIGHT_COLOR","INACTIVE_HIGHLIGHT_COLOR","ModelTraceExplorerHighlightedCodeSnippet","data","activeMatch","containsActiveMatch","scrollToActiveMatch","scrollIntoView","block","inline","spans","getHighlightedSpanComponents","activeMatchBackgroundColor","colors","inactiveMatchBackgroundColor","backgroundSecondary","typography","fontSizeSm","BasicTable","Table","scrollable","TableRenderer","header","rows","isValid","_childArray$","childArray","React","toArray","slice","flatMap","props","filter","c","useParsedTableComponents","VirtualizedTable","parentRef","rowVirtualizer","useVirtual","overscan","virtualItems","totalSize","maxHeight","border","borderColor","borders","borderRadiusMd","marginBottom","md","height","virtualRow","rowIndex","index","rowElement","measureRef","top","start","VirtualizedTableRow","isHeader","some","tagName","TableRow","style","backgroundPrimary","VirtualizedTableCell","TableHeader","paddingLeft","textPrimary","TableCell","urlTransform","startsWith","defaultUrlTransform","GenAIMarkdownRenderer","components","getMarkdownComponents","extensions","ReactMarkdown","remarkPlugins","RemarkPlugins","CodeMarkdownComponent","codeBlock","codeInline","codeProps","_node$position","_node$position2","language","_codeProps$className","exec","className","line","end","InlineCode","code","CodeBlock","String","replace","CodeSnippet","actions","SnippetCopyAction","copyText","isDarkMode","isCodeSnippetLanguage","boxSizing","showLineNumbers","remarkGfm","a","href","Link","id","disabled","_Fragment","openInNewTab","_props$extensions$cod","_props$extensions","_props$extensions$cod2","_props$extensions2","p","Paragraph","h1","Title","level","h2","h3","h4","h5","table","tr","th","td","multiline","thead","tbody","img","src","alt","languageString","ModelTraceExplorerCodeSnippetBody","renderMode","CodeSnippetRenderMode","JSON","containsMatches","Boolean","includes","isContentLong","setIsContentLong","expanded","setExpanded","snippetRef","dataToTruncate","parsedData","parse","isString","expandable","split","displayedData","join","useEffect","scrollWidth","clientWidth","PreWithRef","preProps","isKeyMatch","right","PreTag","lineProps","wrapLines","paddingBottom","paddingRight","textOverflow","lineHeightBase","FormattedMessage","defaultMessage","ModelTraceExplorerHighlightedSnippetTitle","title","isActiveMatch","titleLower","startIdx","indexOf","endIdx","scrollMarginTop","getInitialRenderMode","dataIsString","initialRenderMode","MARKDOWN","getRenderModeDisplayText","TEXT","_ref4","ModelTraceExplorerCodeSnippet","tokens","_activeMatch$isKeyMat","setRenderMode","isTitleMatch","shouldShowRenderModeDropdown","borderRadiusSm","withoutMargins","DropdownMenu","Root","Trigger","asChild","Tag","Content","RadioGroup","onValueChange","Object","values","mode","RadioItem","ItemIndicator","Arrow","ModelTraceExplorerAttributesTab","activeSpan","attributes","containsAttributes","keys","isActiveMatchSpan","marginTop","Empty","description","entries","stringify","ModelTraceExplorerChatToolParam","paramName","paramProperties","isRequired","enum","enumValues","hasAdditionalInfo","borderStyles","borderTopLeftRadius","borderTopRightRadius","gridTemplateColumns","gridTemplateRows","flexWrap","ModelTraceExplorerChatTool","tool","_tool$function$parame","_tool$function$parame2","_tool$function$parame3","parameters","properties","requiredParams","required","isExpandable","hoverStyles","actionIconBackgroundHover","role","ChevronRightIcon","getRoleIcon","ModelTraceExplorerIcon","ModelIconType","SYSTEM","USER","WRENCH","MODELS","getRoleDisplayText","message","ModelTraceExplorerChatMessageHeader","tool_call_id","toolName","toolCallId","Tooltip","content","flexShrink","ModelTraceExplorerToolCallMessage","toolCall","functionName","FunctionIcon","arguments","ModelTraceExplorerChatMessageContent","shouldDisplayCodeSnippet","paddingTop","fontSizeBase","ModelTraceExplorerChatMessage","_message$content","_message$content2","isJson","error","tryGetJsonContent","isImageContent","displayedContent","tool_calls","ModelTraceExplorerConversation","messages","ModelTraceExplorerCollapsibleSection","sectionKey","withBorder","borderBottomLeftRadius","borderBottomRightRadius","borderTop","ModelTraceExplorerChatTab","chatTools","overflowY","ModelTraceExplorerDefaultSpanView","inputList","createListFromObject","inputs","outputList","outputs","containsInputs","containsOutputs","getTruncatedStyles","shouldTruncate","KeyValueTag","itemKey","itemValue","charLimit","shouldTruncateKey","shouldTruncateValue","fullLength","isKeyLonger","shorterLength","getKeyAndValueComplexTruncation","ModelTraceExplorerRetrieverDocumentFull","text","metadataTags","logDocumentClick","FileDocumentIcon","ModelTraceExplorerRetrieverDocumentPreview","minWidth","ellipsis","ModelTraceExplorerRetrieverDocument","metadata","ModelTraceExplorerRenderModeToggle","shouldRenderMarkdown","setShouldRenderMarkdown","SegmentedControlGroup","event","SegmentedControlButton","TextBoxIcon","fontSizeLg","MIcon","ModelTraceExplorerRetrieverSpanView","outputsContainsActiveMatch","legacyBorders","document","idx","page_content","ModelTraceExplorerContentTab","isRenderableRetrieverSpan","ModelTraceExplorerEventsTab","events","Array","isArray","XCircleIcon","attribute","getEventAttributeKey","ModelTraceExplorerBadge","count","actionDangerPrimaryBackgroundDefault","actionPrimaryTextDefault","AssessmentPaneToggle","GavelIcon","ASSESSMENT_PANE_MIN_WIDTH","timeSinceStr","date","referenceDate","Date","seconds","floor","getTime","interval","timeSince","getCreateAssessmentPayloadValue","formValue","dataType","isFeedback","feedback","expectation","serialized_value","serialization_format","fetchFn","fetch","serializeRequestBody","payload","FormData","Blob","fetchAPI","async","method","body","response","headers","ok","predefinedError","matchPredefinedError","json","createAssessment","assessment","trace_id","ModelTraceInfoRefetchContext","refetchTraceInfo","useModelTraceInfoRefetchContext","AssessmentCreateForm","assessmentName","spanId","traceId","intl","useIntl","setName","assessmentType","setAssessmentType","setDataType","setValue","rationale","setRationale","valueError","setValueError","mutate","createAssessmentMutation","isLoading","useMutation","mutationFn","onSuccess","onError","displayErrorNotification","formatMessage","Error","onSettled","isNamePrefilled","handleCreate","valueObj","assessment_name","source","source_type","source_id","getCurrentUser","span_id","SimpleSelect","SimpleSelectOption","onKeyDown","stopPropagation","TextArea","autoSize","minRows","maxRows","validationState","FormUI","Message","Number","loading","AssessmentCreateButton","PlusIcon","AssessmentActionsOverflowMenu","setIsEditing","setShowDeleteModal","user","isEditEnabled","shouldEnableAssessmentEditing","doesUserHavePermissions","showEditButton","OverflowIcon","Item","IconWrapper","PencilIcon","TrashIcon","AssessmentDeleteModal","isModalVisible","setIsModalVisible","deleteAssessmentMutation","deleteAssessment","assessmentId","assessment_id","handleDelete","Modal","visible","onOk","okButtonProps","danger","okText","onCancel","cancelText","confirmLoading","useUpdateAssessment","updateAssessmentMutation","updateAssessment","AssessmentEditForm","initialValue","getAssessmentValue","defaultType","getDefaultType","defaultValue","getDefaultValue","isUpdating","overrideAssessmentMutation","isOverwriting","useOverrideAssessment","oldAssessment","newAssessment","overrides","omit","handleUpdate","update_mask","ExpectationValuePreview","objectKey","displayValue","SpanNameDetailViewLink","_node$type","hasException","getSpanExceptionCount","textDecorationColor","actionDangerDefaultTextDefault","actionDefaultTextDefault","getIconTypeForSpan","ModelSpanType","UNKNOWN","getValuePreview","parsedValue","item","isObject","ExpectationItem","isEditing","showDeleteModal","associatedSpan","showAssociatedSpan","getParsedExpectationValue","AssessmentDisplayValue","jsonValue","CheckCircleIcon","DangerIcon","AssessmentSourceName","textWrap","blue500","AssessmentItemHeader","renderConnector","SourceIcon","UserIcon","SparkleIcon","CodeIcon","getSourceIcon","left","borderLeft","borderRadiusFull","last_update_time","FeedbackErrorItem","Alert","closable","error_code","error_message","stack_trace","footer","FeedbackHistoryItem","lg","FeedbackHistoryModal","assessmentHistory","seen","flattened","currentAssessment","has","overriddenAssessment","flattenOverrides","FeedbackItemContent","isHistoryModalVisible","setIsHistoryModalVisible","FeedbackItem","getSourceTypeIcon","sourceType","smallIconStyles","FeedbackValueGroupSourceCounts","feedbacks","sourceCounts","countBy","FeedbackValueGroup","valid","FeedbackGroup","valuesMap","activeSpanId","displayName","getAssessmentDisplayName","showCreateForm","setShowCreateForm","hasError","flat","AssessmentsPane","expectations","partition","groupedFeedbacks","aggregated","group","toSorted","leftName","rightName","localeCompare","groupFeedbacks","sortedExpectations","CloseIcon","ModelTraceExplorerRightPaneTabsImpl","contentStyle","exceptionCount","tabContent","Tabs","tab","List","ModelTraceExplorerResizablePane","ModelTraceExplorerRightPaneTabs","TimelineTreeFilterButton","Popover","FilterIcon","align","shouldDisplay","Checkbox","isChecked","getDisplayNameForSpanType","InfoTooltip","TimelineTreeHeader","showTimelineInfo","setShowTimelineInfo","ListBorderIcon","BarsAscendingVerticalIcon","IconBottomConnector","active","bottom","SPAN_INDENT_WIDTH","borderRight","IconLeftConnector","VerticalConnector","TimelineTreeHierarchyBars","isActiveSpan","isInActiveChain","linesToRender","hasChildren","isExpanded","shouldRender","isActive","TimelineTreeSpanTooltip","_span$type","iconType","primaryTextColor","grey800","grey100","secondaryTextColor","grey500","grey350","hideWhenDetached","isInTooltip","side","TimelineTreeNode","selectedKey","traceStartTime","traceEndTime","onSelect","activeChildIndex","actionDefaultBackgroundHover","actionDefaultBackgroundPress","newExpandedKeys","delete","_node$children$length","_node$children3","concat","TimelineTreeGanttNode","leftOffset","titleInBarRef","titleBesideBarRef","offsetWidth","blue600","white","TimelineTreeGanttBars","_useResizeObserver$wi","treeContainerRef","treeElementWidth","initialXTicks","graphWidth","minPixelsBetweenTicks","range","maxTickCount","rawInterval","magnitude","pow","log10","residual","niceFraction","niceInterval","extendedRight","ticks","tick","ceil","getNiceXTicks","min","xTicks","scaleDurationToTreeWidth","scaleX","n","transform","pointerEvents","TimelineTree","rootNodes","onSpanClick","expandedNodesList","getTimelineTreeExpandedNodesList","_traversedNode$childr","treeElement","_selectedNode$key2","ModelTraceExplorerDetailView","selectedSpanId","onSelectSpan","_treeNode$start","_treeNode$end","window","innerWidth","paneRef","useTimelineTreeExpandedNodes","params","list","initialExpandDepth","info","leftPaneMinWidth","minWidthForSpans","CONTENT_PANE_MIN_WIDTH","useGetModelTraceInfoV3","setModelTrace","setAssessmentsPaneEnabled","useQuery","queryFn","fetchTraceInfoV3","prevModelTrace","_response$trace$trace","_response$trace","trace","trace_info","ModelTraceExplorerChatToolsRenderer","tools","ModelTraceExplorerRetrieverFieldRenderer","documents","ModelTraceExplorerTextFieldRenderer","ModelTraceExplorerFieldRenderer","normalizeConversation","isChatTools","every","isModelTraceChatTool","isRetrieverDocuments","isRetrieverDocument","ModelTraceExplorerSummaryViewExceptionsSection","_firstException$attri","exceptionEvents","getSpanExceptionEvents","isRoot","firstException","ModelTraceExplorerSummaryIntermediateNode","spanName","ModelTraceExplorerSummarySpans","intermediateNodes","rootInputs","rootOutputs","exceptions","hasIntermediateNodes","hasExceptions","isNodeImportant","AGENT","RETRIEVER","CHAT_MODEL","TOOL","LLM","ModelTraceExplorerSummaryView","allAssessments","ModelTraceExplorerImpl","enableSummaryView","shouldEnableSummaryView","ContextProviders","refetchContextValue","ModelTraceExplorer","initialModelTrace","getModelTraceId","refetch","Skeleton","ModelTraceExplorerSkeleton","label","TitleSkeleton","TableSkeleton","lines","isAutogenFunctionCall","obj","get","isAutogenMessage","messageType","convertAssistantMessageToChatMessage","prettyPrintChatMessage","f","prettyPrintToolCall","normalizeAutogenMessage","textParts","part","normalizeAutogenChatInput","normalizeAutogenChatOutput","parseBedrockContent","image","bytes","format","Buffer","from","toString","image_url","convertBedrockMessageToChatMessage","contents","toolCalls","toolUse","input","toolUseId","toolResult","resultContent","parsedContent","contentString","chatMessage","isBedrockMessage","hasRole","hasContent","normalizeBedrockChatInput","normalizeBedrockChatOutput","output","wordWrap","builtin","char","class","constant","hexcode","symbol","normalizeOpenAIChatInput","_obj$messages","isRawModelTraceChatMessage","normalizeOpenAIChatResponse","isModelTraceChoices","choice","_choice$message$tool_","isModelTraceChatResponse","choices","_choice$message$tool_2","isOpenAIResponsesInputMessage","isOpenAIResponsesOutputItem","outputFormat","normalizeOpenAIResponsesInputMessage","normalizeOpenAIResponsesInputItem","imageUrl","normalizeOpenAIResponsesInput","normalizeOpenAIResponsesOutputItem","call_id","output_format","result","normalizeOpenAIResponsesOutput","chunk","isOpenAIAgentMessage","normalizeOpenAIAgentMessage","textContent","callId","arguments_","normalizeOpenAIAgentInput","normalizeOpenAIAgentOutput","isLlamaIndexChatMessageBlock","isLlamaIndexChatMessage","blocks","prettyPrintMessage","normalizeLlamaIndexChatResponse","isLlamaIndexChatResponse","normalizeLlamaIndexChatInput","isLlamaIndexChatInput","CONNECT","isRootSpan","iconColor","iconMap","ModelsIcon","DOCUMENT","ConnectIcon","CODE","FUNCTION","NUMBERS","NumbersIcon","SEARCH","SORT","SortUnsortedIcon","QuestionMarkIcon","WrenchIcon","UserSparkleIcon","CHAIN","ChainIcon","GearIcon","actionDefaultIconDefault","tooltipColor","actionPrimaryIcon","textValidationSuccess","green500","green800","green100","turquoise","blue800","blue100","red500","red700","red800","red100","general","iconSize","tooltipBackgroundTooltip","svg","iconFontSize","isAnthropicContentBlockParam","media_type","tool_use_id","isAnthropicMessageParam","normalizeAnthropicContentBlockParam","processAnthropicMessage","toolMessages","processAnthropicMessageContent","normalizeAnthropicChatInput","normalizeAnthropicChatOutput","isGeminiContentPart","isGeminiContent","parts","isGeminiCandidate","normalizeGeminiChatInput","normalizeGeminiChatOutput","candidates","langchainMessageToModelTraceMessage","_message$additional_k","_part$image_url","normalizedMessage","toolCallsFromKwargs","additional_kwargs","isLangchainToolCallMessage","normalizeLangchainToolCall","isModelTraceToolCall","args","isLangchainBaseMessage","isLangchainChatGeneration","normalizeLangchainChatInput","getMessagesFromLangchainChatGenerations","generations","generation","normalizeLangchainChatResult","isLangchainChatGenerations","normalizeDspyChatInput","msg","normalizeDspyChatOutput"],"sourceRoot":""}