"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[4769],{17297:function(e,r,t){t.d(r,{KR:function(){return i},nX:function(){return n},wO:function(){return o}});const n=()=>!0,o=()=>!0,i=()=>!0},27193:function(e,r,t){t.d(r,{z7:function(){return M},VE:function(){return T}});var n=t(17729),o=t(67122),i=t(82328),s=t(67699),a=t(42346),u=t(74702),c=t(34939),l=t(72670),d=t(2844),p=t(50211),f=t(9133),h=t(50111),g=t(31014),m=t(37523),v=t(13062);var E={name:"1739oy8",styles:"z-index:1"};function y({tooltipMessage:e,...r}){const t=E;return(0,h.Y)(m.LegacyTooltip,{title:e,children:(0,h.Y)(v.B,{componentId:"codegen_web-shared_src_snippet_actions_snippetactionbutton.tsx_33",...r,css:t})})}var N=t(96950),w=t(6958),A=t(88464);function T({copyText:e,onClick:r,...t}){const{actionIcon:n,tooltipMessage:o,copy:i}=function(e,r,t){const n=(0,A.A)(),o=r||n.formatMessage({id:"hBAhI8",defaultMessage:"Copy"}),i=n.formatMessage({id:"g4hHzO",defaultMessage:"Copied"}),s=(0,N.useClipboard)(),a=(0,g.useRef)(),[u,c]=(0,g.useState)(!1),[l,d]=(0,g.useState)(!1);return(0,g.useEffect)((()=>()=>{window.clearTimeout(a.current)}),[]),{actionIcon:u?(0,h.Y)(w.C,{}):(0,h.Y)(m.CopyIcon,{}),tooltipMessage:u?i:o,copy:()=>{s.copy(e),window.clearTimeout(a.current),c(!0),null===t||void 0===t||t(),a.current=window.setTimeout((()=>{c(!1)}),3e3)},copied:u,ariaLabel:o,tooltipOpen:l||u,handleTooltipOpenChange:d}}(e);return(0,h.Y)(y,{tooltipMessage:o,icon:n,onClick:e=>{i(),null===r||void 0===r||r(e)},...t})}n.A.registerLanguage("sql",l.A),n.A.registerLanguage("java",i.A),n.A.registerLanguage("python",u.A),n.A.registerLanguage("go",o.A),n.A.registerLanguage("javascript",s.A),n.A.registerLanguage("yaml",c.A),n.A.registerLanguage("json",a.A);const R="24px",S={light:p.A,duotoneDark:d.A};function M({theme:e="light",language:r,actions:t,style:o,children:i,showLineNumbers:s,lineNumberStyle:a,wrapLongLines:u,wrapLines:c,PreTag:l}){const d={border:"none",borderRadius:0,margin:0,padding:R,...o};return(0,h.Y)(n.A,{showLineNumbers:s,lineNumberStyle:a,language:r,style:S[e],customStyle:d,codeTagProps:{style:(0,f.pick)(o,"backgroundColor")},wrapLongLines:u,wrapLines:c,PreTag:l,children:i})}},30576:function(e,r,t){t.r(r),t.d(r,{CodeSnippetRenderMode:function(){return a.cC},INFERENCE_TABLE_RESPONSE_COLUMN_KEY:function(){return a.O5},INFERENCE_TABLE_TRACE_COLUMN_KEY:function(){return a.So},MLFLOW_TRACE_SCHEMA_VERSION_KEY:function(){return a.jQ},ModelIconType:function(){return a.Dy},ModelSpanType:function(){return a.UG},ModelTraceExplorer:function(){return n.a},ModelTraceExplorerOSSNotebookRenderer:function(){return o.$},ModelTraceSpanType:function(){return a.VZ},getIsMlflowTraceUIEnabled:function(){return s.KR},getModelTraceId:function(){return i.MF},getModelTraceSpanEndTime:function(){return i.jE},getModelTraceSpanId:function(){return i.wH},getModelTraceSpanParentId:function(){return i.cp},getModelTraceSpanStartTime:function(){return i.CR},getTraceArtifact:function(){return u.g},isModelTrace:function(){return i.Lq},isV3ModelTraceSpan:function(){return i.UZ}});var n=t(8409),o=t(87956),i=t(46932),s=t(17297),a=t(48563),u=t(75060)},39416:function(e,r,t){t.d(r,{a$:function(){return u}});var n=t(88443);let o=function(e){return e.UserInputError="UserInputError",e.UnexpectedSystemStateError="UnexpectedSystemStateError",e.ServerError="ServerError",e.SessionError="SessionError",e.NetworkError="NetworkError",e.ApplicationError="ApplicationError",e.UnknownError="UnknownError",e}({}),i=function(e){return e.BadRequestError="BadRequestError",e.DatasetRunNotFoundError="DatasetRunNotFoundError",e.FormValidationError="FormInputError",e.GenericNetworkRequestError="GenericNetworkRequestError",e.GraphQLGenericError="GraphQLGenericError",e.InternalServerError="InternalServerError",e.NotFoundError="NotFoundError",e.PermissionError="PermissionError",e.RateLimitedError="RateLimitedError",e.RouteNotFoundError="RouteNotFoundError",e.ServiceUnavailableError="ServiceUnavailableError",e.UnauthorizedError="UnauthorizedError",e.UnknownError="UnknownError",e}({});var s=t(50111);class a extends Error{constructor(e,r){super(e),this.errorLogType=void 0,this.errorName=void 0,this.displayMessage=void 0,this.isUserError=!1}}const u=e=>e instanceof a?e:e instanceof Error&&("networkError"in e||"graphQLErrors"in e)?c(e):e instanceof Response?l(e):new w(e);const c=e=>{return"networkError"in e&&((r=e.networkError)instanceof Error&&r.hasOwnProperty("response"))?l(e.networkError.response,e.networkError):new f(e);var r},l=(e,r)=>{const t=d.getNetworkRequestErrorDetailsFromResponse(e);switch(e.status){case 400:return new h(t,r);case 401:return new N(t,r);case 403:return new v(t,r);case 404:return new m(t,r);case 429:return new E(t,r);case 500:return new g(t,r);case 503:return new y(t,r);default:return new p(t,r)}};class d extends a{constructor(e,r,t){super(e,t),this.status=void 0,this.response=void 0,this.status=r.status,this.response=r.response}}d.getNetworkRequestErrorDetailsFromResponse=e=>({status:e.status});class p extends d{constructor(e,r){super("A network error occurred.",e,r),this.errorLogType=o.ServerError,this.errorName=i.GenericNetworkRequestError,this.displayMessage=(0,s.Y)(n.A,{id:"/CaNq/",defaultMessage:"A network error occurred."})}}class f extends a{constructor(e){super("A GraphQL error occurred.",e),this.errorLogType=o.ApplicationError,this.errorName=i.GraphQLGenericError,this.displayMessage=(0,s.Y)(n.A,{id:"PPPbd+",defaultMessage:"A GraphQL error occurred."})}}class h extends d{constructor(e,r){super("The request was invalid.",e,r),this.errorLogType=o.UserInputError,this.errorName=i.BadRequestError,this.displayMessage=(0,s.Y)(n.A,{id:"Id2mFI",defaultMessage:"The request was invalid."})}}class g extends d{constructor(e,r){super("Internal server error",e,r),this.errorLogType=o.ServerError,this.errorName=i.InternalServerError,this.displayMessage=(0,s.Y)(n.A,{id:"nY1YrF",defaultMessage:"Internal server error"})}}class m extends d{constructor(e,r){super("The requested resource was not found.",e,r),this.errorLogType=o.UserInputError,this.errorName=i.NotFoundError,this.displayMessage=(0,s.Y)(n.A,{id:"R3Lb6z",defaultMessage:"The requested resource was not found."}),this.isUserError=!0}}class v extends d{constructor(e,r){super("You do not have permission to access this resource.",e,r),this.errorLogType=o.UnexpectedSystemStateError,this.errorName=i.PermissionError,this.displayMessage=(0,s.Y)(n.A,{id:"G6IQTa",defaultMessage:"You do not have permission to access this resource."}),this.isUserError=!0}}class E extends d{constructor(e,r){super("This request exceeds the maximum queries per second limit. Please wait and try again.",e,r),this.errorLogType=o.ServerError,this.errorName=i.RateLimitedError,this.displayMessage=(0,s.Y)(n.A,{id:"5PlfiT",defaultMessage:"This request exceeds the maximum queries per second limit. Please wait and try again."})}}class y extends d{constructor(e,r){super("Internal server error",e,r),this.errorLogType=o.ServerError,this.errorName=i.InternalServerError,this.displayMessage=(0,s.Y)(n.A,{id:"/XlqZA",defaultMessage:"Service unavailable error"})}}class N extends d{constructor(e,r){super("This request exceeds the maximum queries per second limit. Please wait and try again.",e,r),this.errorLogType=o.SessionError,this.errorName=i.UnauthorizedError,this.displayMessage=(0,s.Y)(n.A,{id:"gqfk5C",defaultMessage:"User is not authorized."})}}class w extends a{constructor(e){super("An unknown error occurred.",e),this.errorLogType=o.UnknownError,this.errorName=i.UnknownError,this.displayMessage=(0,s.Y)(n.A,{id:"bKSd3c",defaultMessage:"An unknown error occurred."})}}},39771:function(e,r,t){t(31014)},46932:function(e,r,t){t.d(r,{CL:function(){return z},CR:function(){return L},HW:function(){return f},Hq:function(){return Q},I$:function(){return B},LS:function(){return m},Lq:function(){return O},MF:function(){return _},N7:function(){return q},OS:function(){return D},PC:function(){return K},Q0:function(){return F},UZ:function(){return R},W0:function(){return G},ZI:function(){return Z},bn:function(){return P},cp:function(){return M},f7:function(){return N},g_:function(){return C},h8:function(){return j},ij:function(){return h},in:function(){return $},jE:function(){return b},jW:function(){return I},tC:function(){return g},vL:function(){return y},vl:function(){return Y},wH:function(){return S},x0:function(){return V}});var n=t(89555),o=t(9133),i=t(48563),s=t(86494),a=t(92151),u=t(79912),c=t(76901),l=t(36784),d=t(38237),p=t(50111);const f=()=>"User",h=e=>{};function g(e){switch(e){case i.UG.LLM:return i.Dy.MODELS;case i.UG.CHAIN:return i.Dy.CHAIN;case i.UG.AGENT:return i.Dy.AGENT;case i.UG.TOOL:return i.Dy.WRENCH;case i.UG.CHAT_MODEL:return i.Dy.MODELS;case i.UG.RETRIEVER:return i.Dy.SEARCH;case i.UG.PARSER:return i.Dy.CODE;case i.UG.EMBEDDING:return i.Dy.NUMBERS;case i.UG.RERANKER:return i.Dy.SORT;case i.UG.FUNCTION:return i.Dy.FUNCTION;case i.UG.UNKNOWN:return i.Dy.UNKNOWN;default:return i.Dy.FUNCTION}}function m(e){switch(e){case i.UG.LLM:return"LLM";case i.UG.CHAIN:return"Chain";case i.UG.AGENT:return"Agent";case i.UG.TOOL:return"Tool";case i.UG.CHAT_MODEL:return"Chat model";case i.UG.RETRIEVER:return"Retriever";case i.UG.PARSER:return"Parser";case i.UG.EMBEDDING:return"Embedding";case i.UG.RERANKER:return"Reranker";case i.UG.FUNCTION:return"Function";case i.UG.UNKNOWN:return"Unknown";default:return e}}function v(e){try{return JSON.parse(e)}catch(r){return e}}const E=(e,r)=>{if(!r)return[];const t=[],n={inputs:null===e||void 0===e?void 0:e.inputs,outputs:null===e||void 0===e?void 0:e.outputs,attributes:null===e||void 0===e?void 0:e.attributes,events:null===e||void 0===e?void 0:e.events};return(0,o.map)(n,((n,o)=>{if("events"===o)return void t.push(...((e,r)=>{const t=e.events;if(!t)return[];const n=[];return t.forEach(((t,o)=>{const i=t.attributes;i&&Object.keys(i).forEach((s=>{const a=s.toLowerCase().includes(r),u=F(t.name,o,s);a&&n.push({span:e,section:"events",key:u,isKeyMatch:!0,matchIndex:0});const c=JSON.stringify(i[s]).toLowerCase().split(r).length-1;for(let r=0;r<c;r++)n.push({span:e,section:"events",key:u,isKeyMatch:!1,matchIndex:r})}))})),n})(e,r));C(n).forEach((n=>{n.key.toLowerCase().includes(r)&&t.push({span:e,section:o,key:n.key,isKeyMatch:!0,matchIndex:0});const i=n.value.toLowerCase().split(r).length-1;for(let r=0;r<i;r++)t.push({span:e,section:o,key:n.key,isKeyMatch:!1,matchIndex:r})}))})),t};function y(e,r,t){var n,o;const i=r.toLowerCase().trim(),s=Object.values(t.spanTypeDisplayState).every((e=>e));if(""===i&&s)return{filteredTreeNodes:[e],matches:[]};const a=null!==(n=e.children)&&void 0!==n?n:[],u=[],c=[];a.forEach((e=>{const{filteredTreeNodes:r,matches:n}=y(e,i,t);u.push(...r),c.push(...n)}));const l=(null!==(o=e.title)&&void 0!==o?o:"").toLowerCase(),d=E(e,i),p=d.length>0||l.includes(i),f=!e.type||t.spanTypeDisplayState[e.type],h=p&&f,g=u.length>0,m=q(e)>0;return h||t.showParents&&g||t.showExceptions&&m?{filteredTreeNodes:[{...e,children:u}],matches:d.concat(c)}:{filteredTreeNodes:u,matches:c}}function N(e,r){var t;if((0,o.isNil)(r)||(0,o.isNil)(e))return;if(e.key===r)return e;const n=null!==(t=e.children)&&void 0!==t?t:[];for(const o of n){const e=N(o,r);if(e)return e}}const w=(e,r,t,n,i,a)=>{var u,c,l,d,f,h,m,E;const y=v(null===(u=e.attributes)||void 0===u?void 0:u["mlflow.spanType"]),N=v(null===(c=e.attributes)||void 0===c?void 0:c["mlflow.spanInputs"]),w=v(null===(l=e.attributes)||void 0===l?void 0:l["mlflow.spanOutputs"]),A=M(e),T=S(e),R=null!==(d=i[T])&&void 0!==d?d:[];var _;A||R.push(...null!==(_=i[""])&&void 0!==_?_:[]);const I=v(null===(f=e.attributes)||void 0===f?void 0:f["mlflow.chat.messages"]),k=v(null===(h=e.attributes)||void 0===h?void 0:h["mlflow.message.format"]),U=((e,r,t,n)=>{var i,s;if(Array.isArray(e)&&e.every(B))return(0,o.compact)(e.map(Z));const a=null!==(i=Q(r,null===n||void 0===n?void 0:n["mlflow.message.format"]))&&void 0!==i?i:[],u=null!==(s=Q(t,null===n||void 0===n?void 0:n["mlflow.message.format"]))&&void 0!==s?s:[];return 0!==a.length&&0!==u.length?a.concat(u):void 0})(I,N,w,k?{"mlflow.message.format":k}:void 0),x=((e,r)=>{var t;return Array.isArray(e)&&e.every(K)?e:Array.isArray(null===r||void 0===r?void 0:r.tools)&&null!==r&&void 0!==r&&null!==(t=r.tools)&&void 0!==t&&t.every(K)?r.tools:void 0})(v(null===(m=e.attributes)||void 0===m?void 0:m["mlflow.chat.tools"]),N),O=(0,o.mapValues)((0,o.omitBy)(e.attributes,((e,r)=>r.startsWith("mlflow."))),(e=>v(e))),C=e.events,D=(Number(L(e))-r)/1e3,G=(Number(null!==(E=b(e))&&void 0!==E?E:t)-r)/1e3;return{title:e.name,icon:(0,p.Y)(s.P,{type:g(y),hasException:q(e)>0,isRootSpan:!A}),type:y,key:T,start:D,end:G,children:n,inputs:N,outputs:w,attributes:O,events:C,chatMessages:U,chatTools:x,parentId:A,assessments:R,traceId:a}},A=(e,r)=>{if(r)try{return(e=>{const r=atob(e),t=r.length;let n="";for(let o=0;o<t;o++)n+=r.charCodeAt(o).toString(16).padStart(2,"0");return n})(e)}catch(t){return e}return e.startsWith("0x")?e.slice(2):e};function T(e){return"trace_metadata"in e}function R(e){return"start_time_unix_nano"in e}function S(e){var r,t;return R(e)?A(e.span_id,!0):A(null!==(r=null===(t=e.context)||void 0===t?void 0:t.span_id)&&void 0!==r?r:"",!1)}function M(e){var r;return R(e)?A(e.parent_span_id,!0):A(null!==(r=e.parent_id)&&void 0!==r?r:"",!1)}function L(e){return R(e)?Number(e.start_time_unix_nano):Number(e.start_time)}function b(e){return R(e)?Number(e.end_time_unix_nano):Number(e.end_time)}function _(e){var r;return T(e.info)?e.info.trace_id:null!==(r=e.info.request_id)&&void 0!==r?r:""}function I(e){var r,t;const n=_(e),a=null!==(r=null===(t=e.trace_data)||void 0===t?void 0:t.spans)&&void 0!==r?r:e.data.spans,u={},c={};a.forEach((e=>{const r=S(e);u[r]=e,c[r]=[]})),a.forEach((e=>{const r=S(e),t=M(e);if(t){if(!c[t])throw new Error("Tree structure is malformed!");c[t].push(r)}}));const l=a.find((e=>!M(e)));if((0,o.isNil)(l))return null;return function r(t){var o,a,d;const f=u[t],h=Number(L(l)),m=Number(b(l)),v=c[t].map(r),E=k(e.info);if(R(f)||"parent_id"in f)return w(f,h,m,v,E,n);const y=null!==(o=f.span_type)&&void 0!==o?o:i.UG.UNKNOWN;return{title:f.name,icon:(0,p.Y)(s.P,{type:g(y)}),type:y,key:f.context.span_id,start:Number(f.start_time)-h,end:Number(null!==(a=f.end_time)&&void 0!==a?a:m)-h,children:v,inputs:f.inputs,outputs:f.outputs,attributes:f.attributes,events:f.events,parentId:null!==(d=f.parent_id)&&void 0!==d?d:f.parent_span_id,assessments:[],traceId:n}}(S(l))}const k=e=>{let r=[];var t;T(e)?r=null!==(t=e.assessments)&&void 0!==t?t:[]:r=U(e.tags);const n=(0,o.keyBy)(r,"assessment_id");Object.values(n).forEach((e=>{if(e.overrides){const r=n[e.overrides];e.overriddenAssessment=r}})),r=Object.values(n);const i=r.reduce(((e,r)=>{var t;const n=null!==(t=r.span_id)&&void 0!==t?t:"";return e[n]||(e[n]=[]),e[n].push(r),e}),{});return Object.keys(i).forEach((e=>{i[e].sort(((e,r)=>new Date(r.last_update_time).getTime()-new Date(e.last_update_time).getTime()))})),i},U=e=>{if(!e)return[];return(Array.isArray(e)?e:Object.entries(e).map((([e,r])=>({key:e,value:r})))).filter((({key:e})=>e.startsWith("mlflow.assessment."))).map((({value:e})=>JSON.parse(e)))};function x(e){var r;if(e)return(0,o.isArray)(e)?null===(r=e.find((e=>e.key===i.jQ)))||void 0===r?void 0:r.value:e[i.jQ]}const O=e=>{var r;const t=null===e||void 0===e?void 0:e.info,n=null===e||void 0===e?void 0:e.data;if(!t||!n||null===n||void 0===n||!n.spans)return!1;const o=null!==(r=null===t||void 0===t?void 0:t.request_metadata)&&void 0!==r?r:null===t||void 0===t?void 0:t.trace_metadata;if(o&&x(o))return!0;const i=null===t||void 0===t?void 0:t.tags;return!(!i||!x(i))},C=e=>(0,o.isNil)(e)?[]:Array.isArray(e)||(0,o.isString)(e)||(0,o.isNumber)(e)||(0,o.isBoolean)(e)?[{key:"",value:JSON.stringify(e,null,2)}]:Object.entries(e).map((([e,r])=>({key:e,value:JSON.stringify(r,null,2)}))),D=({searchFilter:e,data:r,activeMatchBackgroundColor:t,inactiveMatchBackgroundColor:i,containsActiveMatch:s,activeMatch:a,scrollToActiveMatch:u})=>{const c=new RegExp(`(${(0,o.escapeRegExp)(e.trim())})`,"gi"),l=r.split(c),d=[];let f=0;for(let o=0;o<l.length;o++)if(l[o].toLowerCase().includes(e.toLowerCase().trim())){const e=s&&a.matchIndex===f,r=e?t:i,c=(0,p.Y)("span",{ref:e?u:null,css:(0,n.AH)({backgroundColor:r,scrollMarginTop:50},""),children:l[o]},o);f++,d.push(c)}else d.push(l[o]);return d},G=e=>(0,o.has)(e,"page_content"),Y=e=>e.type===i.UG.RETRIEVER&&Array.isArray(e.outputs)&&e.outputs.length>0&&(0,o.every)(e.outputs,G),F=(e,r,t)=>`${e}-${r}-${t}`,P=e=>{var r;return(null!==(r=e.events)&&void 0!==r?r:[]).filter((e=>"exception"===e.name))},q=e=>P(e).length,H=e=>!(0,o.isNil)(e)&&(!(!(0,o.isNil)(e.type)&&!(0,o.isString)(e.type))&&(!(!(0,o.isNil)(e.description)&&!(0,o.isString)(e.description))&&!(!(0,o.isNil)(e.enum)&&!Array.isArray(e.enum)))),K=e=>{var r;if((0,o.isNil)(e)||"function"!==e.type||!(0,o.has)(e,"function.name"))return!1;const t=null===(r=e.function)||void 0===r?void 0:r.parameters;if(!(0,o.isNil)(t)){const e=t.required;if(!(0,o.isNil)(e)&&(!Array.isArray(e)||!e.every(o.isString)))return!1;const r=t.properties;if(!(0,o.isNil)(r)&&!Object.values(r).every(H))return!1}return!0},j=e=>{var r,t;return e&&(0,o.isString)(e.id)&&(0,o.isString)(null===(r=e.function)||void 0===r?void 0:r.arguments)&&(0,o.isString)(null===(t=e.function)||void 0===t?void 0:t.name)},W=e=>!(!(0,o.isNil)(e)&&!(0,o.isString)(e))||!!(0,o.isArray)(e)&&e.every((e=>(e=>{switch(e.type){case"text":case"input_text":case"output_text":return(0,o.isString)(e.text);case"image_url":const{image_url:r}=e;return!(0,o.isNil)(r)&&(0,o.isString)(r.url)&&((0,o.isNil)(r.detail)||["auto","low","high"].includes(r.detail));case"input_audio":const{input_audio:t}=e;return!(0,o.isNil)(t)&&(0,o.isString)(t.data)&&((0,o.isNil)(t.format)||["wav","mp3"].includes(t.format));default:return!1}})(e))),B=e=>{if(!e)return!1;if(e.tool_calls){if(!Array.isArray(e.tool_calls))return!1;if(!e.tool_calls.every(j))return!1}return"reasoning"===e.type||!!W(e.content)&&("user"===e.role||"assistant"===e.role||"system"===e.role||"tool"===e.role)},V=e=>Array.isArray(e)&&e.length>0&&e.every((e=>{return(0,o.has)(e,"message")&&(r=e.message,!!B(r)&&((0,o.isNil)(r.content)||(0,o.isString)(r.content)));var r})),$=e=>e&&V(e.choices),Q=(e,r)=>{var t,n,i,s,p,f,h,g,m,v,E,y;try{if(Array.isArray(e)&&e.length>0&&e.every(B))return(0,o.compact)(e.map(Z));switch(r){case"langchain":const r=null!==(t=(0,a.HD)(e))&&void 0!==t?t:(0,a.oI)(e);if(r)return r;break;case"llamaindex":const o=null!==(n=(0,u.H)(e))&&void 0!==n?n:(0,a.W3)(e);if(o)return o;break;case"openai":const N=null!==(i=null!==(s=null!==(p=(0,a.a8)(e))&&void 0!==p?p:(0,a.bS)(e))&&void 0!==s?s:(0,a.n_)(e))&&void 0!==i?i:(0,a.AG)(e);if(N)return N;break;case"dspy":const w=null!==(f=(0,a.iU)(e))&&void 0!==f?f:(0,a.Pn)(e);if(w)return w;break;case"gemini":const A=null!==(h=(0,a.DE)(e))&&void 0!==h?h:(0,a.Sy)(e);if(A)return A;break;case"anthropic":const T=null!==(g=(0,a.KF)(e))&&void 0!==g?g:(0,a.pL)(e);if(T)return T;break;case"openai-agent":const R=null!==(m=(0,c.xW)(e))&&void 0!==m?m:(0,c.m$)(e);if(R)return R;break;case"autogen":const S=null!==(v=(0,l.n)(e))&&void 0!==v?v:(0,l.u)(e);if(S)return S;break;case"bedrock":const M=null!==(E=(0,d.Y)(e))&&void 0!==E?E:(0,d.f)(e);if(M)return M;break;default:const L=null!==(y=(0,a.a8)(e))&&void 0!==y?y:(0,a.bS)(e);if(L)return L}return null}catch(N){return null}},z=e=>{var r;let t=null===(r=e.function)||void 0===r?void 0:r.arguments;try{t=JSON.stringify(JSON.parse(t),null,2)}catch(n){}return{id:e.id,function:{arguments:t,name:e.function.name}}},J=e=>{if((0,o.isNil)(e)||(0,o.isString)(e))return e;return e.map((e=>{var r;switch(e.type){case"text":case"input_text":case"output_text":return e.text;case"image_url":const t=null===e||void 0===e||null===(r=e.image_url)||void 0===r?void 0:r.url;return t?`![](${t})`:"[image]";case"input_audio":return"[audio]"}})).filter((e=>void 0!==e)).join("\n\n")},Z=e=>{var r;return"reasoning"===e.type?null:{...e,content:J(e.content),tool_calls:null===(r=e.tool_calls)||void 0===r?void 0:r.map(z)}}},48563:function(e,r,t){t.d(r,{Dy:function(){return a},O5:function(){return o},So:function(){return i},UG:function(){return s},VZ:function(){return u},cC:function(){return c},jQ:function(){return n}});const n="mlflow.trace_schema.version",o="response",i="trace";let s=function(e){return e.LLM="LLM",e.CHAIN="CHAIN",e.AGENT="AGENT",e.TOOL="TOOL",e.FUNCTION="FUNCTION",e.CHAT_MODEL="CHAT_MODEL",e.RETRIEVER="RETRIEVER",e.PARSER="PARSER",e.EMBEDDING="EMBEDDING",e.RERANKER="RERANKER",e.UNKNOWN="UNKNOWN",e}({}),a=function(e){return e.MODELS="models",e.DOCUMENT="document",e.CONNECT="connect",e.SEARCH="search",e.SORT="sort",e.UNKNOWN="unknown",e.FUNCTION="function",e.CODE="code",e.NUMBERS="numbers",e.WRENCH="wrench",e.AGENT="agent",e.CHAIN="chain",e.USER="user",e.SYSTEM="system",e}({}),u=function(e){return e.LLM="LLM",e.CHAIN="CHAIN",e.AGENT="AGENT",e.TOOL="TOOL",e.CHAT_MODEL="CHAT_MODEL",e.RETRIEVER="RETRIEVER",e.PARSER="PARSER",e.EMBEDDING="EMBEDDING",e.RERANKER="RERANKER",e.UNKNOWN="UNKNOWN",e}({}),c=function(e){return e.JSON="json",e.TEXT="text",e.MARKDOWN="markdown",e}({})},75060:function(e,r,t){async function n(e){try{const r=await fetch(`/ajax-api/2.0/mlflow/get-trace-artifact?request_id=${e}`),t=await r.text(),n=JSON.parse(t);return n.spans?{info:{request_id:e},data:n}:n.error_code?n.message:"Unknown error occurred"}catch(r){return r instanceof Error?r.message:"string"===typeof r?r:"Unknown error occurred"}}t.d(r,{g:function(){return n}})},87956:function(e,r,t){t.d(r,{$:function(){return f}});var n=t(89555),o=t(31014),i=t(13062),s=t(37523),a=t(88443),u=t(30576),c=t(50111);const l=(e,r)=>{const t=new URLSearchParams;return t.append("selectedTraceId",e),t.append("compareRunsMode","TRACES"),`/#/experiments/${r}?${t.toString()}`};var d={name:"1elrbzk",styles:"width:calc(100% - 2px)"},p={name:"inxa61",styles:"flex:1;overflow:hidden"};const f=()=>{const e=(0,o.useMemo)((()=>new URLSearchParams(window.location.search).getAll("trace_id")),[]),r=(0,o.useMemo)((()=>new URLSearchParams(window.location.search).getAll("experiment_id")),[]),[t,f]=(0,o.useState)(e.length>0?0:null),[h,g]=(0,o.useState)(null),[m,v]=(0,o.useState)(!0),[E,y]=(0,o.useState)(null),{theme:N}=(0,i.u)();return(0,o.useEffect)((()=>{(async()=>{if(null===t)return;v(!0);const r=e[t],n=await(0,u.getTraceArtifact)(r);"string"===typeof n?y(n):g(n),v(!1)})()}),[t,e]),0===e.length||null===t?null:m?(0,c.Y)("div",{css:d,children:(0,c.Y)(i.T.Text,{color:"secondary",children:(0,c.Y)(a.A,{id:"JJFZ1V",defaultMessage:"Fetching trace data..."})})}):h?(0,c.FD)("div",{css:(0,n.AH)({display:"flex",flexDirection:"column",border:`1px solid ${N.colors.border}`,height:"calc(100% - 2px)"},""),children:[(0,c.FD)("div",{css:(0,n.AH)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:`${N.spacing.xs}px ${N.spacing.md}px`},""),children:[(0,c.FD)("div",{css:(0,n.AH)({display:"flex",alignItems:"center",gap:N.spacing.sm},""),children:[(0,c.Y)(i.T.Title,{level:4,withoutMargins:!0,children:"MLflow Trace UI"}),(0,c.Y)(s.InfoTooltip,{componentId:"mlflow.notebook.trace-ui-info",iconTitle:"More information",maxWidth:400,content:(0,c.Y)(a.A,{id:"LED2z5",defaultMessage:"To disable or enable this display, call {disableFunction} or {enableFunction} and re-run the cell",values:{disableFunction:(0,c.Y)("code",{children:"mlflow.tracing.disable_notebook_display()"}),enableFunction:(0,c.Y)("code",{children:"mlflow.tracing.enable_notebook_display()"})}})}),(0,c.Y)(i.T.Link,{componentId:"mlflow.notebook.trace-ui-learn-more-link",href:"https://mlflow.org/docs/latest/llms/tracing/index.html?ref=jupyter-notebook-widget",openInNewTab:!0,title:"Learn More",children:(0,c.Y)(a.A,{id:"uIY1qq",defaultMessage:"Learn More"})})]}),(0,c.Y)(i.T.Link,{componentId:"mlflow.notebook.trace-ui-see-in-mlflow-link",href:l(e[t],r[t]),openInNewTab:!0,title:"View in MLflow UI",children:(0,c.Y)(a.A,{id:"4NyhOm",defaultMessage:"View in MLflow UI"})})]}),e.length>1&&(0,c.Y)(s.Pagination,{componentId:"mlflow.notebook.pagination",currentPageIndex:t+1,dangerouslySetAntdProps:{showQuickJumper:!0},numTotal:e.length,onChange:e=>f(e-1),pageSize:1,style:{marginBottom:N.spacing.sm,paddingLeft:N.spacing.sm,paddingRight:N.spacing.sm}}),(0,c.Y)("div",{css:p,children:(0,c.Y)(u.ModelTraceExplorer,{modelTrace:h,initialActiveView:"detail"})})]}):(0,c.Y)("div",{css:(0,n.AH)({paddingTop:N.spacing.md,width:"calc(100% - 2px)"},""),children:(0,c.Y)(s.Empty,{image:(0,c.Y)(i.l,{}),description:(0,c.FD)(c.FK,{children:[(0,c.Y)(i.T.Paragraph,{children:(0,c.Y)(a.A,{id:"UD4Z+e",defaultMessage:"An error occurred while attempting to fetch trace data (ID: {traceId}). Please ensure that the MLflow tracking server is running, and that the trace data exists. Error details:",values:{traceId:e[t]}})}),E&&(0,c.Y)(i.T.Paragraph,{children:E})]}),title:(0,c.Y)(a.A,{id:"md81Lo",defaultMessage:"Error"})})})}},94026:function(e,r,t){t.d(r,{wY:function(){return o}});var n=t(31014);t(18930);function o({ref:e,debounceTimeMs:r}){const t=(0,n.useRef)({width:-1,height:-1}),o=(0,n.useRef)(),[i,s]=(0,n.useState)(null),a=(0,n.useCallback)((e=>{if(0===e.length)return;const n=e[0].contentRect;if(-1===t.current.width)return t.current={width:n.width,height:n.height},void s(t.current);if(n.width!==t.current.width||n.height!==t.current.height){if(t.current.width=n.width,t.current.height=n.height,!r)return void s({...t.current});clearTimeout(o.current),o.current=setTimeout((()=>{s({...t.current})}),r)}}),[r]),u=(0,n.useRef)();return u.current||(u.current=new ResizeObserver(a)),(0,n.useEffect)((()=>{const r="function"===typeof e?e():e.current;if(r){const e=u.current;return e.observe(r),()=>e.unobserve(r)}})),i}t(39771)}}]);
//# sourceMappingURL=4769.79f48d1d.chunk.js.map